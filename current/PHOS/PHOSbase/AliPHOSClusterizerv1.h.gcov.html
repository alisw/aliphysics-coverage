<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - coverage.info - PHOS/PHOSbase/AliPHOSClusterizerv1.h</title>
  <link rel="stylesheet" type="text/css" href="../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../index.html">top level</a> - <a href="index.html">PHOS/PHOSbase</a> - AliPHOSClusterizerv1.h<span style="font-size: 80%;"> (source / <a href="AliPHOSClusterizerv1.h.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">coverage.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">1</td>
            <td class="headerCovTableEntry">20</td>
            <td class="headerCovTableEntryLo">5.0 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2016-06-14 17:26:59</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">2</td>
            <td class="headerCovTableEntry">23</td>
            <td class="headerCovTableEntryLo">8.7 %</td>
          </tr>
          <tr><td><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            : #ifndef ALIPHOSCLUSTERIZERV1_H</a>
<span class="lineNum">       2 </span>            : #define ALIPHOSCLUSTERIZERV1_H
<span class="lineNum">       3 </span>            : /* Copyright(c) 1998-1999, ALICE Experiment at CERN, All rights reserved. *
<span class="lineNum">       4 </span>            :  * See cxx source for full Copyright notice                               */
<span class="lineNum">       5 </span>            : 
<span class="lineNum">       6 </span>            : /* $Id$ */
<span class="lineNum">       7 </span>            : 
<span class="lineNum">       8 </span>            : /* History of cvs commits:
<span class="lineNum">       9 </span>            :  *
<span class="lineNum">      10 </span>            :  * $Log: AliPHOSClusterizerv1.h,v $
<span class="lineNum">      11 </span>            :  * Revision 1.54  2007/10/01 20:24:08  kharlov
<span class="lineNum">      12 </span>            :  * Memory leaks fixed
<span class="lineNum">      13 </span>            :  *
<span class="lineNum">      14 </span>            :  * Revision 1.53  2007/08/28 12:55:07  policheh
<span class="lineNum">      15 </span>            :  * Loaders removed from the reconstruction code (C.Cheshkov)
<span class="lineNum">      16 </span>            :  *
<span class="lineNum">      17 </span>            :  * Revision 1.52  2007/08/07 14:16:00  kharlov
<span class="lineNum">      18 </span>            :  * Quality assurance added (Yves Schutz)
<span class="lineNum">      19 </span>            :  *
<span class="lineNum">      20 </span>            :  * Revision 1.51  2007/04/11 11:55:45  policheh
<span class="lineNum">      21 </span>            :  * SetDistancesToBadChannels() added.
<span class="lineNum">      22 </span>            :  *
<span class="lineNum">      23 </span>            :  * Revision 1.50  2007/03/28 19:18:15  kharlov
<span class="lineNum">      24 </span>            :  * RecPoints recalculation in TSM removed
<span class="lineNum">      25 </span>            :  *
<span class="lineNum">      26 </span>            :  * Revision 1.49  2007/03/06 06:51:27  kharlov
<span class="lineNum">      27 </span>            :  * Calculation of cluster properties dep. on vertex posponed to TrackSegmentMaker
<span class="lineNum">      28 </span>            :  *
<span class="lineNum">      29 </span>            :  * Revision 1.48  2006/08/30 16:12:52  kharlov
<span class="lineNum">      30 </span>            :  * Reconstruction of raw data from beam test 2006 (B.Polichtchouk)
<span class="lineNum">      31 </span>            :  *
<span class="lineNum">      32 </span>            :  * Revision 1.47  2006/08/25 16:56:30  kharlov
<span class="lineNum">      33 </span>            :  * Compliance with Effective C++
<span class="lineNum">      34 </span>            :  *
<span class="lineNum">      35 </span>            :  * Revision 1.46  2006/08/01 12:20:17  cvetan
<span class="lineNum">      36 </span>            :  * 1. Adding a possibility to read and reconstruct an old rcu formatted raw data. This is controlled by an option of AliReconstruction and AliPHOSReconstructor. 2. In case of raw data processing (without galice.root) create the default AliPHOSGeometry object. Most likely this should be moved to the CDB
<span class="lineNum">      37 </span>            :  *
<span class="lineNum">      38 </span>            :  * Revision 1.45  2006/04/29 20:26:46  hristov
<span class="lineNum">      39 </span>            :  * Separate EMC and CPV calibration (Yu.Kharlov)
<span class="lineNum">      40 </span>            :  *
<span class="lineNum">      41 </span>            :  * Revision 1.44  2005/09/02 14:32:07  kharlov
<span class="lineNum">      42 </span>            :  * Calibration of raw data
<span class="lineNum">      43 </span>            :  *
<span class="lineNum">      44 </span>            :  * Revision 1.43  2005/05/28 14:19:04  schutz
<span class="lineNum">      45 </span>            :  * Compilation warnings fixed by T.P.
<span class="lineNum">      46 </span>            :  *
<span class="lineNum">      47 </span>            :  */
<span class="lineNum">      48 </span>            : 
<span class="lineNum">      49 </span>            : //_________________________________________________________________________
<span class="lineNum">      50 </span>            : //  Implementation version 1 of the clusterization algorithm                     
<span class="lineNum">      51 </span>            : //  Performs clusterization (collects neighbouring active cells) and 
<span class="lineNum">      52 </span>            : //  unfolding of the clusters with several local maxima.  
<span class="lineNum">      53 </span>            : //  results are stored in TreeR#, branches PHOSEmcRP (EMC recPoints),
<span class="lineNum">      54 </span>            : //  PHOSCpvRP (CPV RecPoints) and AliPHOSClusterizer
<span class="lineNum">      55 </span>            : //
<span class="lineNum">      56 </span>            : //*-- Author: Yves Schutz (SUBATECH)
<span class="lineNum">      57 </span>            : 
<span class="lineNum">      58 </span>            : // --- ROOT system ---
<span class="lineNum">      59 </span>            : class TClonesArray ;
<span class="lineNum">      60 </span>            : class TVector3 ;
<span class="lineNum">      61 </span>            : // --- Standard library ---
<span class="lineNum">      62 </span>            : 
<span class="lineNum">      63 </span>            : // --- AliRoot header files ---
<span class="lineNum">      64 </span>            : 
<span class="lineNum">      65 </span>            : #include &quot;AliPHOSClusterizer.h&quot;
<span class="lineNum">      66 </span>            : class AliPHOSEmcRecPoint ; 
<span class="lineNum">      67 </span>            : class AliPHOSDigit ;
<span class="lineNum">      68 </span>            : class AliPHOSDigitizer ;
<span class="lineNum">      69 </span>            : class AliPHOSGeometry ;
<span class="lineNum">      70 </span>            : 
<span class="lineNum">      71 </span>            : class AliPHOSClusterizerv1 : public AliPHOSClusterizer {
<span class="lineNum">      72 </span>            :   
<span class="lineNum">      73 </span>            : public:
<span class="lineNum">      74 </span>            :   
<span class="lineNum">      75 </span>            :   AliPHOSClusterizerv1() ;
<span class="lineNum">      76 </span>            :   AliPHOSClusterizerv1(AliPHOSGeometry *geom);
<span class="lineNum">      77 </span>            :   virtual ~AliPHOSClusterizerv1()  ;
<span class="lineNum">      78 </span>            : 
<span class="lineNum">      79 </span>            :   void    InitParameters() ;
<span class="lineNum">      80 </span>            :   
<span class="lineNum">      81 </span>            :   virtual Int_t   AreNeighbours(AliPHOSDigit * d1, AliPHOSDigit * d2)const ; 
<a name="82"><span class="lineNum">      82 </span>            :                                // Checks if digits are in neighbour cells </a>
<span class="lineNum">      83 </span>            : 
<span class="lineNum">      84 </span><span class="lineNoCov">          0 :   virtual void    GetNumberOfClustersFound(int * numb )const{  numb[0] = fNumberOfEmcClusters ; </span>
<a name="85"><span class="lineNum">      85 </span><span class="lineNoCov">          0 :                                                                numb[1] = fNumberOfCpvClusters ; }</span></a>
<a name="86"><span class="lineNum">      86 </span>            : </a>
<a name="87"><span class="lineNum">      87 </span><span class="lineNoCov">          0 :   virtual Float_t GetEmcClusteringThreshold()const{ return fEmcClusteringThreshold;}</span></a>
<a name="88"><span class="lineNum">      88 </span><span class="lineNoCov">          0 :   virtual Float_t GetEmcLocalMaxCut()const        { return fEmcLocMaxCut;} </span></a>
<a name="89"><span class="lineNum">      89 </span><span class="lineNoCov">          0 :   virtual Float_t GetEmcLogWeight()const          { return fW0;}  </span></a>
<a name="90"><span class="lineNum">      90 </span><span class="lineNoCov">          0 :   virtual Float_t GetCpvClusteringThreshold()const{ return fCpvClusteringThreshold;  } </span></a>
<a name="91"><span class="lineNum">      91 </span><span class="lineNoCov">          0 :   virtual Float_t GetCpvLocalMaxCut()const        { return fCpvLocMaxCut;} </span></a>
<span class="lineNum">      92 </span><span class="lineNoCov">          0 :   virtual Float_t GetCpvLogWeight()const          { return fW0CPV;}  </span>
<span class="lineNum">      93 </span><span class="lineNoCov">          0 :   virtual Float_t GetEcoreRadius()const           { return fEcoreRadius;}  </span>
<span class="lineNum">      94 </span>            :   //  virtual const char *  GetRecPointsBranch() const{ return GetName() ;}
<span class="lineNum">      95 </span>            : 
<span class="lineNum">      96 </span>            :   virtual void    Digits2Clusters(Option_t *option);
<span class="lineNum">      97 </span>            : 
<a name="98"><span class="lineNum">      98 </span>            :   void Print(const Option_t * = &quot;&quot;)const ;</a>
<a name="99"><span class="lineNum">      99 </span>            : </a>
<a name="100"><span class="lineNum">     100 </span><span class="lineNoCov">          0 :   virtual void SetEmcClusteringThreshold(Float_t cluth)  { fEmcClusteringThreshold = cluth ; }</span></a>
<a name="101"><span class="lineNum">     101 </span><span class="lineNoCov">          0 :   virtual void SetEmcLocalMaxCut(Float_t cut)            { fEmcLocMaxCut = cut ; }</span></a>
<a name="102"><span class="lineNum">     102 </span><span class="lineNoCov">          0 :   virtual void SetEmcLogWeight(Float_t w)                { fW0 = w ; }</span></a>
<a name="103"><span class="lineNum">     103 </span><span class="lineNoCov">          0 :   virtual void SetCpvClusteringThreshold(Float_t cluth)  { fCpvClusteringThreshold = cluth ; }</span></a>
<a name="104"><span class="lineNum">     104 </span><span class="lineNoCov">          0 :   virtual void SetCpvLocalMaxCut(Float_t cut)            { fCpvLocMaxCut = cut ; }</span></a>
<a name="105"><span class="lineNum">     105 </span><span class="lineNoCov">          0 :   virtual void SetCpvLogWeight(Float_t w)                { fW0CPV = w ; }</span></a>
<span class="lineNum">     106 </span><span class="lineNoCov">          0 :   virtual void SetUnfolding(Bool_t toUnfold = kTRUE )    { fToUnfold = toUnfold ;}</span>
<a name="107"><span class="lineNum">     107 </span><span class="lineNoCov">          0 :   virtual void SetCoreRadius(Float_t coreRadius)         { fEcoreRadius = coreRadius ;}</span></a>
<span class="lineNum">     108 </span>            :   //Switch to &quot;on flyght&quot; mode, without writing to TreeR and file  
<span class="lineNum">     109 </span><span class="lineNoCov">          0 :   void SetWriting(Bool_t toWrite = kFALSE){fWrite = toWrite;} </span>
<span class="lineNum">     110 </span>            :   static Double_t ShowerShape(Double_t x, Double_t z) ; // Shape of EM shower used in unfolding; 
<span class="lineNum">     111 </span>            :                                             //class member function (not object member function)
<span class="lineNum">     112 </span>            :   static void UnfoldingChiSquare(Int_t &amp; nPar, Double_t * Grad, Double_t &amp; fret, Double_t * x, Int_t iflag)  ;
<a name="113"><span class="lineNum">     113 </span>            :                                             // Chi^2 of the fit. Should be static to be passed to MINUIT</a>
<span class="lineNum">     114 </span>            :   //  void Unload() ; 
<span class="lineNum">     115 </span><span class="lineNoCov">          0 :   virtual const char * Version() const { return &quot;clu-v1&quot;; }  </span>
<span class="lineNum">     116 </span>            : 
<span class="lineNum">     117 </span>            : protected:
<span class="lineNum">     118 </span>            : 
<span class="lineNum">     119 </span>            :   void           WriteRecPoints() ;
<span class="lineNum">     120 </span>            :   virtual void   MakeClusters( ) ;            
<span class="lineNum">     121 </span>            :   virtual Bool_t IsInEmc (AliPHOSDigit * digit)const ;     // Tells if id digit is in EMC
<span class="lineNum">     122 </span>            :   virtual Bool_t IsInCpv (AliPHOSDigit * digit)const ;     // Tells if id digit is in CPV
<span class="lineNum">     123 </span>            :   void           CleanDigits(TClonesArray * digits) ;
<span class="lineNum">     124 </span>            :   void           SetDistancesToBadChannels();
<span class="lineNum">     125 </span>            :   virtual Float_t Calibrate(Float_t amp, Int_t absId) const ;  // Tranforms ADC counts to energy   
<span class="lineNum">     126 </span>            :   virtual Float_t CalibrateT(Float_t amp, Int_t absId, Bool_t isLG) const ;  //Tranforms Sample counts to sec.
<span class="lineNum">     127 </span>            :   Bool_t CheckTimeGate(Float_t t1, Float_t amp1, Float_t t2, Float_t amp2)const ; //Checks if time difference is reasonable
<span class="lineNum">     128 </span>            :    
<span class="lineNum">     129 </span>            : private:
<span class="lineNum">     130 </span>            :   AliPHOSClusterizerv1(const AliPHOSClusterizerv1 &amp; clu) ;
<span class="lineNum">     131 </span>            :   AliPHOSClusterizerv1 &amp; operator = (const AliPHOSClusterizerv1 &amp; obj);
<span class="lineNum">     132 </span>            : 
<span class="lineNum">     133 </span>            :   Bool_t  FindFit(AliPHOSEmcRecPoint * emcRP, AliPHOSDigit ** MaxAt, Float_t * maxAtEnergy, 
<span class="lineNum">     134 </span>            :                   Int_t NPar, Float_t * FitParametres) const; //Used in UnfoldClusters, calls TMinuit
<span class="lineNum">     135 </span>            :   void    Init() ;
<span class="lineNum">     136 </span>            : 
<span class="lineNum">     137 </span>            :   virtual void   MakeUnfolding() ;
<span class="lineNum">     138 </span>            :   void           UnfoldCluster(AliPHOSEmcRecPoint * iniEmc,Int_t Nmax, 
<span class="lineNum">     139 </span>            :                        AliPHOSDigit ** maxAt,Float_t * maxAtEnergy ) ; //Unfolds cluster using TMinuit package
<span class="lineNum">     140 </span>            :   void           PrintRecPoints(Option_t * option) ;
<span class="lineNum">     141 </span>            : 
<span class="lineNum">     142 </span>            : private:
<span class="lineNum">     143 </span>            : 
<span class="lineNum">     144 </span>            :   Bool_t  fDefaultInit;              //! Says if the task was created by defaut ctor (only parameters are initialized)
<span class="lineNum">     145 </span>            :   Int_t   fEmcCrystals ;             // number of EMC cristals in PHOS
<span class="lineNum">     146 </span>            : 
<span class="lineNum">     147 </span>            :   Bool_t  fToUnfold ;                // To perform unfolding 
<span class="lineNum">     148 </span>            :   Bool_t  fToUnfoldCPV ;             // To perform unfolding in CPV
<span class="lineNum">     149 </span>            :   Bool_t  fWrite ;                   // Write RecPoints to TreeR  
<span class="lineNum">     150 </span>            :   Bool_t  fDigitsUsed[53760];        //Mark digits as already used in cluster (EMC:5*56*64 ; CPV: 5*56*128)
<span class="lineNum">     151 </span>            :  
<span class="lineNum">     152 </span>            :   Int_t   fNumberOfEmcClusters ;     // number of EMC clusters found
<span class="lineNum">     153 </span>            :   Int_t   fNumberOfCpvClusters ;     // number of CPV clusters found
<span class="lineNum">     154 </span>            :  
<span class="lineNum">     155 </span>            :   Float_t fEmcClusteringThreshold ;  // minimum energy to start EMC cluster
<span class="lineNum">     156 </span>            :   Float_t fCpvClusteringThreshold ;  // minimum energy to start CPV cluster
<span class="lineNum">     157 </span>            :   Float_t fEmcLocMaxCut ;            // minimum energy difference to distinguish local maxima in a cluster
<span class="lineNum">     158 </span>            :   Float_t fW0 ;                      // logarithmic weight for the cluster center of gravity calculation
<span class="lineNum">     159 </span>            :   Float_t fCpvLocMaxCut ;            // minimum energy difference to distinguish local maxima in a CPV cluster
<span class="lineNum">     160 </span>            :   Float_t fW0CPV ;                   // logarithmic weight for the CPV cluster center of gravity calculation
<span class="lineNum">     161 </span>            :   Float_t fTimeGateLowAmp ;          // Threshold for good/bad time measurement
<span class="lineNum">     162 </span>            :   Float_t fTimeGateLow ;             // Time difference between cells with low amplitude
<span class="lineNum">     163 </span>            :   Float_t fTimeGateHigh ;            // Time difference between cells with good time measurement
<span class="lineNum">     164 </span>            :  
<a name="165"><span class="lineNum">     165 </span>            :   Float_t fEcoreRadius ;             // Radius within which the core energy is calculated, in cm</a>
<span class="lineNum">     166 </span>            : 
<span class="lineNum">     167 </span><span class="lineCov">        334 :   ClassDef(AliPHOSClusterizerv1,8)   // Clusterizer implementation version 1</span>
<span class="lineNum">     168 </span>            : 
<span class="lineNum">     169 </span>            : };
<span class="lineNum">     170 </span>            : 
<span class="lineNum">     171 </span>            : #endif // AliPHOSCLUSTERIZERV1_H
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.11</a></td></tr>
  </table>
  <br>

</body>
</html>
