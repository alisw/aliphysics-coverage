<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - coverage.info - TPC/TPCbase/AliTPCParam.cxx</title>
  <link rel="stylesheet" type="text/css" href="../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../index.html">top level</a> - <a href="index.html">TPC/TPCbase</a> - AliTPCParam.cxx<span style="font-size: 80%;"> (source / <a href="AliTPCParam.cxx.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">coverage.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">418</td>
            <td class="headerCovTableEntry">510</td>
            <td class="headerCovTableEntryMed">82.0 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2016-06-14 17:26:59</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">29</td>
            <td class="headerCovTableEntry">42</td>
            <td class="headerCovTableEntryLo">69.0 %</td>
          </tr>
          <tr><td><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            : /**************************************************************************</a>
<span class="lineNum">       2 </span>            :  * Copyright(c) 1998-1999, ALICE Experiment at CERN, All rights reserved. *
<span class="lineNum">       3 </span>            :  *                                                                        *
<span class="lineNum">       4 </span>            :  * Author: The ALICE Off-line Project.                                    *
<span class="lineNum">       5 </span>            :  * Contributors are mentioned in the code where appropriate.              *
<span class="lineNum">       6 </span>            :  *                                                                        *
<span class="lineNum">       7 </span>            :  * Permission to use, copy, modify and distribute this software and its   *
<span class="lineNum">       8 </span>            :  * documentation strictly for non-commercial purposes is hereby granted   *
<span class="lineNum">       9 </span>            :  * without fee, provided that the above copyright notice appears in all   *
<span class="lineNum">      10 </span>            :  * copies and that both the copyright notice and this permission notice   *
<span class="lineNum">      11 </span>            :  * appear in the supporting documentation. The authors make no claims     *
<span class="lineNum">      12 </span>            :  * about the suitability of this software for any purpose. It is          *
<span class="lineNum">      13 </span>            :  * provided &quot;as is&quot; without express or implied warranty.                  *
<span class="lineNum">      14 </span>            :  **************************************************************************/
<span class="lineNum">      15 </span>            : 
<span class="lineNum">      16 </span>            : 
<span class="lineNum">      17 </span>            : /// \class AliTPCParam
<span class="lineNum">      18 </span>            : /// \brief Manager and of geomety  classes for set: TPC
<span class="lineNum">      19 </span>            : ///
<span class="lineNum">      20 </span>            : /// !sectors are numbered from  0
<span class="lineNum">      21 </span>            : /// !pad rows are numbered from 0
<span class="lineNum">      22 </span>            : ///
<span class="lineNum">      23 </span>            : /// 12.6.   changed z relative
<span class="lineNum">      24 </span>            : ///
<span class="lineNum">      25 </span>            : /// \author Marian Ivanov, Uni. of Bratislava, ivanov@fmph.uniba.sk
<span class="lineNum">      26 </span>            : 
<span class="lineNum">      27 </span>            : //
<span class="lineNum">      28 </span>            : 
<span class="lineNum">      29 </span>            : #include &lt;AliTPCParam.h&gt;
<span class="lineNum">      30 </span>            : 
<span class="lineNum">      31 </span>            : #include &lt;TGeoManager.h&gt;
<span class="lineNum">      32 </span>            : #include &lt;TGeoPhysicalNode.h&gt;
<span class="lineNum">      33 </span>            : #include &lt;TString.h&gt;
<span class="lineNum">      34 </span>            : #include &quot;AliAlignObj.h&quot;
<span class="lineNum">      35 </span>            : #include &quot;AliAlignObjParams.h&quot;
<span class="lineNum">      36 </span>            : #include &quot;AliLog.h&quot;
<span class="lineNum">      37 </span>            : #include &quot;TGraphErrors.h&quot;
<span class="lineNum">      38 </span>            : #include &quot;AliTPCcalibDB.h&quot;
<span class="lineNum">      39 </span>            : #include &quot;AliTPCROC.h&quot;
<span class="lineNum">      40 </span>            : #include &quot;AliMathBase.h&quot;
<span class="lineNum">      41 </span>            : 
<span class="lineNum">      42 </span>            : TObjArray *AliTPCParam::fBBParam = 0;
<a name="43"><span class="lineNum">      43 </span>            : </a>
<span class="lineNum">      44 </span>            : /// \cond CLASSIMP
<span class="lineNum">      45 </span><span class="lineCov">         24 : ClassImp(AliTPCParam)</span>
<span class="lineNum">      46 </span>            : /// \endcond
<span class="lineNum">      47 </span>            : 
<a name="48"><span class="lineNum">      48 </span>            : </a>
<span class="lineNum">      49 </span>            : //___________________________________________
<span class="lineNum">      50 </span>            : AliTPCParam::AliTPCParam()
<span class="lineNum">      51 </span><span class="lineCov">         18 :             :AliDetectorParam(),</span>
<span class="lineNum">      52 </span><span class="lineCov">         18 :              fbStatus(kFALSE),</span>
<span class="lineNum">      53 </span><span class="lineCov">         18 :              fInnerRadiusLow(0.),</span>
<span class="lineNum">      54 </span><span class="lineCov">         18 :              fInnerRadiusUp(0.),</span>
<span class="lineNum">      55 </span><span class="lineCov">         18 :              fOuterRadiusUp(0.),</span>
<span class="lineNum">      56 </span><span class="lineCov">         18 :              fOuterRadiusLow(0.),</span>
<span class="lineNum">      57 </span><span class="lineCov">         18 :              fInnerAngle(0.),</span>
<span class="lineNum">      58 </span><span class="lineCov">         18 :              fInnerAngleShift(0.),</span>
<span class="lineNum">      59 </span><span class="lineCov">         18 :              fOuterAngle(0.),</span>
<span class="lineNum">      60 </span><span class="lineCov">         18 :              fOuterAngleShift(0.),</span>
<span class="lineNum">      61 </span><span class="lineCov">         18 :              fInnerFrameSpace(0.),</span>
<span class="lineNum">      62 </span><span class="lineCov">         18 :              fOuterFrameSpace(0.),</span>
<span class="lineNum">      63 </span><span class="lineCov">         18 :              fInnerWireMount(0.),</span>
<span class="lineNum">      64 </span><span class="lineCov">         18 :              fOuterWireMount(0.),</span>
<span class="lineNum">      65 </span><span class="lineCov">         18 :              fNInnerSector(0),</span>
<span class="lineNum">      66 </span><span class="lineCov">         18 :              fNOuterSector(0),</span>
<span class="lineNum">      67 </span><span class="lineCov">         18 :              fNSector(0),</span>
<span class="lineNum">      68 </span><span class="lineCov">         18 :              fZLength(0),</span>
<span class="lineNum">      69 </span><span class="lineCov">         18 :              fRotAngle(),</span>
<span class="lineNum">      70 </span><span class="lineCov">         18 :              fGeometryType(0),</span>
<span class="lineNum">      71 </span><span class="lineCov">         18 :              fTrackingMatrix(0),</span>
<span class="lineNum">      72 </span><span class="lineCov">         18 :              fClusterMatrix(0),</span>
<span class="lineNum">      73 </span><span class="lineCov">         18 :              fGlobalMatrix(0),</span>
<span class="lineNum">      74 </span><span class="lineCov">         18 :              fNInnerWiresPerPad(0),</span>
<span class="lineNum">      75 </span><span class="lineCov">         18 :              fInnerWWPitch(0),</span>
<span class="lineNum">      76 </span><span class="lineCov">         18 :              fInnerDummyWire(0),</span>
<span class="lineNum">      77 </span><span class="lineCov">         18 :              fInnerOffWire(0.),</span>
<span class="lineNum">      78 </span><span class="lineCov">         18 :              fRInnerFirstWire(0.),</span>
<span class="lineNum">      79 </span><span class="lineCov">         18 :              fRInnerLastWire(0.),</span>
<span class="lineNum">      80 </span><span class="lineCov">         18 :              fLastWireUp1(0.),</span>
<span class="lineNum">      81 </span><span class="lineCov">         18 :              fNOuter1WiresPerPad(0),</span>
<span class="lineNum">      82 </span><span class="lineCov">         18 :              fNOuter2WiresPerPad(0),</span>
<span class="lineNum">      83 </span><span class="lineCov">         18 :              fOuterWWPitch(0.),</span>
<span class="lineNum">      84 </span><span class="lineCov">         18 :              fOuterDummyWire(0),</span>
<span class="lineNum">      85 </span><span class="lineCov">         18 :              fOuterOffWire(0.),</span>
<span class="lineNum">      86 </span><span class="lineCov">         18 :              fROuterFirstWire(0.),</span>
<span class="lineNum">      87 </span><span class="lineCov">         18 :              fROuterLastWire(0.),</span>
<span class="lineNum">      88 </span><span class="lineCov">         18 :              fInnerPadPitchLength(0.),</span>
<span class="lineNum">      89 </span><span class="lineCov">         18 :              fInnerPadPitchWidth(0.),</span>
<span class="lineNum">      90 </span><span class="lineCov">         18 :              fInnerPadLength(0.),</span>
<span class="lineNum">      91 </span><span class="lineCov">         18 :              fInnerPadWidth(0.),</span>
<span class="lineNum">      92 </span><span class="lineCov">         18 :              fOuter1PadPitchLength(0.),</span>
<span class="lineNum">      93 </span><span class="lineCov">         18 :              fOuter2PadPitchLength(0.),</span>
<span class="lineNum">      94 </span><span class="lineCov">         18 :              fOuterPadPitchWidth(0.),</span>
<span class="lineNum">      95 </span><span class="lineCov">         18 :              fOuter1PadLength(0.),</span>
<span class="lineNum">      96 </span><span class="lineCov">         18 :              fOuter2PadLength(0.),</span>
<span class="lineNum">      97 </span><span class="lineCov">         18 :              fOuterPadWidth(0.),</span>
<span class="lineNum">      98 </span><span class="lineCov">         18 :              fBMWPCReadout(kFALSE),</span>
<span class="lineNum">      99 </span><span class="lineCov">         18 :              fNCrossRows(0),</span>
<span class="lineNum">     100 </span><span class="lineCov">         18 :              fNRowLow(0),</span>
<span class="lineNum">     101 </span><span class="lineCov">         18 :              fNRowUp1(0),</span>
<span class="lineNum">     102 </span><span class="lineCov">         18 :              fNRowUp2(0),</span>
<span class="lineNum">     103 </span><span class="lineCov">         18 :              fNRowUp(0),</span>
<span class="lineNum">     104 </span><span class="lineCov">         18 :              fNtRows(0),</span>
<span class="lineNum">     105 </span><span class="lineCov">         18 :              fDiffT(0.),</span>
<span class="lineNum">     106 </span><span class="lineCov">         18 :              fDiffL(0.),</span>
<span class="lineNum">     107 </span><span class="lineCov">         18 :              fGasGain(0.),</span>
<span class="lineNum">     108 </span><span class="lineCov">         18 :              fDriftV(0.),</span>
<span class="lineNum">     109 </span><span class="lineCov">         18 :              fOmegaTau(0.),</span>
<span class="lineNum">     110 </span><span class="lineCov">         18 :              fAttCoef(0.),</span>
<span class="lineNum">     111 </span><span class="lineCov">         18 :              fOxyCont(0.),</span>
<span class="lineNum">     112 </span><span class="lineCov">         18 :              fFpot(0.),</span>
<span class="lineNum">     113 </span><span class="lineCov">         18 :              fNprim(0.),</span>
<span class="lineNum">     114 </span><span class="lineCov">         18 :              fNtot(0.),</span>
<span class="lineNum">     115 </span><span class="lineCov">         18 :              fWmean(0.),</span>
<span class="lineNum">     116 </span><span class="lineCov">         18 :              fExp(0.),</span>
<span class="lineNum">     117 </span><span class="lineCov">         18 :              fEend(0.),</span>
<span class="lineNum">     118 </span><span class="lineCov">         18 :              fBetheBloch(0x0),   // dE/dx:BG  - used in the reconstruction</span>
<span class="lineNum">     119 </span><span class="lineCov">         18 :              fBetheBlochMC(0x0), // dN_{prim}/dx:BG - used for the simulation of energy loss</span>
<span class="lineNum">     120 </span><span class="lineCov">         18 :              fGainSlopesHV(0),   // graph with the gain slope as function of HV - per chamber</span>
<span class="lineNum">     121 </span><span class="lineCov">         18 :              fGainSlopesPT(0),   // graph with the gain slope as function of P/T - per chamber</span>
<span class="lineNum">     122 </span><span class="lineCov">         18 :              fPadCoupling(0.),</span>
<span class="lineNum">     123 </span><span class="lineCov">         18 :              fZeroSup(0),</span>
<span class="lineNum">     124 </span><span class="lineCov">         18 :              fNoise(0.),</span>
<span class="lineNum">     125 </span><span class="lineCov">         18 :              fChipGain(0.),</span>
<span class="lineNum">     126 </span><span class="lineCov">         18 :              fChipNorm(0.),</span>
<span class="lineNum">     127 </span><span class="lineCov">         18 :              fTSample(0.),</span>
<span class="lineNum">     128 </span><span class="lineCov">         18 :              fZWidth(0.),</span>
<span class="lineNum">     129 </span><span class="lineCov">         18 :              fTSigma(0.),</span>
<span class="lineNum">     130 </span><span class="lineCov">         18 :              fMaxTBin(0),</span>
<span class="lineNum">     131 </span><span class="lineCov">         18 :              fADCSat(0),</span>
<span class="lineNum">     132 </span><span class="lineCov">         18 :              fADCDynRange(0.),</span>
<span class="lineNum">     133 </span><span class="lineCov">         18 :              fTotalNormFac(0.),</span>
<span class="lineNum">     134 </span><span class="lineCov">         18 :              fNoiseNormFac(0.),</span>
<span class="lineNum">     135 </span><span class="lineCov">         18 :              fUseGlitchFilter(kTRUE),</span>
<span class="lineNum">     136 </span><span class="lineCov">         18 :              fNominalVoltage(),</span>
<span class="lineNum">     137 </span><span class="lineCov">         18 :              fMaxVoltageDeviation(40.),</span>
<span class="lineNum">     138 </span><span class="lineCov">         18 :              fMaxDipVoltage(2.),</span>
<span class="lineNum">     139 </span><span class="lineCov">         18 :              fMaxHVfractionBad(.4),</span>
<span class="lineNum">     140 </span><span class="lineCov">         18 :              fVoltageDipScanPeriod(1.),</span>
<span class="lineNum">     141 </span><span class="lineCov">         18 :              fNResponseMax(0),</span>
<span class="lineNum">     142 </span><span class="lineCov">         18 :              fResponseThreshold(0.),</span>
<span class="lineNum">     143 </span><span class="lineCov">         18 :              fCurrentMax(0),</span>
<span class="lineNum">     144 </span><span class="lineCov">         18 :              fResponseBin(0),</span>
<span class="lineNum">     145 </span><span class="lineCov">         18 :              fResponseWeight(0),</span>
<span class="lineNum">     146 </span><span class="lineCov">         18 :              fGateDelay(0.),</span>
<span class="lineNum">     147 </span><span class="lineCov">         18 :              fL1Delay(0.),</span>
<span class="lineNum">     148 </span><span class="lineCov">         18 :              fNTBinsBeforeL1(0),</span>
<span class="lineNum">     149 </span><span class="lineCov">         18 :              fNTBinsL1(0.)</span>
<span class="lineNum">     150 </span><span class="lineCov">         54 : {</span>
<span class="lineNum">     151 </span>            :   //
<span class="lineNum">     152 </span>            :   //constructor sets the default parameters
<span class="lineNum">     153 </span>            :   //
<span class="lineNum">     154 </span>            : 
<span class="lineNum">     155 </span><span class="lineCov">         18 :   SetTitle(&quot;75x40_100x60_150x60&quot;);</span>
<span class="lineNum">     156 </span><span class="lineCov">         18 :   SetDefault();</span>
<span class="lineNum">     157 </span><span class="lineCov">         27 :   if (!fBBParam) fBBParam= new TObjArray(1000);</span>
<span class="lineNum">     158 </span><span class="lineCov">         18 :   fRegionGain[0]=fRegionGain[1]=fRegionGain[2]=0.;</span>
<a name="159"><span class="lineNum">     159 </span><span class="lineCov">         18 : }</span></a>
<span class="lineNum">     160 </span>            : 
<span class="lineNum">     161 </span>            : AliTPCParam::~AliTPCParam()
<span class="lineNum">     162 </span><span class="lineCov">          6 : {</span>
<span class="lineNum">     163 </span>            :   /// destructor deletes some dynamicaly alocated variables
<span class="lineNum">     164 </span>            : 
<span class="lineNum">     165 </span><span class="lineCov">          9 :   if (fResponseBin!=0)    delete [] fResponseBin;</span>
<span class="lineNum">     166 </span><span class="lineCov">          9 :   if (fResponseWeight!=0) delete [] fResponseWeight;</span>
<span class="lineNum">     167 </span><span class="lineCov">          9 :   if (fRotAngle      !=0) delete [] fRotAngle;</span>
<span class="lineNum">     168 </span>            : 
<span class="lineNum">     169 </span><span class="lineCov">          3 :   CleanGeoMatrices();</span>
<span class="lineNum">     170 </span>            : 
<a name="171"><span class="lineNum">     171 </span><span class="lineCov">          3 : }</span></a>
<span class="lineNum">     172 </span>            : 
<span class="lineNum">     173 </span>            : Int_t  AliTPCParam::Transform0to1(Float_t *xyz, Int_t * index)  const
<span class="lineNum">     174 </span>            : {
<span class="lineNum">     175 </span>            :   /// calculates sector number (index[1], undefined on input)
<span class="lineNum">     176 </span>            :   /// xyz intact
<span class="lineNum">     177 </span>            : 
<span class="lineNum">     178 </span>            :   Float_t angle,x1;
<span class="lineNum">     179 </span>            :   Int_t sector;
<span class="lineNum">     180 </span><span class="lineCov">          8 :   Float_t r = TMath::Sqrt(xyz[0]*xyz[0]+xyz[1]*xyz[1]);</span>
<span class="lineNum">     181 </span><span class="lineCov">          4 :   if ((xyz[0]==0)&amp;&amp;(xyz[1]==0)) angle = 0.;</span>
<span class="lineNum">     182 </span>            :   else
<span class="lineNum">     183 </span>            :     {
<span class="lineNum">     184 </span><span class="lineCov">          4 :       angle =TMath::ASin(xyz[1]/r);</span>
<span class="lineNum">     185 </span><span class="lineCov">          4 :       if   (xyz[0]&lt;0)   angle=TMath::Pi()-angle;</span>
<span class="lineNum">     186 </span><span class="lineCov">          8 :       if ( (xyz[0]&gt;0) &amp;&amp; (xyz[1]&lt;0) ) angle=2*TMath::Pi()+angle;</span>
<span class="lineNum">     187 </span>            :     }
<span class="lineNum">     188 </span>            : 
<span class="lineNum">     189 </span><span class="lineCov">          4 :   sector=Int_t(TMath::Nint((angle-fInnerAngleShift)/fInnerAngle));</span>
<span class="lineNum">     190 </span>            : 
<span class="lineNum">     191 </span><span class="lineCov">          4 :   Float_t cos,sin;</span>
<span class="lineNum">     192 </span><span class="lineCov">          4 :   AdjustCosSin(sector,cos,sin);</span>
<span class="lineNum">     193 </span><span class="lineCov">          4 :   x1=xyz[0]*cos + xyz[1]*sin;</span>
<span class="lineNum">     194 </span>            : 
<span class="lineNum">     195 </span><span class="lineCov">          4 :   if (x1&gt;fOuterRadiusLow)</span>
<span class="lineNum">     196 </span>            :     {
<span class="lineNum">     197 </span><span class="lineCov">          4 :       sector=Int_t(TMath::Nint((angle-fOuterAngleShift)/fOuterAngle))+fNInnerSector;</span>
<span class="lineNum">     198 </span><span class="lineCov">          4 :       if (xyz[2]&lt;0)  sector+=(fNOuterSector&gt;&gt;1);</span>
<span class="lineNum">     199 </span>            :     }
<span class="lineNum">     200 </span>            :     else
<span class="lineNum">     201 </span><span class="lineNoCov">          0 :       if (xyz[2]&lt;0) sector+=(fNInnerSector&gt;&gt;1);</span>
<span class="lineNum">     202 </span><span class="lineCov">          8 :   if (sector&lt;0 || sector&gt;=fNSector) AliError(Form(&quot;Wrong sector %d&quot;,sector));</span>
<span class="lineNum">     203 </span><span class="lineCov">          4 :   index[1]=sector; // calculated sector number</span>
<span class="lineNum">     204 </span><span class="lineCov">          4 :   index[0]=1; // indicates system after transformation</span>
<span class="lineNum">     205 </span><span class="lineCov">          4 :   return sector;</span>
<a name="206"><span class="lineNum">     206 </span><span class="lineCov">          4 : }</span></a>
<span class="lineNum">     207 </span>            : 
<span class="lineNum">     208 </span>            : Bool_t  AliTPCParam::Transform(Float_t */*xyz*/, Int_t *index, Int_t* /*oindex*/)
<span class="lineNum">     209 </span>            : {
<span class="lineNum">     210 </span>            :   /// transformation from input coodination system to output coordination system
<span class="lineNum">     211 </span>            : 
<span class="lineNum">     212 </span>            :   switch (index[0]){
<span class="lineNum">     213 </span>            :   case 0:
<span class="lineNum">     214 </span>            :     break;
<span class="lineNum">     215 </span>            :   };
<span class="lineNum">     216 </span>            : 
<span class="lineNum">     217 </span><span class="lineNoCov">          0 :   return kFALSE;</span>
<span class="lineNum">     218 </span>            : 
<a name="219"><span class="lineNum">     219 </span>            : }</a>
<span class="lineNum">     220 </span>            : 
<span class="lineNum">     221 </span>            : Int_t AliTPCParam::GetPadRow(Float_t *xyz, Int_t *index) const
<span class="lineNum">     222 </span>            : {
<span class="lineNum">     223 </span>            :   /// calculates pad row of point xyz - transformation to system 8 (digit system)
<span class="lineNum">     224 </span>            : 
<span class="lineNum">     225 </span><span class="lineCov">    3382744 :   Int_t system = index[0];</span>
<span class="lineNum">     226 </span><span class="lineCov">    1691372 :   if (0==system) {</span>
<span class="lineNum">     227 </span><span class="lineNoCov">          0 :     Transform0to1(xyz,index);</span>
<span class="lineNum">     228 </span>            :     system=1;
<span class="lineNum">     229 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">     230 </span><span class="lineCov">    1691372 :   if (1==system) {</span>
<span class="lineNum">     231 </span><span class="lineNoCov">          0 :     Transform1to2(xyz,index);</span>
<span class="lineNum">     232 </span>            :     system=2;
<span class="lineNum">     233 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">     234 </span>            : 
<span class="lineNum">     235 </span><span class="lineCov">    1691372 :   if (fGeometryType==0){ //straight row</span>
<span class="lineNum">     236 </span><span class="lineCov">    1691372 :     if (2==system) {</span>
<span class="lineNum">     237 </span><span class="lineCov">    1691372 :       Transform2to3(xyz,index);</span>
<span class="lineNum">     238 </span>            :       system=3;
<span class="lineNum">     239 </span><span class="lineCov">    1691372 :     }</span>
<span class="lineNum">     240 </span><span class="lineCov">    1691372 :     if (3==system) {</span>
<span class="lineNum">     241 </span><span class="lineCov">    1691372 :       Transform3to4(xyz,index);</span>
<span class="lineNum">     242 </span>            :       system=4;
<span class="lineNum">     243 </span><span class="lineCov">    1691372 :     }</span>
<span class="lineNum">     244 </span><span class="lineCov">    1691372 :     if (4==system) {</span>
<span class="lineNum">     245 </span><span class="lineCov">    1691372 :       Transform4to8(xyz,index);</span>
<span class="lineNum">     246 </span>            :       system=8;
<span class="lineNum">     247 </span><span class="lineCov">    1691372 :     }</span>
<span class="lineNum">     248 </span><span class="lineCov">    1691372 :     if (8==system) {</span>
<span class="lineNum">     249 </span><span class="lineCov">    1691372 :       index[0]=8;</span>
<span class="lineNum">     250 </span><span class="lineCov">    1691372 :       return index[2];</span>
<span class="lineNum">     251 </span>            :     }
<span class="lineNum">     252 </span>            :   }
<span class="lineNum">     253 </span>            : 
<span class="lineNum">     254 </span><span class="lineNoCov">          0 :   if (fGeometryType==1){ //cylindrical geometry</span>
<span class="lineNum">     255 </span><span class="lineNoCov">          0 :     if (2==system) {</span>
<span class="lineNum">     256 </span><span class="lineNoCov">          0 :       Transform2to5(xyz,index);</span>
<span class="lineNum">     257 </span>            :       system=5;
<span class="lineNum">     258 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">     259 </span><span class="lineNoCov">          0 :     if (5==system) {</span>
<span class="lineNum">     260 </span><span class="lineNoCov">          0 :       Transform2to3(xyz,index);</span>
<span class="lineNum">     261 </span>            :       system=6;
<span class="lineNum">     262 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">     263 </span><span class="lineNoCov">          0 :     if (6==system) {</span>
<span class="lineNum">     264 </span><span class="lineNoCov">          0 :       Transform3to4(xyz,index);</span>
<span class="lineNum">     265 </span>            :       system=7;
<span class="lineNum">     266 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">     267 </span><span class="lineNoCov">          0 :     if (8==system) {</span>
<span class="lineNum">     268 </span><span class="lineNoCov">          0 :       index[0]=8;</span>
<span class="lineNum">     269 </span><span class="lineNoCov">          0 :       return index[2];</span>
<span class="lineNum">     270 </span>            :     }
<span class="lineNum">     271 </span>            :   }
<span class="lineNum">     272 </span><span class="lineNoCov">          0 :   index[0]=system;</span>
<span class="lineNum">     273 </span><span class="lineNoCov">          0 :   return -1; //if no reasonable system</span>
<a name="274"><span class="lineNum">     274 </span><span class="lineCov">    1691372 : }</span></a>
<span class="lineNum">     275 </span>            : 
<span class="lineNum">     276 </span>            : void  AliTPCParam::SetSectorAngles(Float_t innerangle, Float_t innershift, Float_t outerangle,
<span class="lineNum">     277 </span>            :                         Float_t outershift)
<span class="lineNum">     278 </span>            : {
<span class="lineNum">     279 </span>            :   /// set opening angles
<span class="lineNum">     280 </span>            : 
<span class="lineNum">     281 </span>            :   static const  Float_t  kDegtoRad = 0.01745329251994;
<span class="lineNum">     282 </span><span class="lineCov">         72 :   fInnerAngle = innerangle;       //opening angle of Inner sector</span>
<span class="lineNum">     283 </span><span class="lineCov">         36 :   fInnerAngleShift = innershift;  //shift of first inner sector center to the 0</span>
<span class="lineNum">     284 </span><span class="lineCov">         36 :   fOuterAngle = outerangle;       //opening angle of outer sector</span>
<span class="lineNum">     285 </span><span class="lineCov">         36 :   fOuterAngleShift = outershift;  //shift of first sector center to the 0</span>
<span class="lineNum">     286 </span><span class="lineCov">         36 :   fInnerAngle *=kDegtoRad;</span>
<span class="lineNum">     287 </span><span class="lineCov">         36 :   fInnerAngleShift *=kDegtoRad;</span>
<span class="lineNum">     288 </span><span class="lineCov">         36 :   fOuterAngle *=kDegtoRad;</span>
<span class="lineNum">     289 </span><span class="lineCov">         36 :   fOuterAngleShift *=kDegtoRad;</span>
<a name="290"><span class="lineNum">     290 </span><span class="lineCov">         36 : }</span></a>
<span class="lineNum">     291 </span>            : 
<span class="lineNum">     292 </span>            : Float_t  AliTPCParam::GetInnerAngle() const
<span class="lineNum">     293 </span>            : {
<span class="lineNum">     294 </span>            :   /// return angle
<span class="lineNum">     295 </span>            : 
<span class="lineNum">     296 </span><span class="lineCov">    1649122 :   return fInnerAngle;</span>
<span class="lineNum">     297 </span>            : 
<a name="298"><span class="lineNum">     298 </span>            : }</a>
<span class="lineNum">     299 </span>            : 
<span class="lineNum">     300 </span>            : Float_t  AliTPCParam::GetInnerAngleShift() const
<span class="lineNum">     301 </span>            : {
<span class="lineNum">     302 </span>            :   /// return angle
<span class="lineNum">     303 </span>            : 
<a name="304"><span class="lineNum">     304 </span><span class="lineCov">    1648870 :   return fInnerAngleShift;</span></a>
<span class="lineNum">     305 </span>            : }
<span class="lineNum">     306 </span>            : Float_t  AliTPCParam::GetOuterAngle() const
<span class="lineNum">     307 </span>            : {
<span class="lineNum">     308 </span>            :   /// return angle
<span class="lineNum">     309 </span>            : 
<a name="310"><span class="lineNum">     310 </span><span class="lineCov">     621716 :   return fOuterAngle;</span></a>
<span class="lineNum">     311 </span>            : }
<span class="lineNum">     312 </span>            : Float_t  AliTPCParam::GetOuterAngleShift() const
<span class="lineNum">     313 </span>            : {
<span class="lineNum">     314 </span>            :   /// return angle
<span class="lineNum">     315 </span>            : 
<span class="lineNum">     316 </span><span class="lineCov">     621332 :      return fOuterAngleShift;</span>
<span class="lineNum">     317 </span>            : }
<a name="318"><span class="lineNum">     318 </span>            : </a>
<span class="lineNum">     319 </span>            : 
<span class="lineNum">     320 </span>            : Int_t AliTPCParam::GetIndex(Int_t sector, Int_t row) const
<span class="lineNum">     321 </span>            : {
<span class="lineNum">     322 </span>            :   /// give index of the given sector and pad row
<span class="lineNum">     323 </span>            :   /// no control if the sectors and rows  are reasonable !!!
<span class="lineNum">     324 </span>            : 
<span class="lineNum">     325 </span><span class="lineCov">     274131 :   if (sector&lt;fNInnerSector) return sector*fNRowLow+row;</span>
<span class="lineNum">     326 </span><span class="lineCov">      69120 :   return (fNInnerSector*fNRowLow)+(sector-fNInnerSector)*fNRowUp+row;</span>
<a name="327"><span class="lineNum">     327 </span><span class="lineCov">     114417 : }</span></a>
<span class="lineNum">     328 </span>            : 
<span class="lineNum">     329 </span>            : Bool_t   AliTPCParam::AdjustSectorRow(Int_t index, Int_t &amp; sector, Int_t &amp;row) const
<span class="lineNum">     330 </span>            : {
<span class="lineNum">     331 </span>            :   /// return sector and padrow for given index
<span class="lineNum">     332 </span>            :   /// if index is reasonable returns true else return false
<span class="lineNum">     333 </span>            : 
<span class="lineNum">     334 </span><span class="lineCov">     274563 :   if ( (index&lt;0) || (index&gt;fNtRows))  return kFALSE;</span>
<span class="lineNum">     335 </span><span class="lineCov">      91521 :   Int_t outindex = fNInnerSector*fNRowLow;</span>
<span class="lineNum">     336 </span><span class="lineCov">      91521 :   if (index&lt;outindex) {</span>
<span class="lineNum">     337 </span><span class="lineCov">      36225 :     sector = index/fNRowLow;</span>
<span class="lineNum">     338 </span><span class="lineCov">      36225 :     row    = index - sector*fNRowLow;</span>
<span class="lineNum">     339 </span><span class="lineCov">      36225 :     return kTRUE;</span>
<span class="lineNum">     340 </span>            :   }
<span class="lineNum">     341 </span><span class="lineCov">      55296 :   index-= outindex;</span>
<span class="lineNum">     342 </span><span class="lineCov">      55296 :   sector = index/fNRowUp;</span>
<span class="lineNum">     343 </span><span class="lineCov">      55296 :   row    = index - sector*fNRowUp;</span>
<span class="lineNum">     344 </span><span class="lineCov">      55296 :   sector += fNInnerSector;</span>
<span class="lineNum">     345 </span><span class="lineCov">      55296 :   return kTRUE;</span>
<a name="346"><span class="lineNum">     346 </span><span class="lineCov">      91521 : }</span></a>
<span class="lineNum">     347 </span>            : 
<span class="lineNum">     348 </span>            : void AliTPCParam::SetDefault()
<span class="lineNum">     349 </span>            : {
<span class="lineNum">     350 </span>            :   /// set default parameters
<span class="lineNum">     351 </span>            :   ///
<span class="lineNum">     352 </span>            :   /// const static  Int_t kMaxRows=600;
<span class="lineNum">     353 </span>            :   ///
<span class="lineNum">     354 </span>            :   /// sector default parameters
<span class="lineNum">     355 </span>            : 
<span class="lineNum">     356 </span>            :   static const  Float_t kInnerRadiusLow = 83.65;
<span class="lineNum">     357 </span>            :   static const  Float_t kInnerRadiusUp  = 133.3;
<span class="lineNum">     358 </span>            :   static const  Float_t kOuterRadiusLow = 133.5;
<span class="lineNum">     359 </span>            :   static const  Float_t kOuterRadiusUp  = 247.7;
<span class="lineNum">     360 </span>            :   static const  Float_t kInnerAngle = 20; // 20 degrees
<span class="lineNum">     361 </span>            :   static const  Float_t kInnerAngleShift = 10;
<span class="lineNum">     362 </span>            :   static const  Float_t kOuterAngle = 20; //  20 degrees
<span class="lineNum">     363 </span>            :   static const  Float_t kOuterAngleShift = 10;
<span class="lineNum">     364 </span>            :   static const  Float_t kInnerFrameSpace = 1.5;
<span class="lineNum">     365 </span>            :   static const  Float_t kOuterFrameSpace = 1.5;
<span class="lineNum">     366 </span>            :   static const  Float_t kInnerWireMount = 1.2;
<span class="lineNum">     367 </span>            :   static const  Float_t kOuterWireMount = 1.4;
<span class="lineNum">     368 </span>            :   static const  Float_t kZLength =250.;
<span class="lineNum">     369 </span>            :   static const  Int_t   kGeometryType = 0; //straight rows
<span class="lineNum">     370 </span>            :   static const Int_t kNRowLow = 63;
<span class="lineNum">     371 </span>            :   static const Int_t kNRowUp1 = 64;
<span class="lineNum">     372 </span>            :   static const Int_t kNRowUp2 = 32;
<span class="lineNum">     373 </span>            :   static const Int_t  kNRowUp = 96;
<span class="lineNum">     374 </span>            :   //
<span class="lineNum">     375 </span>            :   //wires default parameters
<span class="lineNum">     376 </span>            :   //
<span class="lineNum">     377 </span>            :   static const Int_t    kNInnerWiresPerPad = 3;
<span class="lineNum">     378 </span>            :   static const Int_t    kInnerDummyWire = 2;
<span class="lineNum">     379 </span>            :   static const Float_t  kInnerWWPitch = 0.25;
<span class="lineNum">     380 </span>            :   static const Float_t  kRInnerFirstWire = 84.475;
<span class="lineNum">     381 </span>            :   static const Float_t  kRInnerLastWire = 132.475;
<span class="lineNum">     382 </span>            :   static const Float_t  kInnerOffWire = 0.5;
<span class="lineNum">     383 </span>            :   static const Int_t    kNOuter1WiresPerPad = 4;
<span class="lineNum">     384 </span>            :   static const Int_t    kNOuter2WiresPerPad = 6;
<span class="lineNum">     385 </span>            :   static const Float_t  kOuterWWPitch = 0.25;
<span class="lineNum">     386 </span>            :   static const Float_t  kROuterFirstWire = 134.225;
<span class="lineNum">     387 </span>            :   static const Float_t  kROuterLastWire = 246.975;
<span class="lineNum">     388 </span>            :   static const Int_t    kOuterDummyWire = 2;
<span class="lineNum">     389 </span>            :   static const Float_t  kOuterOffWire = 0.5;
<span class="lineNum">     390 </span>            :   //
<span class="lineNum">     391 </span>            :   //pad default parameters
<span class="lineNum">     392 </span>            :   //
<span class="lineNum">     393 </span>            :   static const Float_t  kInnerPadPitchLength = 0.75;
<span class="lineNum">     394 </span>            :   static const Float_t  kInnerPadPitchWidth = 0.40;
<span class="lineNum">     395 </span>            :   static const Float_t  kInnerPadLength = 0.75;
<span class="lineNum">     396 </span>            :   static const Float_t  kInnerPadWidth = 0.40;
<span class="lineNum">     397 </span>            :   static const Float_t  kOuter1PadPitchLength = 1.0;
<span class="lineNum">     398 </span>            :   static const Float_t  kOuterPadPitchWidth = 0.6;
<span class="lineNum">     399 </span>            :   static const Float_t  kOuter1PadLength = 1.0;
<span class="lineNum">     400 </span>            :   static const Float_t  kOuterPadWidth = 0.6;
<span class="lineNum">     401 </span>            :   static const Float_t  kOuter2PadPitchLength = 1.5;
<span class="lineNum">     402 </span>            :   static const Float_t  kOuter2PadLength = 1.5;
<span class="lineNum">     403 </span>            : 
<span class="lineNum">     404 </span>            :   static const Bool_t   kBMWPCReadout = kTRUE; //MWPC readout - another possibility GEM
<span class="lineNum">     405 </span>            :   static const Int_t    kNCrossRows = 1; //number of rows to cross-talk
<span class="lineNum">     406 </span>            : 
<span class="lineNum">     407 </span>            :   //
<span class="lineNum">     408 </span>            :   //gas default parameters
<span class="lineNum">     409 </span>            :   //
<span class="lineNum">     410 </span>            :   static const  Float_t  kDiffT = 2.2e-2;
<span class="lineNum">     411 </span>            :   static const  Float_t  kDiffL = 2.2e-2;
<span class="lineNum">     412 </span>            :   static const  Float_t  kGasGain = 2.e4;
<span class="lineNum">     413 </span>            :   static const  Float_t  kDriftV  =2.83e6;
<span class="lineNum">     414 </span>            :   static const  Float_t  kOmegaTau = 0.145;
<span class="lineNum">     415 </span>            :   static const  Float_t  kAttCoef = 250.;
<span class="lineNum">     416 </span>            :   static const  Float_t  kOxyCont = 5.e-6;
<span class="lineNum">     417 </span>            :   static const  Float_t  kFpot = 22.77e-9;
<span class="lineNum">     418 </span>            :   static const  Float_t  kNprim=14.35;
<span class="lineNum">     419 </span>            :   static const  Float_t  kNtot=42.66;
<span class="lineNum">     420 </span>            :   static const  Float_t  kWmean = 35.97e-9;
<span class="lineNum">     421 </span>            :   static const  Float_t  kExp = 2.2;
<span class="lineNum">     422 </span>            :   static const  Float_t  kEend = 10.e-6;
<span class="lineNum">     423 </span>            :   //
<span class="lineNum">     424 </span>            :   //electronic default parameters
<span class="lineNum">     425 </span>            :   //
<span class="lineNum">     426 </span>            :   static const  Float_t  kPadCoupling=0.5;
<span class="lineNum">     427 </span>            :   static const  Int_t    kZeroSup=2;
<span class="lineNum">     428 </span>            :   static const  Float_t  kNoise = 1000;
<span class="lineNum">     429 </span>            :   static const  Float_t  kChipGain = 12;
<span class="lineNum">     430 </span>            :   static const  Float_t  kChipNorm = 0.4;
<span class="lineNum">     431 </span>            :   static const  Float_t  kTSample = 2.e-7;
<span class="lineNum">     432 </span>            :   static const  Float_t  kTFWHM   = 1.9e-7;  //fwhm of charge distribution
<span class="lineNum">     433 </span>            :   static const  Int_t    kMaxTBin =445;
<span class="lineNum">     434 </span>            :   static const  Int_t    kADCSat  =1024;
<span class="lineNum">     435 </span>            :   static const  Float_t  kADCDynRange =2000.;
<span class="lineNum">     436 </span>            :   //
<span class="lineNum">     437 </span>            :   //response constants
<span class="lineNum">     438 </span>            :   //
<span class="lineNum">     439 </span>            :   static const Int_t     kNResponseMax=100;
<span class="lineNum">     440 </span>            :   static const Float_t   kResponseThreshold=0.01;
<span class="lineNum">     441 </span>            :   //L1 constants
<span class="lineNum">     442 </span>            :   //  static const Float_t   kGateDelay=6.1e-6; //In s
<span class="lineNum">     443 </span>            :   static const Float_t   kGateDelay=0.; //For the moment no gating
<span class="lineNum">     444 </span>            :   //  static const Float_t   kL1Delay=6.5e-6; //In s
<span class="lineNum">     445 </span>            :   static const Float_t   kL1Delay=0.; //For the moment no delay
<span class="lineNum">     446 </span>            :   //  static const UShort_t  kNTBinsBeforeL1=14;
<span class="lineNum">     447 </span>            :   static const UShort_t  kNTBinsBeforeL1=0; //For the moment no shift
<span class="lineNum">     448 </span><span class="lineCov">         72 :   fbStatus = kFALSE;</span>
<span class="lineNum">     449 </span>            :   //
<span class="lineNum">     450 </span>            :   //set sector parameters
<span class="lineNum">     451 </span>            :   //
<span class="lineNum">     452 </span><span class="lineCov">         36 :   SetInnerRadiusLow(kInnerRadiusLow);</span>
<span class="lineNum">     453 </span><span class="lineCov">         36 :   SetOuterRadiusLow(kOuterRadiusLow);</span>
<span class="lineNum">     454 </span><span class="lineCov">         36 :   SetInnerRadiusUp(kInnerRadiusUp);</span>
<span class="lineNum">     455 </span><span class="lineCov">         36 :   SetOuterRadiusUp(kOuterRadiusUp);</span>
<span class="lineNum">     456 </span><span class="lineCov">         36 :   SetInnerFrameSpace(kInnerFrameSpace);</span>
<span class="lineNum">     457 </span><span class="lineCov">         36 :   SetOuterFrameSpace(kOuterFrameSpace);</span>
<span class="lineNum">     458 </span><span class="lineCov">         36 :   SetInnerWireMount(kInnerWireMount);</span>
<span class="lineNum">     459 </span><span class="lineCov">         36 :   SetOuterWireMount(kOuterWireMount);</span>
<span class="lineNum">     460 </span><span class="lineCov">         36 :   SetSectorAngles(kInnerAngle,kInnerAngleShift,kOuterAngle,kOuterAngleShift);</span>
<span class="lineNum">     461 </span><span class="lineCov">         36 :   SetZLength(kZLength);</span>
<span class="lineNum">     462 </span><span class="lineCov">         36 :   SetGeometryType(kGeometryType);</span>
<span class="lineNum">     463 </span><span class="lineCov">         36 :   SetRowNLow(kNRowLow);</span>
<span class="lineNum">     464 </span><span class="lineCov">         36 :   SetRowNUp1 (kNRowUp1);</span>
<span class="lineNum">     465 </span><span class="lineCov">         36 :   SetRowNUp2(kNRowUp2);</span>
<span class="lineNum">     466 </span><span class="lineCov">         36 :   SetRowNUp(kNRowUp);</span>
<span class="lineNum">     467 </span>            :   //
<span class="lineNum">     468 </span>            :   //set wire parameters
<span class="lineNum">     469 </span>            :   //
<span class="lineNum">     470 </span><span class="lineCov">         36 :   SetInnerNWires(kNInnerWiresPerPad);</span>
<span class="lineNum">     471 </span><span class="lineCov">         36 :   SetInnerDummyWire(kInnerDummyWire);</span>
<span class="lineNum">     472 </span><span class="lineCov">         36 :   SetInnerOffWire(kInnerOffWire);</span>
<span class="lineNum">     473 </span><span class="lineCov">         36 :   SetOuter1NWires(kNOuter1WiresPerPad);</span>
<span class="lineNum">     474 </span><span class="lineCov">         36 :   SetOuter2NWire(kNOuter2WiresPerPad);</span>
<span class="lineNum">     475 </span><span class="lineCov">         36 :   SetOuterDummyWire(kOuterDummyWire);</span>
<span class="lineNum">     476 </span><span class="lineCov">         36 :   SetOuterOffWire(kOuterOffWire);</span>
<span class="lineNum">     477 </span><span class="lineCov">         36 :   SetInnerWWPitch(kInnerWWPitch);</span>
<span class="lineNum">     478 </span><span class="lineCov">         36 :   SetRInnerFirstWire(kRInnerFirstWire);</span>
<span class="lineNum">     479 </span><span class="lineCov">         36 :   SetRInnerLastWire(kRInnerLastWire);</span>
<span class="lineNum">     480 </span><span class="lineCov">         36 :   SetOuterWWPitch(kOuterWWPitch);</span>
<span class="lineNum">     481 </span><span class="lineCov">         36 :   SetROuterFirstWire(kROuterFirstWire);</span>
<span class="lineNum">     482 </span><span class="lineCov">         36 :   SetROuterLastWire(kROuterLastWire);</span>
<span class="lineNum">     483 </span>            :   //
<span class="lineNum">     484 </span>            :   //set pad parameter
<span class="lineNum">     485 </span>            :   //
<span class="lineNum">     486 </span><span class="lineCov">         36 :   SetInnerPadPitchLength(kInnerPadPitchLength);</span>
<span class="lineNum">     487 </span><span class="lineCov">         36 :   SetInnerPadPitchWidth(kInnerPadPitchWidth);</span>
<span class="lineNum">     488 </span><span class="lineCov">         36 :   SetInnerPadLength(kInnerPadLength);</span>
<span class="lineNum">     489 </span><span class="lineCov">         36 :   SetInnerPadWidth(kInnerPadWidth);</span>
<span class="lineNum">     490 </span><span class="lineCov">         36 :   SetOuter1PadPitchLength(kOuter1PadPitchLength);</span>
<span class="lineNum">     491 </span><span class="lineCov">         36 :   SetOuter2PadPitchLength(kOuter2PadPitchLength);</span>
<span class="lineNum">     492 </span><span class="lineCov">         36 :   SetOuterPadPitchWidth(kOuterPadPitchWidth);</span>
<span class="lineNum">     493 </span><span class="lineCov">         36 :   SetOuter1PadLength(kOuter1PadLength);</span>
<span class="lineNum">     494 </span><span class="lineCov">         36 :   SetOuter2PadLength(kOuter2PadLength);</span>
<span class="lineNum">     495 </span><span class="lineCov">         36 :   SetOuterPadWidth(kOuterPadWidth);</span>
<span class="lineNum">     496 </span><span class="lineCov">         36 :   SetMWPCReadout(kBMWPCReadout);</span>
<span class="lineNum">     497 </span><span class="lineCov">         36 :   SetNCrossRows(kNCrossRows);</span>
<span class="lineNum">     498 </span>            :   //
<span class="lineNum">     499 </span>            :   //set gas paremeters
<span class="lineNum">     500 </span>            :   //
<span class="lineNum">     501 </span><span class="lineCov">         36 :   SetDiffT(kDiffT);</span>
<span class="lineNum">     502 </span><span class="lineCov">         36 :   SetDiffL(kDiffL);</span>
<span class="lineNum">     503 </span><span class="lineCov">         36 :   SetGasGain(kGasGain);</span>
<span class="lineNum">     504 </span><span class="lineCov">         36 :   SetDriftV(kDriftV);</span>
<span class="lineNum">     505 </span><span class="lineCov">         36 :   SetOmegaTau(kOmegaTau);</span>
<span class="lineNum">     506 </span><span class="lineCov">         36 :   SetAttCoef(kAttCoef);</span>
<span class="lineNum">     507 </span><span class="lineCov">         36 :   SetOxyCont(kOxyCont);</span>
<span class="lineNum">     508 </span><span class="lineCov">         36 :   SetFpot(kFpot);</span>
<span class="lineNum">     509 </span><span class="lineCov">         36 :   SetNprim(kNprim);</span>
<span class="lineNum">     510 </span><span class="lineCov">         36 :   SetNtot(kNtot);</span>
<span class="lineNum">     511 </span><span class="lineCov">         36 :   SetWmean(kWmean);</span>
<span class="lineNum">     512 </span><span class="lineCov">         36 :   SetExp(kExp);</span>
<span class="lineNum">     513 </span><span class="lineCov">         36 :   SetEend(kEend);</span>
<span class="lineNum">     514 </span>            :   //
<span class="lineNum">     515 </span><span class="lineCov">         36 :   SetComposition(0.9,0.,0.1,0.,0.,0.);// Ne-CO2 90/10</span>
<span class="lineNum">     516 </span>            :   //
<span class="lineNum">     517 </span><span class="lineCov">         36 :   SetBetheBloch(GetBetheBlochParamAlice());</span>
<span class="lineNum">     518 </span><span class="lineCov">         36 :   SetBetheBlochMC(GetBetheBlochParamAliceMC());</span>
<span class="lineNum">     519 </span>            :   //
<span class="lineNum">     520 </span>            :   //set electronivc parameters
<span class="lineNum">     521 </span>            :   //
<span class="lineNum">     522 </span><span class="lineCov">         36 :   SetPadCoupling(kPadCoupling);</span>
<span class="lineNum">     523 </span><span class="lineCov">         36 :   SetZeroSup(kZeroSup);</span>
<span class="lineNum">     524 </span><span class="lineCov">         36 :   SetNoise(kNoise);</span>
<span class="lineNum">     525 </span><span class="lineCov">         36 :   SetChipGain(kChipGain);</span>
<span class="lineNum">     526 </span><span class="lineCov">         36 :   SetChipNorm(kChipNorm);</span>
<span class="lineNum">     527 </span><span class="lineCov">         36 :   SetTSample(kTSample);</span>
<span class="lineNum">     528 </span><span class="lineCov">         36 :   SetTFWHM(kTFWHM);</span>
<span class="lineNum">     529 </span><span class="lineCov">         36 :   SetMaxTBin(kMaxTBin);</span>
<span class="lineNum">     530 </span><span class="lineCov">         36 :   SetADCSat(kADCSat);</span>
<span class="lineNum">     531 </span><span class="lineCov">         36 :   SetADCDynRange(kADCDynRange);</span>
<span class="lineNum">     532 </span><span class="lineCov">       2664 :   for (UInt_t i=0; i&lt;36; i++)</span>
<span class="lineNum">     533 </span>            :   {
<span class="lineNum">     534 </span><span class="lineCov">       1296 :     SetNominalVoltage(1196.0, i);</span>
<span class="lineNum">     535 </span>            :   }
<span class="lineNum">     536 </span><span class="lineCov">       2664 :   for (UInt_t i=36; i&lt;72; i++)</span>
<span class="lineNum">     537 </span>            :   {
<span class="lineNum">     538 </span><span class="lineCov">       1296 :     SetNominalVoltage(1417.0, i);</span>
<span class="lineNum">     539 </span>            :   }
<span class="lineNum">     540 </span>            : //   //set magnetic field
<span class="lineNum">     541 </span>            : //   SetBField(kBField);
<span class="lineNum">     542 </span>            : //   SetNPrimLoss(kNPrimLoss);
<span class="lineNum">     543 </span>            : //   SetNTotalLoss(kNTotalLoss);
<span class="lineNum">     544 </span>            :   //
<span class="lineNum">     545 </span>            :   //set response  parameters
<span class="lineNum">     546 </span>            :   //
<span class="lineNum">     547 </span><span class="lineCov">         36 :   SetNResponseMax(kNResponseMax);</span>
<span class="lineNum">     548 </span><span class="lineCov">         36 :   SetResponseThreshold(static_cast&lt;int&gt;(kResponseThreshold));</span>
<span class="lineNum">     549 </span>            :   //L1 data
<span class="lineNum">     550 </span><span class="lineCov">         36 :   SetGateDelay(kGateDelay);</span>
<span class="lineNum">     551 </span><span class="lineCov">         36 :   SetL1Delay(kL1Delay);</span>
<span class="lineNum">     552 </span><span class="lineCov">         36 :   SetNTBinsBeforeL1(kNTBinsBeforeL1);</span>
<span class="lineNum">     553 </span><span class="lineCov">         36 :   SetNominalGainSlopes();</span>
<span class="lineNum">     554 </span><span class="lineCov">         36 : }</span>
<a name="555"><span class="lineNum">     555 </span>            : </a>
<span class="lineNum">     556 </span>            : 
<span class="lineNum">     557 </span>            : Bool_t AliTPCParam::Update()
<span class="lineNum">     558 </span>            : {
<span class="lineNum">     559 </span>            :   /// update some calculated parameter which must be updated after changing &quot;base&quot;
<span class="lineNum">     560 </span>            :   /// parameters
<span class="lineNum">     561 </span>            :   /// for example we can change size of pads and according this recalculate number
<span class="lineNum">     562 </span>            :   /// of pad rows, number of of pads in given row ....
<span class="lineNum">     563 </span>            : 
<span class="lineNum">     564 </span>            :   const Float_t kQel = 1.602e-19; // elementary charge
<span class="lineNum">     565 </span><span class="lineCov">         66 :   fbStatus = kFALSE;</span>
<span class="lineNum">     566 </span>            : 
<span class="lineNum">     567 </span>            :   Int_t i,j;  //loop variables because HP
<span class="lineNum">     568 </span>            :   //-----------------Sector section------------------------------------------
<span class="lineNum">     569 </span>            :   //calclulate number of sectors
<span class="lineNum">     570 </span><span class="lineCov">         33 :   fNInnerSector = Int_t(4*TMath::Pi()/fInnerAngle+0.2);</span>
<span class="lineNum">     571 </span>            :        // number of inner sectors - factor 0.2 to don't be influnced by inprecision
<span class="lineNum">     572 </span><span class="lineCov">         33 :   if (fNInnerSector%2) return kFALSE;</span>
<span class="lineNum">     573 </span><span class="lineCov">         33 :   fNOuterSector = Int_t(4*TMath::Pi()/fOuterAngle+0.2);</span>
<span class="lineNum">     574 </span><span class="lineCov">         33 :   if (fNOuterSector%2) return kFALSE;</span>
<span class="lineNum">     575 </span><span class="lineCov">         33 :   fNSector  = fNInnerSector+fNOuterSector;</span>
<span class="lineNum">     576 </span>            : 
<span class="lineNum">     577 </span><span class="lineCov">         63 :   if (fRotAngle!=0) delete [] fRotAngle;</span>
<span class="lineNum">     578 </span><span class="lineCov">         33 :   fRotAngle = new Float_t[4*fNSector];</span>
<span class="lineNum">     579 </span>            :   //calculate sin and cosine of rotations angle
<span class="lineNum">     580 </span>            :   //sectors angles numbering from 0
<span class="lineNum">     581 </span>            : 
<span class="lineNum">     582 </span><span class="lineCov">         33 :   j=fNInnerSector*2;</span>
<span class="lineNum">     583 </span><span class="lineCov">         33 :   Float_t angle = fInnerAngleShift;</span>
<span class="lineNum">     584 </span><span class="lineCov">       1254 :   for (i=0; j&lt;fNInnerSector*4; i+=4, j+=4 , angle +=fInnerAngle){</span>
<span class="lineNum">     585 </span><span class="lineCov">        594 :     fRotAngle[i]=TMath::Cos(angle);</span>
<span class="lineNum">     586 </span><span class="lineCov">        594 :     fRotAngle[i+1]=TMath::Sin(angle);</span>
<span class="lineNum">     587 </span><span class="lineCov">        594 :     fRotAngle[j] =  fRotAngle[i];</span>
<span class="lineNum">     588 </span><span class="lineCov">        594 :     fRotAngle[j+1] =  fRotAngle[i+1];</span>
<span class="lineNum">     589 </span><span class="lineCov">        594 :     fRotAngle[i+2] =angle;</span>
<span class="lineNum">     590 </span><span class="lineCov">        594 :     fRotAngle[j+2] =angle;    </span>
<span class="lineNum">     591 </span><span class="lineCov">        594 :     fRotAngle[i+3] =angle;</span>
<span class="lineNum">     592 </span><span class="lineCov">        594 :     fRotAngle[j+3] =angle;    </span>
<span class="lineNum">     593 </span>            :   }
<span class="lineNum">     594 </span><span class="lineCov">         33 :   angle = fOuterAngleShift;</span>
<span class="lineNum">     595 </span><span class="lineCov">         33 :   j=(fNInnerSector+fNOuterSector/2)*4;</span>
<span class="lineNum">     596 </span><span class="lineCov">       1254 :   for (i=fNInnerSector*4; j&lt;fNSector*4; i+=4,j+=4, angle +=fOuterAngle){</span>
<span class="lineNum">     597 </span><span class="lineCov">        594 :     fRotAngle[i]=TMath::Cos(angle);</span>
<span class="lineNum">     598 </span><span class="lineCov">        594 :     fRotAngle[i+1]=TMath::Sin(angle);</span>
<span class="lineNum">     599 </span><span class="lineCov">        594 :     fRotAngle[j] =  fRotAngle[i];</span>
<span class="lineNum">     600 </span><span class="lineCov">        594 :     fRotAngle[j+1] =  fRotAngle[i+1];</span>
<span class="lineNum">     601 </span><span class="lineCov">        594 :     fRotAngle[i+2] =angle;</span>
<span class="lineNum">     602 </span><span class="lineCov">        594 :     fRotAngle[j+2] =angle;    </span>
<span class="lineNum">     603 </span><span class="lineCov">        594 :     fRotAngle[i+3] =angle;</span>
<span class="lineNum">     604 </span><span class="lineCov">        594 :     fRotAngle[j+3] =angle;    </span>
<span class="lineNum">     605 </span>            :   }
<span class="lineNum">     606 </span>            : 
<span class="lineNum">     607 </span><span class="lineCov">         33 :   fZWidth = fTSample*fDriftV;</span>
<span class="lineNum">     608 </span><span class="lineCov">         33 :   fTotalNormFac = fPadCoupling*fChipNorm*kQel*1.e15*fChipGain*fADCSat/fADCDynRange;</span>
<span class="lineNum">     609 </span><span class="lineCov">         33 :   fNoiseNormFac = kQel*1.e15*fChipGain*fADCSat/fADCDynRange;</span>
<span class="lineNum">     610 </span>            :   //wire section
<span class="lineNum">     611 </span>            :   /*  Int_t nwire;
<span class="lineNum">     612 </span>            :   Float_t wspace; //available space for wire
<span class="lineNum">     613 </span>            :   Float_t dummyspace; //dummyspace for wire
<span class="lineNum">     614 </span>            : 
<span class="lineNum">     615 </span>            :   wspace =fInnerRadiusUp-fInnerRadiusLow-2*fInnerOffWire;
<span class="lineNum">     616 </span>            :   nwire = Int_t(wspace/fInnerWWPitch);
<span class="lineNum">     617 </span>            :   wspace = Float_t(nwire)*fInnerWWPitch;
<span class="lineNum">     618 </span>            :   dummyspace =(fInnerRadiusUp-fInnerRadiusLow-wspace)/2.;
<span class="lineNum">     619 </span>            :   wspace =fOuterRadiusUp-fOuterRadiusLow-2*fOuterOffWire;
<span class="lineNum">     620 </span>            :   nwire = Int_t(wspace/fOuterWWPitch);
<span class="lineNum">     621 </span>            :   wspace = Float_t(nwire)*fOuterWWPitch;
<span class="lineNum">     622 </span>            :   dummyspace =(fOuterRadiusUp-fOuterRadiusLow-wspace)/2.;
<span class="lineNum">     623 </span>            :   fROuterFirstWire = fOuterRadiusLow+dummyspace;
<span class="lineNum">     624 </span>            :   fROuterLastWire = fROuterFirstWire+fOuterWWPitch*(Float_t)(nwire);
<span class="lineNum">     625 </span>            :   */
<span class="lineNum">     626 </span>            : 
<span class="lineNum">     627 </span>            :   //
<span class="lineNum">     628 </span>            :   //response data
<span class="lineNum">     629 </span>            :   //
<span class="lineNum">     630 </span><span class="lineCov">         63 :   if (fResponseBin) delete [] fResponseBin;</span>
<span class="lineNum">     631 </span><span class="lineCov">         63 :   if (fResponseWeight) delete [] fResponseWeight;</span>
<span class="lineNum">     632 </span><span class="lineCov">         33 :   fResponseBin    = new Int_t[3*fNResponseMax];</span>
<span class="lineNum">     633 </span><span class="lineCov">         33 :   fResponseWeight = new Float_t[fNResponseMax];</span>
<span class="lineNum">     634 </span>            : 
<span class="lineNum">     635 </span>            :   //L1 data
<span class="lineNum">     636 </span><span class="lineCov">         33 :   fNTBinsL1 = fL1Delay/fTSample - (Float_t)fNTBinsBeforeL1;</span>
<span class="lineNum">     637 </span><span class="lineCov">         33 :   fbStatus = kTRUE;</span>
<span class="lineNum">     638 </span>            :   return kTRUE;
<a name="639"><span class="lineNum">     639 </span><span class="lineCov">         33 : }</span></a>
<span class="lineNum">     640 </span>            : 
<span class="lineNum">     641 </span>            : void AliTPCParam::CleanGeoMatrices(){
<span class="lineNum">     642 </span>            :   /// clean geo matrices
<span class="lineNum">     643 </span>            : 
<span class="lineNum">     644 </span><span class="lineCov">         40 :   if (fTrackingMatrix) {</span>
<span class="lineNum">     645 </span><span class="lineCov">        730 :     for(Int_t i = 0; i &lt; fNSector; i++)</span>
<span class="lineNum">     646 </span><span class="lineCov">        360 :       delete fTrackingMatrix[i];</span>
<span class="lineNum">     647 </span><span class="lineCov">         10 :     delete [] fTrackingMatrix;</span>
<span class="lineNum">     648 </span>            :   }
<span class="lineNum">     649 </span>            : 
<span class="lineNum">     650 </span><span class="lineCov">         20 :   if (fClusterMatrix) {</span>
<span class="lineNum">     651 </span><span class="lineCov">        730 :     for(Int_t i = 0; i &lt; fNSector; i++)</span>
<span class="lineNum">     652 </span><span class="lineCov">        720 :       delete fClusterMatrix[i];</span>
<span class="lineNum">     653 </span><span class="lineCov">         10 :     delete [] fClusterMatrix;</span>
<span class="lineNum">     654 </span>            :   }
<span class="lineNum">     655 </span>            : 
<span class="lineNum">     656 </span><span class="lineCov">         20 :   if (fGlobalMatrix) {</span>
<span class="lineNum">     657 </span><span class="lineCov">        730 :     for(Int_t i = 0; i &lt; fNSector; i++)</span>
<span class="lineNum">     658 </span><span class="lineCov">        720 :       delete fGlobalMatrix[i];</span>
<span class="lineNum">     659 </span><span class="lineCov">         10 :     delete [] fGlobalMatrix;</span>
<span class="lineNum">     660 </span>            :   }
<span class="lineNum">     661 </span>            : 
<span class="lineNum">     662 </span><span class="lineCov">         20 :   return;</span>
<a name="663"><span class="lineNum">     663 </span>            : }</a>
<span class="lineNum">     664 </span>            : 
<span class="lineNum">     665 </span>            : Bool_t AliTPCParam::ReadGeoMatrices(){
<span class="lineNum">     666 </span>            :   /// read geo matrixes
<span class="lineNum">     667 </span>            : 
<span class="lineNum">     668 </span><span class="lineCov">         34 :   if (!gGeoManager){</span>
<span class="lineNum">     669 </span><span class="lineNoCov">          0 :     AliFatal(&quot;Geo manager not initialized\n&quot;);</span>
<span class="lineNum">     670 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">     671 </span><span class="lineCov">         17 :   AliAlignObjParams o;</span>
<span class="lineNum">     672 </span>            :   //
<span class="lineNum">     673 </span>            : 
<span class="lineNum">     674 </span>            :   // clean geo matrices
<span class="lineNum">     675 </span><span class="lineCov">         17 :   CleanGeoMatrices();</span>
<span class="lineNum">     676 </span>            : 
<span class="lineNum">     677 </span>            :   // create new geo matrices
<span class="lineNum">     678 </span><span class="lineCov">         34 :   fTrackingMatrix = new TGeoHMatrix*[fNSector];</span>
<span class="lineNum">     679 </span><span class="lineCov">         34 :   fClusterMatrix = new TGeoHMatrix*[fNSector];</span>
<span class="lineNum">     680 </span><span class="lineCov">         34 :   fGlobalMatrix = new TGeoHMatrix*[fNSector];</span>
<span class="lineNum">     681 </span><span class="lineCov">       2482 :   for (Int_t isec=0; isec&lt;fNSector; isec++) {</span>
<span class="lineNum">     682 </span><span class="lineCov">       1224 :     fGlobalMatrix[isec] = 0;</span>
<span class="lineNum">     683 </span><span class="lineCov">       1224 :     fClusterMatrix[isec]= 0;</span>
<span class="lineNum">     684 </span><span class="lineCov">       1224 :     fTrackingMatrix[isec]=0;</span>
<span class="lineNum">     685 </span>            :   }
<span class="lineNum">     686 </span>            :   //
<span class="lineNum">     687 </span><span class="lineCov">       2499 :   for (Int_t isec=0; isec&lt;fNSector; isec++) {</span>
<span class="lineNum">     688 </span><span class="lineCov">       1224 :     fGlobalMatrix[isec] = 0;</span>
<span class="lineNum">     689 </span><span class="lineCov">       1224 :     fClusterMatrix[isec]= 0;</span>
<span class="lineNum">     690 </span><span class="lineCov">       1224 :     fTrackingMatrix[isec]=0;</span>
<span class="lineNum">     691 </span>            :     AliGeomManager::ELayerID iLayer;
<span class="lineNum">     692 </span>            :     Int_t iModule;
<span class="lineNum">     693 </span>            : 
<span class="lineNum">     694 </span><span class="lineCov">       1224 :     if(isec&lt;fNInnerSector) {</span>
<span class="lineNum">     695 </span>            :       iLayer = AliGeomManager::kTPC1;
<span class="lineNum">     696 </span>            :       iModule = isec;
<span class="lineNum">     697 </span><span class="lineCov">        612 :     }</span>
<span class="lineNum">     698 </span>            :     else {
<span class="lineNum">     699 </span>            :       iLayer = AliGeomManager::kTPC2;
<span class="lineNum">     700 </span><span class="lineCov">        612 :       iModule = isec - fNInnerSector;</span>
<span class="lineNum">     701 </span>            :     }
<span class="lineNum">     702 </span>            : 
<span class="lineNum">     703 </span><span class="lineCov">       1224 :     UShort_t volid = AliGeomManager::LayerToVolUID(iLayer,iModule);</span>
<span class="lineNum">     704 </span><span class="lineCov">       1224 :     TGeoPNEntry* pne = gGeoManager-&gt;GetAlignableEntryByUID(volid);</span>
<span class="lineNum">     705 </span><span class="lineCov">       1224 :     if(!pne)</span>
<span class="lineNum">     706 </span>            :     {
<span class="lineNum">     707 </span><span class="lineNoCov">          0 :       AliError(Form(&quot;Alignable entry for volume ID %d not in geometry. Exiting!&quot;,volid));</span>
<span class="lineNum">     708 </span><span class="lineNoCov">          0 :       return kFALSE;</span>
<span class="lineNum">     709 </span>            :     }
<span class="lineNum">     710 </span><span class="lineCov">       1224 :     const char *path = pne-&gt;GetTitle();</span>
<span class="lineNum">     711 </span><span class="lineCov">       2448 :     if (!gGeoManager-&gt;cd(path)) return kFALSE;</span>
<span class="lineNum">     712 </span><span class="lineCov">       1224 :     TGeoHMatrix *m = gGeoManager-&gt;GetCurrentMatrix();</span>
<span class="lineNum">     713 </span>            :     // Since GEANT4 does not allow reflections, in this case the reflection
<span class="lineNum">     714 </span>            :     // component if the matrix is embedded by TGeo inside TGeoScaledShape
<span class="lineNum">     715 </span><span class="lineCov">       3672 :     if (gGeoManager-&gt;GetCurrentVolume()-&gt;GetShape()-&gt;IsReflected())</span>
<span class="lineNum">     716 </span><span class="lineNoCov">          0 :        m-&gt;ReflectZ(kFALSE, kTRUE);</span>
<span class="lineNum">     717 </span>            :     //
<span class="lineNum">     718 </span><span class="lineCov">       1224 :     TGeoRotation mchange;</span>
<span class="lineNum">     719 </span><span class="lineCov">       2448 :     mchange.RotateY(90); mchange.RotateX(90);</span>
<span class="lineNum">     720 </span><span class="lineCov">       1224 :     Float_t ROCcenter[3];</span>
<span class="lineNum">     721 </span><span class="lineCov">       1224 :     GetChamberCenter(isec,ROCcenter);</span>
<span class="lineNum">     722 </span>            :     //
<span class="lineNum">     723 </span>            :     // Convert to global coordinate system
<span class="lineNum">     724 </span>            :     //
<span class="lineNum">     725 </span><span class="lineCov">       3672 :     fGlobalMatrix[isec] = new TGeoHMatrix(*m);</span>
<span class="lineNum">     726 </span><span class="lineCov">       2448 :     fGlobalMatrix[isec]-&gt;Multiply(&amp;(mchange.Inverse()));</span>
<span class="lineNum">     727 </span><span class="lineCov">       1224 :     TGeoTranslation center(&quot;center&quot;,-ROCcenter[0],-ROCcenter[1],-ROCcenter[2]);</span>
<span class="lineNum">     728 </span><span class="lineCov">       1224 :     fGlobalMatrix[isec]-&gt;Multiply(&amp;center);</span>
<span class="lineNum">     729 </span>            :     //
<span class="lineNum">     730 </span>            :     //  cluster correction matrix
<span class="lineNum">     731 </span>            :     //
<span class="lineNum">     732 </span><span class="lineCov">       3672 :     fClusterMatrix[isec] = new TGeoHMatrix;</span>
<span class="lineNum">     733 </span><span class="lineCov">       1224 :     Double_t sectorAngle = 20.*(isec%18)+10;</span>
<span class="lineNum">     734 </span><span class="lineCov">       1224 :     TGeoHMatrix  rotMatrix;</span>
<span class="lineNum">     735 </span><span class="lineCov">       1224 :     rotMatrix.RotateZ(sectorAngle);</span>
<span class="lineNum">     736 </span><span class="lineCov">       2448 :     if (GetGlobalMatrix(isec)-&gt;GetTranslation()[2]&gt;0){</span>
<span class="lineNum">     737 </span>            :       //
<span class="lineNum">     738 </span>            :       // mirrored system
<span class="lineNum">     739 </span>            :       //
<span class="lineNum">     740 </span><span class="lineCov">        612 :       TGeoRotation mirrorZ;</span>
<span class="lineNum">     741 </span><span class="lineCov">        612 :       mirrorZ.SetAngles(90,0,90,90,180,0);</span>
<span class="lineNum">     742 </span><span class="lineCov">        612 :       fClusterMatrix[isec]-&gt;Multiply(&amp;mirrorZ);</span>
<span class="lineNum">     743 </span><span class="lineCov">        612 :     }</span>
<span class="lineNum">     744 </span><span class="lineCov">       1224 :     TGeoTranslation trans(0,0,GetZLength(isec));</span>
<span class="lineNum">     745 </span><span class="lineCov">       1224 :     fClusterMatrix[isec]-&gt;MultiplyLeft(&amp;trans);</span>
<span class="lineNum">     746 </span><span class="lineCov">       1224 :     fClusterMatrix[isec]-&gt;MultiplyLeft((GetGlobalMatrix(isec)));</span>
<span class="lineNum">     747 </span><span class="lineCov">       2448 :     fClusterMatrix[isec]-&gt;MultiplyLeft(&amp;(rotMatrix.Inverse()));</span>
<span class="lineNum">     748 </span><span class="lineCov">       1224 :   }</span>
<span class="lineNum">     749 </span><span class="lineCov">         17 :   return kTRUE;</span>
<a name="750"><span class="lineNum">     750 </span><span class="lineCov">         17 : }</span></a>
<span class="lineNum">     751 </span>            : 
<span class="lineNum">     752 </span>            : TGeoHMatrix *  AliTPCParam::Tracking2LocalMatrix(const TGeoHMatrix * geoMatrix, Int_t sector) const{
<span class="lineNum">     753 </span>            :   /// make local to tracking matrix
<span class="lineNum">     754 </span>            : 
<span class="lineNum">     755 </span><span class="lineCov">        144 :   Double_t sectorAngle = 20.*(sector%18)+10;</span>
<span class="lineNum">     756 </span><span class="lineCov">         72 :   TGeoHMatrix *newMatrix = new TGeoHMatrix();</span>
<span class="lineNum">     757 </span><span class="lineCov">         72 :   newMatrix-&gt;RotateZ(sectorAngle);</span>
<span class="lineNum">     758 </span><span class="lineCov">         72 :   newMatrix-&gt;MultiplyLeft(&amp;(geoMatrix-&gt;Inverse()));</span>
<span class="lineNum">     759 </span><span class="lineCov">         72 :   return newMatrix;</span>
<span class="lineNum">     760 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">     761 </span>            : 
<span class="lineNum">     762 </span>            : 
<a name="763"><span class="lineNum">     763 </span>            : </a>
<span class="lineNum">     764 </span>            : 
<span class="lineNum">     765 </span>            : Bool_t AliTPCParam::GetStatus() const
<span class="lineNum">     766 </span>            : {
<span class="lineNum">     767 </span>            :   /// get information about object consistency
<span class="lineNum">     768 </span>            : 
<span class="lineNum">     769 </span><span class="lineNoCov">          0 :   return fbStatus;</span>
<a name="770"><span class="lineNum">     770 </span>            : }</a>
<span class="lineNum">     771 </span>            : 
<span class="lineNum">     772 </span>            : Int_t AliTPCParam::GetNRowLow() const
<span class="lineNum">     773 </span>            : {
<span class="lineNum">     774 </span>            :   /// get the number of pad rows in low sector
<span class="lineNum">     775 </span>            : 
<a name="776"><span class="lineNum">     776 </span><span class="lineCov">     140712 :   return fNRowLow;</span></a>
<span class="lineNum">     777 </span>            : }
<span class="lineNum">     778 </span>            : Int_t AliTPCParam::GetNRowUp() const
<span class="lineNum">     779 </span>            : {
<span class="lineNum">     780 </span>            :   /// get the number of pad rows in up sector
<span class="lineNum">     781 </span>            : 
<a name="782"><span class="lineNum">     782 </span><span class="lineCov">        608 :   return fNRowUp;</span></a>
<span class="lineNum">     783 </span>            : }
<span class="lineNum">     784 </span>            : Int_t AliTPCParam::GetNRowUp1() const
<span class="lineNum">     785 </span>            : {
<span class="lineNum">     786 </span>            :   /// get the number of pad rows in up1 sector
<span class="lineNum">     787 </span>            : 
<a name="788"><span class="lineNum">     788 </span><span class="lineCov">    1425296 :   return fNRowUp1;</span></a>
<span class="lineNum">     789 </span>            : }
<span class="lineNum">     790 </span>            : Int_t AliTPCParam::GetNRowUp2() const
<span class="lineNum">     791 </span>            : {
<span class="lineNum">     792 </span>            :   /// get the number of pad rows in up2 sector
<span class="lineNum">     793 </span>            : 
<a name="794"><span class="lineNum">     794 </span><span class="lineCov">       1080 :   return fNRowUp2;</span></a>
<span class="lineNum">     795 </span>            : }
<span class="lineNum">     796 </span>            : Float_t AliTPCParam::GetPadRowRadiiLow(Int_t irow) const
<span class="lineNum">     797 </span>            : {
<span class="lineNum">     798 </span>            :   /// get the pad row (irow) radii
<span class="lineNum">     799 </span>            : 
<span class="lineNum">     800 </span><span class="lineCov">     338028 :   if ( !(irow&lt;0) &amp;&amp; (irow&lt;fNRowLow) )</span>
<span class="lineNum">     801 </span><span class="lineCov">     112676 :     return  fPadRowLow[irow];</span>
<span class="lineNum">     802 </span>            :   else
<span class="lineNum">     803 </span><span class="lineNoCov">          0 :     return 0;</span>
<a name="804"><span class="lineNum">     804 </span><span class="lineCov">     112676 : }</span></a>
<span class="lineNum">     805 </span>            : 
<span class="lineNum">     806 </span>            : Float_t AliTPCParam::GetPadRowRadiiUp(Int_t irow) const
<span class="lineNum">     807 </span>            : {
<span class="lineNum">     808 </span>            :   /// get the pad row (irow) radii
<span class="lineNum">     809 </span>            : 
<span class="lineNum">     810 </span><span class="lineCov">     206976 :  if ( !(irow&lt;0) &amp;&amp; (irow&lt;fNRowUp) )</span>
<span class="lineNum">     811 </span><span class="lineCov">      68992 :     return  fPadRowUp[irow];</span>
<span class="lineNum">     812 </span>            :   else
<span class="lineNum">     813 </span><span class="lineNoCov">          0 :     return 0;</span>
<a name="814"><span class="lineNum">     814 </span><span class="lineCov">      68992 : }</span></a>
<span class="lineNum">     815 </span>            : 
<span class="lineNum">     816 </span>            : Int_t AliTPCParam::GetNPadsLow(Int_t irow) const
<span class="lineNum">     817 </span>            : {
<span class="lineNum">     818 </span>            :   /// get the number of pads in row irow
<span class="lineNum">     819 </span>            : 
<span class="lineNum">     820 </span><span class="lineCov">   12049505 :   if ( !(irow&lt;0) &amp;&amp; (irow&lt;fNRowLow) )</span>
<span class="lineNum">     821 </span><span class="lineCov">    3999060 :     return  fNPadsLow[irow];</span>
<span class="lineNum">     822 </span>            :   else
<span class="lineNum">     823 </span><span class="lineCov">      22980 :     return 0;</span>
<span class="lineNum">     824 </span><span class="lineCov">    4022040 : }</span>
<a name="825"><span class="lineNum">     825 </span>            : </a>
<span class="lineNum">     826 </span>            : 
<span class="lineNum">     827 </span>            : Int_t AliTPCParam::GetNPadsUp(Int_t irow) const
<span class="lineNum">     828 </span>            : {
<span class="lineNum">     829 </span>            :   /// get the number of pads in row irow
<span class="lineNum">     830 </span>            : 
<span class="lineNum">     831 </span><span class="lineCov">    8605676 :   if ( !(irow&lt;0) &amp;&amp; (irow&lt;fNRowUp) )</span>
<span class="lineNum">     832 </span><span class="lineCov">    2837892 :     return  fNPadsUp[irow];</span>
<span class="lineNum">     833 </span>            :   else
<span class="lineNum">     834 </span><span class="lineCov">      32235 :     return 0;</span>
<a name="835"><span class="lineNum">     835 </span><span class="lineCov">    2870127 : }</span></a>
<span class="lineNum">     836 </span>            : 
<span class="lineNum">     837 </span>            : Int_t AliTPCParam::GetWireSegment(Int_t sector, Int_t row) const
<span class="lineNum">     838 </span>            : {
<span class="lineNum">     839 </span>            :   /// Get Anode wire segment index IROC --&gt; 4 segments in [0,3], 7 segments OROC[4,10]
<span class="lineNum">     840 </span>            :   ///
<span class="lineNum">     841 </span>            :   /// To  be speed-up using caching lookup table
<span class="lineNum">     842 </span>            : 
<span class="lineNum">     843 </span>            :   Int_t wireIndex = -1;
<span class="lineNum">     844 </span>            :   // check if the given set of sector and row is OK
<span class="lineNum">     845 </span><span class="lineNoCov">          0 :   if ( (sector&lt;0 || sector&gt;=72) || (row&lt;0 || row&gt;95) || (sector&lt;36 &amp;&amp; row&gt;64) ){</span>
<span class="lineNum">     846 </span><span class="lineNoCov">          0 :     AliError(&quot;No matching anode wire segment for this set of sector-row \n&quot;);</span>
<span class="lineNum">     847 </span><span class="lineNoCov">          0 :     return wireIndex;</span>
<span class="lineNum">     848 </span>            :   }
<span class="lineNum">     849 </span>            :   // find the wire index for given sector-row
<span class="lineNum">     850 </span><span class="lineNoCov">          0 :   if ( sector&lt;36 ){                               // IROC anode wire segments</span>
<span class="lineNum">     851 </span><span class="lineNoCov">          0 :     if (row&lt;16) wireIndex=0;</span>
<span class="lineNum">     852 </span><span class="lineNoCov">          0 :     else if (row&gt;=16 &amp;&amp; row&lt;32) wireIndex=1;</span>
<span class="lineNum">     853 </span><span class="lineNoCov">          0 :     else if (row&gt;=32 &amp;&amp; row&lt;48) wireIndex=2;</span>
<span class="lineNum">     854 </span>            :     else wireIndex=3;
<span class="lineNum">     855 </span>            :   } else {                                        // OROC anode wire segments
<span class="lineNum">     856 </span><span class="lineNoCov">          0 :     if (row&lt;16) wireIndex=4;</span>
<span class="lineNum">     857 </span><span class="lineNoCov">          0 :     else if ( row&gt;=16 &amp;&amp; row&lt;32) wireIndex=5;</span>
<span class="lineNum">     858 </span><span class="lineNoCov">          0 :     else if ( row&gt;=32 &amp;&amp; row&lt;48) wireIndex=6;</span>
<span class="lineNum">     859 </span><span class="lineNoCov">          0 :     else if ( row&gt;=48 &amp;&amp; row&lt;64) wireIndex=7;</span>
<span class="lineNum">     860 </span><span class="lineNoCov">          0 :     else if ( row&gt;=64 &amp;&amp; row&lt;75) wireIndex=8;</span>
<span class="lineNum">     861 </span><span class="lineNoCov">          0 :     else if ( row&gt;=75 &amp;&amp; row&lt;85) wireIndex=9;</span>
<span class="lineNum">     862 </span>            :     else wireIndex=10;
<span class="lineNum">     863 </span>            :   }
<span class="lineNum">     864 </span><span class="lineNoCov">          0 :   return wireIndex;</span>
<a name="865"><span class="lineNum">     865 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     866 </span>            : 
<span class="lineNum">     867 </span>            : Int_t AliTPCParam::GetNPadsPerSegment(Int_t wireSegmentID) const
<span class="lineNum">     868 </span>            : {
<span class="lineNum">     869 </span>            :   /// Get the number of pads in a given anode wire segment
<span class="lineNum">     870 </span>            :   ///
<span class="lineNum">     871 </span>            :   /// check if the given segment index is OK
<span class="lineNum">     872 </span>            :   /// To be done (if needed) - cache the lookup table
<span class="lineNum">     873 </span>            : 
<span class="lineNum">     874 </span><span class="lineNoCov">          0 :   if ( wireSegmentID&lt;0 || wireSegmentID&gt;10 ){</span>
<span class="lineNum">     875 </span><span class="lineNoCov">          0 :     AliError(&quot;Wrong anode wire segment index. it should be [0,10] \n&quot;);</span>
<span class="lineNum">     876 </span><span class="lineNoCov">          0 :     return -1;</span>
<span class="lineNum">     877 </span>            :   }
<span class="lineNum">     878 </span>            :   // get sector type from wireSegmentID
<span class="lineNum">     879 </span><span class="lineNoCov">          0 :   Int_t sector = (wireSegmentID&lt;4) ? 0 : 36; // ROC [0,35] --&gt; IROC, ROC [36,71] --&gt; OROC</span>
<span class="lineNum">     880 </span>            :   // get the upper and lower row number for the given wireSegmentID
<span class="lineNum">     881 </span>            :   Int_t segRowDown = 0;
<span class="lineNum">     882 </span>            :   Int_t segRowUp   = 0;
<span class="lineNum">     883 </span>            : 
<span class="lineNum">     884 </span><span class="lineNoCov">          0 :   if ( wireSegmentID == 0 || wireSegmentID == 4 ) {</span>
<span class="lineNum">     885 </span>            :     segRowDown = 0;
<span class="lineNum">     886 </span>            :     segRowUp   = 16;
<span class="lineNum">     887 </span><span class="lineNoCov">          0 :   } else if ( wireSegmentID == 1 || wireSegmentID == 5 ) {</span>
<span class="lineNum">     888 </span>            :     segRowDown = 16;
<span class="lineNum">     889 </span>            :     segRowUp   = 32;
<span class="lineNum">     890 </span><span class="lineNoCov">          0 :   } else if ( wireSegmentID == 2 || wireSegmentID == 6 ) {</span>
<span class="lineNum">     891 </span>            :     segRowDown = 32;
<span class="lineNum">     892 </span>            :     segRowUp   = 48;
<span class="lineNum">     893 </span><span class="lineNoCov">          0 :   } else if ( wireSegmentID == 3 || wireSegmentID == 7 ) {</span>
<span class="lineNum">     894 </span>            :     segRowDown = 48;
<span class="lineNum">     895 </span>            :     segRowUp   = 63;
<span class="lineNum">     896 </span><span class="lineNoCov">          0 :   } else if ( wireSegmentID == 8 ) {</span>
<span class="lineNum">     897 </span>            :     segRowDown = 64;
<span class="lineNum">     898 </span>            :     segRowUp   = 75;
<span class="lineNum">     899 </span><span class="lineNoCov">          0 :   } else if ( wireSegmentID == 9 ) {</span>
<span class="lineNum">     900 </span>            :     segRowDown = 75;
<span class="lineNum">     901 </span>            :     segRowUp   = 85;
<span class="lineNum">     902 </span><span class="lineNoCov">          0 :   } else {</span>
<span class="lineNum">     903 </span>            :     segRowDown = 85;
<span class="lineNum">     904 </span>            :     segRowUp   = 95;
<span class="lineNum">     905 </span>            :   }
<span class="lineNum">     906 </span>            :   // count the number of pads on the given segment
<span class="lineNum">     907 </span><span class="lineNoCov">          0 :   AliTPCROC *r=AliTPCROC::Instance();</span>
<span class="lineNum">     908 </span>            :   Int_t nPads=0;
<span class="lineNum">     909 </span><span class="lineNoCov">          0 :   for (Int_t irow = segRowDown; irow &lt; segRowUp ; irow++){</span>
<span class="lineNum">     910 </span><span class="lineNoCov">          0 :     nPads += r-&gt;GetNPads(sector,irow);</span>
<span class="lineNum">     911 </span>            :   }
<span class="lineNum">     912 </span>            :   return nPads;
<a name="913"><span class="lineNum">     913 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     914 </span>            : 
<span class="lineNum">     915 </span>            : Float_t AliTPCParam::GetYInner(Int_t irow) const
<span class="lineNum">     916 </span>            : {
<span class="lineNum">     917 </span><span class="lineNoCov">          0 :   return fYInner[irow];</span>
<span class="lineNum">     918 </span>            : }
<a name="919"><span class="lineNum">     919 </span>            : </a>
<span class="lineNum">     920 </span>            : 
<span class="lineNum">     921 </span>            : Float_t AliTPCParam::GetYOuter(Int_t irow) const
<span class="lineNum">     922 </span>            : {
<span class="lineNum">     923 </span><span class="lineNoCov">          0 :   return fYOuter[irow];</span>
<a name="924"><span class="lineNum">     924 </span>            : }</a>
<span class="lineNum">     925 </span>            : 
<span class="lineNum">     926 </span>            : Int_t AliTPCParam::GetSectorIndex(Float_t angle, Int_t row, Float_t z) const
<span class="lineNum">     927 </span>            : {
<span class="lineNum">     928 </span>            :   /// returns the sector index
<span class="lineNum">     929 </span>            :   /// takes as input the angle, index of the pad row and z position
<span class="lineNum">     930 </span>            : 
<span class="lineNum">     931 </span><span class="lineNoCov">          0 :   if(row&lt;0) return -1;</span>
<span class="lineNum">     932 </span>            : 
<span class="lineNum">     933 </span><span class="lineNoCov">          0 :   if (angle &gt; 2.*TMath::Pi()) angle -= 2.*TMath::Pi();</span>
<span class="lineNum">     934 </span><span class="lineNoCov">          0 :   if (angle &lt; 0.            ) angle += 2.*TMath::Pi();</span>
<span class="lineNum">     935 </span>            : 
<span class="lineNum">     936 </span>            :   Int_t sector;
<span class="lineNum">     937 </span><span class="lineNoCov">          0 :   if(row&lt;fNRowLow) {</span>
<span class="lineNum">     938 </span><span class="lineNoCov">          0 :     sector=Int_t(TMath::Nint((angle-fInnerAngleShift)/fInnerAngle));</span>
<span class="lineNum">     939 </span><span class="lineNoCov">          0 :     if (z&lt;0) sector += (fNInnerSector&gt;&gt;1);</span>
<span class="lineNum">     940 </span>            :   }
<span class="lineNum">     941 </span>            :   else {
<span class="lineNum">     942 </span><span class="lineNoCov">          0 :     sector=Int_t(TMath::Nint((angle-fOuterAngleShift)/fOuterAngle))+fNInnerSector;</span>
<span class="lineNum">     943 </span><span class="lineNoCov">          0 :     if (z&lt;0) sector += (fNOuterSector&gt;&gt;1);</span>
<span class="lineNum">     944 </span>            :   }
<span class="lineNum">     945 </span>            : 
<span class="lineNum">     946 </span>            :   return sector;
<a name="947"><span class="lineNum">     947 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     948 </span>            : 
<span class="lineNum">     949 </span>            : Float_t AliTPCParam::GetChamberCenter(Int_t isec, Float_t * center) const
<span class="lineNum">     950 </span>            : {
<span class="lineNum">     951 </span>            :   /// returns the default radial position
<span class="lineNum">     952 </span>            :   /// of the readout chambers
<span class="lineNum">     953 </span>            : 
<span class="lineNum">     954 </span>            :   const Float_t kROCcenterIn = 110.2;
<span class="lineNum">     955 </span>            :   const Float_t kROCcenterOut = 188.45;
<span class="lineNum">     956 </span>            : 
<span class="lineNum">     957 </span><span class="lineCov">       3672 :   if (isec&lt;fNInnerSector){</span>
<span class="lineNum">     958 </span><span class="lineCov">       1836 :     if (center){</span>
<span class="lineNum">     959 </span><span class="lineCov">        612 :       center[0] = kROCcenterIn;</span>
<span class="lineNum">     960 </span><span class="lineCov">        612 :       center[1] = 0;</span>
<span class="lineNum">     961 </span><span class="lineCov">        612 :       center[2] = -5.51-0.08;</span>
<span class="lineNum">     962 </span><span class="lineCov">        612 :     }</span>
<span class="lineNum">     963 </span><span class="lineCov">        612 :     return kROCcenterIn;</span>
<span class="lineNum">     964 </span>            :   }
<span class="lineNum">     965 </span>            :   else{
<span class="lineNum">     966 </span><span class="lineCov">        612 :     if (center){</span>
<span class="lineNum">     967 </span><span class="lineCov">        612 :       center[0] = kROCcenterOut;</span>
<span class="lineNum">     968 </span><span class="lineCov">        612 :       center[1] = 0;</span>
<span class="lineNum">     969 </span><span class="lineCov">        612 :       center[2] = -5.61-0.08;</span>
<span class="lineNum">     970 </span><span class="lineCov">        612 :     }</span>
<span class="lineNum">     971 </span><span class="lineCov">        612 :     return kROCcenterOut;</span>
<span class="lineNum">     972 </span>            :   }
<a name="973"><span class="lineNum">     973 </span><span class="lineCov">       1224 : }</span></a>
<span class="lineNum">     974 </span>            : 
<span class="lineNum">     975 </span>            : void AliTPCParam::SetNominalGainSlopes(){
<span class="lineNum">     976 </span>            :   /// Setting the nominal TPC gain slopes
<span class="lineNum">     977 </span>            :   /// Nominal values were obtained as a mena values foe 2010,2011, and 2012 data
<span class="lineNum">     978 </span>            :   /// Differntial values can be provided per year
<span class="lineNum">     979 </span>            : 
<span class="lineNum">     980 </span><span class="lineCov">         72 :   Float_t sector[72]={0};</span>
<span class="lineNum">     981 </span><span class="lineCov">         36 :   Float_t gainHV[72]={0};</span>
<span class="lineNum">     982 </span><span class="lineCov">         36 :   Float_t gainPT[72]={0};</span>
<span class="lineNum">     983 </span>            :   //
<span class="lineNum">     984 </span><span class="lineCov">       5256 :   for (Int_t isec=0; isec&lt;72; isec++){</span>
<span class="lineNum">     985 </span><span class="lineCov">       2592 :     sector[isec]=isec;</span>
<span class="lineNum">     986 </span><span class="lineCov">       2592 :     gainHV[isec]=0.0115;  // change of the Gain dG/G  per 1 Volt  of voltage change(1/V) - it is roughly the same for IROC and OROC</span>
<span class="lineNum">     987 </span><span class="lineCov">       2592 :     gainPT[isec]=2.2;     // change of the Gains dG/G per P/T change ()</span>
<span class="lineNum">     988 </span>            :   }
<span class="lineNum">     989 </span><span class="lineCov">         72 :   fGainSlopesHV = new TGraphErrors(72,sector,gainHV,0,0);</span>
<span class="lineNum">     990 </span><span class="lineCov">         72 :   fGainSlopesPT = new TGraphErrors(72,sector,gainPT,0,0);</span>
<span class="lineNum">     991 </span><span class="lineCov">         36 :   fGainSlopesHV-&gt;SetName(&quot;GainSlopesHV&quot;);</span>
<span class="lineNum">     992 </span><span class="lineCov">         36 :   fGainSlopesPT-&gt;SetName(&quot;GainSlopesPT&quot;);</span>
<span class="lineNum">     993 </span><span class="lineCov">         36 : }</span>
<a name="994"><span class="lineNum">     994 </span>            : </a>
<span class="lineNum">     995 </span>            : 
<span class="lineNum">     996 </span>            : TVectorD * AliTPCParam::GetBetheBlochParamNa49(){
<span class="lineNum">     997 </span>            :   /// Parameters of the BB for the Aleph parametrization AliMathBase::BetheBlochAleph
<span class="lineNum">     998 </span>            :   /// Na49 parameters were used as first set of parameters for ALICE simulation
<span class="lineNum">     999 </span>            :   /// (see TPC TDR for details)
<span class="lineNum">    1000 </span>            : 
<span class="lineNum">    1001 </span><span class="lineNoCov">          0 :   TVectorD v(5);</span>
<span class="lineNum">    1002 </span><span class="lineNoCov">          0 :   v(0)=0.76176e-1;</span>
<span class="lineNum">    1003 </span><span class="lineNoCov">          0 :   v(1)=10.632;</span>
<span class="lineNum">    1004 </span><span class="lineNoCov">          0 :   v(2)=0.13279e-4;</span>
<span class="lineNum">    1005 </span><span class="lineNoCov">          0 :   v(3)=1.8631;</span>
<span class="lineNum">    1006 </span><span class="lineNoCov">          0 :   v(4)=1.9479;</span>
<span class="lineNum">    1007 </span><span class="lineNoCov">          0 :   return new TVectorD(v);</span>
<a name="1008"><span class="lineNum">    1008 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1009 </span>            : 
<span class="lineNum">    1010 </span>            : TVectorD * AliTPCParam::GetBetheBlochParamAlice(){
<span class="lineNum">    1011 </span>            :   /// Parameters of the BB for the Aleph parametrization AliMathBase::BetheBlochAleph
<span class="lineNum">    1012 </span>            :   /// Na49 parameters were used as first set of parameters for ALICE simulation
<span class="lineNum">    1013 </span>            :   /// Second set was obtained from ALICE 2009-2013 data taking
<span class="lineNum">    1014 </span>            :   /// (see TPC TDR for details)
<span class="lineNum">    1015 </span>            : 
<span class="lineNum">    1016 </span><span class="lineCov">         72 :   TVectorD v(5);</span>
<span class="lineNum">    1017 </span><span class="lineCov">         72 :   v[0] = 0.0851148;</span>
<span class="lineNum">    1018 </span><span class="lineCov">         72 :   v[1] = 9.25771;</span>
<span class="lineNum">    1019 </span><span class="lineCov">         72 :   v[2] = 2.6558e-05;</span>
<span class="lineNum">    1020 </span><span class="lineCov">         72 :   v[3] = 2.32742;</span>
<span class="lineNum">    1021 </span><span class="lineCov">         72 :   v[4] = 1.83039;</span>
<span class="lineNum">    1022 </span><span class="lineCov">         72 :   return new TVectorD(v);</span>
<a name="1023"><span class="lineNum">    1023 </span><span class="lineCov">         36 : }</span></a>
<span class="lineNum">    1024 </span>            : 
<span class="lineNum">    1025 </span>            : TVectorD * AliTPCParam::GetBetheBlochParamAliceMC(){
<span class="lineNum">    1026 </span>            :   /// Parameters of the BB for the Aleph parametrization AliMathBase::BetheBlochAleph
<span class="lineNum">    1027 </span>            :   /// dNdx parameterization
<span class="lineNum">    1028 </span>            : 
<span class="lineNum">    1029 </span><span class="lineCov">         72 :   TVectorD v(5);</span>
<span class="lineNum">    1030 </span><span class="lineCov">         72 :   v[0] =0.0820172 ;</span>
<span class="lineNum">    1031 </span><span class="lineCov">         72 :   v[1] =9.94795 ;</span>
<span class="lineNum">    1032 </span><span class="lineCov">         72 :   v[2] =8.97292e-05;</span>
<span class="lineNum">    1033 </span><span class="lineCov">         72 :   v[3] =2.05873 ;</span>
<span class="lineNum">    1034 </span><span class="lineCov">         72 :   v[4] =1.65272 ;</span>
<span class="lineNum">    1035 </span>            : 
<span class="lineNum">    1036 </span><span class="lineCov">         72 :   return new TVectorD(v);</span>
<span class="lineNum">    1037 </span><span class="lineCov">         36 : }</span>
<a name="1038"><span class="lineNum">    1038 </span>            : </a>
<span class="lineNum">    1039 </span>            : 
<span class="lineNum">    1040 </span>            : Double_t  AliTPCParam::BetheBlochAleph(Double_t bg, Int_t type){
<span class="lineNum">    1041 </span>            :   /// GetBetheBloch retur values for the parametrs regieter at poition type
<span class="lineNum">    1042 </span>            :   /// Used for visualization and comparison purposes
<span class="lineNum">    1043 </span><span class="lineNoCov">          0 :   if (bg&lt;=0) return 0;</span>
<span class="lineNum">    1044 </span>            :   TVectorD * paramBB =0;
<span class="lineNum">    1045 </span><span class="lineNoCov">          0 :   if (type==0) {</span>
<span class="lineNum">    1046 </span><span class="lineNoCov">          0 :     AliTPCParam* param = AliTPCcalibDB::Instance()-&gt;GetParameters();</span>
<span class="lineNum">    1047 </span><span class="lineNoCov">          0 :     if (param) paramBB=param-&gt;GetBetheBlochParameters();</span>
<span class="lineNum">    1048 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">    1049 </span><span class="lineNoCov">          0 :   if (type==1){</span>
<span class="lineNum">    1050 </span><span class="lineNoCov">          0 :     paramBB = (TVectorD*)fBBParam-&gt;At(type);</span>
<span class="lineNum">    1051 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">    1052 </span><span class="lineNoCov">          0 :   if (!paramBB) return 0;</span>
<span class="lineNum">    1053 </span>            :   //
<span class="lineNum">    1054 </span><span class="lineNoCov">          0 :   return AliMathBase::BetheBlochAleph(bg,(*paramBB)(0),(*paramBB)(1),(*paramBB)(2),(*paramBB)(3),(*paramBB)(4));</span>
<span class="lineNum">    1055 </span><span class="lineNoCov">          0 : }</span>
<a name="1056"><span class="lineNum">    1056 </span>            : </a>
<span class="lineNum">    1057 </span>            : 
<span class="lineNum">    1058 </span>            : void AliTPCParam::RegisterBBParam(TVectorD* param, Int_t position){
<span class="lineNum">    1059 </span>            :   ///
<span class="lineNum">    1060 </span>            : 
<span class="lineNum">    1061 </span><span class="lineNoCov">          0 :   fBBParam-&gt;AddAt(param,position);</span>
<span class="lineNum">    1062 </span><span class="lineNoCov">          0 : }</span>
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.11</a></td></tr>
  </table>
  <br>

</body>
</html>
