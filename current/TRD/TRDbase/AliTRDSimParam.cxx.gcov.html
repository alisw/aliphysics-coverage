<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - coverage.info - TRD/TRDbase/AliTRDSimParam.cxx</title>
  <link rel="stylesheet" type="text/css" href="../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../index.html">top level</a> - <a href="index.html">TRD/TRDbase</a> - AliTRDSimParam.cxx<span style="font-size: 80%;"> (source / <a href="AliTRDSimParam.cxx.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">coverage.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">108</td>
            <td class="headerCovTableEntry">249</td>
            <td class="headerCovTableEntryLo">43.4 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2016-06-14 17:26:59</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">9</td>
            <td class="headerCovTableEntry">17</td>
            <td class="headerCovTableEntryLo">52.9 %</td>
          </tr>
          <tr><td><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            : /**************************************************************************</a>
<span class="lineNum">       2 </span>            :  * Copyright(c) 1998-1999, ALICE Experiment at CERN, All rights reserved. *
<span class="lineNum">       3 </span>            :  *                                                                        *
<span class="lineNum">       4 </span>            :  * Author: The ALICE Off-line Project.                                    *
<span class="lineNum">       5 </span>            :  * Contributors are mentioned in the code where appropriate.              *
<span class="lineNum">       6 </span>            :  *                                                                        *
<span class="lineNum">       7 </span>            :  * Permission to use, copy, modify and distribute this software and its   *
<span class="lineNum">       8 </span>            :  * documentation strictly for non-commercial purposes is hereby granted   *
<span class="lineNum">       9 </span>            :  * without fee, provided that the above copyright notice appears in all   *
<span class="lineNum">      10 </span>            :  * copies and that both the copyright notice and this permission notice   *
<span class="lineNum">      11 </span>            :  * appear in the supporting documentation. The authors make no claims     *
<span class="lineNum">      12 </span>            :  * about the suitability of this software for any purpose. It is          *
<span class="lineNum">      13 </span>            :  * provided &quot;as is&quot; without express or implied warranty.                  *
<span class="lineNum">      14 </span>            :  **************************************************************************/
<span class="lineNum">      15 </span>            : 
<span class="lineNum">      16 </span>            : /* $Id$ */
<span class="lineNum">      17 </span>            : 
<span class="lineNum">      18 </span>            : ////////////////////////////////////////////////////////////////////////////
<span class="lineNum">      19 </span>            : //                                                                        //
<span class="lineNum">      20 </span>            : // Class containing constant simulation parameters                        //
<span class="lineNum">      21 </span>            : //                                                                        //
<span class="lineNum">      22 </span>            : // Request an instance with AliTRDSimParam::Instance()                    //
<span class="lineNum">      23 </span>            : // Then request the needed values                                         //
<span class="lineNum">      24 </span>            : //                                                                        //
<span class="lineNum">      25 </span>            : ////////////////////////////////////////////////////////////////////////////
<span class="lineNum">      26 </span>            : 
<span class="lineNum">      27 </span>            : #include &lt;TMath.h&gt;
<span class="lineNum">      28 </span>            : 
<span class="lineNum">      29 </span>            : #include &quot;AliRun.h&quot;
<span class="lineNum">      30 </span>            : 
<span class="lineNum">      31 </span>            : #include &quot;AliTRDSimParam.h&quot;
<span class="lineNum">      32 </span>            : #include &quot;AliTRDCommonParam.h&quot;
<a name="33"><span class="lineNum">      33 </span>            : #include &quot;AliLog.h&quot;</a>
<span class="lineNum">      34 </span>            : 
<span class="lineNum">      35 </span><span class="lineCov">         48 : ClassImp(AliTRDSimParam)</span>
<span class="lineNum">      36 </span>            : 
<span class="lineNum">      37 </span>            : AliTRDSimParam *AliTRDSimParam::fgInstance   = 0;
<span class="lineNum">      38 </span>            : Bool_t          AliTRDSimParam::fgTerminated = kFALSE;
<a name="39"><span class="lineNum">      39 </span>            : </a>
<span class="lineNum">      40 </span>            : //_ singleton implementation __________________________________________________
<span class="lineNum">      41 </span>            : AliTRDSimParam* AliTRDSimParam::Instance()
<span class="lineNum">      42 </span>            : {
<span class="lineNum">      43 </span>            :   //
<span class="lineNum">      44 </span>            :   // Singleton implementation
<span class="lineNum">      45 </span>            :   // Returns an instance of this class, it is created if neccessary
<span class="lineNum">      46 </span>            :   // 
<span class="lineNum">      47 </span>            :   
<span class="lineNum">      48 </span><span class="lineCov">        792 :   if (fgTerminated != kFALSE) {</span>
<span class="lineNum">      49 </span><span class="lineNoCov">          0 :     return 0;</span>
<span class="lineNum">      50 </span>            :   }
<span class="lineNum">      51 </span>            : 
<span class="lineNum">      52 </span><span class="lineCov">        396 :   if (fgInstance == 0) {</span>
<span class="lineNum">      53 </span><span class="lineCov">          2 :     fgInstance = new AliTRDSimParam();</span>
<span class="lineNum">      54 </span><span class="lineCov">          1 :   }  </span>
<span class="lineNum">      55 </span>            : 
<span class="lineNum">      56 </span><span class="lineCov">        396 :   return fgInstance;</span>
<span class="lineNum">      57 </span>            : 
<span class="lineNum">      58 </span><span class="lineCov">        396 : }</span>
<a name="59"><span class="lineNum">      59 </span>            : </a>
<span class="lineNum">      60 </span>            : //_ singleton implementation __________________________________________________
<span class="lineNum">      61 </span>            : void AliTRDSimParam::Terminate()
<span class="lineNum">      62 </span>            : {
<span class="lineNum">      63 </span>            :   //
<span class="lineNum">      64 </span>            :   // Singleton implementation
<span class="lineNum">      65 </span>            :   // Deletes the instance of this class and sets the terminated flag,
<span class="lineNum">      66 </span>            :   // instances cannot be requested anymore
<span class="lineNum">      67 </span>            :   // This function can be called several times.
<span class="lineNum">      68 </span>            :   //
<span class="lineNum">      69 </span>            :   
<span class="lineNum">      70 </span><span class="lineNoCov">          0 :   fgTerminated = kTRUE;</span>
<span class="lineNum">      71 </span>            :   
<span class="lineNum">      72 </span><span class="lineNoCov">          0 :   if (fgInstance != 0) {</span>
<span class="lineNum">      73 </span><span class="lineNoCov">          0 :     delete fgInstance;</span>
<span class="lineNum">      74 </span><span class="lineNoCov">          0 :     fgInstance = 0;</span>
<span class="lineNum">      75 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">      76 </span>            : 
<span class="lineNum">      77 </span><span class="lineNoCov">          0 : }</span>
<a name="78"><span class="lineNum">      78 </span>            : </a>
<span class="lineNum">      79 </span>            : //_____________________________________________________________________________
<span class="lineNum">      80 </span>            : AliTRDSimParam::AliTRDSimParam()
<span class="lineNum">      81 </span><span class="lineCov">          1 :   :TObject()</span>
<span class="lineNum">      82 </span><span class="lineCov">          1 :   ,fGasGain(0.0)</span>
<span class="lineNum">      83 </span><span class="lineCov">          1 :   ,fNoise(0.0)</span>
<span class="lineNum">      84 </span><span class="lineCov">          1 :   ,fChipGain(0.0)</span>
<span class="lineNum">      85 </span><span class="lineCov">          1 :   ,fADCoutRange(0.0)</span>
<span class="lineNum">      86 </span><span class="lineCov">          1 :   ,fADCinRange(0.0)</span>
<span class="lineNum">      87 </span><span class="lineCov">          1 :   ,fADCbaseline(0)</span>
<span class="lineNum">      88 </span><span class="lineCov">          1 :   ,fDiffusionOn(kFALSE)</span>
<span class="lineNum">      89 </span><span class="lineCov">          1 :   ,fElAttachOn(kFALSE)</span>
<span class="lineNum">      90 </span><span class="lineCov">          1 :   ,fElAttachProp(0.0)</span>
<span class="lineNum">      91 </span><span class="lineCov">          1 :   ,fTRFOn(kFALSE)</span>
<span class="lineNum">      92 </span><span class="lineCov">          1 :   ,fTRFsmp(0)</span>
<span class="lineNum">      93 </span><span class="lineCov">          1 :   ,fTRFbin(0)</span>
<span class="lineNum">      94 </span><span class="lineCov">          1 :   ,fTRFlo(0.0)</span>
<span class="lineNum">      95 </span><span class="lineCov">          1 :   ,fTRFhi(0.0)</span>
<span class="lineNum">      96 </span><span class="lineCov">          1 :   ,fTRFwid(0.0)</span>
<span class="lineNum">      97 </span><span class="lineCov">          1 :   ,fCTOn(kFALSE)</span>
<span class="lineNum">      98 </span><span class="lineCov">          1 :   ,fCTsmp(0)</span>
<span class="lineNum">      99 </span><span class="lineCov">          1 :   ,fPadCoupling(0.0)</span>
<span class="lineNum">     100 </span><span class="lineCov">          1 :   ,fTimeCoupling(0.0)</span>
<span class="lineNum">     101 </span><span class="lineCov">          1 :   ,fTimeStructOn(kFALSE)</span>
<span class="lineNum">     102 </span><span class="lineCov">          1 :   ,fPRFOn(kFALSE)</span>
<span class="lineNum">     103 </span><span class="lineCov">          1 :   ,fNTimeBins(0)</span>
<span class="lineNum">     104 </span><span class="lineCov">          1 :   ,fNTBoverwriteOCDB(kFALSE)</span>
<span class="lineNum">     105 </span><span class="lineCov">          5 : {</span>
<span class="lineNum">     106 </span>            :   //
<span class="lineNum">     107 </span>            :   // Default constructor
<span class="lineNum">     108 </span>            :   //
<span class="lineNum">     109 </span>            :   
<span class="lineNum">     110 </span><span class="lineCov">          1 :   Init();</span>
<span class="lineNum">     111 </span>            : 
<span class="lineNum">     112 </span><span class="lineCov">          2 : }</span>
<a name="113"><span class="lineNum">     113 </span>            : </a>
<span class="lineNum">     114 </span>            : //_____________________________________________________________________________
<span class="lineNum">     115 </span>            : void AliTRDSimParam::Init()
<span class="lineNum">     116 </span>            : {
<span class="lineNum">     117 </span>            :   // 
<span class="lineNum">     118 </span>            :   // Default initializiation
<span class="lineNum">     119 </span>            :   //
<span class="lineNum">     120 </span>            :   
<span class="lineNum">     121 </span>            :   // The default parameter for the digitization
<span class="lineNum">     122 </span><span class="lineCov">          2 :   fGasGain           = 4000.0;</span>
<span class="lineNum">     123 </span><span class="lineCov">          1 :   fChipGain          =   12.4;</span>
<span class="lineNum">     124 </span><span class="lineCov">          1 :   fNoise             = 1250.0;</span>
<span class="lineNum">     125 </span><span class="lineCov">          1 :   fADCoutRange       = 1023.0;          // 10-bit ADC</span>
<span class="lineNum">     126 </span><span class="lineCov">          1 :   fADCinRange        = 2000.0;          // 2V input range</span>
<span class="lineNum">     127 </span><span class="lineCov">          1 :   fADCbaseline       =   10;</span>
<span class="lineNum">     128 </span>            : 
<span class="lineNum">     129 </span>            :   // Diffusion on
<span class="lineNum">     130 </span><span class="lineCov">          1 :   fDiffusionOn       = kTRUE;</span>
<span class="lineNum">     131 </span>            :   
<span class="lineNum">     132 </span>            :   // Propability for electron attachment
<span class="lineNum">     133 </span><span class="lineCov">          1 :   fElAttachOn        = kFALSE;</span>
<span class="lineNum">     134 </span><span class="lineCov">          1 :   fElAttachProp      = 0.0;</span>
<span class="lineNum">     135 </span>            : 
<span class="lineNum">     136 </span>            :   // The time response function
<span class="lineNum">     137 </span><span class="lineCov">          1 :   fTRFOn             = kTRUE;</span>
<span class="lineNum">     138 </span>            : 
<span class="lineNum">     139 </span>            :   // The cross talk
<span class="lineNum">     140 </span><span class="lineCov">          1 :   fCTOn              = kTRUE;</span>
<span class="lineNum">     141 </span>            : 
<span class="lineNum">     142 </span>            :   // The pad coupling factor
<span class="lineNum">     143 </span>            :   // Use 0.46, instead of the theroetical value 0.3, since it reproduces better 
<span class="lineNum">     144 </span>            :   // the test beam data, even tough it is not understood why.
<span class="lineNum">     145 </span><span class="lineCov">          1 :   fPadCoupling       = 0.46;</span>
<span class="lineNum">     146 </span>            : 
<span class="lineNum">     147 </span>            :   // The time coupling factor (same number as for the TPC)
<span class="lineNum">     148 </span><span class="lineCov">          1 :   fTimeCoupling      = 0.4;</span>
<span class="lineNum">     149 </span>            : 
<span class="lineNum">     150 </span>            :   // Use drift time maps
<span class="lineNum">     151 </span><span class="lineCov">          1 :   fTimeStructOn      = kTRUE;</span>
<span class="lineNum">     152 </span>            :   
<span class="lineNum">     153 </span>            :   // The pad response function
<span class="lineNum">     154 </span><span class="lineCov">          1 :   fPRFOn             = kTRUE;</span>
<span class="lineNum">     155 </span>            : 
<span class="lineNum">     156 </span>            :   // The number of time bins
<span class="lineNum">     157 </span><span class="lineCov">          1 :   fNTimeBins         = 22;</span>
<span class="lineNum">     158 </span><span class="lineCov">          1 :   fNTBoverwriteOCDB  = kFALSE;</span>
<span class="lineNum">     159 </span>            : 
<span class="lineNum">     160 </span><span class="lineCov">          1 :   ReInit();</span>
<span class="lineNum">     161 </span>            : 
<span class="lineNum">     162 </span><span class="lineCov">          1 : }</span>
<a name="163"><span class="lineNum">     163 </span>            : </a>
<span class="lineNum">     164 </span>            : //_____________________________________________________________________________
<span class="lineNum">     165 </span>            : AliTRDSimParam::~AliTRDSimParam() 
<span class="lineNum">     166 </span><span class="lineNoCov">          0 : {</span>
<span class="lineNum">     167 </span>            :   //
<span class="lineNum">     168 </span>            :   // Destructor
<span class="lineNum">     169 </span>            :   //
<span class="lineNum">     170 </span>            :   
<span class="lineNum">     171 </span><span class="lineNoCov">          0 :   if (fTRFsmp) {</span>
<span class="lineNum">     172 </span><span class="lineNoCov">          0 :     delete [] fTRFsmp;</span>
<span class="lineNum">     173 </span><span class="lineNoCov">          0 :     fTRFsmp = 0;</span>
<span class="lineNum">     174 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">     175 </span>            : 
<span class="lineNum">     176 </span><span class="lineNoCov">          0 :   if (fCTsmp) {</span>
<span class="lineNum">     177 </span><span class="lineNoCov">          0 :     delete [] fCTsmp;</span>
<span class="lineNum">     178 </span><span class="lineNoCov">          0 :     fCTsmp  = 0;</span>
<span class="lineNum">     179 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">     180 </span>            : 
<span class="lineNum">     181 </span><span class="lineNoCov">          0 : }</span>
<a name="182"><span class="lineNum">     182 </span>            : </a>
<span class="lineNum">     183 </span>            : //_____________________________________________________________________________
<span class="lineNum">     184 </span>            : AliTRDSimParam::AliTRDSimParam(const AliTRDSimParam &amp;p)
<span class="lineNum">     185 </span><span class="lineNoCov">          0 :   :TObject(p)</span>
<span class="lineNum">     186 </span><span class="lineNoCov">          0 :   ,fGasGain(p.fGasGain)</span>
<span class="lineNum">     187 </span><span class="lineNoCov">          0 :   ,fNoise(p.fNoise)</span>
<span class="lineNum">     188 </span><span class="lineNoCov">          0 :   ,fChipGain(p.fChipGain)</span>
<span class="lineNum">     189 </span><span class="lineNoCov">          0 :   ,fADCoutRange(p.fADCoutRange)</span>
<span class="lineNum">     190 </span><span class="lineNoCov">          0 :   ,fADCinRange(p.fADCinRange)</span>
<span class="lineNum">     191 </span><span class="lineNoCov">          0 :   ,fADCbaseline(p.fADCbaseline)</span>
<span class="lineNum">     192 </span><span class="lineNoCov">          0 :   ,fDiffusionOn(p.fDiffusionOn)</span>
<span class="lineNum">     193 </span><span class="lineNoCov">          0 :   ,fElAttachOn(p.fElAttachOn)</span>
<span class="lineNum">     194 </span><span class="lineNoCov">          0 :   ,fElAttachProp(p.fElAttachProp)</span>
<span class="lineNum">     195 </span><span class="lineNoCov">          0 :   ,fTRFOn(p.fTRFOn)</span>
<span class="lineNum">     196 </span><span class="lineNoCov">          0 :   ,fTRFsmp(0)</span>
<span class="lineNum">     197 </span><span class="lineNoCov">          0 :   ,fTRFbin(p.fTRFbin)</span>
<span class="lineNum">     198 </span><span class="lineNoCov">          0 :   ,fTRFlo(p.fTRFlo)</span>
<span class="lineNum">     199 </span><span class="lineNoCov">          0 :   ,fTRFhi(p.fTRFhi)</span>
<span class="lineNum">     200 </span><span class="lineNoCov">          0 :   ,fTRFwid(p.fTRFwid)</span>
<span class="lineNum">     201 </span><span class="lineNoCov">          0 :   ,fCTOn(p.fCTOn)</span>
<span class="lineNum">     202 </span><span class="lineNoCov">          0 :   ,fCTsmp(0)</span>
<span class="lineNum">     203 </span><span class="lineNoCov">          0 :   ,fPadCoupling(p.fPadCoupling)</span>
<span class="lineNum">     204 </span><span class="lineNoCov">          0 :   ,fTimeCoupling(p.fTimeCoupling)</span>
<span class="lineNum">     205 </span><span class="lineNoCov">          0 :   ,fTimeStructOn(p.fTimeStructOn)</span>
<span class="lineNum">     206 </span><span class="lineNoCov">          0 :   ,fPRFOn(p.fPRFOn)</span>
<span class="lineNum">     207 </span><span class="lineNoCov">          0 :   ,fNTimeBins(p.fNTimeBins)</span>
<span class="lineNum">     208 </span><span class="lineNoCov">          0 :   ,fNTBoverwriteOCDB(p.fNTBoverwriteOCDB)</span>
<span class="lineNum">     209 </span><span class="lineNoCov">          0 : {</span>
<span class="lineNum">     210 </span>            :   //
<span class="lineNum">     211 </span>            :   // Copy constructor
<span class="lineNum">     212 </span>            :   //
<span class="lineNum">     213 </span>            : 
<span class="lineNum">     214 </span>            :   Int_t iBin = 0;
<span class="lineNum">     215 </span>            : 
<span class="lineNum">     216 </span><span class="lineNoCov">          0 :   fTRFsmp = new Float_t[fTRFbin];</span>
<span class="lineNum">     217 </span><span class="lineNoCov">          0 :   for (iBin = 0; iBin &lt; fTRFbin; iBin++) {</span>
<span class="lineNum">     218 </span><span class="lineNoCov">          0 :     fTRFsmp[iBin] = ((AliTRDSimParam &amp;) p).fTRFsmp[iBin];</span>
<span class="lineNum">     219 </span>            :   }                                                                             
<span class="lineNum">     220 </span>            : 
<span class="lineNum">     221 </span><span class="lineNoCov">          0 :   fCTsmp  = new Float_t[fTRFbin];</span>
<span class="lineNum">     222 </span><span class="lineNoCov">          0 :   for (iBin = 0; iBin &lt; fTRFbin; iBin++) {</span>
<span class="lineNum">     223 </span><span class="lineNoCov">          0 :     fCTsmp[iBin]  = ((AliTRDSimParam &amp;) p).fCTsmp[iBin];</span>
<span class="lineNum">     224 </span>            :   }                                                                             
<span class="lineNum">     225 </span>            : 
<span class="lineNum">     226 </span><span class="lineNoCov">          0 : }</span>
<a name="227"><span class="lineNum">     227 </span>            : </a>
<span class="lineNum">     228 </span>            : //_____________________________________________________________________________
<span class="lineNum">     229 </span>            : AliTRDSimParam &amp;AliTRDSimParam::operator=(const AliTRDSimParam &amp;p)
<span class="lineNum">     230 </span>            : {
<span class="lineNum">     231 </span>            :   //
<span class="lineNum">     232 </span>            :   // Assignment operator
<span class="lineNum">     233 </span>            :   //
<span class="lineNum">     234 </span>            : 
<span class="lineNum">     235 </span><span class="lineNoCov">          0 :   if (this == &amp;p) {</span>
<span class="lineNum">     236 </span><span class="lineNoCov">          0 :     return *this;</span>
<span class="lineNum">     237 </span>            :   }
<span class="lineNum">     238 </span>            : 
<span class="lineNum">     239 </span><span class="lineNoCov">          0 :   Init();</span>
<span class="lineNum">     240 </span>            : 
<span class="lineNum">     241 </span><span class="lineNoCov">          0 :   fGasGain          = p.fGasGain;</span>
<span class="lineNum">     242 </span><span class="lineNoCov">          0 :   fNoise            = p.fNoise;</span>
<span class="lineNum">     243 </span><span class="lineNoCov">          0 :   fChipGain         = p.fChipGain;</span>
<span class="lineNum">     244 </span><span class="lineNoCov">          0 :   fADCoutRange      = p.fADCoutRange;</span>
<span class="lineNum">     245 </span><span class="lineNoCov">          0 :   fADCinRange       = p.fADCinRange;</span>
<span class="lineNum">     246 </span><span class="lineNoCov">          0 :   fADCbaseline      = p.fADCbaseline;</span>
<span class="lineNum">     247 </span><span class="lineNoCov">          0 :   fDiffusionOn      = p.fDiffusionOn;</span>
<span class="lineNum">     248 </span><span class="lineNoCov">          0 :   fElAttachOn       = p.fElAttachOn;</span>
<span class="lineNum">     249 </span><span class="lineNoCov">          0 :   fElAttachProp     = p.fElAttachProp;</span>
<span class="lineNum">     250 </span><span class="lineNoCov">          0 :   fTRFOn            = p.fTRFOn;</span>
<span class="lineNum">     251 </span><span class="lineNoCov">          0 :   fTRFsmp           = 0;</span>
<span class="lineNum">     252 </span><span class="lineNoCov">          0 :   fTRFbin           = p.fTRFbin;</span>
<span class="lineNum">     253 </span><span class="lineNoCov">          0 :   fTRFlo            = p.fTRFlo;</span>
<span class="lineNum">     254 </span><span class="lineNoCov">          0 :   fTRFhi            = p.fTRFhi;</span>
<span class="lineNum">     255 </span><span class="lineNoCov">          0 :   fTRFwid           = p.fTRFwid;</span>
<span class="lineNum">     256 </span><span class="lineNoCov">          0 :   fCTOn             = p.fCTOn;</span>
<span class="lineNum">     257 </span><span class="lineNoCov">          0 :   fCTsmp            = 0;</span>
<span class="lineNum">     258 </span><span class="lineNoCov">          0 :   fPadCoupling      = p.fPadCoupling;</span>
<span class="lineNum">     259 </span><span class="lineNoCov">          0 :   fTimeCoupling     = p.fTimeCoupling;</span>
<span class="lineNum">     260 </span><span class="lineNoCov">          0 :   fTimeStructOn     = p.fTimeStructOn;</span>
<span class="lineNum">     261 </span><span class="lineNoCov">          0 :   fPRFOn            = p.fPRFOn;</span>
<span class="lineNum">     262 </span><span class="lineNoCov">          0 :   fNTimeBins        = p.fNTimeBins;</span>
<span class="lineNum">     263 </span><span class="lineNoCov">          0 :   fNTBoverwriteOCDB = p.fNTBoverwriteOCDB;</span>
<span class="lineNum">     264 </span>            : 
<span class="lineNum">     265 </span>            :   Int_t iBin = 0;
<span class="lineNum">     266 </span>            : 
<span class="lineNum">     267 </span><span class="lineNoCov">          0 :   if (fTRFsmp) {</span>
<span class="lineNum">     268 </span><span class="lineNoCov">          0 :     delete[] fTRFsmp;</span>
<span class="lineNum">     269 </span>            :   }
<span class="lineNum">     270 </span><span class="lineNoCov">          0 :   fTRFsmp = new Float_t[fTRFbin];</span>
<span class="lineNum">     271 </span><span class="lineNoCov">          0 :   for (iBin = 0; iBin &lt; fTRFbin; iBin++) {</span>
<span class="lineNum">     272 </span><span class="lineNoCov">          0 :     fTRFsmp[iBin] = ((AliTRDSimParam &amp;) p).fTRFsmp[iBin];</span>
<span class="lineNum">     273 </span>            :   }                                                                             
<span class="lineNum">     274 </span>            : 
<span class="lineNum">     275 </span><span class="lineNoCov">          0 :   if (fCTsmp) {</span>
<span class="lineNum">     276 </span><span class="lineNoCov">          0 :     delete[] fCTsmp;</span>
<span class="lineNum">     277 </span>            :   }
<span class="lineNum">     278 </span><span class="lineNoCov">          0 :   fCTsmp  = new Float_t[fTRFbin];</span>
<span class="lineNum">     279 </span><span class="lineNoCov">          0 :   for (iBin = 0; iBin &lt; fTRFbin; iBin++) {</span>
<span class="lineNum">     280 </span><span class="lineNoCov">          0 :     fCTsmp[iBin]  = ((AliTRDSimParam &amp;) p).fCTsmp[iBin];</span>
<span class="lineNum">     281 </span>            :   }                                                                             
<span class="lineNum">     282 </span>            : 
<span class="lineNum">     283 </span>            :   return *this;
<span class="lineNum">     284 </span>            : 
<span class="lineNum">     285 </span><span class="lineNoCov">          0 : }</span>
<a name="286"><span class="lineNum">     286 </span>            : </a>
<span class="lineNum">     287 </span>            : //_____________________________________________________________________________
<span class="lineNum">     288 </span>            : void AliTRDSimParam::Copy(TObject &amp;p) const
<span class="lineNum">     289 </span>            : {
<span class="lineNum">     290 </span>            :   //
<span class="lineNum">     291 </span>            :   // Copy function
<span class="lineNum">     292 </span>            :   //
<span class="lineNum">     293 </span>            :   
<span class="lineNum">     294 </span><span class="lineNoCov">          0 :   AliTRDSimParam *target = dynamic_cast&lt;AliTRDSimParam *&gt; (&amp;p);</span>
<span class="lineNum">     295 </span><span class="lineNoCov">          0 :   if (!target) {</span>
<span class="lineNum">     296 </span><span class="lineNoCov">          0 :     return;</span>
<span class="lineNum">     297 </span>            :   }
<span class="lineNum">     298 </span>            : 
<span class="lineNum">     299 </span><span class="lineNoCov">          0 :   target-&gt;fGasGain            = fGasGain;</span>
<span class="lineNum">     300 </span><span class="lineNoCov">          0 :   target-&gt;fNoise              = fNoise;</span>
<span class="lineNum">     301 </span><span class="lineNoCov">          0 :   target-&gt;fChipGain           = fChipGain;  </span>
<span class="lineNum">     302 </span><span class="lineNoCov">          0 :   target-&gt;fADCoutRange        = fADCoutRange;</span>
<span class="lineNum">     303 </span><span class="lineNoCov">          0 :   target-&gt;fADCinRange         = fADCinRange;</span>
<span class="lineNum">     304 </span><span class="lineNoCov">          0 :   target-&gt;fADCbaseline        = fADCbaseline; </span>
<span class="lineNum">     305 </span><span class="lineNoCov">          0 :   target-&gt;fDiffusionOn        = fDiffusionOn; </span>
<span class="lineNum">     306 </span><span class="lineNoCov">          0 :   target-&gt;fElAttachOn         = fElAttachOn;</span>
<span class="lineNum">     307 </span><span class="lineNoCov">          0 :   target-&gt;fElAttachProp       = fElAttachProp;</span>
<span class="lineNum">     308 </span><span class="lineNoCov">          0 :   target-&gt;fTRFOn              = fTRFOn;</span>
<span class="lineNum">     309 </span><span class="lineNoCov">          0 :   target-&gt;fTRFbin             = fTRFbin;</span>
<span class="lineNum">     310 </span><span class="lineNoCov">          0 :   target-&gt;fTRFlo              = fTRFlo;</span>
<span class="lineNum">     311 </span><span class="lineNoCov">          0 :   target-&gt;fTRFhi              = fTRFhi;</span>
<span class="lineNum">     312 </span><span class="lineNoCov">          0 :   target-&gt;fTRFwid             = fTRFwid;</span>
<span class="lineNum">     313 </span><span class="lineNoCov">          0 :   target-&gt;fCTOn               = fCTOn;</span>
<span class="lineNum">     314 </span><span class="lineNoCov">          0 :   target-&gt;fPadCoupling        = fPadCoupling;</span>
<span class="lineNum">     315 </span><span class="lineNoCov">          0 :   target-&gt;fTimeCoupling       = fTimeCoupling;</span>
<span class="lineNum">     316 </span><span class="lineNoCov">          0 :   target-&gt;fPRFOn              = fPRFOn;</span>
<span class="lineNum">     317 </span><span class="lineNoCov">          0 :   target-&gt;fNTimeBins          = fNTimeBins;</span>
<span class="lineNum">     318 </span><span class="lineNoCov">          0 :   target-&gt;fNTBoverwriteOCDB   = fNTBoverwriteOCDB;</span>
<span class="lineNum">     319 </span>            : 
<span class="lineNum">     320 </span><span class="lineNoCov">          0 :   if (target-&gt;fTRFsmp) {</span>
<span class="lineNum">     321 </span><span class="lineNoCov">          0 :     delete[] target-&gt;fTRFsmp;</span>
<span class="lineNum">     322 </span>            :   }
<span class="lineNum">     323 </span><span class="lineNoCov">          0 :   target-&gt;fTRFsmp = new Float_t[fTRFbin];</span>
<span class="lineNum">     324 </span><span class="lineNoCov">          0 :   for (Int_t iBin = 0; iBin &lt; fTRFbin; iBin++) {</span>
<span class="lineNum">     325 </span><span class="lineNoCov">          0 :     target-&gt;fTRFsmp[iBin] = fTRFsmp[iBin];</span>
<span class="lineNum">     326 </span>            :   }
<span class="lineNum">     327 </span>            : 
<span class="lineNum">     328 </span><span class="lineNoCov">          0 :   if (target-&gt;fCTsmp) {</span>
<span class="lineNum">     329 </span><span class="lineNoCov">          0 :     delete[] target-&gt;fCTsmp;</span>
<span class="lineNum">     330 </span>            :   }
<span class="lineNum">     331 </span><span class="lineNoCov">          0 :   target-&gt;fCTsmp  = new Float_t[fTRFbin];</span>
<span class="lineNum">     332 </span><span class="lineNoCov">          0 :   for (Int_t iBin = 0; iBin &lt; fTRFbin; iBin++) {</span>
<span class="lineNum">     333 </span><span class="lineNoCov">          0 :     target-&gt;fCTsmp[iBin]  = fCTsmp[iBin];</span>
<span class="lineNum">     334 </span>            :   }
<span class="lineNum">     335 </span>            :   
<span class="lineNum">     336 </span><span class="lineNoCov">          0 : }</span>
<a name="337"><span class="lineNum">     337 </span>            : </a>
<span class="lineNum">     338 </span>            : //_____________________________________________________________________________
<span class="lineNum">     339 </span>            : void AliTRDSimParam::ReInit()
<span class="lineNum">     340 </span>            : {
<span class="lineNum">     341 </span>            :   //
<span class="lineNum">     342 </span>            :   // Reinitializes the parameter class after a change
<span class="lineNum">     343 </span>            :   //
<span class="lineNum">     344 </span>            : 
<span class="lineNum">     345 </span><span class="lineCov">          2 :   if      (AliTRDCommonParam::Instance()-&gt;IsXenon()) {</span>
<span class="lineNum">     346 </span>            :     // The range and the binwidth for the sampled TRF 
<span class="lineNum">     347 </span><span class="lineCov">          1 :     fTRFbin = 200;</span>
<span class="lineNum">     348 </span>            :     // Start 0.2 mus before the signal
<span class="lineNum">     349 </span><span class="lineCov">          1 :     fTRFlo  = -0.4;</span>
<span class="lineNum">     350 </span>            :     // End the maximum drift time after the signal 
<span class="lineNum">     351 </span><span class="lineCov">          1 :     fTRFhi  =  3.58;</span>
<span class="lineNum">     352 </span>            :     // Standard gas gain
<span class="lineNum">     353 </span><span class="lineCov">          1 :     fGasGain = 4000.0;</span>
<span class="lineNum">     354 </span><span class="lineCov">          1 :   }</span>
<span class="lineNum">     355 </span><span class="lineNoCov">          0 :   else if (AliTRDCommonParam::Instance()-&gt;IsArgon()) {</span>
<span class="lineNum">     356 </span>            :     // The range and the binwidth for the sampled TRF 
<span class="lineNum">     357 </span><span class="lineNoCov">          0 :     fTRFbin  =  50;</span>
<span class="lineNum">     358 </span>            :     // Start 0.2 mus before the signal
<span class="lineNum">     359 </span><span class="lineNoCov">          0 :     fTRFlo   =  0.02;</span>
<span class="lineNum">     360 </span>            :     // End the maximum drift time after the signal 
<span class="lineNum">     361 </span><span class="lineNoCov">          0 :     fTRFhi   =  1.98;</span>
<span class="lineNum">     362 </span>            :     // Higher gas gain
<span class="lineNum">     363 </span><span class="lineNoCov">          0 :     fGasGain = 8000.0;</span>
<span class="lineNum">     364 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">     365 </span>            :   else {
<span class="lineNum">     366 </span><span class="lineNoCov">          0 :     AliFatal(&quot;Not a valid gas mixture!&quot;);</span>
<span class="lineNum">     367 </span>            :   }
<span class="lineNum">     368 </span><span class="lineCov">          1 :   fTRFwid = (fTRFhi - fTRFlo) / ((Float_t) fTRFbin);</span>
<span class="lineNum">     369 </span>            : 
<span class="lineNum">     370 </span>            :   // Create the sampled TRF
<span class="lineNum">     371 </span><span class="lineCov">          1 :   SampleTRF();</span>
<span class="lineNum">     372 </span>            : 
<span class="lineNum">     373 </span><span class="lineCov">          1 : }</span>
<a name="374"><span class="lineNum">     374 </span>            : </a>
<span class="lineNum">     375 </span>            : //_____________________________________________________________________________
<span class="lineNum">     376 </span>            : void AliTRDSimParam::SampleTRF()
<span class="lineNum">     377 </span>            : {
<span class="lineNum">     378 </span>            :   //
<span class="lineNum">     379 </span>            :   // Samples the new time response function.
<span class="lineNum">     380 </span>            :   //
<span class="lineNum">     381 </span>            : 
<span class="lineNum">     382 </span>            :   Int_t ipasa = 0;
<span class="lineNum">     383 </span>            : 
<span class="lineNum">     384 </span>            :   // Xenon
<span class="lineNum">     385 </span>            :   // From Antons measurements with Fe55 source, adjusted by C. Lippmann.
<span class="lineNum">     386 </span>            :   // time bins are -0.4, -0.38, -0.36, ...., 3.54, 3.56, 3.58 microseconds
<span class="lineNum">     387 </span>            :   const Int_t kNpasa     = 200;  // kNpasa should be equal to fTRFbin!
<span class="lineNum">     388 </span><span class="lineCov">          2 :   Float_t xtalk[kNpasa];</span>
<span class="lineNum">     389 </span><span class="lineCov">          1 :   Float_t signal[kNpasa]     = { 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000</span>
<span class="lineNum">     390 </span>            :                                , 0.0002, 0.0007, 0.0026, 0.0089, 0.0253, 0.0612, 0.1319
<span class="lineNum">     391 </span>            :                                , 0.2416, 0.3913, 0.5609, 0.7295, 0.8662, 0.9581, 1.0000
<span class="lineNum">     392 </span>            :                                , 0.9990, 0.9611, 0.8995, 0.8269, 0.7495, 0.6714, 0.5987
<span class="lineNum">     393 </span>            :                                , 0.5334, 0.4756, 0.4249, 0.3811, 0.3433, 0.3110, 0.2837
<span class="lineNum">     394 </span>            :                                , 0.2607, 0.2409, 0.2243, 0.2099, 0.1974, 0.1868, 0.1776
<span class="lineNum">     395 </span>            :                                , 0.1695, 0.1627, 0.1566, 0.1509, 0.1457, 0.1407, 0.1362
<span class="lineNum">     396 </span>            :                                , 0.1317, 0.1274, 0.1233, 0.1196, 0.1162, 0.1131, 0.1102
<span class="lineNum">     397 </span>            :                                , 0.1075, 0.1051, 0.1026, 0.1004, 0.0979, 0.0956, 0.0934
<span class="lineNum">     398 </span>            :                                , 0.0912, 0.0892, 0.0875, 0.0858, 0.0843, 0.0829, 0.0815
<span class="lineNum">     399 </span>            :                                , 0.0799, 0.0786, 0.0772, 0.0757, 0.0741, 0.0729, 0.0718
<span class="lineNum">     400 </span>            :                                , 0.0706, 0.0692, 0.0680, 0.0669, 0.0655, 0.0643, 0.0630
<span class="lineNum">     401 </span>            :                                , 0.0618, 0.0607, 0.0596, 0.0587, 0.0576, 0.0568, 0.0558
<span class="lineNum">     402 </span>            :                                , 0.0550, 0.0541, 0.0531, 0.0522, 0.0513, 0.0505, 0.0497
<span class="lineNum">     403 </span>            :                                , 0.0490, 0.0484, 0.0474, 0.0465, 0.0457, 0.0449, 0.0441
<span class="lineNum">     404 </span>            :                                , 0.0433, 0.0425, 0.0417, 0.0410, 0.0402, 0.0395, 0.0388
<span class="lineNum">     405 </span>            :                                , 0.0381, 0.0374, 0.0368, 0.0361, 0.0354, 0.0348, 0.0342
<span class="lineNum">     406 </span>            :                                , 0.0336, 0.0330, 0.0324, 0.0318, 0.0312, 0.0306, 0.0301
<span class="lineNum">     407 </span>            :                                , 0.0296, 0.0290, 0.0285, 0.0280, 0.0275, 0.0270, 0.0265
<span class="lineNum">     408 </span>            :                                , 0.0260, 0.0256, 0.0251, 0.0246, 0.0242, 0.0238, 0.0233
<span class="lineNum">     409 </span>            :                                , 0.0229, 0.0225, 0.0221, 0.0217, 0.0213, 0.0209, 0.0206
<span class="lineNum">     410 </span>            :                                , 0.0202, 0.0198, 0.0195, 0.0191, 0.0188, 0.0184, 0.0181
<span class="lineNum">     411 </span>            :                                , 0.0178, 0.0175, 0.0171, 0.0168, 0.0165, 0.0162, 0.0159
<span class="lineNum">     412 </span>            :                                , 0.0157, 0.0154, 0.0151, 0.0148, 0.0146, 0.0143, 0.0140
<span class="lineNum">     413 </span>            :                                , 0.0138, 0.0135, 0.0133, 0.0131, 0.0128, 0.0126, 0.0124
<span class="lineNum">     414 </span>            :                                , 0.0121, 0.0119, 0.0120, 0.0115, 0.0113, 0.0111, 0.0109
<span class="lineNum">     415 </span>            :                                , 0.0107, 0.0105, 0.0103, 0.0101, 0.0100, 0.0098, 0.0096
<span class="lineNum">     416 </span>            :                                , 0.0094, 0.0092, 0.0091, 0.0089, 0.0088, 0.0086, 0.0084
<span class="lineNum">     417 </span>            :                                , 0.0083, 0.0081, 0.0080, 0.0078 };
<span class="lineNum">     418 </span><span class="lineCov">          1 :   signal[0] = 0.0;</span>
<span class="lineNum">     419 </span><span class="lineCov">          1 :   signal[1] = 0.0;</span>
<span class="lineNum">     420 </span><span class="lineCov">          1 :   signal[2] = 0.0;</span>
<span class="lineNum">     421 </span>            :   // With undershoot, positive peak corresponds to ~3% of the main signal:
<span class="lineNum">     422 </span><span class="lineCov">        396 :   for (ipasa = 3; ipasa &lt; kNpasa; ipasa++) {</span>
<span class="lineNum">     423 </span><span class="lineCov">        197 :     xtalk[ipasa] = 0.2 * (signal[ipasa-2] - signal[ipasa-3]);</span>
<span class="lineNum">     424 </span>            :   }
<span class="lineNum">     425 </span><span class="lineCov">          1 :   xtalk[0]  = 0.0;   </span>
<span class="lineNum">     426 </span><span class="lineCov">          1 :   xtalk[1]  = 0.0;  </span>
<span class="lineNum">     427 </span><span class="lineCov">          1 :   xtalk[2]  = 0.0;  </span>
<span class="lineNum">     428 </span>            : 
<span class="lineNum">     429 </span>            :   // Argon
<span class="lineNum">     430 </span>            :   // Ar measurement with Fe55 source by Anton
<span class="lineNum">     431 </span>            :   // time bins are 0.02, 0.06, 0.10, ...., 1.90, 1.94, 1.98 microseconds
<span class="lineNum">     432 </span>            :   const Int_t kNpasaAr = 50;
<span class="lineNum">     433 </span><span class="lineCov">          1 :   Float_t xtalkAr[kNpasaAr];</span>
<span class="lineNum">     434 </span><span class="lineCov">          1 :   Float_t signalAr[kNpasaAr] = { -0.01,  0.01,  0.00,  0.00,  0.01</span>
<span class="lineNum">     435 </span>            :                                , -0.01,  0.01,  2.15, 22.28, 55.53
<span class="lineNum">     436 </span>            :                                , 68.52, 58.21, 40.92, 27.12, 18.49
<span class="lineNum">     437 </span>            :                                , 13.42, 10.48,  8.67,  7.49,  6.55
<span class="lineNum">     438 </span>            :                                ,  5.71,  5.12,  4.63,  4.22,  3.81
<span class="lineNum">     439 </span>            :                                ,  3.48,  3.20,  2.94,  2.77,  2.63
<span class="lineNum">     440 </span>            :                                ,  2.50,  2.37,  2.23,  2.13,  2.03
<span class="lineNum">     441 </span>            :                                ,  1.91,  1.83,  1.75,  1.68,  1.63
<span class="lineNum">     442 </span>            :                                ,  1.56,  1.49,  1.50,  1.49,  1.29
<span class="lineNum">     443 </span>            :                                ,  1.19,  1.21,  1.21,  1.20,  1.10 };
<span class="lineNum">     444 </span>            :   // Normalization to maximum
<span class="lineNum">     445 </span><span class="lineCov">        102 :   for (ipasa = 0; ipasa &lt; kNpasaAr; ipasa++) {</span>
<span class="lineNum">     446 </span><span class="lineCov">         50 :     signalAr[ipasa] /= 68.52;</span>
<span class="lineNum">     447 </span>            :   }
<span class="lineNum">     448 </span><span class="lineCov">          1 :   signalAr[0] = 0.0;</span>
<span class="lineNum">     449 </span><span class="lineCov">          1 :   signalAr[1] = 0.0;</span>
<span class="lineNum">     450 </span><span class="lineCov">          1 :   signalAr[2] = 0.0;</span>
<span class="lineNum">     451 </span>            :   // With undershoot, positive peak corresponds to ~3% of the main signal:
<span class="lineNum">     452 </span><span class="lineCov">         96 :   for (ipasa = 3; ipasa &lt; kNpasaAr; ipasa++) {</span>
<span class="lineNum">     453 </span><span class="lineCov">         47 :     xtalkAr[ipasa] = 0.2 * (signalAr[ipasa-2] - signalAr[ipasa-3]);</span>
<span class="lineNum">     454 </span>            :   }
<span class="lineNum">     455 </span><span class="lineCov">          1 :   xtalkAr[0]  = 0.0;   </span>
<span class="lineNum">     456 </span><span class="lineCov">          1 :   xtalkAr[1]  = 0.0;  </span>
<span class="lineNum">     457 </span><span class="lineCov">          1 :   xtalkAr[2]  = 0.0;  </span>
<span class="lineNum">     458 </span>            : 
<span class="lineNum">     459 </span><span class="lineCov">          1 :   if (fTRFsmp) {</span>
<span class="lineNum">     460 </span><span class="lineNoCov">          0 :     delete [] fTRFsmp;</span>
<span class="lineNum">     461 </span>            :   }
<span class="lineNum">     462 </span><span class="lineCov">          1 :   fTRFsmp = new Float_t[fTRFbin];</span>
<span class="lineNum">     463 </span>            : 
<span class="lineNum">     464 </span><span class="lineCov">          1 :   if (fCTsmp)  {</span>
<span class="lineNum">     465 </span><span class="lineNoCov">          0 :     delete [] fCTsmp;</span>
<span class="lineNum">     466 </span>            :   }
<span class="lineNum">     467 </span><span class="lineCov">          1 :   fCTsmp  = new Float_t[fTRFbin];</span>
<span class="lineNum">     468 </span>            : 
<span class="lineNum">     469 </span><span class="lineCov">          1 :   if      (AliTRDCommonParam::Instance()-&gt;IsXenon()) {</span>
<span class="lineNum">     470 </span><span class="lineCov">          1 :     if (fTRFbin != kNpasa) {</span>
<span class="lineNum">     471 </span><span class="lineNoCov">          0 :       AliError(&quot;Array mismatch (xenon)\n\n&quot;);</span>
<span class="lineNum">     472 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">     473 </span>            :   }
<span class="lineNum">     474 </span><span class="lineNoCov">          0 :   else if (AliTRDCommonParam::Instance()-&gt;IsArgon()) {</span>
<span class="lineNum">     475 </span><span class="lineNoCov">          0 :     if (fTRFbin != kNpasaAr) {</span>
<span class="lineNum">     476 </span><span class="lineNoCov">          0 :       AliError(&quot;Array mismatch (argon)\n\n&quot;);</span>
<span class="lineNum">     477 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">     478 </span>            :   }
<span class="lineNum">     479 </span>            : 
<span class="lineNum">     480 </span><span class="lineCov">        402 :   for (Int_t iBin = 0; iBin &lt; fTRFbin; iBin++) {</span>
<span class="lineNum">     481 </span><span class="lineCov">        200 :     if      (AliTRDCommonParam::Instance()-&gt;IsXenon()) {</span>
<span class="lineNum">     482 </span><span class="lineCov">        200 :       fTRFsmp[iBin] = signal[iBin];</span>
<span class="lineNum">     483 </span><span class="lineCov">        200 :       fCTsmp[iBin]  = xtalk[iBin];</span>
<span class="lineNum">     484 </span><span class="lineCov">        200 :     }</span>
<span class="lineNum">     485 </span><span class="lineNoCov">          0 :     else if (AliTRDCommonParam::Instance()-&gt;IsArgon()) {</span>
<span class="lineNum">     486 </span><span class="lineNoCov">          0 :       fTRFsmp[iBin] = signalAr[iBin];</span>
<span class="lineNum">     487 </span><span class="lineNoCov">          0 :       fCTsmp[iBin]  = xtalkAr[iBin];</span>
<span class="lineNum">     488 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">     489 </span>            :   }
<span class="lineNum">     490 </span>            : 
<span class="lineNum">     491 </span><span class="lineCov">          1 : }</span>
<a name="492"><span class="lineNum">     492 </span>            : </a>
<span class="lineNum">     493 </span>            : //_____________________________________________________________________________
<span class="lineNum">     494 </span>            : Double_t AliTRDSimParam::TimeResponse(Double_t time) const
<span class="lineNum">     495 </span>            : {
<span class="lineNum">     496 </span>            :   //
<span class="lineNum">     497 </span>            :   // Applies the preamp shaper time response
<span class="lineNum">     498 </span>            :   // (We assume a signal rise time of 0.2us = fTRFlo/2.
<span class="lineNum">     499 </span>            :   //
<span class="lineNum">     500 </span>            : 
<span class="lineNum">     501 </span><span class="lineCov">   20435188 :   Double_t rt   = (time - .5*fTRFlo) / fTRFwid;</span>
<span class="lineNum">     502 </span><span class="lineCov">   10217594 :   Int_t    iBin = (Int_t) rt; </span>
<span class="lineNum">     503 </span><span class="lineCov">   10217594 :   Double_t dt   = rt - iBin; </span>
<span class="lineNum">     504 </span><span class="lineCov">   20435188 :   if ((iBin &gt;= 0) &amp;&amp; (iBin+1 &lt; fTRFbin)) {</span>
<span class="lineNum">     505 </span><span class="lineCov">   10217594 :     return fTRFsmp[iBin] + (fTRFsmp[iBin+1] - fTRFsmp[iBin])*dt;</span>
<span class="lineNum">     506 </span>            :   } 
<span class="lineNum">     507 </span>            :   else {
<span class="lineNum">     508 </span><span class="lineNoCov">          0 :     return 0.0;</span>
<span class="lineNum">     509 </span>            :   }
<span class="lineNum">     510 </span>            : 
<span class="lineNum">     511 </span><span class="lineCov">   10217594 : }</span>
<a name="512"><span class="lineNum">     512 </span>            : </a>
<span class="lineNum">     513 </span>            : //_____________________________________________________________________________
<span class="lineNum">     514 </span>            : Double_t AliTRDSimParam::CrossTalk(Double_t time) const
<span class="lineNum">     515 </span>            : {
<span class="lineNum">     516 </span>            :   //
<span class="lineNum">     517 </span>            :   // Applies the pad-pad capacitive cross talk
<span class="lineNum">     518 </span>            :   //
<span class="lineNum">     519 </span>            : 
<span class="lineNum">     520 </span><span class="lineCov">   20435188 :   Double_t rt   = (time - fTRFlo) / fTRFwid;</span>
<span class="lineNum">     521 </span><span class="lineCov">   10217594 :   Int_t    iBin = (Int_t) rt; </span>
<span class="lineNum">     522 </span><span class="lineCov">   10217594 :   Double_t dt   = rt - iBin; </span>
<span class="lineNum">     523 </span><span class="lineCov">   20435188 :   if ((iBin &gt;= 0) &amp;&amp; (iBin+1 &lt; fTRFbin)) {</span>
<span class="lineNum">     524 </span><span class="lineCov">   10217594 :     return fCTsmp[iBin] + (fCTsmp[iBin+1] - fCTsmp[iBin])*dt;</span>
<span class="lineNum">     525 </span>            :   } 
<span class="lineNum">     526 </span>            :   else {
<span class="lineNum">     527 </span><span class="lineNoCov">          0 :     return 0.0;</span>
<span class="lineNum">     528 </span>            :   }
<span class="lineNum">     529 </span>            : 
<span class="lineNum">     530 </span><span class="lineCov">   10217594 : }</span>
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.11</a></td></tr>
  </table>
  <br>

</body>
</html>
