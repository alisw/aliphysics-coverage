<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - coverage.info - STRUCT/AliHALLv3.cxx</title>
  <link rel="stylesheet" type="text/css" href="../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../index.html">top level</a> - <a href="index.html">STRUCT</a> - AliHALLv3.cxx<span style="font-size: 80%;"> (source / <a href="AliHALLv3.cxx.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">coverage.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">219</td>
            <td class="headerCovTableEntry">241</td>
            <td class="headerCovTableEntryHi">90.9 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2016-06-14 17:26:59</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">8</td>
            <td class="headerCovTableEntry">8</td>
            <td class="headerCovTableEntryHi">100.0 %</td>
          </tr>
          <tr><td><img src="../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            : /**************************************************************************</a>
<span class="lineNum">       2 </span>            :  * Copyright(c) 1998-1999, ALICE Experiment at CERN, All rights reserved. *
<span class="lineNum">       3 </span>            :  *                                                                        *
<span class="lineNum">       4 </span>            :  * Author: The ALICE Off-line Project.                                    *
<span class="lineNum">       5 </span>            :  * Contributors are mentioned in the code where appropriate.              *
<span class="lineNum">       6 </span>            :  *                                                                        *
<span class="lineNum">       7 </span>            :  * Permission to use, copy, modify and distribute this software and its   *
<span class="lineNum">       8 </span>            :  * documentation strictly for non-commercial purposes is hereby granted   *
<span class="lineNum">       9 </span>            :  * without fee, provided that the above copyright notice appears in all   *
<span class="lineNum">      10 </span>            :  * copies and that both the copyright notice and this permission notice   *
<span class="lineNum">      11 </span>            :  * appear in the supporting documentation. The authors make no claims     *
<span class="lineNum">      12 </span>            :  * about the suitability of this software for any purpose. It is          *
<span class="lineNum">      13 </span>            :  * provided &quot;as is&quot; without express or implied warranty.                  *
<span class="lineNum">      14 </span>            :  **************************************************************************/
<span class="lineNum">      15 </span>            : 
<span class="lineNum">      16 </span>            : /* $Id$ */
<span class="lineNum">      17 </span>            : 
<span class="lineNum">      18 </span>            : ///////////////////////////////////////////////////////////////////////////////
<span class="lineNum">      19 </span>            : //                                                                           //
<span class="lineNum">      20 </span>            : //  Experimental Hall                                                        //
<span class="lineNum">      21 </span>            : //  This class contains the description of the experimental hall             //
<span class="lineNum">      22 </span>            : //  and the shielding blocks.                                                // 
<span class="lineNum">      23 </span>            : //  Author: Andreas Morsch                                                   //
<span class="lineNum">      24 </span>            : //  andreas.morsch@cern.ch                                                   //
<span class="lineNum">      25 </span>            : //                                                                           //
<span class="lineNum">      26 </span>            : ///////////////////////////////////////////////////////////////////////////////
<span class="lineNum">      27 </span>            : 
<span class="lineNum">      28 </span>            : #include &lt;TVirtualMC.h&gt;
<span class="lineNum">      29 </span>            : 
<span class="lineNum">      30 </span>            : #include &quot;AliConst.h&quot;
<span class="lineNum">      31 </span>            : #include &quot;AliHALLv3.h&quot;
<span class="lineNum">      32 </span>            : #include &quot;AliMagF.h&quot;
<span class="lineNum">      33 </span>            : #include &quot;AliRun.h&quot;
<span class="lineNum">      34 </span>            : #include &quot;AliLog.h&quot;
<span class="lineNum">      35 </span>            : #include &quot;AliMC.h&quot;
<span class="lineNum">      36 </span>            : #include &quot;AliTrackReference.h&quot;
<span class="lineNum">      37 </span>            : #include &lt;TGeoVolume.h&gt;
<span class="lineNum">      38 </span>            : #include &lt;TGeoManager.h&gt;
<span class="lineNum">      39 </span>            : #include &lt;TGeoMatrix.h&gt;
<span class="lineNum">      40 </span>            : #include &lt;TGeoCompositeShape.h&gt;
<span class="lineNum">      41 </span>            : #include &lt;TGeoBBox.h&gt;
<span class="lineNum">      42 </span>            : #include &lt;TGeoTube.h&gt;
<span class="lineNum">      43 </span>            : #include &lt;TGeoPgon.h&gt;
<span class="lineNum">      44 </span>            : #include &lt;TGeoPcon.h&gt;
<span class="lineNum">      45 </span>            : #include &lt;TGeoCone.h&gt;
<span class="lineNum">      46 </span>            : #include &lt;TGeoTrd1.h&gt;
<a name="47"><span class="lineNum">      47 </span>            : #include &lt;TGeoArb8.h&gt;</a>
<span class="lineNum">      48 </span>            : 
<span class="lineNum">      49 </span><span class="lineCov">         12 : ClassImp(AliHALL)</span>
<a name="50"><span class="lineNum">      50 </span>            :  </a>
<span class="lineNum">      51 </span>            : //_____________________________________________________________________________
<span class="lineNum">      52 </span><span class="lineCov">         24 : AliHALLv3::AliHALLv3() : fNewShield24(0), fRefVolumeId(-1), fScoring(0), fRackShield(0)</span>
<span class="lineNum">      53 </span><span class="lineCov">         60 : {</span>
<span class="lineNum">      54 </span>            :   //
<span class="lineNum">      55 </span>            :   // Default constructor for the experimental Hall
<span class="lineNum">      56 </span>            :   //
<span class="lineNum">      57 </span><span class="lineCov">         24 : }</span>
<a name="58"><span class="lineNum">      58 </span>            :  </a>
<span class="lineNum">      59 </span>            : //_____________________________________________________________________________
<span class="lineNum">      60 </span>            : AliHALLv3::AliHALLv3(const char *name, const char *title)
<span class="lineNum">      61 </span><span class="lineCov">          2 :   : AliHALL(name,title), fNewShield24(0), fRefVolumeId(-1), fScoring(0), fRackShield(0)</span>
<span class="lineNum">      62 </span><span class="lineCov">          5 : {</span>
<span class="lineNum">      63 </span>            :   //
<span class="lineNum">      64 </span>            :   // Standard constructor for the experimental Hall
<span class="lineNum">      65 </span>            :   //
<span class="lineNum">      66 </span>            : 
<span class="lineNum">      67 </span><span class="lineCov">          2 : }</span>
<a name="68"><span class="lineNum">      68 </span>            :  </a>
<span class="lineNum">      69 </span>            : //_____________________________________________________________________________
<span class="lineNum">      70 </span>            : void AliHALLv3::CreateGeometry()
<span class="lineNum">      71 </span>            : {
<span class="lineNum">      72 </span>            :   //
<span class="lineNum">      73 </span>            :   // Create the geometry of the exprimental hall
<span class="lineNum">      74 </span>            :   //
<span class="lineNum">      75 </span>            :   Float_t r2, dy;
<span class="lineNum">      76 </span>            :   Float_t phid, phim, h, r;
<span class="lineNum">      77 </span>            :   Float_t w1, dh, am, bm, dl,cm, hm, dr, dx, xl;
<span class="lineNum">      78 </span>            :   Float_t hullen;
<span class="lineNum">      79 </span>            :   Float_t phi;
<span class="lineNum">      80 </span>            : 
<span class="lineNum">      81 </span>            :   // The top volume
<span class="lineNum">      82 </span>            :   //
<span class="lineNum">      83 </span><span class="lineCov">          2 :   TGeoVolume* top = gGeoManager-&gt;GetVolume(&quot;ALIC&quot;);</span>
<span class="lineNum">      84 </span><span class="lineCov">          1 :   TGeoVolumeAssembly* asHall = new TGeoVolumeAssembly(&quot;HALL&quot;);</span>
<span class="lineNum">      85 </span>            :   
<span class="lineNum">      86 </span>            :   // Rotations
<span class="lineNum">      87 </span>            :   // rotation by 90 deg in the y-z plane
<span class="lineNum">      88 </span><span class="lineCov">          1 :   TGeoRotation* rot000 = new TGeoRotation(&quot;rot000&quot;,  90., 0.,180.,  0.,    90., 90.);  </span>
<span class="lineNum">      89 </span><span class="lineCov">          1 :   TGeoRotation* rot001 = new TGeoRotation(&quot;rot001&quot;, 270., 0., 90., 90.,   180.,  0.);  </span>
<span class="lineNum">      90 </span>            : 
<span class="lineNum">      91 </span>            :   // Materials
<span class="lineNum">      92 </span><span class="lineCov">          1 :   TGeoMedium* kMedCC     = gGeoManager-&gt;GetMedium(&quot;HALL_CC_C2&quot;);</span>
<span class="lineNum">      93 </span><span class="lineCov">          1 :   TGeoMedium* kMedST     = gGeoManager-&gt;GetMedium(&quot;HALL_STST_C2&quot;);</span>
<span class="lineNum">      94 </span><span class="lineCov">          1 :   TGeoMedium* kMedAir    = gGeoManager-&gt;GetMedium(&quot;HALL_AIR_C2&quot;);</span>
<span class="lineNum">      95 </span><span class="lineCov">          1 :   TGeoMedium* kMedFe     = gGeoManager-&gt;GetMedium(&quot;HALL_FE_C2&quot;);</span>
<span class="lineNum">      96 </span>            :   
<span class="lineNum">      97 </span>            :   // Floor thickness 
<span class="lineNum">      98 </span>            :   Float_t dyFloor  =  190.;
<span class="lineNum">      99 </span>            :   // Floor width
<span class="lineNum">     100 </span>            :   Float_t dxFloor  = 1400.;
<span class="lineNum">     101 </span>            :   // Floor level 
<span class="lineNum">     102 </span>            :   Float_t  yFloor  = -801.;
<span class="lineNum">     103 </span>            :   // Pit centre
<span class="lineNum">     104 </span>            :   Float_t  zPit    = 2300.;
<span class="lineNum">     105 </span>            :   // Pit radius
<span class="lineNum">     106 </span>            :   Float_t  rPit    = 1140.;
<span class="lineNum">     107 </span>            :   // Hall end 
<span class="lineNum">     108 </span>            :   Float_t  zHall24 = 1700.;
<span class="lineNum">     109 </span>            :   Float_t  zHall26 = 1900.;
<span class="lineNum">     110 </span>            :     // Overlap between hall and pit radius
<span class="lineNum">     111 </span>            :   Float_t oPit = zHall24 - (zPit - rPit);
<span class="lineNum">     112 </span>            :   // Length of the L3 floor
<span class="lineNum">     113 </span>            :   Float_t dzL3 = 1700.;
<span class="lineNum">     114 </span>            :   // Start of hall roof in y
<span class="lineNum">     115 </span>            :   Float_t yHall = 500.;
<span class="lineNum">     116 </span>            :   // Radius of the hall roof
<span class="lineNum">     117 </span>            :   Float_t rHall = 1070.;
<span class="lineNum">     118 </span>            :   //
<span class="lineNum">     119 </span>            :   Float_t epsBig   = 100.;
<span class="lineNum">     120 </span>            :   Float_t epsSmall =   1.;
<span class="lineNum">     121 </span>            :   
<span class="lineNum">     122 </span>            :   
<span class="lineNum">     123 </span>            : 
<span class="lineNum">     124 </span>            :   //
<span class="lineNum">     125 </span>            :   // RB24/26 Tunnel Floor 
<span class="lineNum">     126 </span>            :   r   = 220.;
<span class="lineNum">     127 </span>            :   h   = 140.;
<span class="lineNum">     128 </span><span class="lineCov">          1 :   phi = TMath::ACos(h / r);</span>
<span class="lineNum">     129 </span><span class="lineCov">          1 :   xl  = r * TMath::Sin(phi);</span>
<span class="lineNum">     130 </span>            :   dr  = 1600.;
<span class="lineNum">     131 </span><span class="lineCov">          1 :   dh  = dr * TMath::Cos(phi);</span>
<span class="lineNum">     132 </span><span class="lineCov">          1 :   dl  = dr * TMath::Sin(phi);</span>
<span class="lineNum">     133 </span><span class="lineCov">          1 :   if (gAlice-&gt;GetModule(&quot;ZDC&quot;) == 0) {</span>
<span class="lineNum">     134 </span>            :     //     No ZDC 
<span class="lineNum">     135 </span>            :     hullen = 370.;
<span class="lineNum">     136 </span><span class="lineNoCov">          0 :   } else {</span>
<span class="lineNum">     137 </span>            :     
<span class="lineNum">     138 </span>            :     //     ZDC is present 
<span class="lineNum">     139 </span>            :     hullen = 6520.;
<span class="lineNum">     140 </span>            :   }
<span class="lineNum">     141 </span>            : 
<span class="lineNum">     142 </span><span class="lineCov">          2 :   TGeoVolume* voHUFL = new TGeoVolume(&quot;HUFL&quot;,</span>
<span class="lineNum">     143 </span><span class="lineCov">          3 :                                       new TGeoTrd1(xl +dl, xl, hullen, dh / 2.),</span>
<span class="lineNum">     144 </span>            :                                       kMedCC);
<span class="lineNum">     145 </span><span class="lineCov">          1 :   r2 = hullen + zHall26;</span>
<span class="lineNum">     146 </span><span class="lineCov">          2 :   asHall-&gt;AddNode(voHUFL, 1, new TGeoCombiTrans(70., -100. - dh / 2., -r2 - 0.755, rot000));</span>
<span class="lineNum">     147 </span>            : 
<span class="lineNum">     148 </span>            :   //
<span class="lineNum">     149 </span>            :   // RB24/26 wall 
<span class="lineNum">     150 </span><span class="lineCov">          1 :   phid     = phi * kRaddeg;</span>
<span class="lineNum">     151 </span><span class="lineCov">          2 :   TGeoVolume* voHUWA = new TGeoVolume(&quot;HUWA&quot;,</span>
<span class="lineNum">     152 </span><span class="lineCov">          3 :                                       new TGeoTubeSeg(r, r+dr, hullen, phid - 90. + 0.002, 270. - phid - 0.002),</span>
<span class="lineNum">     153 </span>            :                                       kMedCC);
<span class="lineNum">     154 </span><span class="lineCov">          2 :   asHall-&gt;AddNode(voHUWA, 1, new TGeoTranslation(70., 40., -zHall26 - hullen + 0.002 ));</span>
<span class="lineNum">     155 </span>            :   //
<span class="lineNum">     156 </span>            :   // Air inside tunnel
<span class="lineNum">     157 </span><span class="lineCov">          1 :   TGeoTube* shHUWAT1 = new TGeoTube(0., r, hullen);</span>
<span class="lineNum">     158 </span><span class="lineCov">          1 :   shHUWAT1-&gt;SetName(&quot;shHUWAT1&quot;);</span>
<span class="lineNum">     159 </span>            :   //
<span class="lineNum">     160 </span>            :   // Space for ZDC
<span class="lineNum">     161 </span><span class="lineCov">          1 :   TGeoBBox*    shHUWAT2 = new TGeoBBox(70., 110., hullen + 20.);</span>
<span class="lineNum">     162 </span><span class="lineCov">          1 :   shHUWAT2-&gt;SetName(&quot;shHUWAT2&quot;);</span>
<span class="lineNum">     163 </span><span class="lineCov">          1 :   TGeoTranslation*   tHUWAT2 = new TGeoTranslation(&quot;tHUWAT2&quot;, -70., -30., 0.);</span>
<span class="lineNum">     164 </span><span class="lineCov">          1 :   tHUWAT2-&gt;RegisterYourself();</span>
<span class="lineNum">     165 </span>            : 
<span class="lineNum">     166 </span><span class="lineCov">          1 :   TGeoBBox*    shHUWAT3 = new TGeoBBox(270., 110., hullen + 20.);</span>
<span class="lineNum">     167 </span><span class="lineCov">          1 :   shHUWAT3-&gt;SetName(&quot;shHUWAT3&quot;);</span>
<span class="lineNum">     168 </span><span class="lineCov">          1 :   TGeoTranslation*   tHUWAT3 = new TGeoTranslation(&quot;tHUWAT3&quot;, 0., -110. - 140., 0.);</span>
<span class="lineNum">     169 </span><span class="lineCov">          1 :   tHUWAT3-&gt;RegisterYourself();</span>
<span class="lineNum">     170 </span>            :   
<span class="lineNum">     171 </span><span class="lineCov">          1 :   TGeoCompositeShape*  shHUWAT = new TGeoCompositeShape(&quot;HUWAT&quot;, &quot;(shHUWAT1-shHUWAT2:tHUWAT2)-shHUWAT3:tHUWAT3&quot;);</span>
<span class="lineNum">     172 </span><span class="lineCov">          1 :   TGeoVolume* voHUWAT = new TGeoVolume(&quot;HUWAT&quot;, shHUWAT, kMedAir);</span>
<span class="lineNum">     173 </span><span class="lineCov">          2 :   asHall-&gt;AddNode(voHUWAT, 1, new TGeoTranslation(70., 40., -zHall26 - hullen - 0.755));</span>
<span class="lineNum">     174 </span>            :   
<span class="lineNum">     175 </span>            :   //
<span class="lineNum">     176 </span>            :   //  Hall floor 
<span class="lineNum">     177 </span>            :   //  RB26 side
<span class="lineNum">     178 </span>            :   phid      = 16.197;
<span class="lineNum">     179 </span><span class="lineCov">          1 :   Float_t dzFloor26 = zHall26 - dzL3/2.;</span>
<span class="lineNum">     180 </span><span class="lineCov">          1 :   TGeoBBox* shHHF1 = new TGeoBBox(dxFloor/2. + 470., dyFloor/2., dzFloor26/2. - 0.002);</span>
<span class="lineNum">     181 </span><span class="lineCov">          1 :   shHHF1-&gt;SetName(&quot;shHHF1&quot;);</span>
<span class="lineNum">     182 </span><span class="lineCov">          1 :   TGeoVolume* voHHF1 = new TGeoVolume(&quot;HHF1&quot;, shHHF1, kMedCC);</span>
<span class="lineNum">     183 </span><span class="lineCov">          2 :   asHall-&gt;AddNode(voHHF1, 2, new TGeoTranslation(0., yFloor, -(dzL3/2. + dzFloor26/2.)));</span>
<span class="lineNum">     184 </span>            :   // RB24 side
<span class="lineNum">     185 </span><span class="lineCov">          1 :   Float_t dzFloor24 = zHall24 - dzL3/2.;</span>
<span class="lineNum">     186 </span><span class="lineCov">          1 :   TGeoBBox* shHHF41 = new TGeoBBox(dxFloor/2. + 470., dyFloor/2., dzFloor24/2.);</span>
<span class="lineNum">     187 </span><span class="lineCov">          1 :   shHHF41-&gt;SetName(&quot;shHHF41&quot;);</span>
<span class="lineNum">     188 </span><span class="lineCov">          1 :   TGeoTube* shHHF42 = new TGeoTube(0., rPit + epsBig, dyFloor/2.);</span>
<span class="lineNum">     189 </span><span class="lineCov">          1 :   shHHF42-&gt;SetName(&quot;shHHF42&quot;);</span>
<span class="lineNum">     190 </span><span class="lineCov">          1 :   TGeoCombiTrans* trHHF42 = new TGeoCombiTrans(&quot;trHHF42&quot;, 0., 0., dzFloor24/2. + rPit - oPit, rot000);</span>
<span class="lineNum">     191 </span><span class="lineCov">          1 :   trHHF42-&gt;RegisterYourself();</span>
<span class="lineNum">     192 </span>            :   
<span class="lineNum">     193 </span><span class="lineCov">          1 :   TGeoCompositeShape*  shHHF4 = new TGeoCompositeShape(&quot;HHF4&quot;, &quot;shHHF41+shHHF42:trHHF42&quot;);</span>
<span class="lineNum">     194 </span><span class="lineCov">          1 :   TGeoVolume* voHHF4 = new TGeoVolume(&quot;HHF4&quot;, shHHF4, kMedCC);</span>
<span class="lineNum">     195 </span><span class="lineCov">          2 :   asHall-&gt;AddNode(voHHF4, 1, new TGeoTranslation(0., yFloor,  dzL3/2. + dzFloor24/2.));</span>
<span class="lineNum">     196 </span>            : 
<span class="lineNum">     197 </span>            : 
<span class="lineNum">     198 </span>            :   //
<span class="lineNum">     199 </span>            :   //  Hall side walls 
<span class="lineNum">     200 </span><span class="lineCov">          1 :   Float_t trH1   = (1273.78 - dyFloor)/ 2.;</span>
<span class="lineNum">     201 </span>            :   Float_t trBL1  = 207.3;
<span class="lineNum">     202 </span>            :   Float_t trTL1  =  50.;
<span class="lineNum">     203 </span><span class="lineCov">          1 :   Float_t trALP1 = TMath::ATan((trBL1 - trTL1) / 2. / trH1) * kRaddeg;</span>
<span class="lineNum">     204 </span><span class="lineCov">          1 :   dx = 1.5 * trBL1 - 0.5 * trTL1 + dxFloor/2. + dyFloor * TMath::Tan(phid * kDegrad);</span>
<span class="lineNum">     205 </span><span class="lineCov">          2 :   TGeoVolume* voHHW11 = new TGeoVolume(&quot;HHW11&quot;,</span>
<span class="lineNum">     206 </span><span class="lineCov">          4 :                                        new TGeoTrap(dzFloor26/2. - 0.002, 0., 0., </span>
<span class="lineNum">     207 </span><span class="lineCov">          1 :                                                     trH1, trBL1, trTL1, trALP1, trH1, trBL1, trTL1, trALP1),</span>
<span class="lineNum">     208 </span>            :                                        kMedCC);
<span class="lineNum">     209 </span><span class="lineCov">          2 :   TGeoVolume* voHHW12 = new TGeoVolume(&quot;HHW12&quot;,</span>
<span class="lineNum">     210 </span><span class="lineCov">          3 :                                        new TGeoTrap(dzFloor24/2., 0., 0., </span>
<span class="lineNum">     211 </span>            :                                                     trH1, trBL1, trTL1, trALP1, trH1, trBL1, trTL1, trALP1),
<span class="lineNum">     212 </span>            :                                        kMedCC);
<span class="lineNum">     213 </span>            :  
<span class="lineNum">     214 </span><span class="lineCov">          1 :   dy = yFloor + dyFloor/2. + trH1;</span>
<span class="lineNum">     215 </span>            :   
<span class="lineNum">     216 </span><span class="lineCov">          2 :   asHall-&gt;AddNode(voHHW12, 1, new TGeoTranslation( dx, dy,  (dzL3/2. + dzFloor24/2.)));</span>
<span class="lineNum">     217 </span><span class="lineCov">          2 :   asHall-&gt;AddNode(voHHW12, 2, new TGeoCombiTrans (-dx, dy,  (dzL3/2. + dzFloor24/2.), rot001));</span>
<span class="lineNum">     218 </span><span class="lineCov">          2 :   asHall-&gt;AddNode(voHHW11, 1, new TGeoTranslation( dx, dy, -(dzL3/2. + dzFloor26/2.)));</span>
<span class="lineNum">     219 </span><span class="lineCov">          2 :   asHall-&gt;AddNode(voHHW11, 2, new TGeoCombiTrans (-dx, dy, -(dzL3/2. + dzFloor26/2.), rot001));</span>
<span class="lineNum">     220 </span>            : 
<span class="lineNum">     221 </span><span class="lineCov">          1 :   Float_t boDY =  (yHall - (yFloor + dyFloor/2.) - 2. * trH1)/ 2.;</span>
<span class="lineNum">     222 </span>            :   Float_t dzHall = zHall26 + zHall24;
<span class="lineNum">     223 </span>            : 
<span class="lineNum">     224 </span><span class="lineCov">          3 :   TGeoVolume* voHBW1 = new TGeoVolume(&quot;HBW1&quot;, new TGeoBBox(50., boDY, dzHall / 2. - 0.05), kMedCC);</span>
<span class="lineNum">     225 </span>            : 
<span class="lineNum">     226 </span><span class="lineCov">          2 :   asHall-&gt;AddNode(voHBW1, 1,  new TGeoTranslation( 1120., yHall - boDY, (zHall24-zHall26)/2.));</span>
<span class="lineNum">     227 </span><span class="lineCov">          2 :   asHall-&gt;AddNode(voHBW1, 2,  new TGeoTranslation(-1120., yHall - boDY, (zHall24-zHall26)/2.));</span>
<span class="lineNum">     228 </span>            : 
<span class="lineNum">     229 </span>            :   //
<span class="lineNum">     230 </span>            :   // Slanted wall close to L3 magnet 
<span class="lineNum">     231 </span>            :   //
<span class="lineNum">     232 </span>            :   phim =  45.;
<span class="lineNum">     233 </span>            :   hm   = 790.;
<span class="lineNum">     234 </span><span class="lineCov">          1 :   am   = hm * TMath::Tan(phim / 2. * kDegrad);</span>
<span class="lineNum">     235 </span><span class="lineCov">          1 :   bm   = (hm + 76.) / hm * am;</span>
<span class="lineNum">     236 </span><span class="lineCov">          1 :   cm   = bm * 2. / TMath::Sqrt(2.);</span>
<span class="lineNum">     237 </span><span class="lineCov">          1 :   trH1   =  (1273.78 - cm) / 2. - 0.002;</span>
<span class="lineNum">     238 </span><span class="lineCov">          1 :   trBL1  =  235. - cm * TMath::Tan(phid * kDegrad) / 2.;</span>
<span class="lineNum">     239 </span>            :   trTL1  =   50.;
<span class="lineNum">     240 </span><span class="lineCov">          1 :   trALP1 = TMath::ATan((trBL1 - trTL1) / 2. / trH1) * kRaddeg;</span>
<span class="lineNum">     241 </span>            : 
<span class="lineNum">     242 </span>            :   w1 = trBL1;
<span class="lineNum">     243 </span><span class="lineCov">          1 :   dx = cm * TMath::Tan(phid * kDegrad) + dxFloor/2. + trBL1 * 1.5 - trTL1 * .5;</span>
<span class="lineNum">     244 </span>            : 
<span class="lineNum">     245 </span><span class="lineCov">          2 :   TGeoVolume* voHHW2 = new TGeoVolume(&quot;HHW2&quot;,</span>
<span class="lineNum">     246 </span><span class="lineCov">          4 :                                       new TGeoTrap(dzL3/2. - 0.002, 0., 0., </span>
<span class="lineNum">     247 </span><span class="lineCov">          1 :                                                    trH1, trBL1, trTL1, trALP1, trH1, trBL1, trTL1, trALP1),</span>
<span class="lineNum">     248 </span>            :                                       kMedCC);
<span class="lineNum">     249 </span>            : 
<span class="lineNum">     250 </span><span class="lineCov">          1 :   r2 = cm + yFloor - dyFloor/2. + trH1;</span>
<span class="lineNum">     251 </span>            : 
<span class="lineNum">     252 </span><span class="lineCov">          2 :   asHall-&gt;AddNode(voHHW2, 1, new TGeoTranslation(dx, r2, 0.));</span>
<span class="lineNum">     253 </span><span class="lineCov">          2 :   asHall-&gt;AddNode(voHHW2, 2, new TGeoCombiTrans(-dx, r2, 0., rot001));</span>
<span class="lineNum">     254 </span>            : 
<span class="lineNum">     255 </span><span class="lineCov">          1 :   trH1   = cm / 2.;</span>
<span class="lineNum">     256 </span><span class="lineCov">          1 :   trBL1  = w1 + cm / 2.;</span>
<span class="lineNum">     257 </span>            :   trTL1  = w1;
<span class="lineNum">     258 </span><span class="lineCov">          1 :   trALP1 = TMath::ATan(.5) * kRaddeg;</span>
<span class="lineNum">     259 </span><span class="lineCov">          1 :   dx = 1170. - trBL1 * .5 - trTL1 * .5;</span>
<span class="lineNum">     260 </span>            : 
<span class="lineNum">     261 </span><span class="lineCov">          2 :   TGeoVolume* voHHW3 = new TGeoVolume(&quot;HHW3&quot;,</span>
<span class="lineNum">     262 </span><span class="lineCov">          4 :                                       new TGeoTrap(dzL3/2., 0., 0., </span>
<span class="lineNum">     263 </span><span class="lineCov">          1 :                                                    trH1, trBL1, trTL1, trALP1, trH1, trBL1, trTL1, trALP1),</span>
<span class="lineNum">     264 </span>            :                                       kMedCC);
<span class="lineNum">     265 </span>            : 
<span class="lineNum">     266 </span><span class="lineCov">          1 :   r2 = trH1 - 896.;</span>
<span class="lineNum">     267 </span><span class="lineCov">          2 :   asHall-&gt;AddNode(voHHW3, 1, new TGeoTranslation( dx, r2, 0.));</span>
<span class="lineNum">     268 </span><span class="lineCov">          2 :   asHall-&gt;AddNode(voHHW3, 2, new TGeoCombiTrans (-dx, r2, 0., rot001));</span>
<span class="lineNum">     269 </span>            :   //
<span class="lineNum">     270 </span>            :   // Floor L3
<span class="lineNum">     271 </span>            :   Float_t dyFloorL3  = 76.;
<span class="lineNum">     272 </span><span class="lineCov">          1 :   Float_t dx1FloorL3 = rHall + epsBig - 2. * trBL1;</span>
<span class="lineNum">     273 </span><span class="lineCov">          1 :   Float_t dx2FloorL3 = dx1FloorL3 + TMath::Tan(phim * kDegrad) * dyFloorL3;</span>
<span class="lineNum">     274 </span>            :   
<span class="lineNum">     275 </span>            :   
<span class="lineNum">     276 </span><span class="lineCov">          2 :   TGeoVolume* voHHF2 = new TGeoVolume(&quot;HHF2&quot;, </span>
<span class="lineNum">     277 </span><span class="lineCov">          3 :                                       new TGeoTrd1(dx1FloorL3 - 0.5, dx2FloorL3 - 0.5, dzL3/2., dyFloorL3/2.), </span>
<span class="lineNum">     278 </span>            :                                       kMedCC);
<span class="lineNum">     279 </span>            : 
<span class="lineNum">     280 </span><span class="lineCov">          2 :   asHall-&gt;AddNode(voHHF2, 1, new TGeoCombiTrans(0., yFloor - dyFloor / 2. + dyFloorL3 / 2. - 0.5,0., rot000));</span>
<span class="lineNum">     281 </span>            :   //
<span class="lineNum">     282 </span>            :   // Tunnel roof and pit
<span class="lineNum">     283 </span>            :   // Roof
<span class="lineNum">     284 </span><span class="lineCov">          1 :   TGeoTubeSeg* shHHC11 = new TGeoTubeSeg(rHall, rHall + 100., dzHall / 2., 0., 180.);</span>
<span class="lineNum">     285 </span><span class="lineCov">          1 :   shHHC11-&gt;SetName(&quot;shHHC11&quot;);</span>
<span class="lineNum">     286 </span>            :   // Pit 
<span class="lineNum">     287 </span><span class="lineCov">          1 :   TGeoTube*    shHHC12 = new TGeoTube(rPit, rPit + 100., 1000.);</span>
<span class="lineNum">     288 </span><span class="lineCov">          1 :   shHHC12-&gt;SetName(&quot;shHHC12&quot;);</span>
<span class="lineNum">     289 </span>            :   // Pit inside
<span class="lineNum">     290 </span><span class="lineCov">          1 :   TGeoTube*    shHHC13 = new TGeoTube(   0, rPit - epsSmall, 1000.);</span>
<span class="lineNum">     291 </span><span class="lineCov">          1 :   shHHC13-&gt;SetName(&quot;shHHC13&quot;);</span>
<span class="lineNum">     292 </span>            :   // Roof inside
<span class="lineNum">     293 </span><span class="lineCov">          1 :   TGeoTubeSeg* shHHC14 = new TGeoTubeSeg(0., rHall, dzHall / 2. + epsBig, 0., 180.);</span>
<span class="lineNum">     294 </span><span class="lineCov">          1 :   shHHC14-&gt;SetName(&quot;shHHC14&quot;);</span>
<span class="lineNum">     295 </span>            : 
<span class="lineNum">     296 </span><span class="lineCov">          1 :   TGeoCombiTrans* trHHC = new TGeoCombiTrans(&quot;trHHC&quot;, 0., 1000., dzHall/2. + rPit - oPit, rot000);</span>
<span class="lineNum">     297 </span><span class="lineCov">          1 :   trHHC-&gt;RegisterYourself();</span>
<span class="lineNum">     298 </span><span class="lineCov">          1 :   TGeoCompositeShape*  shHHC1 = new TGeoCompositeShape(&quot;HHC1&quot;, &quot;shHHC11+shHHC12:trHHC-(shHHC14+shHHC13:trHHC)&quot;);</span>
<span class="lineNum">     299 </span><span class="lineCov">          1 :   TGeoVolume* voHHC1 = new TGeoVolume(&quot;HHC1&quot;, shHHC1, kMedCC);</span>
<span class="lineNum">     300 </span>            : 
<span class="lineNum">     301 </span><span class="lineCov">          2 :   asHall-&gt;AddNode(voHHC1, 1, new TGeoTranslation(0., yHall, -(zHall26-zHall24)/2.));</span>
<span class="lineNum">     302 </span>            : 
<span class="lineNum">     303 </span>            : 
<span class="lineNum">     304 </span>            :   //
<span class="lineNum">     305 </span>            :   // Pit wall ground level
<span class="lineNum">     306 </span><span class="lineCov">          1 :   dy = yFloor + 1206. / 2. + dyFloor/2.;</span>
<span class="lineNum">     307 </span><span class="lineCov">          1 :   TGeoTube* shHHCPW1 = new TGeoTube(rPit, rPit + 100., 1206./2.);</span>
<span class="lineNum">     308 </span><span class="lineCov">          1 :   shHHCPW1-&gt;SetName(&quot;shHHCPW1&quot;);</span>
<span class="lineNum">     309 </span><span class="lineCov">          1 :   TGeoCombiTrans* trHHCPW1 = new TGeoCombiTrans(&quot;trHHCPW1&quot;, 0., 0., 0., rot000);</span>
<span class="lineNum">     310 </span><span class="lineCov">          1 :   trHHCPW1-&gt;RegisterYourself();</span>
<span class="lineNum">     311 </span>            : 
<span class="lineNum">     312 </span><span class="lineCov">          1 :   TGeoBBox* shHHCPW2 = new TGeoBBox(rPit + 100., 1206./ 2. + 20., rPit + 100.);</span>
<span class="lineNum">     313 </span><span class="lineCov">          1 :   shHHCPW2-&gt;SetName(&quot;shHHCPW2&quot;);</span>
<span class="lineNum">     314 </span>            :   
<span class="lineNum">     315 </span><span class="lineCov">          1 :   TGeoTube* shHHCPW3 = new TGeoTube(0., 60., 60.);</span>
<span class="lineNum">     316 </span><span class="lineCov">          1 :   shHHCPW3-&gt;SetName(&quot;shHHCPW3&quot;);</span>
<span class="lineNum">     317 </span>            : 
<span class="lineNum">     318 </span>            :   
<span class="lineNum">     319 </span><span class="lineCov">          1 :   TGeoTranslation* trHHCPW2 = new TGeoTranslation(&quot;trHHCPW2&quot;, 0., 0., -(rPit + 100.) - oPit);</span>
<span class="lineNum">     320 </span><span class="lineCov">          1 :   trHHCPW2-&gt;RegisterYourself();</span>
<span class="lineNum">     321 </span>            : 
<span class="lineNum">     322 </span><span class="lineCov">          1 :   TGeoTranslation* trHHCPW3 = new TGeoTranslation(&quot;trHHCPW3&quot;, 0., -dy, rPit + 50.);</span>
<span class="lineNum">     323 </span><span class="lineCov">          1 :   trHHCPW3-&gt;RegisterYourself();</span>
<span class="lineNum">     324 </span>            : 
<span class="lineNum">     325 </span>            :   TGeoCompositeShape*  shHHCPW 
<span class="lineNum">     326 </span><span class="lineCov">          1 :       = new TGeoCompositeShape(&quot;HHCPW&quot;, &quot;shHHCPW1:trHHCPW1-(shHHCPW2:trHHCPW2+shHHCPW3:trHHCPW3)&quot;);</span>
<span class="lineNum">     327 </span><span class="lineCov">          1 :   TGeoVolume* voHHCPW = new TGeoVolume(&quot;HHCPW&quot;, shHHCPW, kMedCC);</span>
<span class="lineNum">     328 </span>            : 
<span class="lineNum">     329 </span><span class="lineCov">          2 :   asHall-&gt;AddNode(voHHCPW, 1, new TGeoTranslation(0., dy, 2300.));</span>
<span class="lineNum">     330 </span>            :   // 
<span class="lineNum">     331 </span>            :   // Foundations of the Muon Spectrometer
<span class="lineNum">     332 </span>            :   // Drawing ALIP2A_0110
<span class="lineNum">     333 </span>            :   //
<span class="lineNum">     334 </span><span class="lineCov">          1 :   TGeoVolumeAssembly* asFMS = new TGeoVolumeAssembly(&quot;asFMS&quot;);</span>
<span class="lineNum">     335 </span>            :   Float_t zFil = -1465.86 - 60.;
<span class="lineNum">     336 </span>            :   // Muon Filter Foundation
<span class="lineNum">     337 </span>            :   // Pillars
<span class="lineNum">     338 </span>            :   dy = 263.54/2.;
<span class="lineNum">     339 </span><span class="lineCov">          1 :   Float_t ys = yFloor + dyFloor / 2.;</span>
<span class="lineNum">     340 </span><span class="lineCov">          3 :   TGeoVolume* voFmsMfPil = new TGeoVolume(&quot;FmsMfPil&quot;, new TGeoBBox( 50., dy, 165.), kMedCC);</span>
<span class="lineNum">     341 </span><span class="lineCov">          1 :   ys += dy;</span>
<span class="lineNum">     342 </span><span class="lineCov">          2 :   asFMS-&gt;AddNode(voFmsMfPil, 1, new TGeoTranslation(-330. + 50., ys, zFil + 165. - 90.));</span>
<span class="lineNum">     343 </span><span class="lineCov">          2 :   asFMS-&gt;AddNode(voFmsMfPil, 2, new TGeoTranslation( 330. - 50., ys, zFil + 165  - 90.));</span>
<span class="lineNum">     344 </span>            :   //
<span class="lineNum">     345 </span>            :   // Transverse bars
<span class="lineNum">     346 </span><span class="lineCov">          1 :   ys += dy;</span>
<span class="lineNum">     347 </span>            :   dy = 91.32/2.;
<span class="lineNum">     348 </span><span class="lineCov">          1 :   ys += dy;</span>
<span class="lineNum">     349 </span><span class="lineCov">          3 :   TGeoVolume* voFmsMfTb1 = new TGeoVolume(&quot;FmsMfTb1&quot;, new TGeoBBox(330., dy,  60.), kMedCC);</span>
<span class="lineNum">     350 </span><span class="lineCov">          2 :   asFMS-&gt;AddNode(voFmsMfTb1, 1, new TGeoTranslation(0., ys, zFil));</span>
<span class="lineNum">     351 </span><span class="lineCov">          1 :   ys += dy;</span>
<span class="lineNum">     352 </span>            :   dy = 41.14/2.;
<span class="lineNum">     353 </span><span class="lineCov">          1 :   ys += dy;</span>
<span class="lineNum">     354 </span><span class="lineCov">          3 :   TGeoVolume* voFmsMfTb2 = new TGeoVolume(&quot;FmsMfTb2&quot;, new TGeoBBox(330., dy,  60.), kMedCC);</span>
<span class="lineNum">     355 </span><span class="lineCov">          2 :   asFMS-&gt;AddNode(voFmsMfTb2, 1, new TGeoTranslation(0., ys, zFil));</span>
<span class="lineNum">     356 </span>            :   //
<span class="lineNum">     357 </span>            :   // Dipole foundation
<span class="lineNum">     358 </span>            :   ys = yFloor + dyFloor / 2.;
<span class="lineNum">     359 </span>            :   dy = (263.54 - 6.2)/2.;
<span class="lineNum">     360 </span><span class="lineCov">          1 :   ys += dy;</span>
<span class="lineNum">     361 </span><span class="lineCov">          3 :   TGeoVolume* voFmsDf1 = new TGeoVolume(&quot;FmsDf1&quot;, new TGeoBBox(370., dy,  448.0 / 2.), kMedCC);</span>
<span class="lineNum">     362 </span><span class="lineCov">          2 :   asFMS-&gt;AddNode(voFmsDf1, 1, new TGeoTranslation(0., ys, zFil + 240. + 224.));</span>
<span class="lineNum">     363 </span><span class="lineCov">          3 :   TGeoVolume* voFmsDf2 = new TGeoVolume(&quot;FmsDf2&quot;, new TGeoBBox(370., (263.54 + 110.)/2.,  112.0 / 2.), kMedCC);</span>
<span class="lineNum">     364 </span><span class="lineCov">          2 :   asFMS-&gt;AddNode(voFmsDf2, 1, new TGeoTranslation(0., ys - 110./2., zFil + 688. + 56.));</span>
<span class="lineNum">     365 </span>            : 
<span class="lineNum">     366 </span>            :   //
<span class="lineNum">     367 </span>            :   // Shielding in front of L3 magnet in PX24 and UX25
<span class="lineNum">     368 </span>            :   // Drawing ALIP2I__0016
<span class="lineNum">     369 </span>            :   //
<span class="lineNum">     370 </span>            : 
<span class="lineNum">     371 </span><span class="lineCov">          1 :   TGeoVolumeAssembly* asShRb24 = new TGeoVolumeAssembly(&quot;ShRb24&quot;);</span>
<span class="lineNum">     372 </span>            :   //
<span class="lineNum">     373 </span>            :   // Side walls 
<span class="lineNum">     374 </span>            :   // start 7450 from IP
<span class="lineNum">     375 </span><span class="lineCov">          3 :   TGeoVolume* voShRb24Sw = new TGeoVolume(&quot;ShRb24Sw&quot;, new TGeoBBox(80., 420., 520.), kMedCC);</span>
<span class="lineNum">     376 </span><span class="lineCov">          2 :   asShRb24-&gt;AddNode(voShRb24Sw, 1, new TGeoTranslation(+315, -420. + 140., 0.));</span>
<span class="lineNum">     377 </span><span class="lineCov">          2 :   asShRb24-&gt;AddNode(voShRb24Sw, 2, new TGeoTranslation(-315, -420. + 140., 0.));</span>
<span class="lineNum">     378 </span>            :   //
<span class="lineNum">     379 </span>            :   // Roof
<span class="lineNum">     380 </span><span class="lineCov">          3 :   TGeoVolume* voShRb24Ro = new TGeoVolume(&quot;ShRb24Ro&quot;, new TGeoBBox(395., 80., 520.), kMedCC);</span>
<span class="lineNum">     381 </span><span class="lineCov">          2 :   asShRb24-&gt;AddNode(voShRb24Ro, 1, new TGeoTranslation(0., +80. + 140., 0.));</span>
<span class="lineNum">     382 </span>            :   //
<span class="lineNum">     383 </span>            :   // Concrete Plug
<span class="lineNum">     384 </span><span class="lineCov">          1 :   TGeoBBox* shShRb24Pl1 = new TGeoBBox(235., 140., 40.);</span>
<span class="lineNum">     385 </span><span class="lineCov">          1 :   shShRb24Pl1-&gt;SetName(&quot;ShRb24Pl1&quot;);</span>
<span class="lineNum">     386 </span>            :   // Steel Plug
<span class="lineNum">     387 </span><span class="lineCov">          1 :   TGeoBBox* shShRb24Pl4 = new TGeoBBox(15., 20., 40.);</span>
<span class="lineNum">     388 </span><span class="lineCov">          1 :   shShRb24Pl4-&gt;SetName(&quot;ShRb24Pl4&quot;);</span>
<span class="lineNum">     389 </span>            : 
<span class="lineNum">     390 </span><span class="lineCov">          1 :   TGeoBBox* shShRb24Pl41 = new TGeoBBox(15., 20., 45.);</span>
<span class="lineNum">     391 </span><span class="lineCov">          1 :   shShRb24Pl41-&gt;SetName(&quot;ShRb24Pl41&quot;);</span>
<span class="lineNum">     392 </span>            :   
<span class="lineNum">     393 </span>            :   //
<span class="lineNum">     394 </span>            :   // Opening for beam pipe
<span class="lineNum">     395 </span>            :   Float_t dxShRb24Pl = 14.5;
<span class="lineNum">     396 </span>            :   Float_t dyShRb24Pl = 20.0;
<span class="lineNum">     397 </span><span class="lineCov">          1 :   if (fNewShield24) {</span>
<span class="lineNum">     398 </span>            :     dxShRb24Pl = 6.;
<span class="lineNum">     399 </span>            :     dyShRb24Pl = 6.;
<span class="lineNum">     400 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">     401 </span><span class="lineCov">          1 :   TGeoBBox* shShRb24Pl2 = new TGeoBBox(dxShRb24Pl, dyShRb24Pl, 60.);</span>
<span class="lineNum">     402 </span><span class="lineCov">          1 :   shShRb24Pl2-&gt;SetName(&quot;ShRb24Pl2&quot;);</span>
<span class="lineNum">     403 </span>            :   //
<span class="lineNum">     404 </span>            :   // Opening for tubes
<span class="lineNum">     405 </span><span class="lineCov">          1 :   TGeoBBox* shShRb24Pl3 = new TGeoBBox(20., 60., 60.);</span>
<span class="lineNum">     406 </span><span class="lineCov">          1 :   shShRb24Pl3-&gt;SetName(&quot;ShRb24Pl3&quot;);</span>
<span class="lineNum">     407 </span>            : 
<span class="lineNum">     408 </span><span class="lineCov">          1 :   TGeoTranslation* trPl3 = new TGeoTranslation(&quot;trPl3&quot;, +235. -90., 80., 0.);</span>
<span class="lineNum">     409 </span><span class="lineCov">          1 :   trPl3-&gt;RegisterYourself();</span>
<span class="lineNum">     410 </span>            : 
<span class="lineNum">     411 </span><span class="lineCov">          1 :   TGeoTranslation* trPl4 = new TGeoTranslation(&quot;trPl4&quot;, 0., -6., 0.);</span>
<span class="lineNum">     412 </span><span class="lineCov">          1 :   trPl4-&gt;RegisterYourself();</span>
<span class="lineNum">     413 </span><span class="lineCov">          1 :   TGeoTranslation* trPl5 = new TGeoTranslation(&quot;trPl5&quot;, 0., +6., 0.);</span>
<span class="lineNum">     414 </span><span class="lineCov">          1 :   trPl5-&gt;RegisterYourself();</span>
<span class="lineNum">     415 </span>            : 
<span class="lineNum">     416 </span>            :   TGeoCompositeShape*  shRb24Pl   = 0;
<span class="lineNum">     417 </span>            :   TGeoCompositeShape*  shRb24PlSS = 0;
<span class="lineNum">     418 </span><span class="lineCov">          2 :   if (!fNewShield24) {</span>
<span class="lineNum">     419 </span><span class="lineCov">          1 :     shRb24Pl = new TGeoCompositeShape(&quot;Rb24Pl&quot;, &quot;ShRb24Pl1-ShRb24Pl2:trPl4-ShRb24Pl3:trPl3&quot;);</span>
<span class="lineNum">     420 </span><span class="lineCov">          1 :   } else {</span>
<span class="lineNum">     421 </span><span class="lineCov">          1 :     shRb24Pl   = new TGeoCompositeShape(&quot;Rb24Pl&quot;,   &quot;ShRb24Pl1-(ShRb24Pl41:trPl4+ShRb24Pl3:trPl3)&quot;);</span>
<span class="lineNum">     422 </span><span class="lineNoCov">          0 :     shRb24PlSS = new TGeoCompositeShape(&quot;Rb24PlSS&quot;, &quot;ShRb24Pl4-ShRb24Pl2:trPl5&quot;);</span>
<span class="lineNum">     423 </span>            :   }
<span class="lineNum">     424 </span>            : 
<span class="lineNum">     425 </span><span class="lineCov">          1 :   TGeoVolume* voRb24Pl = new TGeoVolume(&quot;Rb24Pl&quot;, shRb24Pl, kMedCC);</span>
<span class="lineNum">     426 </span>            : 
<span class="lineNum">     427 </span><span class="lineCov">          2 :   asShRb24-&gt;AddNode(voRb24Pl, 1, new TGeoTranslation(0., 0., 520. - 40.));</span>
<span class="lineNum">     428 </span><span class="lineCov">          1 :   if (fNewShield24) {</span>
<span class="lineNum">     429 </span><span class="lineNoCov">          0 :     TGeoVolume* voRb24PlSS = new TGeoVolume(&quot;Rb24PlSS&quot;, shRb24PlSS, kMedST);</span>
<span class="lineNum">     430 </span><span class="lineNoCov">          0 :     asShRb24-&gt;AddNode(voRb24PlSS, 1, new TGeoTranslation(0., -6., 520. - 40.));</span>
<span class="lineNum">     431 </span><span class="lineNoCov">          0 :    }</span>
<span class="lineNum">     432 </span>            : 
<span class="lineNum">     433 </span>            : 
<span class="lineNum">     434 </span>            :   //
<span class="lineNum">     435 </span>            :   // Concrete platform and shielding PX24
<span class="lineNum">     436 </span>            :   // Drawing LHCJUX 250014
<span class="lineNum">     437 </span>            :   //
<span class="lineNum">     438 </span><span class="lineCov">          1 :   TGeoVolumeAssembly* asShPx24 = new TGeoVolumeAssembly(&quot;ShPx24&quot;);</span>
<span class="lineNum">     439 </span>            :   // Platform
<span class="lineNum">     440 </span><span class="lineCov">          3 :   TGeoVolume* voShPx24Pl = new TGeoVolume(&quot;ShPx24Pl&quot;, new TGeoBBox(1613.5/2., 120./2., 1205./2.), kMedCC);</span>
<span class="lineNum">     441 </span><span class="lineCov">          2 :   asShPx24-&gt;AddNode(voShPx24Pl, 1, new TGeoTranslation(55., -140. - 60., 0.));</span>
<span class="lineNum">     442 </span>            :   // Pillars
<span class="lineNum">     443 </span><span class="lineCov">          3 :   TGeoVolume* voShPx24Pi = new TGeoVolume(&quot;ShPx24Pi&quot;, new TGeoBBox(160./2., 440./2., 40/2.), kMedCC);</span>
<span class="lineNum">     444 </span><span class="lineCov">          2 :   asShPx24-&gt;AddNode(voShPx24Pi, 1, new TGeoTranslation(-180. - 80., -220. -260.,  1205./2. - 20.));</span>
<span class="lineNum">     445 </span><span class="lineCov">          2 :   asShPx24-&gt;AddNode(voShPx24Pi, 2, new TGeoTranslation(+290. + 80., -220. -260.,  1205./2. - 20.));</span>
<span class="lineNum">     446 </span><span class="lineCov">          2 :   asShPx24-&gt;AddNode(voShPx24Pi, 3, new TGeoTranslation(-180. - 80., -220. -260., -1205./2. + 20. + 120.));</span>
<span class="lineNum">     447 </span><span class="lineCov">          2 :   asShPx24-&gt;AddNode(voShPx24Pi, 4, new TGeoTranslation(+290. + 80., -220. -260., -1205./2. + 20. + 120.));</span>
<span class="lineNum">     448 </span><span class="lineCov">          2 :   asShPx24-&gt;AddNode(voShPx24Pi, 5, new TGeoTranslation(-180. - 80., -220. -260., -1205./2. - 20. + 480.));</span>
<span class="lineNum">     449 </span><span class="lineCov">          2 :   asShPx24-&gt;AddNode(voShPx24Pi, 6, new TGeoTranslation(+290. + 80., -220. -260., -1205./2. - 20. + 480.));</span>
<span class="lineNum">     450 </span><span class="lineCov">          2 :   asShPx24-&gt;AddNode(voShPx24Pi, 7, new TGeoTranslation(-180. - 80., -220. -260., -1205./2. - 20. + 800.));</span>
<span class="lineNum">     451 </span><span class="lineCov">          2 :   asShPx24-&gt;AddNode(voShPx24Pi, 8, new TGeoTranslation(+290. + 80., -220. -260., -1205./2. - 20. + 800.));</span>
<span class="lineNum">     452 </span>            :   // Side Walls 
<span class="lineNum">     453 </span><span class="lineCov">          3 :   TGeoVolume* voShPx24Sw = new TGeoVolume(&quot;ShPx24Sw&quot;, new TGeoBBox(160./2., 280./2., 1205./2.), kMedCC);</span>
<span class="lineNum">     454 </span><span class="lineCov">          2 :   asShPx24-&gt;AddNode(voShPx24Sw, 1, new TGeoTranslation(-180, 0., 0.));</span>
<span class="lineNum">     455 </span><span class="lineCov">          2 :   asShPx24-&gt;AddNode(voShPx24Sw, 2, new TGeoTranslation(+290, 0., 0.));</span>
<span class="lineNum">     456 </span>            :   // Roof
<span class="lineNum">     457 </span><span class="lineCov">          3 :   TGeoVolume* voShPx24Ro = new TGeoVolume(&quot;ShPx24Ro&quot;, new TGeoBBox(630./2., 160./2., 1205./2.), kMedCC);</span>
<span class="lineNum">     458 </span><span class="lineCov">          2 :   asShPx24-&gt;AddNode(voShPx24Ro, 1, new TGeoTranslation(55., 80.+ 140., 0.));</span>
<span class="lineNum">     459 </span><span class="lineCov">          2 :   asHall-&gt;AddNode(asShRb24, 1, new TGeoTranslation(0., 0., +745. + 520.));</span>
<span class="lineNum">     460 </span><span class="lineCov">          2 :   asHall-&gt;AddNode(asShPx24, 1, new TGeoTranslation(0., 0., +745. + 1040. + 1205./ 2.));</span>
<span class="lineNum">     461 </span>            :   // Stainless Steel Plug 80 cm thick
<span class="lineNum">     462 </span><span class="lineCov">          1 :   TGeoBBox* shShPx24Pl1 = new TGeoBBox(155., 140., 40.);</span>
<span class="lineNum">     463 </span><span class="lineCov">          1 :   shShPx24Pl1-&gt;SetName(&quot;ShPx24Pl1&quot;);</span>
<span class="lineNum">     464 </span>            :   // Opening for beam pipe
<span class="lineNum">     465 </span>            :   Float_t dxPx24Pl2 =  9.5;
<span class="lineNum">     466 </span>            :   Float_t dyPx24Pl2 = 14.0;
<span class="lineNum">     467 </span>            :   // Option for new shielding closer to the beam pipe
<span class="lineNum">     468 </span><span class="lineCov">          1 :   if (fNewShield24) {</span>
<span class="lineNum">     469 </span>            :     dxPx24Pl2 = 6.;
<span class="lineNum">     470 </span>            :     dyPx24Pl2 = 6.;
<span class="lineNum">     471 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">     472 </span>            :   //
<span class="lineNum">     473 </span><span class="lineCov">          1 :   TGeoBBox* shShPx24Pl2 = new TGeoBBox(dxPx24Pl2, dyPx24Pl2, 60.);</span>
<span class="lineNum">     474 </span><span class="lineCov">          1 :   shShPx24Pl2-&gt;SetName(&quot;ShPx24Pl2&quot;);</span>
<span class="lineNum">     475 </span><span class="lineCov">          1 :   TGeoTranslation* trPl2  = new TGeoTranslation(&quot;trPl2&quot;,  -55., 0., 0.);</span>
<span class="lineNum">     476 </span><span class="lineCov">          1 :   trPl2-&gt;RegisterYourself();</span>
<span class="lineNum">     477 </span>            : 
<span class="lineNum">     478 </span><span class="lineCov">          1 :   TGeoCompositeShape*  shPx24Pl = new TGeoCompositeShape(&quot;Px24Pl&quot;, &quot;ShPx24Pl1-ShPx24Pl2:trPl2&quot;);</span>
<span class="lineNum">     479 </span><span class="lineCov">          1 :   TGeoVolume* voPx24Pl = new TGeoVolume(&quot;Px24Pl&quot;, shPx24Pl, kMedST);</span>
<span class="lineNum">     480 </span><span class="lineCov">          2 :   asShPx24-&gt;AddNode(voPx24Pl, 1, new TGeoTranslation(55., 0., -1205./2. + 40.));</span>
<span class="lineNum">     481 </span><span class="lineCov">          2 :   asHall-&gt;AddNode(asFMS, 1, new TGeoTranslation(0.,  0., 0.));</span>
<span class="lineNum">     482 </span>            : 
<span class="lineNum">     483 </span>            :   //
<span class="lineNum">     484 </span>            :   // Scoring plane for beam background simulations
<span class="lineNum">     485 </span>            :   //
<span class="lineNum">     486 </span><span class="lineCov">          3 :   TGeoVolume* voRB24Scoring = new TGeoVolume(&quot;RB24Scoring&quot;, new TGeoTube(4.3, 300., 1.), kMedAir);</span>
<span class="lineNum">     487 </span><span class="lineCov">          2 :   asHall-&gt;AddNode(voRB24Scoring, 1, new TGeoTranslation(0., 0., 735.));</span>
<span class="lineNum">     488 </span>            :   //
<span class="lineNum">     489 </span>            :   // Extra shielding in front of racks
<span class="lineNum">     490 </span>            :   //
<span class="lineNum">     491 </span><span class="lineCov">          1 :   if (fRackShield) {</span>
<span class="lineNum">     492 </span><span class="lineNoCov">          0 :     TGeoVolume* voRackShield = new TGeoVolume(&quot;RackShield&quot;, new TGeoBBox(30., 125., 50.), kMedFe);</span>
<span class="lineNum">     493 </span><span class="lineNoCov">          0 :     asHall-&gt;AddNode(voRackShield, 1, new TGeoTranslation(85., -495., 1726.));</span>
<span class="lineNum">     494 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">     495 </span>            :   //
<span class="lineNum">     496 </span><span class="lineCov">          1 :   top-&gt;AddNode(asHall, 1, gGeoIdentity);</span>
<span class="lineNum">     497 </span>            :   
<a name="498"><span class="lineNum">     498 </span><span class="lineCov">          1 : }</span></a>
<span class="lineNum">     499 </span>            : 
<span class="lineNum">     500 </span>            : void AliHALLv3::Init()
<span class="lineNum">     501 </span>            : {
<span class="lineNum">     502 </span>            :   //
<span class="lineNum">     503 </span>            :   // Initialise the module after the geometry has been defined
<span class="lineNum">     504 </span>            :   //
<span class="lineNum">     505 </span><span class="lineCov">          2 :     if(AliLog::GetGlobalDebugLevel()&gt;0) {</span>
<span class="lineNum">     506 </span><span class="lineNoCov">          0 :         printf(&quot;%s: **************************************&quot;</span>
<span class="lineNum">     507 </span>            :                &quot; HALL &quot;
<span class="lineNum">     508 </span><span class="lineNoCov">          0 :                &quot;**************************************\n&quot;,ClassName());</span>
<span class="lineNum">     509 </span><span class="lineNoCov">          0 :         printf(&quot;\n%s:      Version 3 of HALL initialised\n\n&quot;,ClassName());</span>
<span class="lineNum">     510 </span><span class="lineNoCov">          0 :         printf(&quot;%s: **************************************&quot;</span>
<span class="lineNum">     511 </span>            :                &quot; HALL &quot;
<span class="lineNum">     512 </span><span class="lineNoCov">          0 :                &quot;**************************************\n&quot;,ClassName());</span>
<span class="lineNum">     513 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">     514 </span>            : //
<span class="lineNum">     515 </span>            : // The reference volume id
<span class="lineNum">     516 </span><span class="lineCov">          1 :     fRefVolumeId = TVirtualMC::GetMC()-&gt;VolId(&quot;RB24Scoring&quot;);</span>
<a name="517"><span class="lineNum">     517 </span><span class="lineCov">          1 : }</span></a>
<span class="lineNum">     518 </span>            : 
<span class="lineNum">     519 </span>            : void AliHALLv3::StepManager()
<span class="lineNum">     520 </span>            : {
<span class="lineNum">     521 </span>            : //
<span class="lineNum">     522 </span>            : // Stepmanager of AliHALLv2
<span class="lineNum">     523 </span>            : // Used for recording of reference tracks entering scoring plane
<span class="lineNum">     524 </span>            : //
<span class="lineNum">     525 </span><span class="lineCov">     259276 :   if (!fScoring) return;</span>
<span class="lineNum">     526 </span><span class="lineNoCov">          0 :   Int_t   copy, id;</span>
<span class="lineNum">     527 </span>            :   
<span class="lineNum">     528 </span>            :   //
<span class="lineNum">     529 </span>            :   // Only charged tracks
<span class="lineNum">     530 </span><span class="lineNoCov">          0 :   if( !(TVirtualMC::GetMC()-&gt;TrackCharge()) ) return; </span>
<span class="lineNum">     531 </span>            :   //
<span class="lineNum">     532 </span>            :   // Only tracks entering mother volume
<span class="lineNum">     533 </span>            :   // 
<span class="lineNum">     534 </span>            : 
<span class="lineNum">     535 </span><span class="lineNoCov">          0 :   id=TVirtualMC::GetMC()-&gt;CurrentVolID(copy);</span>
<span class="lineNum">     536 </span>            : 
<span class="lineNum">     537 </span><span class="lineNoCov">          0 :   if ((id != fRefVolumeId))   return;</span>
<span class="lineNum">     538 </span><span class="lineNoCov">          0 :   if(!TVirtualMC::GetMC()-&gt;IsTrackEntering()) return;</span>
<span class="lineNum">     539 </span>            :   //
<span class="lineNum">     540 </span>            :   // Add the reference track
<span class="lineNum">     541 </span>            :   //
<span class="lineNum">     542 </span><span class="lineNoCov">          0 :   AddTrackReference(gAlice-&gt;GetMCApp()-&gt;GetCurrentTrackNumber(), AliTrackReference::kHALL);</span>
<span class="lineNum">     543 </span><span class="lineCov">     129638 : }</span>
<span class="lineNum">     544 </span>            : 
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.11</a></td></tr>
  </table>
  <br>

</body>
</html>
