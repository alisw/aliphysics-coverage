<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - coverage.info - ITS/ITSsim/AliITSv11Geometry.cxx</title>
  <link rel="stylesheet" type="text/css" href="../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../index.html">top level</a> - <a href="index.html">ITS/ITSsim</a> - AliITSv11Geometry.cxx<span style="font-size: 80%;"> (source / <a href="AliITSv11Geometry.cxx.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">coverage.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">99</td>
            <td class="headerCovTableEntry">518</td>
            <td class="headerCovTableEntryLo">19.1 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2016-06-14 17:26:59</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">16</td>
            <td class="headerCovTableEntry">33</td>
            <td class="headerCovTableEntryLo">48.5 %</td>
          </tr>
          <tr><td><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            : /**************************************************************************</a>
<span class="lineNum">       2 </span>            :  * Copyright(c) 1998-1999, ALICE Experiment at CERN, All rights reserved. *
<span class="lineNum">       3 </span>            :  *                                                                        *
<span class="lineNum">       4 </span>            :  * Author: The ALICE Off-line Project.                                    *
<span class="lineNum">       5 </span>            :  * Contributors are mentioned in the code where appropriate.              *
<span class="lineNum">       6 </span>            :  *                                                                        *
<span class="lineNum">       7 </span>            :  * Permission to use, copy, modify and distribute this software and its   *
<span class="lineNum">       8 </span>            :  * documentation strictly for non-commercial purposes is hereby granted   *
<span class="lineNum">       9 </span>            :  * without fee, provided that the above copyright notice appears in all   *
<span class="lineNum">      10 </span>            :  * copies and that both the copyright notice and this permission notice   *
<span class="lineNum">      11 </span>            :  * appear in the supporting documentation. The authors make no claims     *
<span class="lineNum">      12 </span>            :  * about the suitability of this software for any purpose. It is          *
<span class="lineNum">      13 </span>            :  * provided &quot;as is&quot; without express or implied warranty.                  *
<span class="lineNum">      14 </span>            :  **************************************************************************/
<span class="lineNum">      15 </span>            : 
<span class="lineNum">      16 </span>            : /*
<span class="lineNum">      17 </span>            :  $Id$ 
<span class="lineNum">      18 </span>            : */
<span class="lineNum">      19 </span>            : 
<span class="lineNum">      20 </span>            : 
<span class="lineNum">      21 </span>            : ////////////////////////////////////////////////////////////////////////
<span class="lineNum">      22 </span>            : //  This class is a base class for the ITS geometry version 11. It 
<span class="lineNum">      23 </span>            : //  contains common/standard functions used in many places in defining 
<span class="lineNum">      24 </span>            : //  the ITS geometry, version 11. Large posions of the ITS geometry, 
<span class="lineNum">      25 </span>            : //  version 11, should be derived from this class so as to make maximum 
<span class="lineNum">      26 </span>            : //  use of these common functions. This class also defines the proper 
<span class="lineNum">      27 </span>            : //  conversion valuse such, to cm and degrees, such that the most usefull 
<span class="lineNum">      28 </span>            : //  units, those used in the Engineering drawings, can be used.
<span class="lineNum">      29 </span>            : ////////////////////////////////////////////////////////////////////////
<span class="lineNum">      30 </span>            : 
<span class="lineNum">      31 </span>            : 
<span class="lineNum">      32 </span>            : #include &lt;Riostream.h&gt;
<span class="lineNum">      33 </span>            : #include &lt;TMath.h&gt;
<span class="lineNum">      34 </span>            : #include &lt;TArc.h&gt;
<span class="lineNum">      35 </span>            : #include &lt;TLine.h&gt;
<span class="lineNum">      36 </span>            : #include &lt;TArrow.h&gt;
<span class="lineNum">      37 </span>            : #include &lt;TCanvas.h&gt;
<span class="lineNum">      38 </span>            : #include &lt;TText.h&gt;
<span class="lineNum">      39 </span>            : #include &lt;TGeoPcon.h&gt;
<span class="lineNum">      40 </span>            : #include &lt;TGeoCone.h&gt;
<span class="lineNum">      41 </span>            : #include &lt;TGeoTube.h&gt; // contaings TGeoTubeSeg
<span class="lineNum">      42 </span>            : #include &lt;TGeoArb8.h&gt;
<span class="lineNum">      43 </span>            : #include &lt;TGeoElement.h&gt;
<span class="lineNum">      44 </span>            : #include &lt;TGeoMaterial.h&gt;
<span class="lineNum">      45 </span>            : #include &lt;TPolyMarker.h&gt;
<span class="lineNum">      46 </span>            : #include &lt;TPolyLine.h&gt;
<span class="lineNum">      47 </span>            : #include &lt;AliMagF.h&gt;
<span class="lineNum">      48 </span>            : #include &lt;AliRun.h&gt;
<span class="lineNum">      49 </span>            : #include &quot;AliITSv11Geometry.h&quot;
<span class="lineNum">      50 </span>            : 
<span class="lineNum">      51 </span>            : using std::endl;
<a name="52"><span class="lineNum">      52 </span>            : using std::cout;</a>
<span class="lineNum">      53 </span>            : using std::cin;
<span class="lineNum">      54 </span><span class="lineCov">        116 : ClassImp(AliITSv11Geometry)</span>
<span class="lineNum">      55 </span>            : 
<span class="lineNum">      56 </span>            : const Double_t AliITSv11Geometry::fgkmicron = 1.0E-4;
<span class="lineNum">      57 </span>            : const Double_t AliITSv11Geometry::fgkmm = 0.10;
<span class="lineNum">      58 </span>            : const Double_t AliITSv11Geometry::fgkcm = 1.00;
<span class="lineNum">      59 </span>            : const Double_t AliITSv11Geometry::fgkDegree = 1.0;
<span class="lineNum">      60 </span>            : const Double_t AliITSv11Geometry::fgkRadian = 180./3.14159265358979323846;
<span class="lineNum">      61 </span>            : const Double_t AliITSv11Geometry::fgkgcm3 = 1.0; // assume default is g/cm^3
<span class="lineNum">      62 </span>            : const Double_t AliITSv11Geometry::fgkKgm3 = 1.0E+3;// assume Kg/m^3
<span class="lineNum">      63 </span>            : const Double_t AliITSv11Geometry::fgkKgdm3 = 1.0; // assume Kg/dm^3
<span class="lineNum">      64 </span>            : const Double_t AliITSv11Geometry::fgkCelsius = 1.0; // Assume default is C
<span class="lineNum">      65 </span>            : const Double_t AliITSv11Geometry::fgkPascal  = 1.0E-3; // Assume kPascal
<span class="lineNum">      66 </span>            : const Double_t AliITSv11Geometry::fgkKPascal = 1.0;    // Asume kPascal
<span class="lineNum">      67 </span>            : const Double_t AliITSv11Geometry::fgkeV      = 1.0E-9; // GeV default
<span class="lineNum">      68 </span>            : const Double_t AliITSv11Geometry::fgkKeV     = 1.0e-6; // GeV default
<span class="lineNum">      69 </span>            : const Double_t AliITSv11Geometry::fgkMeV     = 1.0e-3; // GeV default
<a name="70"><span class="lineNum">      70 </span>            : const Double_t AliITSv11Geometry::fgkGeV     = 1.0;    // GeV default</a>
<span class="lineNum">      71 </span>            : //______________________________________________________________________
<span class="lineNum">      72 </span>            : void AliITSv11Geometry::IntersectLines(Double_t m, Double_t x0, Double_t y0,
<span class="lineNum">      73 </span>            :                                        Double_t n, Double_t x1, Double_t y1,
<span class="lineNum">      74 </span>            :                                        Double_t &amp;xi, Double_t &amp;yi)const{
<span class="lineNum">      75 </span>            :     // Given the two lines, one passing by (x0,y0) with slope m and
<span class="lineNum">      76 </span>            :     // the other passing by (x1,y1) with slope n, returns the coordinates
<span class="lineNum">      77 </span>            :     // of the intersecting point (xi,yi)
<span class="lineNum">      78 </span>            :     // Inputs:
<span class="lineNum">      79 </span>            :     //    Double_t   m     The slope of the first line
<span class="lineNum">      80 </span>            :     //    Double_t  x0,y0  The x and y coord. of the first point
<span class="lineNum">      81 </span>            :     //    Double_t   n     The slope of the second line
<span class="lineNum">      82 </span>            :     //    Double_t  x1,y1  The x and y coord. of the second point
<span class="lineNum">      83 </span>            :     // Outputs:
<span class="lineNum">      84 </span>            :     //    The coordinates xi and yi of the intersection point
<span class="lineNum">      85 </span>            :     // Return:
<span class="lineNum">      86 </span>            :     //    none.
<span class="lineNum">      87 </span>            :     // Created:      14 Dec 2009  Mario Sitta
<span class="lineNum">      88 </span>            : 
<span class="lineNum">      89 </span><span class="lineCov">         28 :     if (TMath::Abs(m-n) &lt; 0.000001) {</span>
<span class="lineNum">      90 </span><span class="lineNoCov">          0 :       AliError(Form(&quot;Lines are parallel: m = %f n = %f\n&quot;,m,n));</span>
<span class="lineNum">      91 </span><span class="lineNoCov">          0 :       return;</span>
<span class="lineNum">      92 </span>            :     }
<span class="lineNum">      93 </span>            : 
<span class="lineNum">      94 </span><span class="lineCov">         14 :     xi = (y1 - n*x1 - y0 + m*x0)/(m - n);</span>
<span class="lineNum">      95 </span><span class="lineCov">         14 :     yi = y0 + m*(xi - x0);</span>
<span class="lineNum">      96 </span>            : 
<span class="lineNum">      97 </span><span class="lineCov">         14 :     return;</span>
<a name="98"><span class="lineNum">      98 </span><span class="lineCov">         14 : }</span></a>
<span class="lineNum">      99 </span>            : //______________________________________________________________________
<span class="lineNum">     100 </span>            : Bool_t AliITSv11Geometry::IntersectCircle(Double_t m, Double_t x0, Double_t y0,
<span class="lineNum">     101 </span>            :                                           Double_t rr, Double_t xc, Double_t yc,
<span class="lineNum">     102 </span>            :                                           Double_t &amp;xi1, Double_t &amp;yi1,
<span class="lineNum">     103 </span>            :                                           Double_t &amp;xi2, Double_t &amp;yi2){
<span class="lineNum">     104 </span>            :     // Given a lines  passing by (x0,y0) with slope m and a circle with
<span class="lineNum">     105 </span>            :     // radius rr and center (xc,yc), returns the coordinates of the
<span class="lineNum">     106 </span>            :     // intersecting points (xi1,yi1) and (xi2,yi2) (xi1 &gt; xi2)
<span class="lineNum">     107 </span>            :     // Inputs:
<span class="lineNum">     108 </span>            :     //    Double_t   m     The slope of the line
<span class="lineNum">     109 </span>            :     //    Double_t  x0,y0  The x and y coord. of the point
<span class="lineNum">     110 </span>            :     //    Double_t   rr     The radius of the circle
<span class="lineNum">     111 </span>            :     //    Double_t  xc,yc  The x and y coord. of the center of circle
<span class="lineNum">     112 </span>            :     // Outputs:
<span class="lineNum">     113 </span>            :     //    The coordinates xi and yi of the intersection points
<span class="lineNum">     114 </span>            :     // Return:
<span class="lineNum">     115 </span>            :     //    kFALSE if the line does not intercept the circle, otherwise kTRUE
<span class="lineNum">     116 </span>            :     // Created:      18 Dec 2009  Mario Sitta
<span class="lineNum">     117 </span>            : 
<span class="lineNum">     118 </span><span class="lineCov">          4 :     Double_t p = m*x0 - y0;</span>
<span class="lineNum">     119 </span><span class="lineCov">          2 :     Double_t q = m*m + 1;</span>
<span class="lineNum">     120 </span>            : 
<span class="lineNum">     121 </span><span class="lineCov">          2 :     p = p-m*xc+yc;</span>
<span class="lineNum">     122 </span>            : 
<span class="lineNum">     123 </span><span class="lineCov">          2 :     Double_t delta = m*m*p*p - q*(p*p - rr*rr);</span>
<span class="lineNum">     124 </span>            : 
<span class="lineNum">     125 </span><span class="lineCov">          2 :     if (delta &lt; 0)</span>
<span class="lineNum">     126 </span><span class="lineNoCov">          0 :       return kFALSE;</span>
<span class="lineNum">     127 </span>            :     else {
<span class="lineNum">     128 </span><span class="lineCov">          2 :       Double_t root = TMath::Sqrt(delta);</span>
<span class="lineNum">     129 </span><span class="lineCov">          2 :       xi1 = (m*p + root)/q + xc;</span>
<span class="lineNum">     130 </span><span class="lineCov">          2 :       xi2 = (m*p - root)/q + xc;</span>
<span class="lineNum">     131 </span><span class="lineCov">          2 :       yi1 = m*(xi1 - x0) + y0;</span>
<span class="lineNum">     132 </span><span class="lineCov">          2 :       yi2 = m*(xi2 - x0) + y0;</span>
<span class="lineNum">     133 </span>            :       return kTRUE;
<span class="lineNum">     134 </span>            :     }
<a name="135"><span class="lineNum">     135 </span><span class="lineCov">          2 : }</span></a>
<span class="lineNum">     136 </span>            : //______________________________________________________________________
<span class="lineNum">     137 </span>            : Double_t AliITSv11Geometry::Yfrom2Points(Double_t x0,Double_t y0,
<span class="lineNum">     138 </span>            :                                          Double_t x1,Double_t y1,
<span class="lineNum">     139 </span>            :                                          Double_t x)const{
<span class="lineNum">     140 </span>            :     // Given the two points (x0,y0) and (x1,y1) and the location x, returns
<span class="lineNum">     141 </span>            :     // the value y corresponding to that point x on the line defined by the
<span class="lineNum">     142 </span>            :     // two points.
<span class="lineNum">     143 </span>            :     // Inputs:
<span class="lineNum">     144 </span>            :     //    Double_t  x0  The first x value defining the line
<span class="lineNum">     145 </span>            :     //    Double_t  y0  The first y value defining the line
<span class="lineNum">     146 </span>            :     //    Double_t  x1  The second x value defining the line
<span class="lineNum">     147 </span>            :     //    Double_t  y1  The second y value defining the line
<span class="lineNum">     148 </span>            :     //    Double_t   x  The x value for which the y value is wanted.
<span class="lineNum">     149 </span>            :     // Outputs:
<span class="lineNum">     150 </span>            :     //    none.
<span class="lineNum">     151 </span>            :     // Return:
<span class="lineNum">     152 </span>            :     //    The value y corresponding to the point x on the line defined by
<span class="lineNum">     153 </span>            :     //    the two points (x0,y0) and (x1,y1).
<span class="lineNum">     154 </span>            : 
<span class="lineNum">     155 </span><span class="lineCov">         12 :     if(x0==x1 &amp;&amp; y0==y1) {</span>
<span class="lineNum">     156 </span><span class="lineNoCov">          0 :         printf(&quot;Error: AliITSv11Geometry::Yfrom2Ponts The two points are &quot;</span>
<span class="lineNum">     157 </span>            :                &quot;the same (%e,%e) and (%e,%e)&quot;,x0,y0,x1,y1);
<span class="lineNum">     158 </span><span class="lineNoCov">          0 :         return 0.0;</span>
<span class="lineNum">     159 </span>            :     } // end if
<span class="lineNum">     160 </span><span class="lineCov">          6 :     if(x0==x1){</span>
<span class="lineNum">     161 </span><span class="lineNoCov">          0 :         printf(&quot;Warning: AliITSv11Geometry::Yfrom2Points x0=%e == x1=%e. &quot;</span>
<span class="lineNum">     162 </span>            :                &quot;line vertical &quot;&quot;returning mean y&quot;,x0,x1);
<span class="lineNum">     163 </span><span class="lineNoCov">          0 :         return 0.5*(y0+y1);</span>
<span class="lineNum">     164 </span>            :     }// end if x0==x1
<span class="lineNum">     165 </span><span class="lineCov">          6 :     Double_t m = (y0-y1)/(x0-x1);</span>
<span class="lineNum">     166 </span><span class="lineCov">          6 :     return m*(x-x0)+y0;</span>
<a name="167"><span class="lineNum">     167 </span><span class="lineCov">          6 : }</span></a>
<span class="lineNum">     168 </span>            : //______________________________________________________________________
<span class="lineNum">     169 </span>            : Double_t AliITSv11Geometry::Xfrom2Points(Double_t x0,Double_t y0,
<span class="lineNum">     170 </span>            :                                          Double_t x1,Double_t y1,
<span class="lineNum">     171 </span>            :                                          Double_t y)const{
<span class="lineNum">     172 </span>            :     // Given the two points (x0,y0) and (x1,y1) and the location y, returns
<span class="lineNum">     173 </span>            :     // the value x corresponding to that point y on the line defined by the
<span class="lineNum">     174 </span>            :     // two points.
<span class="lineNum">     175 </span>            :     // Inputs:
<span class="lineNum">     176 </span>            :     //    Double_t  x0  The first x value defining the line
<span class="lineNum">     177 </span>            :     //    Double_t  y0  The first y value defining the line
<span class="lineNum">     178 </span>            :     //    Double_t  x1  The second x value defining the line
<span class="lineNum">     179 </span>            :     //    Double_t  y1  The second y value defining the line
<span class="lineNum">     180 </span>            :     //    Double_t   y  The y value for which the x value is wanted.
<span class="lineNum">     181 </span>            :     // Outputs:
<span class="lineNum">     182 </span>            :     //    none.
<span class="lineNum">     183 </span>            :     // Return:
<span class="lineNum">     184 </span>            :     //    The value x corresponding to the point y on the line defined by
<span class="lineNum">     185 </span>            :     //    the two points (x0,y0) and (x1,y1).
<span class="lineNum">     186 </span>            : 
<span class="lineNum">     187 </span><span class="lineCov">          2 :     if(x0==x1 &amp;&amp; y0==y1) {</span>
<span class="lineNum">     188 </span><span class="lineNoCov">          0 :         printf(&quot;Error: AliITSv11Geometry::Yfrom2Ponts The two points are &quot;</span>
<span class="lineNum">     189 </span>            :                &quot;the same (%e,%e) and (%e,%e)&quot;,x0,y0,x1,y1);
<span class="lineNum">     190 </span><span class="lineNoCov">          0 :         return 0.0;</span>
<span class="lineNum">     191 </span>            :     } // end if
<span class="lineNum">     192 </span><span class="lineCov">          1 :     if(y0==y1){</span>
<span class="lineNum">     193 </span><span class="lineNoCov">          0 :         printf(&quot;Warrning: AliITSv11Geometry::Yfrom2Points y0=%e == y1=%e. &quot;</span>
<span class="lineNum">     194 </span>            :                &quot;line horizontal returning mean x&quot;,y0,y1);
<span class="lineNum">     195 </span><span class="lineNoCov">          0 :         return 0.5*(x0+x1);</span>
<span class="lineNum">     196 </span>            :     }// end if y0==y1
<span class="lineNum">     197 </span><span class="lineCov">          1 :     Double_t m = (x0-x1)/(y0-y1);</span>
<span class="lineNum">     198 </span><span class="lineCov">          1 :     return m*(y-y0)+x0;</span>
<a name="199"><span class="lineNum">     199 </span><span class="lineCov">          1 : }</span></a>
<span class="lineNum">     200 </span>            : //______________________________________________________________________
<span class="lineNum">     201 </span>            : Double_t AliITSv11Geometry::RmaxFrom2Points(const TGeoPcon *p,Int_t i1,
<span class="lineNum">     202 </span>            :                                             Int_t i2,Double_t z)const{
<span class="lineNum">     203 </span>            :     // functions Require at parts of Volume A to be already defined.
<span class="lineNum">     204 </span>            :     // Retruns the value of Rmax corresponding to point z alone the line
<span class="lineNum">     205 </span>            :     // defined by the two points p.Rmax(i1),p-GetZ(i1) and p-&gt;GetRmax(i2),
<span class="lineNum">     206 </span>            :     // p-&gt;GetZ(i2).
<span class="lineNum">     207 </span>            :     // Inputs:
<span class="lineNum">     208 </span>            :     //    TGeoPcon *p  The Polycone where the two points come from
<span class="lineNum">     209 </span>            :     //    Int_t    i1  Point 1
<span class="lineNum">     210 </span>            :     //    Int_t    i2  Point 2
<span class="lineNum">     211 </span>            :     //    Double_t  z  The value of z for which Rmax is to be found
<span class="lineNum">     212 </span>            :     // Outputs:
<span class="lineNum">     213 </span>            :     //    none.
<span class="lineNum">     214 </span>            :     // Return:
<span class="lineNum">     215 </span>            :     //    Double_t Rmax the value corresponding to z
<span class="lineNum">     216 </span>            :     Double_t d0,d1,d2,r;
<span class="lineNum">     217 </span>            : 
<span class="lineNum">     218 </span><span class="lineCov">         10 :     d0 = p-&gt;GetRmax(i1)-p-&gt;GetRmax(i2);// cout &lt;&lt;&quot;L263: d0=&quot;&lt;&lt;d0&lt;&lt;endl;</span>
<span class="lineNum">     219 </span><span class="lineCov">          5 :     d1 = z-p-&gt;GetZ(i2);// cout &lt;&lt;&quot;L264: d1=&quot;&lt;&lt;d1&lt;&lt;endl;</span>
<span class="lineNum">     220 </span><span class="lineCov">          5 :     d2 = p-&gt;GetZ(i1)-p-&gt;GetZ(i2);// cout &lt;&lt;&quot;L265: d2=&quot;&lt;&lt;d2&lt;&lt;endl;</span>
<span class="lineNum">     221 </span><span class="lineCov">          5 :     r  = p-&gt;GetRmax(i2) + d1*d0/d2;// cout &lt;&lt;&quot;L266: r=&quot;&lt;&lt;r&lt;&lt;endl;</span>
<span class="lineNum">     222 </span><span class="lineCov">          5 :     return r;</span>
<a name="223"><span class="lineNum">     223 </span>            : }</a>
<span class="lineNum">     224 </span>            : //______________________________________________________________________
<span class="lineNum">     225 </span>            : Double_t AliITSv11Geometry::RminFrom2Points(const TGeoPcon *p,Int_t i1,
<span class="lineNum">     226 </span>            :                                             Int_t i2,Double_t z)const{
<span class="lineNum">     227 </span>            :     // Retruns the value of Rmin corresponding to point z alone the line
<span class="lineNum">     228 </span>            :     // defined by the two points p-&gt;GetRmin(i1),p-&gt;GetZ(i1) and 
<span class="lineNum">     229 </span>            :     // p-&gt;GetRmin(i2),  p-&gt;GetZ(i2).
<span class="lineNum">     230 </span>            :     // Inputs:
<span class="lineNum">     231 </span>            :     //    TGeoPcon *p  The Polycone where the two points come from
<span class="lineNum">     232 </span>            :     //    Int_t    i1  Point 1
<span class="lineNum">     233 </span>            :     //    Int_t    i2  Point 2
<span class="lineNum">     234 </span>            :     //    Double_t  z  The value of z for which Rmax is to be found
<span class="lineNum">     235 </span>            :     // Outputs:
<span class="lineNum">     236 </span>            :     //    none.
<span class="lineNum">     237 </span>            :     // Return:
<span class="lineNum">     238 </span>            :     //    Double_t Rmax the value corresponding to z
<span class="lineNum">     239 </span>            : 
<span class="lineNum">     240 </span><span class="lineCov">         15 :     return p-&gt;GetRmin(i2)+(p-&gt;GetRmin(i1)-p-&gt;GetRmin(i2))*(z-p-&gt;GetZ(i2))/</span>
<span class="lineNum">     241 </span><span class="lineCov">          5 :      (p-&gt;GetZ(i1)-p-&gt;GetZ(i2));</span>
<a name="242"><span class="lineNum">     242 </span>            : }</a>
<span class="lineNum">     243 </span>            : //______________________________________________________________________
<span class="lineNum">     244 </span>            : Double_t AliITSv11Geometry::RFrom2Points(const Double_t *p,const Double_t *az,
<span class="lineNum">     245 </span>            :                                          Int_t i1,Int_t i2,Double_t z)const{
<span class="lineNum">     246 </span>            :     // Retruns the value of Rmin corresponding to point z alone the line
<span class="lineNum">     247 </span>            :     // defined by the two points p-&gt;GetRmin(i1),p-&gt;GetZ(i1) and 
<span class="lineNum">     248 </span>            :     // p-&gt;GetRmin(i2), p-&gt;GetZ(i2).
<span class="lineNum">     249 </span>            :     // Inputs:
<span class="lineNum">     250 </span>            :     //    Double_t az  Array of z values
<span class="lineNum">     251 </span>            :     //    Double_t  r  Array of r values
<span class="lineNum">     252 </span>            :     //    Int_t    i1  First Point in arrays
<span class="lineNum">     253 </span>            :     //    Int_t    i2  Second Point in arrays
<span class="lineNum">     254 </span>            :     //    Double_t z   Value z at which r is to be found
<span class="lineNum">     255 </span>            :     // Outputs:
<span class="lineNum">     256 </span>            :     //    none.
<span class="lineNum">     257 </span>            :     // Return:
<span class="lineNum">     258 </span>            :     //    The value r corresponding to z and the line defined by the two points
<span class="lineNum">     259 </span>            : 
<span class="lineNum">     260 </span><span class="lineNoCov">          0 :     return p[i2]+(p[i1]-p[i2])*(z-az[i2])/(az[i1]-az[i2]);</span>
<a name="261"><span class="lineNum">     261 </span>            : }</a>
<span class="lineNum">     262 </span>            : //______________________________________________________________________
<span class="lineNum">     263 </span>            : Double_t AliITSv11Geometry::Zfrom2MinPoints(const TGeoPcon *p,Int_t i1,
<span class="lineNum">     264 </span>            :                                             Int_t i2,Double_t r)const{
<span class="lineNum">     265 </span>            :     // Retruns the value of Z corresponding to point R alone the line
<span class="lineNum">     266 </span>            :     // defined by the two points p-&gt;GetRmin(i1),p-&gt;GetZ(i1) and 
<span class="lineNum">     267 </span>            :     // p-&gt;GetRmin(i2),p-&gt;GetZ(i2)
<span class="lineNum">     268 </span>            :     // Inputs:
<span class="lineNum">     269 </span>            :     //    TGeoPcon *p  The Poly cone where the two points come from.
<span class="lineNum">     270 </span>            :     //    Int_t    i1  First Point in arrays
<span class="lineNum">     271 </span>            :     //    Int_t    i2  Second Point in arrays
<span class="lineNum">     272 </span>            :     //    Double_t r   Value r min at which z is to be found
<span class="lineNum">     273 </span>            :     // Outputs:
<span class="lineNum">     274 </span>            :     //    none.
<span class="lineNum">     275 </span>            :     // Return:
<span class="lineNum">     276 </span>            :     //    The value z corresponding to r min and the line defined by 
<span class="lineNum">     277 </span>            :     //    the two points
<span class="lineNum">     278 </span>            : 
<span class="lineNum">     279 </span><span class="lineNoCov">          0 :     return p-&gt;GetZ(i2)+(p-&gt;GetZ(i1)-p-&gt;GetZ(i2))*(r-p-&gt;GetRmin(i2))/</span>
<span class="lineNum">     280 </span><span class="lineNoCov">          0 :      (p-&gt;GetRmin(i1)-p-&gt;GetRmin(i2));</span>
<a name="281"><span class="lineNum">     281 </span>            : }</a>
<span class="lineNum">     282 </span>            : //______________________________________________________________________
<span class="lineNum">     283 </span>            : Double_t AliITSv11Geometry::Zfrom2MaxPoints(const TGeoPcon *p,Int_t i1,
<span class="lineNum">     284 </span>            :                                             Int_t i2,Double_t r)const{
<span class="lineNum">     285 </span>            :     // Retruns the value of Z corresponding to point R alone the line
<span class="lineNum">     286 </span>            :     // defined by the two points p-&gt;GetRmax(i1),p-&gt;GetZ(i1) and 
<span class="lineNum">     287 </span>            :     // p-&gt;GetRmax(i2),p-&gt;GetZ(i2)
<span class="lineNum">     288 </span>            :     // Inputs:
<span class="lineNum">     289 </span>            :     //    TGeoPcon *p  The Poly cone where the two points come from.
<span class="lineNum">     290 </span>            :     //    Int_t    i1  First Point in arrays
<span class="lineNum">     291 </span>            :     //    Int_t    i2  Second Point in arrays
<span class="lineNum">     292 </span>            :     //    Double_t r   Value r max at which z is to be found
<span class="lineNum">     293 </span>            :     // Outputs:
<span class="lineNum">     294 </span>            :     //    none.
<span class="lineNum">     295 </span>            :     // Return:
<span class="lineNum">     296 </span>            :     //    The value z corresponding to r max and the line defined by 
<span class="lineNum">     297 </span>            :     //    the two points
<span class="lineNum">     298 </span>            : 
<span class="lineNum">     299 </span><span class="lineNoCov">          0 :     return p-&gt;GetZ(i2)+(p-&gt;GetZ(i1)-p-&gt;GetZ(i2))*(r-p-&gt;GetRmax(i2))/</span>
<span class="lineNum">     300 </span><span class="lineNoCov">          0 :      (p-&gt;GetRmax(i1)-p-&gt;GetRmax(i2));</span>
<a name="301"><span class="lineNum">     301 </span>            : }</a>
<span class="lineNum">     302 </span>            : //______________________________________________________________________
<span class="lineNum">     303 </span>            : Double_t AliITSv11Geometry::Zfrom2Points(const Double_t *z,const Double_t *ar,
<span class="lineNum">     304 </span>            :                                          Int_t i1,Int_t i2,Double_t r)const{
<span class="lineNum">     305 </span>            :     // Retruns the value of z corresponding to point R alone the line
<span class="lineNum">     306 </span>            :     // defined by the two points p-&gt;GetRmax(i1),p-&gt;GetZ(i1) and 
<span class="lineNum">     307 </span>            :     // p-&gt;GetRmax(i2),p-&gt;GetZ(i2)
<span class="lineNum">     308 </span>            :     // Inputs:
<span class="lineNum">     309 </span>            :     //    Double_t  z  Array of z values
<span class="lineNum">     310 </span>            :     //    Double_t ar  Array of r values
<span class="lineNum">     311 </span>            :     //    Int_t    i1  First Point in arrays
<span class="lineNum">     312 </span>            :     //    Int_t    i2  Second Point in arrays
<span class="lineNum">     313 </span>            :     //    Double_t r   Value r at which z is to be found
<span class="lineNum">     314 </span>            :     // Outputs:
<span class="lineNum">     315 </span>            :     //    none.
<span class="lineNum">     316 </span>            :     // Return:
<span class="lineNum">     317 </span>            :     //    The value z corresponding to r and the line defined by the two points
<span class="lineNum">     318 </span>            : 
<span class="lineNum">     319 </span><span class="lineNoCov">          0 :     return z[i2]+(z[i1]-z[i2])*(r-ar[i2])/(ar[i1]-ar[i2]);</span>
<a name="320"><span class="lineNum">     320 </span>            : }</a>
<span class="lineNum">     321 </span>            : //______________________________________________________________________
<span class="lineNum">     322 </span>            : Double_t AliITSv11Geometry::RmaxFromZpCone(const TGeoPcon *p,int ip,
<span class="lineNum">     323 </span>            :                                            Double_t tc,Double_t z,
<span class="lineNum">     324 </span>            :                                            Double_t th)const{
<span class="lineNum">     325 </span>            :     // General Outer Cone surface equation Rmax.
<span class="lineNum">     326 </span>            :     // Intputs:
<span class="lineNum">     327 </span>            :     //     TGeoPcon  *p   The poly cone where the initial point comes from
<span class="lineNum">     328 </span>            :     //     Int_t     ip   The index in p to get the point location
<span class="lineNum">     329 </span>            :     //     Double_t  tc   The angle of that part of the cone is at
<span class="lineNum">     330 </span>            :     //     Double_t   z   The value of z to compute Rmax from
<span class="lineNum">     331 </span>            :     //     Double_t  th   The perpendicular distance the parralell line is
<span class="lineNum">     332 </span>            :     //                    from the point ip.
<span class="lineNum">     333 </span>            :     // Outputs:
<span class="lineNum">     334 </span>            :     //     none.
<span class="lineNum">     335 </span>            :     // Return:
<span class="lineNum">     336 </span>            :     //     The value Rmax correstponding to the line at angle th, offeset by
<span class="lineNum">     337 </span>            :     //     th, and the point p-&gt;GetZ/Rmin[ip] at the location z.
<span class="lineNum">     338 </span><span class="lineCov">         50 :     Double_t tantc = TMath::Tan(tc*TMath::DegToRad());</span>
<span class="lineNum">     339 </span><span class="lineCov">         25 :     Double_t costc = TMath::Cos(tc*TMath::DegToRad());</span>
<span class="lineNum">     340 </span>            : 
<span class="lineNum">     341 </span><span class="lineCov">         25 :     return -tantc*(z-p-&gt;GetZ(ip))+p-&gt;GetRmax(ip)+th/costc;</span>
<a name="342"><span class="lineNum">     342 </span>            : }</a>
<span class="lineNum">     343 </span>            : //______________________________________________________________________
<span class="lineNum">     344 </span>            : Double_t AliITSv11Geometry::RFromZpCone(const Double_t *ar,
<span class="lineNum">     345 </span>            :                                         const Double_t *az,int ip,
<span class="lineNum">     346 </span>            :                                         Double_t tc,Double_t z,
<span class="lineNum">     347 </span>            :                                         Double_t th)const{
<span class="lineNum">     348 </span>            :     // General Cone surface equation R(z).
<span class="lineNum">     349 </span>            :     // Intputs:
<span class="lineNum">     350 </span>            :     //     Double_t  ar   The array of R values
<span class="lineNum">     351 </span>            :     //     Double_t  az   The array of Z values
<span class="lineNum">     352 </span>            :     //     Int_t     ip   The index in p to get the point location
<span class="lineNum">     353 </span>            :     //     Double_t  tc   The angle of that part of the cone is at
<span class="lineNum">     354 </span>            :     //     Double_t   z   The value of z to compute R from
<span class="lineNum">     355 </span>            :     //     Double_t  th   The perpendicular distance the parralell line is
<span class="lineNum">     356 </span>            :     //                    from the point ip.
<span class="lineNum">     357 </span>            :     // Outputs:
<span class="lineNum">     358 </span>            :     //     none.
<span class="lineNum">     359 </span>            :     // Return:
<span class="lineNum">     360 </span>            :     //     The value R correstponding to the line at angle th, offeset by
<span class="lineNum">     361 </span>            :     //     th, and the point p-&gt;GetZ/Rmax[ip] at the locatin z.
<span class="lineNum">     362 </span><span class="lineNoCov">          0 :     Double_t tantc = TMath::Tan(tc*TMath::DegToRad());</span>
<span class="lineNum">     363 </span><span class="lineNoCov">          0 :     Double_t costc = TMath::Cos(tc*TMath::DegToRad());</span>
<span class="lineNum">     364 </span>            : 
<span class="lineNum">     365 </span><span class="lineNoCov">          0 :     return -tantc*(z-az[ip])+ar[ip]+th/costc;</span>
<a name="366"><span class="lineNum">     366 </span>            : }</a>
<span class="lineNum">     367 </span>            : //______________________________________________________________________
<span class="lineNum">     368 </span>            : Double_t AliITSv11Geometry::RminFromZpCone(const TGeoPcon *p,Int_t ip,
<span class="lineNum">     369 </span>            :                                            Double_t tc,Double_t z,
<span class="lineNum">     370 </span>            :                                            Double_t th)const{
<span class="lineNum">     371 </span>            :     // General Inner Cone surface equation Rmin.
<span class="lineNum">     372 </span>            :     // Intputs:
<span class="lineNum">     373 </span>            :     //     TGeoPcon  *p   The poly cone where the initial point comes from
<span class="lineNum">     374 </span>            :     //     Int_t     ip   The index in p to get the point location
<span class="lineNum">     375 </span>            :     //     Double_t  tc   The angle of that part of the cone is at
<span class="lineNum">     376 </span>            :     //     Double_t   z   The value of z to compute Rmin from
<span class="lineNum">     377 </span>            :     //     Double_t  th   The perpendicular distance the parralell line is
<span class="lineNum">     378 </span>            :     //                    from the point ip.
<span class="lineNum">     379 </span>            :     // Outputs:
<span class="lineNum">     380 </span>            :     //     none.
<span class="lineNum">     381 </span>            :     // Return:
<span class="lineNum">     382 </span>            :     //     The value Rmin correstponding to the line at angle th, offeset by
<span class="lineNum">     383 </span>            :     //     th, and the point p-&gt;GetZ/Rmin[ip] at the location z.
<span class="lineNum">     384 </span><span class="lineCov">         44 :     Double_t tantc = TMath::Tan(tc*TMath::DegToRad());</span>
<span class="lineNum">     385 </span><span class="lineCov">         22 :     Double_t costc = TMath::Cos(tc*TMath::DegToRad());</span>
<span class="lineNum">     386 </span>            : 
<span class="lineNum">     387 </span><span class="lineCov">         22 :     return -tantc*(z-p-&gt;GetZ(ip))+p-&gt;GetRmin(ip)+th/costc;</span>
<a name="388"><span class="lineNum">     388 </span>            : }</a>
<span class="lineNum">     389 </span>            : //______________________________________________________________________
<span class="lineNum">     390 </span>            : Double_t AliITSv11Geometry::ZFromRmaxpCone(const TGeoPcon *p,int ip,
<span class="lineNum">     391 </span>            :                                            Double_t tc,Double_t r,
<span class="lineNum">     392 </span>            :                                            Double_t th)const{
<span class="lineNum">     393 </span>            :     // General Outer cone Surface equation for z.
<span class="lineNum">     394 </span>            :     // Intputs:
<span class="lineNum">     395 </span>            :     //     TGeoPcon  *p   The poly cone where the initial point comes from
<span class="lineNum">     396 </span>            :     //     Int_t     ip   The index in p to get the point location
<span class="lineNum">     397 </span>            :     //     Double_t  tc   The angle of that part of the cone is at
<span class="lineNum">     398 </span>            :     //     Double_t   r   The value of Rmax to compute z from
<span class="lineNum">     399 </span>            :     //     Double_t  th   The perpendicular distance the parralell line is
<span class="lineNum">     400 </span>            :     //                    from the point ip.
<span class="lineNum">     401 </span>            :     // Outputs:
<span class="lineNum">     402 </span>            :     //     none.
<span class="lineNum">     403 </span>            :     // Return:
<span class="lineNum">     404 </span>            :     //     The value Z correstponding to the line at angle th, offeset by
<span class="lineNum">     405 </span>            :     //     th, and the point p-&gt;GetZ/Rmax[ip] at the location r.
<span class="lineNum">     406 </span><span class="lineCov">         74 :     Double_t tantc = TMath::Tan(tc*TMath::DegToRad());</span>
<span class="lineNum">     407 </span><span class="lineCov">         37 :     Double_t costc = TMath::Cos(tc*TMath::DegToRad());</span>
<span class="lineNum">     408 </span>            : 
<span class="lineNum">     409 </span><span class="lineCov">         37 :     return p-&gt;GetZ(ip)+(p-&gt;GetRmax(ip)+th/costc-r)/tantc;</span>
<a name="410"><span class="lineNum">     410 </span>            : }</a>
<span class="lineNum">     411 </span>            : //______________________________________________________________________
<span class="lineNum">     412 </span>            : Double_t AliITSv11Geometry::ZFromRmaxpCone(const Double_t *ar,
<span class="lineNum">     413 </span>            :                                            const Double_t *az,int ip,
<span class="lineNum">     414 </span>            :                                            Double_t tc,Double_t r,
<span class="lineNum">     415 </span>            :                                            Double_t th)const{
<span class="lineNum">     416 </span>            :     // General Outer cone Surface equation for z.
<span class="lineNum">     417 </span>            :     // Intputs:
<span class="lineNum">     418 </span>            :     //     Double_t  ar   The array of R values
<span class="lineNum">     419 </span>            :     //     Double_t  az   The array of Z values
<span class="lineNum">     420 </span>            :     //     Int_t     ip   The index in p to get the point location
<span class="lineNum">     421 </span>            :     //     Double_t  tc   The angle of that part of the cone is at
<span class="lineNum">     422 </span>            :     //     Double_t   r   The value of Rmax to compute z from
<span class="lineNum">     423 </span>            :     //     Double_t  th   The perpendicular distance the parralell line is
<span class="lineNum">     424 </span>            :     //                    from the point ip.
<span class="lineNum">     425 </span>            :     // Outputs:
<span class="lineNum">     426 </span>            :     //     none.
<span class="lineNum">     427 </span>            :     // Return:
<span class="lineNum">     428 </span>            :     //     The value Z correstponding to the line at angle th, offeset by
<span class="lineNum">     429 </span>            :     //     th, and the point p-&gt;GetZ/Rmax[ip] at the locatin r.
<span class="lineNum">     430 </span><span class="lineNoCov">          0 :     Double_t tantc = TMath::Tan(tc*TMath::DegToRad());</span>
<span class="lineNum">     431 </span><span class="lineNoCov">          0 :     Double_t costc = TMath::Cos(tc*TMath::DegToRad());</span>
<span class="lineNum">     432 </span>            : 
<span class="lineNum">     433 </span><span class="lineNoCov">          0 :     return az[ip]+(ar[ip]+th/costc-r)/tantc;</span>
<a name="434"><span class="lineNum">     434 </span>            : }</a>
<span class="lineNum">     435 </span>            : //______________________________________________________________________
<span class="lineNum">     436 </span>            : Double_t AliITSv11Geometry::ZFromRminpCone(const TGeoPcon *p,int ip,
<span class="lineNum">     437 </span>            :                                            Double_t tc,Double_t r,
<span class="lineNum">     438 </span>            :                                            Double_t th)const{
<span class="lineNum">     439 </span>            :     // General Inner cone Surface equation for z.
<span class="lineNum">     440 </span>            :     // Intputs:
<span class="lineNum">     441 </span>            :     //     TGeoPcon  *p   The poly cone where the initial point comes from
<span class="lineNum">     442 </span>            :     //     Int_t     ip   The index in p to get the point location
<span class="lineNum">     443 </span>            :     //     Double_t  tc   The angle of that part of the cone is at
<span class="lineNum">     444 </span>            :     //     Double_t   r   The value of Rmin to compute z from
<span class="lineNum">     445 </span>            :     //     Double_t  th   The perpendicular distance the parralell line is
<span class="lineNum">     446 </span>            :     //                    from the point ip.
<span class="lineNum">     447 </span>            :     // Outputs:
<span class="lineNum">     448 </span>            :     //     none.
<span class="lineNum">     449 </span>            :     // Return:
<span class="lineNum">     450 </span>            :     //     The value Z correstponding to the line at angle th, offeset by
<span class="lineNum">     451 </span>            :     //     th, and the point p-&gt;GetZ/Rmin[ip] at the location r.
<span class="lineNum">     452 </span><span class="lineCov">         74 :     Double_t tantc = TMath::Tan(tc*TMath::DegToRad());</span>
<span class="lineNum">     453 </span><span class="lineCov">         37 :     Double_t costc = TMath::Cos(tc*TMath::DegToRad());</span>
<span class="lineNum">     454 </span>            : 
<span class="lineNum">     455 </span><span class="lineCov">         37 :     return p-&gt;GetZ(ip)+(p-&gt;GetRmin(ip)+th/costc-r)/tantc;</span>
<a name="456"><span class="lineNum">     456 </span>            : }</a>
<span class="lineNum">     457 </span>            : //______________________________________________________________________
<span class="lineNum">     458 </span>            : void AliITSv11Geometry::RadiusOfCurvature(Double_t rc,Double_t theta0,
<span class="lineNum">     459 </span>            :                                           Double_t z0,Double_t r0,
<span class="lineNum">     460 </span>            :                                           Double_t theta1,Double_t &amp;z1,
<span class="lineNum">     461 </span>            :                                           Double_t &amp;r1)const{
<span class="lineNum">     462 </span>            :     // Given a initial point z0,r0, the initial angle theta0, and the radius
<span class="lineNum">     463 </span>            :     // of curvature, returns the point z1, r1 at the angle theta1. Theta
<span class="lineNum">     464 </span>            :     // measured from the r axis in the clock wise direction [degrees].
<span class="lineNum">     465 </span>            :     // Inputs:
<span class="lineNum">     466 </span>            :     //    Double_t rc     The radius of curvature
<span class="lineNum">     467 </span>            :     //    Double_t theta0 The starting angle (degrees)
<span class="lineNum">     468 </span>            :     //    Double_t z0     The value of z at theta0
<span class="lineNum">     469 </span>            :     //    Double_t r0     The value of r at theta0
<span class="lineNum">     470 </span>            :     //    Double_t theta1 The ending angle (degrees)
<span class="lineNum">     471 </span>            :     // Outputs:
<span class="lineNum">     472 </span>            :     //    Double_t &amp;z1  The value of z at theta1
<span class="lineNum">     473 </span>            :     //    Double_t &amp;r1  The value of r at theta1
<span class="lineNum">     474 </span>            :     // Return:
<span class="lineNum">     475 </span>            :     //    none.
<span class="lineNum">     476 </span>            : 
<span class="lineNum">     477 </span><span class="lineCov">         16 :     z1 = rc*(TMath::Sin(theta1*TMath::DegToRad())-TMath::Sin(theta0*TMath::DegToRad()))+z0;</span>
<span class="lineNum">     478 </span><span class="lineCov">          8 :     r1 = rc*(TMath::Cos(theta1*TMath::DegToRad())-TMath::Cos(theta0*TMath::DegToRad()))+r0;</span>
<span class="lineNum">     479 </span><span class="lineCov">          8 :     return;</span>
<a name="480"><span class="lineNum">     480 </span>            : }</a>
<span class="lineNum">     481 </span>            : //______________________________________________________________________
<span class="lineNum">     482 </span>            : void AliITSv11Geometry::InsidePoint(const TGeoPcon *p,Int_t i1,Int_t i2,
<span class="lineNum">     483 </span>            :                                     Int_t i3,Double_t c,TGeoPcon *q,Int_t j1,
<span class="lineNum">     484 </span>            :                                     Bool_t max)const{
<span class="lineNum">     485 </span>            :     // Given two lines defined by the points i1, i2,i3 in the TGeoPcon 
<span class="lineNum">     486 </span>            :     // class p that intersect at point p-&gt;GetZ(i2) return the point z,r 
<span class="lineNum">     487 </span>            :     // that is Cthick away in the TGeoPcon class q. If points i1=i2
<span class="lineNum">     488 </span>            :     // and max == kTRUE, then p-&gt;GetRmin(i1) and p-&gt;GetRmax(i2) are used.
<span class="lineNum">     489 </span>            :     // if points i2=i3 and max=kTRUE then points p-&gt;GetRmax(i2) and
<span class="lineNum">     490 </span>            :     // p-&gt;GetRmin(i3) are used. If i2=i3 and max=kFALSE, then p-&gt;GetRmin(i2)
<span class="lineNum">     491 </span>            :     // and p-&gt;GetRmax(i3) are used.
<span class="lineNum">     492 </span>            :     // Inputs:
<span class="lineNum">     493 </span>            :     //    TGeoPcon  *p  Class where points i1, i2, and i3 are taken from
<span class="lineNum">     494 </span>            :     //    Int_t     i1  First point in class p
<span class="lineNum">     495 </span>            :     //    Int_t     i2  Second point in class p
<span class="lineNum">     496 </span>            :     //    Int_t     i3  Third point in class p
<span class="lineNum">     497 </span>            :     //    Double_t  c   Distance inside the outer surface/inner suface
<span class="lineNum">     498 </span>            :     //                  that the point j1 is to be computed for.
<span class="lineNum">     499 </span>            :     //    TGeoPcon  *q  Pointer to class for results to be put into.
<span class="lineNum">     500 </span>            :     //    Int_t     j1  Point in class q where data is to be stored.
<span class="lineNum">     501 </span>            :     //    Bool_t    max if kTRUE, then a Rmax value is computed,
<span class="lineNum">     502 </span>            :     //                  else a Rmin valule is computed.
<span class="lineNum">     503 </span>            :     // Output:
<span class="lineNum">     504 </span>            :     //    TGeoPcon  *q  Pointer to class for results to be put into.
<span class="lineNum">     505 </span>            :     // Return:
<span class="lineNum">     506 </span>            :     //    none.
<span class="lineNum">     507 </span><span class="lineNoCov">          0 :     Double_t x0,y0,x1,y1,x2,y2,x,y;</span>
<span class="lineNum">     508 </span>            : 
<span class="lineNum">     509 </span><span class="lineNoCov">          0 :     if(max){</span>
<span class="lineNum">     510 </span><span class="lineNoCov">          0 :         c = -c; //cout &lt;&lt;&quot;L394 c=&quot;&lt;&lt;c&lt;&lt;endl;</span>
<span class="lineNum">     511 </span><span class="lineNoCov">          0 :         y0 = p-&gt;GetRmax(i1);</span>
<span class="lineNum">     512 </span><span class="lineNoCov">          0 :         if(i1==i2) y0 = p-&gt;GetRmin(i1); //cout &lt;&lt;&quot;L396 y0=&quot;&lt;&lt;y0&lt;&lt;endl;</span>
<span class="lineNum">     513 </span><span class="lineNoCov">          0 :         y1 = p-&gt;GetRmax(i2);  //cout &lt;&lt;&quot;L397 y1=&quot;&lt;&lt;y1&lt;&lt;endl;</span>
<span class="lineNum">     514 </span><span class="lineNoCov">          0 :         y2 = p-&gt;GetRmax(i3); //cout &lt;&lt;&quot;L398 y2=&quot;&lt;&lt;y2&lt;&lt;endl;</span>
<span class="lineNum">     515 </span><span class="lineNoCov">          0 :         if(i2==i3) y2 = p-&gt;GetRmin(i3); //cout &lt;&lt;&quot;L399 y2=&quot;&lt;&lt;y2&lt;&lt;endl;</span>
<span class="lineNum">     516 </span>            :     }else{ // min
<span class="lineNum">     517 </span><span class="lineNoCov">          0 :         y0 = p-&gt;GetRmin(i1); //cout &lt;&lt;&quot;L401 y0=&quot;&lt;&lt;y0&lt;&lt;endl;</span>
<span class="lineNum">     518 </span><span class="lineNoCov">          0 :         y1 = p-&gt;GetRmin(i2); //cout &lt;&lt;&quot;L402 y1=&quot;&lt;&lt;y1&lt;&lt;endl;</span>
<span class="lineNum">     519 </span><span class="lineNoCov">          0 :         y2 = p-&gt;GetRmin(i3);</span>
<span class="lineNum">     520 </span><span class="lineNoCov">          0 :         if(i2==i3) y2 = p-&gt;GetRmax(i3); //cout &lt;&lt;&quot;L404 y2=&quot;&lt;&lt;y2&lt;&lt;endl;</span>
<span class="lineNum">     521 </span>            :     } // end if
<span class="lineNum">     522 </span><span class="lineNoCov">          0 :     x0 = p-&gt;GetZ(i1); //cout &lt;&lt;&quot;L406 x0=&quot;&lt;&lt;x0&lt;&lt;endl;</span>
<span class="lineNum">     523 </span><span class="lineNoCov">          0 :     x1 = p-&gt;GetZ(i2); //cout &lt;&lt;&quot;L407 x1=&quot;&lt;&lt;x1&lt;&lt;endl;</span>
<span class="lineNum">     524 </span><span class="lineNoCov">          0 :     x2 = p-&gt;GetZ(i3); //cout &lt;&lt;&quot;L408 x2=&quot;&lt;&lt;x2&lt;&lt;endl;</span>
<span class="lineNum">     525 </span>            :     //
<span class="lineNum">     526 </span><span class="lineNoCov">          0 :     InsidePoint(x0,y0,x1,y1,x2,y2,c,x,y);</span>
<span class="lineNum">     527 </span><span class="lineNoCov">          0 :     q-&gt;Z(j1) = x;</span>
<span class="lineNum">     528 </span><span class="lineNoCov">          0 :     if(max) q-&gt;Rmax(j1) = y;</span>
<span class="lineNum">     529 </span><span class="lineNoCov">          0 :     else    q-&gt;Rmin(j1) = y;</span>
<span class="lineNum">     530 </span>            :     return;
<a name="531"><span class="lineNum">     531 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     532 </span>            : //----------------------------------------------------------------------
<span class="lineNum">     533 </span>            : void AliITSv11Geometry::InsidePoint(Double_t x0,Double_t y0,
<span class="lineNum">     534 </span>            :                                     Double_t x1,Double_t y1,
<span class="lineNum">     535 </span>            :                                     Double_t x2,Double_t y2,Double_t c,
<span class="lineNum">     536 </span>            :                                     Double_t &amp;x,Double_t &amp;y)const{
<span class="lineNum">     537 </span>            :     // Given two intersecting lines defined by the points (x0,y0), (x1,y1) and
<span class="lineNum">     538 </span>            :     // (x1,y1), (x2,y2) {intersecting at (x1,y1)} the point (x,y) a distance
<span class="lineNum">     539 </span>            :     // c away is returned such that two lines a distance c away from the
<span class="lineNum">     540 </span>            :     // lines defined above intersect at (x,y).
<span class="lineNum">     541 </span>            :     // Inputs:
<span class="lineNum">     542 </span>            :     //    Double_t  x0 X point on the first intersecting sets of lines
<span class="lineNum">     543 </span>            :     //    Double_t  y0 Y point on the first intersecting sets of lines
<span class="lineNum">     544 </span>            :     //    Double_t  x1 X point on the first/second intersecting sets of lines
<span class="lineNum">     545 </span>            :     //    Double_t  y1 Y point on the first/second intersecting sets of lines
<span class="lineNum">     546 </span>            :     //    Double_t  x2 X point on the second intersecting sets of lines
<span class="lineNum">     547 </span>            :     //    Double_t  y2 Y point on the second intersecting sets of lines
<span class="lineNum">     548 </span>            :     //    Double_t  c  Distance the two sets of lines are from each other
<span class="lineNum">     549 </span>            :     // Output:
<span class="lineNum">     550 </span>            :     //    Double_t  x  X point for the intersecting sets of parellel lines
<span class="lineNum">     551 </span>            :     //    Double_t  y  Y point for the intersecting sets of parellel lines
<span class="lineNum">     552 </span>            :     // Return:
<span class="lineNum">     553 </span>            :     //    none.
<span class="lineNum">     554 </span>            :     Double_t dx01,dx12,dy01,dy12,r01,r12,m;
<span class="lineNum">     555 </span>            : 
<span class="lineNum">     556 </span>            :     //printf(&quot;InsidePoint: x0=% #12.7g y0=% #12.7g x1=% #12.7g y1=% #12.7g &quot;
<span class="lineNum">     557 </span>            :     //       &quot;x2=% #12.7g y2=% #12.7g c=% #12.7g &quot;,x0,y0,x1,y2,x2,y2,c);
<span class="lineNum">     558 </span><span class="lineCov">       4212 :     dx01 = x0-x1; //cout &lt;&lt;&quot;L410 dx01=&quot;&lt;&lt;dx01&lt;&lt;endl;</span>
<span class="lineNum">     559 </span><span class="lineCov">       2106 :     dx12 = x1-x2; //cout &lt;&lt;&quot;L411 dx12=&quot;&lt;&lt;dx12&lt;&lt;endl;</span>
<span class="lineNum">     560 </span><span class="lineCov">       2106 :     dy01 = y0-y1; //cout &lt;&lt;&quot;L412 dy01=&quot;&lt;&lt;dy01&lt;&lt;endl;</span>
<span class="lineNum">     561 </span><span class="lineCov">       2106 :     dy12 = y1-y2; //cout &lt;&lt;&quot;L413 dy12=&quot;&lt;&lt;dy12&lt;&lt;endl;</span>
<span class="lineNum">     562 </span><span class="lineCov">       2106 :     r01  = TMath::Sqrt(dy01*dy01+dx01*dx01); //cout &lt;&lt;&quot;L414 r01=&quot;&lt;&lt;r01&lt;&lt;endl;</span>
<span class="lineNum">     563 </span><span class="lineCov">       2106 :     r12  = TMath::Sqrt(dy12*dy12+dx12*dx12); //cout &lt;&lt;&quot;L415 r12=&quot;&lt;&lt;r12&lt;&lt;endl;</span>
<span class="lineNum">     564 </span><span class="lineCov">       2106 :     m = dx12*dy01-dy12*dx01;</span>
<span class="lineNum">     565 </span><span class="lineCov">       2106 :     if(m*m&lt;DBL_EPSILON){ // m == n</span>
<span class="lineNum">     566 </span><span class="lineCov">         60 :         if(dy01==0.0){ // line are =</span>
<span class="lineNum">     567 </span><span class="lineNoCov">          0 :             x = x1+c; //cout &lt;&lt;&quot;L419 x=&quot;&lt;&lt;x&lt;&lt;endl;</span>
<span class="lineNum">     568 </span><span class="lineNoCov">          0 :             y = y1; //cout &lt;&lt;&quot;L420 y=&quot;&lt;&lt;y&lt;&lt;endl;</span>
<span class="lineNum">     569 </span>            :             //printf(&quot;dy01==0.0 x=% #12.7g y=% #12.7g\n&quot;,x,y);
<span class="lineNum">     570 </span><span class="lineNoCov">          0 :             return;</span>
<span class="lineNum">     571 </span><span class="lineCov">         60 :         }else if(dx01==0.0){</span>
<span class="lineNum">     572 </span><span class="lineNoCov">          0 :             x = x1;</span>
<span class="lineNum">     573 </span><span class="lineNoCov">          0 :             y = y1+c;</span>
<span class="lineNum">     574 </span>            :             //printf(&quot;dx01==0.0 x=% #12.7g y=% #12.7g\n&quot;,x,y);
<span class="lineNum">     575 </span><span class="lineNoCov">          0 :             return;</span>
<span class="lineNum">     576 </span>            :         }else{ // dx01!=0 and dy01 !=0.
<span class="lineNum">     577 </span><span class="lineCov">         60 :             x = x1-0.5*c*r01/dy01; //cout &lt;&lt;&quot;L434 x=&quot;&lt;&lt;x&lt;&lt;endl;</span>
<span class="lineNum">     578 </span><span class="lineCov">         60 :             y = y1+0.5*c*r01/dx01; //cout &lt;&lt;&quot;L435 y=&quot;&lt;&lt;y&lt;&lt;endl;</span>
<span class="lineNum">     579 </span>            :             //printf(&quot;m*m&lt;DBL_E x=% #12.7g y=% #12.7g\n&quot;,x,y);
<span class="lineNum">     580 </span>            :         } // end if
<span class="lineNum">     581 </span><span class="lineCov">         60 :         return;</span>
<span class="lineNum">     582 </span>            :     } //
<span class="lineNum">     583 </span><span class="lineCov">       2046 :     x = x1+c*(dx12*r01-dx01*r12)/m; //cout &lt;&lt;&quot;L442 x=&quot;&lt;&lt;x&lt;&lt;endl;</span>
<span class="lineNum">     584 </span><span class="lineCov">       2046 :     y = y1+c*(dy12*r01-dy01*r12)/m; //cout &lt;&lt;&quot;L443 y=&quot;&lt;&lt;y&lt;&lt;endl;</span>
<span class="lineNum">     585 </span>            :     //printf(&quot;          x=% #12.7g y=% #12.7g\n&quot;,x,y);
<span class="lineNum">     586 </span>            :     //cout &lt;&lt;&quot;==============================================&quot;&lt;&lt;endl;
<span class="lineNum">     587 </span><span class="lineCov">       2046 :     return;</span>
<a name="588"><span class="lineNum">     588 </span><span class="lineCov">       2106 : }</span></a>
<span class="lineNum">     589 </span>            : //----------------------------------------------------------------------
<span class="lineNum">     590 </span>            : void AliITSv11Geometry:: PrintArb8(const TGeoArb8 *a)const{
<span class="lineNum">     591 </span>            :     // Prints out the content of the TGeoArb8. Usefull for debugging.
<span class="lineNum">     592 </span>            :     // Inputs:
<span class="lineNum">     593 </span>            :     //   TGeoArb8 *a
<span class="lineNum">     594 </span>            :     // Outputs:
<span class="lineNum">     595 </span>            :     //   none.
<span class="lineNum">     596 </span>            :     // Return:
<span class="lineNum">     597 </span>            :     //   none.
<span class="lineNum">     598 </span>            : 
<span class="lineNum">     599 </span><span class="lineNoCov">          0 :     if(!GetDebug()) return;</span>
<span class="lineNum">     600 </span><span class="lineNoCov">          0 :     printf(&quot;%s&quot;,a-&gt;GetName());</span>
<span class="lineNum">     601 </span><span class="lineNoCov">          0 :     a-&gt;InspectShape();</span>
<span class="lineNum">     602 </span><span class="lineNoCov">          0 :     return;</span>
<a name="603"><span class="lineNum">     603 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     604 </span>            : //----------------------------------------------------------------------
<span class="lineNum">     605 </span>            : void AliITSv11Geometry:: PrintPcon(const TGeoPcon *a)const{
<span class="lineNum">     606 </span>            :     // Prints out the content of the TGeoPcon. Usefull for debugging.
<span class="lineNum">     607 </span>            :     // Inputs:
<span class="lineNum">     608 </span>            :     //   TGeoPcon *a
<span class="lineNum">     609 </span>            :     // Outputs:
<span class="lineNum">     610 </span>            :     //   none.
<span class="lineNum">     611 </span>            :     // Return:
<span class="lineNum">     612 </span>            :     //   none.
<span class="lineNum">     613 </span>            :   
<span class="lineNum">     614 </span><span class="lineNoCov">          0 :     if(!GetDebug()) return;</span>
<span class="lineNum">     615 </span><span class="lineNoCov">          0 :     cout &lt;&lt; a-&gt;GetName() &lt;&lt; &quot;: N=&quot; &lt;&lt; a-&gt;GetNz() &lt;&lt; &quot; Phi1=&quot; &lt;&lt; a-&gt;GetPhi1()</span>
<span class="lineNum">     616 </span><span class="lineNoCov">          0 :          &lt;&lt; &quot;, Dphi=&quot; &lt;&lt; a-&gt;GetDphi() &lt;&lt; endl;</span>
<span class="lineNum">     617 </span><span class="lineNoCov">          0 :     cout &lt;&lt; &quot;i\t   Z   \t  Rmin \t  Rmax&quot; &lt;&lt; endl;</span>
<span class="lineNum">     618 </span><span class="lineNoCov">          0 :     for(Int_t iii=0;iii&lt;a-&gt;GetNz();iii++){</span>
<span class="lineNum">     619 </span><span class="lineNoCov">          0 :         cout &lt;&lt; iii &lt;&lt; &quot;\t&quot; &lt;&lt; a-&gt;GetZ(iii) &lt;&lt; &quot;\t&quot; &lt;&lt; a-&gt;GetRmin(iii)</span>
<span class="lineNum">     620 </span><span class="lineNoCov">          0 :              &lt;&lt; &quot;\t&quot; &lt;&lt; a-&gt;GetRmax(iii) &lt;&lt; endl;</span>
<span class="lineNum">     621 </span>            :     } // end for iii
<span class="lineNum">     622 </span><span class="lineNoCov">          0 :     return;</span>
<a name="623"><span class="lineNum">     623 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     624 </span>            : //----------------------------------------------------------------------
<span class="lineNum">     625 </span>            : void AliITSv11Geometry::PrintTube(const TGeoTube *a)const{
<span class="lineNum">     626 </span>            :     // Prints out the content of the TGeoTube. Usefull for debugging.
<span class="lineNum">     627 </span>            :     // Inputs:
<span class="lineNum">     628 </span>            :     //   TGeoTube *a
<span class="lineNum">     629 </span>            :     // Outputs:
<span class="lineNum">     630 </span>            :     //   none.
<span class="lineNum">     631 </span>            :     // Return:
<span class="lineNum">     632 </span>            :     //   none.
<span class="lineNum">     633 </span>            : 
<span class="lineNum">     634 </span><span class="lineNoCov">          0 :     if(!GetDebug()) return;</span>
<span class="lineNum">     635 </span><span class="lineNoCov">          0 :     cout &lt;&lt; a-&gt;GetName() &lt;&lt;&quot;: Rmin=&quot;&lt;&lt;a-&gt;GetRmin()</span>
<span class="lineNum">     636 </span><span class="lineNoCov">          0 :          &lt;&lt;&quot; Rmax=&quot; &lt;&lt;a-&gt;GetRmax()&lt;&lt;&quot; Dz=&quot;&lt;&lt;a-&gt;GetDz()&lt;&lt;endl;</span>
<span class="lineNum">     637 </span><span class="lineNoCov">          0 :     return;</span>
<a name="638"><span class="lineNum">     638 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     639 </span>            : //----------------------------------------------------------------------
<span class="lineNum">     640 </span>            : void AliITSv11Geometry::PrintTubeSeg(const TGeoTubeSeg *a)const{
<span class="lineNum">     641 </span>            :     // Prints out the content of the TGeoTubeSeg. Usefull for debugging.
<span class="lineNum">     642 </span>            :     // Inputs:
<span class="lineNum">     643 </span>            :     //   TGeoTubeSeg *a
<span class="lineNum">     644 </span>            :     // Outputs:
<span class="lineNum">     645 </span>            :     //   none.
<span class="lineNum">     646 </span>            :     // Return:
<span class="lineNum">     647 </span>            :     //   none.
<span class="lineNum">     648 </span>            : 
<span class="lineNum">     649 </span><span class="lineNoCov">          0 :     if(!GetDebug()) return;</span>
<span class="lineNum">     650 </span><span class="lineNoCov">          0 :     cout &lt;&lt; a-&gt;GetName() &lt;&lt;&quot;: Phi1=&quot;&lt;&lt;a-&gt;GetPhi1()&lt;&lt;</span>
<span class="lineNum">     651 </span><span class="lineNoCov">          0 :         &quot; Phi2=&quot;&lt;&lt;a-&gt;GetPhi2()&lt;&lt;&quot; Rmin=&quot;&lt;&lt;a-&gt;GetRmin()</span>
<span class="lineNum">     652 </span><span class="lineNoCov">          0 :          &lt;&lt;&quot; Rmax=&quot; &lt;&lt;a-&gt;GetRmax()&lt;&lt;&quot; Dz=&quot;&lt;&lt;a-&gt;GetDz()&lt;&lt;endl;</span>
<span class="lineNum">     653 </span><span class="lineNoCov">          0 :     return;</span>
<a name="654"><span class="lineNum">     654 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     655 </span>            : //----------------------------------------------------------------------
<span class="lineNum">     656 </span>            : void AliITSv11Geometry::PrintConeSeg(const TGeoConeSeg *a)const{
<span class="lineNum">     657 </span>            :     // Prints out the content of the TGeoConeSeg. Usefull for debugging.
<span class="lineNum">     658 </span>            :     // Inputs:
<span class="lineNum">     659 </span>            :     //   TGeoConeSeg *a
<span class="lineNum">     660 </span>            :     // Outputs:
<span class="lineNum">     661 </span>            :     //   none.
<span class="lineNum">     662 </span>            :     // Return:
<span class="lineNum">     663 </span>            :     //   none.
<span class="lineNum">     664 </span>            : 
<span class="lineNum">     665 </span><span class="lineNoCov">          0 :     if(!GetDebug()) return;</span>
<span class="lineNum">     666 </span><span class="lineNoCov">          0 :     cout &lt;&lt; a-&gt;GetName() &lt;&lt;&quot;: Phi1=&quot;&lt;&lt;a-&gt;GetPhi1()&lt;&lt;</span>
<span class="lineNum">     667 </span><span class="lineNoCov">          0 :         &quot; Phi2=&quot;&lt;&lt;a-&gt;GetPhi2()&lt;&lt;&quot; Rmin1=&quot;&lt;&lt;a-&gt;GetRmin1()</span>
<span class="lineNum">     668 </span><span class="lineNoCov">          0 :          &lt;&lt;&quot; Rmax1=&quot; &lt;&lt;a-&gt;GetRmax1()&lt;&lt;&quot; Rmin2=&quot;&lt;&lt;a-&gt;GetRmin2()</span>
<span class="lineNum">     669 </span><span class="lineNoCov">          0 :          &lt;&lt;&quot; Rmax2=&quot; &lt;&lt;a-&gt;GetRmax2()&lt;&lt;&quot; Dz=&quot;&lt;&lt;a-&gt;GetDz()&lt;&lt;endl;</span>
<span class="lineNum">     670 </span><span class="lineNoCov">          0 :     return;</span>
<a name="671"><span class="lineNum">     671 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     672 </span>            : //----------------------------------------------------------------------
<span class="lineNum">     673 </span>            : void AliITSv11Geometry::PrintBBox(const TGeoBBox *a)const{
<span class="lineNum">     674 </span>            :     // Prints out the content of the TGeoBBox. Usefull for debugging.
<span class="lineNum">     675 </span>            :     // Inputs:
<span class="lineNum">     676 </span>            :     //   TGeoBBox *a
<span class="lineNum">     677 </span>            :     // Outputs:
<span class="lineNum">     678 </span>            :     //   none.
<span class="lineNum">     679 </span>            :     // Return:
<span class="lineNum">     680 </span>            :     //   none.
<span class="lineNum">     681 </span>            : 
<span class="lineNum">     682 </span><span class="lineNoCov">          0 :     if(!GetDebug()) return;</span>
<span class="lineNum">     683 </span><span class="lineNoCov">          0 :     cout &lt;&lt; a-&gt;GetName() &lt;&lt;&quot;: Dx=&quot;&lt;&lt;a-&gt;GetDX()&lt;&lt;</span>
<span class="lineNum">     684 </span><span class="lineNoCov">          0 :         &quot; Dy=&quot;&lt;&lt;a-&gt;GetDY()&lt;&lt;&quot; Dz=&quot;&lt;&lt;a-&gt;GetDZ() &lt;&lt;endl;</span>
<span class="lineNum">     685 </span><span class="lineNoCov">          0 :     return;</span>
<a name="686"><span class="lineNum">     686 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     687 </span>            : //---------------------------------------------------------------------
<span class="lineNum">     688 </span>            : void AliITSv11Geometry::CreateDefaultMaterials(){
<span class="lineNum">     689 </span>            :     // Create ITS materials
<span class="lineNum">     690 </span>            :     // Defined media here should correspond to the one defined in galice.cuts
<span class="lineNum">     691 </span>            :     // File which is red in (AliMC*) fMCApp::Init() { ReadTransPar(); }
<span class="lineNum">     692 </span>            :     // Inputs:
<span class="lineNum">     693 </span>            :     //    none.
<span class="lineNum">     694 </span>            :     // Outputs:
<span class="lineNum">     695 </span>            :     //   none.
<span class="lineNum">     696 </span>            :     // Return:
<span class="lineNum">     697 </span>            :     //   none.
<span class="lineNum">     698 </span>            :     Int_t i;
<span class="lineNum">     699 </span>            :     Double_t w;
<span class="lineNum">     700 </span>            : 
<span class="lineNum">     701 </span>            :     // Define some elements
<span class="lineNum">     702 </span><span class="lineNoCov">          0 :     TGeoElement *itsH  = new TGeoElement(&quot;ITS_H&quot;,&quot;Hydrogen&quot;,1,1.00794);</span>
<span class="lineNum">     703 </span><span class="lineNoCov">          0 :     TGeoElement *itsHe = new TGeoElement(&quot;ITS_He&quot;,&quot;Helium&quot;,2,4.002602);</span>
<span class="lineNum">     704 </span><span class="lineNoCov">          0 :     TGeoElement *itsC  = new TGeoElement(&quot;ITS_C&quot;,&quot;Carbon&quot;,6,12.0107);</span>
<span class="lineNum">     705 </span><span class="lineNoCov">          0 :     TGeoElement *itsN  = new TGeoElement(&quot;ITS_N&quot;,&quot;Nitrogen&quot;,7,14.0067);</span>
<span class="lineNum">     706 </span><span class="lineNoCov">          0 :     TGeoElement *itsO  = new TGeoElement(&quot;ITS_O&quot;,&quot;Oxygen&quot;,8,15.994);</span>
<span class="lineNum">     707 </span><span class="lineNoCov">          0 :     TGeoElement *itsF  = new TGeoElement(&quot;ITS_F&quot;,&quot;Florine&quot;,9,18.9984032);</span>
<span class="lineNum">     708 </span><span class="lineNoCov">          0 :     TGeoElement *itsNe = new TGeoElement(&quot;ITS_Ne&quot;,&quot;Neon&quot;,10,20.1797);</span>
<span class="lineNum">     709 </span><span class="lineNoCov">          0 :     TGeoElement *itsMg = new TGeoElement(&quot;ITS_Mg&quot;,&quot;Magnesium&quot;,12,24.3050);</span>
<span class="lineNum">     710 </span><span class="lineNoCov">          0 :     TGeoElement *itsAl = new TGeoElement(&quot;ITS_Al&quot;,&quot;Aluminum&quot;,13,26981538);</span>
<span class="lineNum">     711 </span><span class="lineNoCov">          0 :     TGeoElement *itsSi = new TGeoElement(&quot;ITS_Si&quot;,&quot;Silicon&quot;,14,28.0855);</span>
<span class="lineNum">     712 </span><span class="lineNoCov">          0 :     TGeoElement *itsP  = new TGeoElement(&quot;ITS_P&quot; ,&quot;Phosphorous&quot;,15,30.973761);</span>
<span class="lineNum">     713 </span><span class="lineNoCov">          0 :     TGeoElement *itsS  = new TGeoElement(&quot;ITS_S&quot; ,&quot;Sulfur&quot;,16,32.065);</span>
<span class="lineNum">     714 </span><span class="lineNoCov">          0 :     TGeoElement *itsAr = new TGeoElement(&quot;ITS_Ar&quot;,&quot;Argon&quot;,18,39.948);</span>
<span class="lineNum">     715 </span><span class="lineNoCov">          0 :     TGeoElement *itsTi = new TGeoElement(&quot;ITS_Ti&quot;,&quot;Titanium&quot;,22,47.867);</span>
<span class="lineNum">     716 </span><span class="lineNoCov">          0 :     TGeoElement *itsCr = new TGeoElement(&quot;ITS_Cr&quot;,&quot;Chromium&quot;,24,51.9961);</span>
<span class="lineNum">     717 </span><span class="lineNoCov">          0 :     TGeoElement *itsMn = new TGeoElement(&quot;ITS_Mn&quot;,&quot;Manganese&quot;,25,54.938049);</span>
<span class="lineNum">     718 </span><span class="lineNoCov">          0 :     TGeoElement *itsFe = new TGeoElement(&quot;ITS_Fe&quot;,&quot;Iron&quot;,26,55.845);</span>
<span class="lineNum">     719 </span><span class="lineNoCov">          0 :     TGeoElement *itsCo = new TGeoElement(&quot;ITS_Co&quot;,&quot;Cobalt&quot;,27,58.933200);</span>
<span class="lineNum">     720 </span><span class="lineNoCov">          0 :     TGeoElement *itsNi = new TGeoElement(&quot;ITS_Ni&quot;,&quot;Nickrl&quot;,28,56.6930);</span>
<span class="lineNum">     721 </span><span class="lineNoCov">          0 :     TGeoElement *itsCu = new TGeoElement(&quot;ITS_Cu&quot;,&quot;Copper&quot;,29,63.546);</span>
<span class="lineNum">     722 </span><span class="lineNoCov">          0 :     TGeoElement *itsZn = new TGeoElement(&quot;ITS_Zn&quot;,&quot;Zinc&quot;,30,65.39);</span>
<span class="lineNum">     723 </span><span class="lineNoCov">          0 :     TGeoElement *itsKr = new TGeoElement(&quot;ITS_Kr&quot;,&quot;Krypton&quot;,36,83.80);</span>
<span class="lineNum">     724 </span><span class="lineNoCov">          0 :     TGeoElement *itsMo = new TGeoElement(&quot;ITS_Mo&quot;,&quot;Molylibdium&quot;,42,95.94);</span>
<span class="lineNum">     725 </span><span class="lineNoCov">          0 :     TGeoElement *itsXe = new TGeoElement(&quot;ITS_Xe&quot;,&quot;Zeon&quot;,54,131.293);</span>
<span class="lineNum">     726 </span>            : 
<span class="lineNum">     727 </span>            :     // Start with the Materials since for any one material there
<span class="lineNum">     728 </span>            :     // can be defined more than one Medium.
<span class="lineNum">     729 </span>            :     // Air, dry. at 15degree C, 101325Pa at sea-level, % by volume
<span class="lineNum">     730 </span>            :     // (% by weight). Density is 351 Kg/m^3
<span class="lineNum">     731 </span>            :     // N2 78.084% (75.47%), O2 20.9476% (23.20%), Ar 0.934 (1.28%)%,
<span class="lineNum">     732 </span>            :     // C02 0.0314% (0.0590%), Ne 0.001818% (0.0012%, CH4 0.002% (),
<span class="lineNum">     733 </span>            :     // He 0.000524% (0.00007%), Kr 0.000114% (0.0003%), H2 0.00005% (3.5E-6%), 
<span class="lineNum">     734 </span>            :     // Xe 0.0000087% (0.00004 %), H2O 0.0% (dry) + trace amounts at the ppm
<span class="lineNum">     735 </span>            :     // levels.
<span class="lineNum">     736 </span><span class="lineNoCov">          0 :     TGeoMixture *itsAir = new TGeoMixture(&quot;ITS_Air&quot;,9);</span>
<span class="lineNum">     737 </span>            :     w = 75.47E-2;
<span class="lineNum">     738 </span><span class="lineNoCov">          0 :     itsAir-&gt;AddElement(itsN,w);// Nitorgen, atomic</span>
<span class="lineNum">     739 </span>            :     w = 23.29E-2 + // O2
<span class="lineNum">     740 </span>            :          5.90E-4 * 2.*15.994/(12.0107+2.*15.994);// CO2.
<span class="lineNum">     741 </span><span class="lineNoCov">          0 :     itsAir-&gt;AddElement(itsO,w);// Oxygen, atomic</span>
<span class="lineNum">     742 </span>            :     w = 1.28E-2;
<span class="lineNum">     743 </span><span class="lineNoCov">          0 :     itsAir-&gt;AddElement(itsAr,w);// Argon, atomic</span>
<span class="lineNum">     744 </span>            :     w =  5.90E-4*12.0107/(12.0107+2.*15.994)+  // CO2
<span class="lineNum">     745 </span>            :          2.0E-5 *12.0107/(12.0107+4.* 1.00794);  // CH4
<span class="lineNum">     746 </span><span class="lineNoCov">          0 :     itsAir-&gt;AddElement(itsC,w);// Carbon, atomic</span>
<span class="lineNum">     747 </span>            :     w = 1.818E-5;
<span class="lineNum">     748 </span><span class="lineNoCov">          0 :     itsAir-&gt;AddElement(itsNe,w);// Ne, atomic</span>
<span class="lineNum">     749 </span>            :     w = 3.5E-8;
<span class="lineNum">     750 </span><span class="lineNoCov">          0 :     itsAir-&gt;AddElement(itsHe,w);// Helium, atomic</span>
<span class="lineNum">     751 </span>            :     w = 7.0E-7;
<span class="lineNum">     752 </span><span class="lineNoCov">          0 :     itsAir-&gt;AddElement(itsKr,w);// Krypton, atomic</span>
<span class="lineNum">     753 </span>            :     w = 3.0E-6;
<span class="lineNum">     754 </span><span class="lineNoCov">          0 :     itsAir-&gt;AddElement(itsH,w);// Hydrogen, atomic</span>
<span class="lineNum">     755 </span>            :     w = 4.0E-7;
<span class="lineNum">     756 </span><span class="lineNoCov">          0 :     itsAir-&gt;AddElement(itsXe,w);// Xenon, atomic</span>
<span class="lineNum">     757 </span><span class="lineNoCov">          0 :     itsAir-&gt;SetDensity(351.0*fgkKgm3); //</span>
<span class="lineNum">     758 </span><span class="lineNoCov">          0 :     itsAir-&gt;SetPressure(101325*fgkPascal);</span>
<span class="lineNum">     759 </span><span class="lineNoCov">          0 :     itsAir-&gt;SetTemperature(15.0*fgkCelsius);</span>
<span class="lineNum">     760 </span><span class="lineNoCov">          0 :     itsAir-&gt;SetState(TGeoMaterial::kMatStateGas);</span>
<span class="lineNum">     761 </span>            :     //
<span class="lineNum">     762 </span>            :     // Silicone
<span class="lineNum">     763 </span><span class="lineNoCov">          0 :     TGeoMaterial *itsSiDet = new TGeoMaterial(&quot;ITS_Si&quot;,itsSi,2.33*fgkgcm3);</span>
<span class="lineNum">     764 </span><span class="lineNoCov">          0 :     itsSiDet-&gt;SetTemperature(15.0*fgkCelsius);</span>
<span class="lineNum">     765 </span><span class="lineNoCov">          0 :     itsSiDet-&gt;SetState(TGeoMaterial::kMatStateSolid);</span>
<span class="lineNum">     766 </span>            :     //
<span class="lineNum">     767 </span>            :     // Epoxy C18 H19 O3
<span class="lineNum">     768 </span><span class="lineNoCov">          0 :     TGeoMixture *itsEpoxy = new TGeoMixture(&quot;ITS_Epoxy&quot;,3);</span>
<span class="lineNum">     769 </span><span class="lineNoCov">          0 :     itsEpoxy-&gt;AddElement(itsC,18);</span>
<span class="lineNum">     770 </span><span class="lineNoCov">          0 :     itsEpoxy-&gt;AddElement(itsH,19);</span>
<span class="lineNum">     771 </span><span class="lineNoCov">          0 :     itsEpoxy-&gt;AddElement(itsO,3);</span>
<span class="lineNum">     772 </span><span class="lineNoCov">          0 :     itsEpoxy-&gt;SetDensity(1.8*fgkgcm3);</span>
<span class="lineNum">     773 </span><span class="lineNoCov">          0 :     itsEpoxy-&gt;SetTemperature(15.0*fgkCelsius);</span>
<span class="lineNum">     774 </span><span class="lineNoCov">          0 :     itsEpoxy-&gt;SetState(TGeoMaterial::kMatStateSolid);</span>
<span class="lineNum">     775 </span>            :     //
<span class="lineNum">     776 </span>            :     // Carbon Fiber, M55J, 60% fiber by volume. Fiber density
<span class="lineNum">     777 </span>            :     // 1.91 g/cm^3. See ToryaCA M55J data sheet.
<span class="lineNum">     778 </span>            :     //Begin_Html
<span class="lineNum">     779 </span>            :     /*
<span class="lineNum">     780 </span>            :        &lt;A HREF=&quot;http://torayusa.com/cfa/pdfs/M55JDataSheet.pdf&quot;&gt; Data Sheet
<span class="lineNum">     781 </span>            :        &lt;/A&gt;
<span class="lineNum">     782 </span>            :     */
<span class="lineNum">     783 </span>            :     //End_Html
<span class="lineNum">     784 </span><span class="lineNoCov">          0 :     TGeoMixture *itsCarbonFiber = new TGeoMixture(&quot;ITS_CarbonFiber-M55J&quot;,4);</span>
<span class="lineNum">     785 </span>            :     // Assume that the epoxy fill in the space between the fibers and so
<span class="lineNum">     786 </span>            :     // no change in the total volume. To compute w, assume 1cm^3 total 
<span class="lineNum">     787 </span>            :     // volume.
<span class="lineNum">     788 </span><span class="lineNoCov">          0 :     w = 1.91/(1.91+(1.-.60)*itsEpoxy-&gt;GetDensity());</span>
<span class="lineNum">     789 </span><span class="lineNoCov">          0 :     itsCarbonFiber-&gt;AddElement(itsC,w);</span>
<span class="lineNum">     790 </span><span class="lineNoCov">          0 :     w = (1.-.60)*itsEpoxy-&gt;GetDensity()/(1.91+(1.-.06)*itsEpoxy-&gt;GetDensity());</span>
<span class="lineNum">     791 </span><span class="lineNoCov">          0 :     for(i=0;i&lt;itsEpoxy-&gt;GetNelements();i++)</span>
<span class="lineNum">     792 </span><span class="lineNoCov">          0 :         itsCarbonFiber-&gt;AddElement(itsEpoxy-&gt;GetElement(i),</span>
<span class="lineNum">     793 </span><span class="lineNoCov">          0 :                                    itsEpoxy-&gt;GetWmixt()[i]*w);</span>
<span class="lineNum">     794 </span><span class="lineNoCov">          0 :     itsCarbonFiber-&gt;SetDensity((1.91+(1.-.60)*itsEpoxy-&gt;GetDensity())*fgkgcm3);</span>
<span class="lineNum">     795 </span><span class="lineNoCov">          0 :     itsCarbonFiber-&gt;SetTemperature(22.0*fgkCelsius);</span>
<span class="lineNum">     796 </span><span class="lineNoCov">          0 :     itsCarbonFiber-&gt;SetState(TGeoMaterial::kMatStateSolid);</span>
<span class="lineNum">     797 </span>            :     //
<span class="lineNum">     798 </span>            :     // 
<span class="lineNum">     799 </span>            :     //
<span class="lineNum">     800 </span>            :     // Rohacell 51A  millable foam product.
<span class="lineNum">     801 </span>            :     // C9 H13 N1 O2  52Kg/m^3
<span class="lineNum">     802 </span>            :     // Elemental composition, Private comunications with
<span class="lineNum">     803 </span>            :     // Bjorn S. Nilsen
<span class="lineNum">     804 </span>            :     //Begin_Html
<span class="lineNum">     805 </span>            :     /*
<span class="lineNum">     806 </span>            :       &lt;A HREF=&quot;http://www.rohacell.com/en/performanceplastics8344.html&quot;&gt;
<span class="lineNum">     807 </span>            :        Rohacell-A see Properties
<span class="lineNum">     808 </span>            :        &lt;/A&gt;
<span class="lineNum">     809 </span>            :      */
<span class="lineNum">     810 </span>            :     //End_Html
<span class="lineNum">     811 </span><span class="lineNoCov">          0 :     TGeoMixture *itsFoam = new TGeoMixture(&quot;ITS_Foam&quot;,4);</span>
<span class="lineNum">     812 </span><span class="lineNoCov">          0 :     itsFoam-&gt;AddElement(itsC,9);</span>
<span class="lineNum">     813 </span><span class="lineNoCov">          0 :     itsFoam-&gt;AddElement(itsH,13);</span>
<span class="lineNum">     814 </span><span class="lineNoCov">          0 :     itsFoam-&gt;AddElement(itsN,1);</span>
<span class="lineNum">     815 </span><span class="lineNoCov">          0 :     itsFoam-&gt;AddElement(itsO,2);</span>
<span class="lineNum">     816 </span><span class="lineNoCov">          0 :     itsFoam-&gt;SetTitle(&quot;Rohacell 51 A&quot;);</span>
<span class="lineNum">     817 </span><span class="lineNoCov">          0 :     itsFoam-&gt;SetDensity(52.*fgkKgm3);</span>
<span class="lineNum">     818 </span><span class="lineNoCov">          0 :     itsFoam-&gt;SetTemperature(22.0*fgkCelsius);</span>
<span class="lineNum">     819 </span><span class="lineNoCov">          0 :     itsFoam-&gt;SetState(TGeoMaterial::kMatStateSolid);</span>
<span class="lineNum">     820 </span>            :     //
<span class="lineNum">     821 </span>            :     // Kapton % by weight, H 2.6362, C69.1133, N 7.3270, O 20.0235
<span class="lineNum">     822 </span>            :     // Density 1.42 g/cm^3
<span class="lineNum">     823 </span>            :     //Begin_Html
<span class="lineNum">     824 </span>            :     /*
<span class="lineNum">     825 </span>            :         &lt;A HREF=&quot;http://www2.dupont.com/Kapton/en_US/assets/downloads/pdf/summaryofprop.pdf&quot;&gt;
<span class="lineNum">     826 </span>            :         Kapton. also see &lt;/A&gt;
<span class="lineNum">     827 </span>            :         &lt;A HREF=&quot;http://physics.nist.gov/cgi-bin/Star/compos.pl?matno=179&quot;&gt;
<span class="lineNum">     828 </span>            :         &lt;/A&gt;
<span class="lineNum">     829 </span>            :      */
<span class="lineNum">     830 </span>            :     //End_Html
<span class="lineNum">     831 </span><span class="lineNoCov">          0 :     TGeoMixture *itsKapton = new TGeoMixture(&quot;ITS_Kapton&quot;,4);</span>
<span class="lineNum">     832 </span><span class="lineNoCov">          0 :     itsKapton-&gt;AddElement(itsH,0.026362);</span>
<span class="lineNum">     833 </span><span class="lineNoCov">          0 :     itsKapton-&gt;AddElement(itsC,0.691133);</span>
<span class="lineNum">     834 </span><span class="lineNoCov">          0 :     itsKapton-&gt;AddElement(itsN,0.073270);</span>
<span class="lineNum">     835 </span><span class="lineNoCov">          0 :     itsKapton-&gt;AddElement(itsO,0.200235);</span>
<span class="lineNum">     836 </span><span class="lineNoCov">          0 :     itsKapton-&gt;SetTitle(&quot;Kapton ribon and cable base&quot;);</span>
<span class="lineNum">     837 </span><span class="lineNoCov">          0 :     itsKapton-&gt;SetDensity(1.42*fgkgcm3);</span>
<span class="lineNum">     838 </span><span class="lineNoCov">          0 :     itsKapton-&gt;SetTemperature(22.0*fgkCelsius);</span>
<span class="lineNum">     839 </span><span class="lineNoCov">          0 :     itsKapton-&gt;SetState(TGeoMaterial::kMatStateSolid);</span>
<span class="lineNum">     840 </span>            :     //
<span class="lineNum">     841 </span>            :     // UPILEX-S C16 H6 O4 N2 polymer (a Kapton like material)
<span class="lineNum">     842 </span>            :     // Density 1.47 g/cm^3
<span class="lineNum">     843 </span>            :     //Begin_Html
<span class="lineNum">     844 </span>            :     /*
<span class="lineNum">     845 </span>            :         &lt;A HREF=&quot;http://northamerica.ube.com/page.php?pageid=9&quot;&gt;
<span class="lineNum">     846 </span>            :         UPILEX-S. also see &lt;/A&gt;
<span class="lineNum">     847 </span>            :         &lt;A HREF=&quot;http://northamerica.ube.com/page.php?pageid=81&quot;&gt;
<span class="lineNum">     848 </span>            :         &lt;/A&gt;
<span class="lineNum">     849 </span>            :      */
<span class="lineNum">     850 </span>            :     //End_Html
<span class="lineNum">     851 </span><span class="lineNoCov">          0 :     TGeoMixture *itsUpilex = new TGeoMixture(&quot;ITS_Upilex&quot;,4);</span>
<span class="lineNum">     852 </span><span class="lineNoCov">          0 :     itsUpilex-&gt;AddElement(itsC,16);</span>
<span class="lineNum">     853 </span><span class="lineNoCov">          0 :     itsUpilex-&gt;AddElement(itsH,6);</span>
<span class="lineNum">     854 </span><span class="lineNoCov">          0 :     itsUpilex-&gt;AddElement(itsN,2);</span>
<span class="lineNum">     855 </span><span class="lineNoCov">          0 :     itsUpilex-&gt;AddElement(itsO,4);</span>
<span class="lineNum">     856 </span><span class="lineNoCov">          0 :     itsUpilex-&gt;SetTitle(&quot;Upilex ribon, cable, and pcb base&quot;);</span>
<span class="lineNum">     857 </span><span class="lineNoCov">          0 :     itsUpilex-&gt;SetDensity(1.47*fgkgcm3);</span>
<span class="lineNum">     858 </span><span class="lineNoCov">          0 :     itsUpilex-&gt;SetTemperature(22.0*fgkCelsius);</span>
<span class="lineNum">     859 </span><span class="lineNoCov">          0 :     itsUpilex-&gt;SetState(TGeoMaterial::kMatStateSolid);</span>
<span class="lineNum">     860 </span>            :     //
<span class="lineNum">     861 </span>            :     // Aluminum 6061 (Al used by US groups)
<span class="lineNum">     862 </span>            :     // % by weight, Cr 0.04-0.35 range [0.0375 nominal value used]
<span class="lineNum">     863 </span>            :     // Cu 0.15-0.4 [0.275], Fe Max 0.7 [0.35], Mg 0.8-1.2 [1.0],
<span class="lineNum">     864 </span>            :     // Mn Max 0.15 [0.075] Si 0.4-0.8 [0.6], Ti Max 0.15 [0.075],
<span class="lineNum">     865 </span>            :     // Zn Max 0.25 [0.125], Rest Al [97.4625]. Density 2.7 g/cm^3
<span class="lineNum">     866 </span>            :     //Begin_Html
<span class="lineNum">     867 </span>            :     /*
<span class="lineNum">     868 </span>            :       &lt;A HREG=&quot;http://www.matweb.com/SpecificMaterial.asp?bassnum=MA6016&amp;group=General&quot;&gt;
<span class="lineNum">     869 </span>            :       Aluminum 6061 specifications
<span class="lineNum">     870 </span>            :       &lt;/A&gt;
<span class="lineNum">     871 </span>            :      */
<span class="lineNum">     872 </span>            :     //End_Html
<span class="lineNum">     873 </span><span class="lineNoCov">          0 :     TGeoMixture *itsAl6061 = new TGeoMixture(&quot;ITS_Al6061&quot;,9);</span>
<span class="lineNum">     874 </span><span class="lineNoCov">          0 :     itsAl6061-&gt;AddElement(itsCr,0.000375);</span>
<span class="lineNum">     875 </span><span class="lineNoCov">          0 :     itsAl6061-&gt;AddElement(itsCu,0.00275);</span>
<span class="lineNum">     876 </span><span class="lineNoCov">          0 :     itsAl6061-&gt;AddElement(itsFe,0.0035);</span>
<span class="lineNum">     877 </span><span class="lineNoCov">          0 :     itsAl6061-&gt;AddElement(itsMg,0.01);</span>
<span class="lineNum">     878 </span><span class="lineNoCov">          0 :     itsAl6061-&gt;AddElement(itsMn,0.00075);</span>
<span class="lineNum">     879 </span><span class="lineNoCov">          0 :     itsAl6061-&gt;AddElement(itsSi,0.006);</span>
<span class="lineNum">     880 </span><span class="lineNoCov">          0 :     itsAl6061-&gt;AddElement(itsTi,0.00075);</span>
<span class="lineNum">     881 </span><span class="lineNoCov">          0 :     itsAl6061-&gt;AddElement(itsZn,0.00125);</span>
<span class="lineNum">     882 </span><span class="lineNoCov">          0 :     itsAl6061-&gt;AddElement(itsAl,0.974625);</span>
<span class="lineNum">     883 </span><span class="lineNoCov">          0 :     itsAl6061-&gt;SetTitle(&quot;Aluminum Alloy 6061&quot;);</span>
<span class="lineNum">     884 </span><span class="lineNoCov">          0 :     itsAl6061-&gt;SetDensity(2.7*fgkgcm3);</span>
<span class="lineNum">     885 </span><span class="lineNoCov">          0 :     itsAl6061-&gt;SetTemperature(22.0*fgkCelsius);</span>
<span class="lineNum">     886 </span><span class="lineNoCov">          0 :     itsAl6061-&gt;SetState(TGeoMaterial::kMatStateSolid);</span>
<span class="lineNum">     887 </span>            :     //
<span class="lineNum">     888 </span>            :     // Aluminum 7075  (Al used by Italian groups)
<span class="lineNum">     889 </span>            :     // % by weight, Cr 0.18-0.28 range [0.23 nominal value used]
<span class="lineNum">     890 </span>            :     // Cu 1.2-2.0 [1.6], Fe Max 0.5 [0.25], Mg 2.1-2.9 [2.5],
<span class="lineNum">     891 </span>            :     // Mn Max 0.3 [0.125] Si Max 0.4 [0.2], Ti Max 0.2 [0.1],
<span class="lineNum">     892 </span>            :     // Zn 5.1-6.1 [5.6], Rest Al [89.395]. Density 2.81 g/cm^3
<span class="lineNum">     893 </span>            :     //Begin_Html
<span class="lineNum">     894 </span>            :     /*
<span class="lineNum">     895 </span>            :       &lt;A HREG=&quot;http://asm.matweb.com/search/SpecificMaterial.asp?bassnum=MA7075T6&quot;&gt;
<span class="lineNum">     896 </span>            :       Aluminum 7075 specifications
<span class="lineNum">     897 </span>            :       &lt;/A&gt;
<span class="lineNum">     898 </span>            :      */
<span class="lineNum">     899 </span>            :     //End_Html
<span class="lineNum">     900 </span><span class="lineNoCov">          0 :     TGeoMixture *itsAl7075 = new TGeoMixture(&quot;ITS_Al7075&quot;,9);</span>
<span class="lineNum">     901 </span><span class="lineNoCov">          0 :     itsAl7075-&gt;AddElement(itsCr,0.0023);</span>
<span class="lineNum">     902 </span><span class="lineNoCov">          0 :     itsAl7075-&gt;AddElement(itsCu,0.016);</span>
<span class="lineNum">     903 </span><span class="lineNoCov">          0 :     itsAl7075-&gt;AddElement(itsFe,0.0025);</span>
<span class="lineNum">     904 </span><span class="lineNoCov">          0 :     itsAl7075-&gt;AddElement(itsMg,0.025);</span>
<span class="lineNum">     905 </span><span class="lineNoCov">          0 :     itsAl7075-&gt;AddElement(itsMn,0.00125);</span>
<span class="lineNum">     906 </span><span class="lineNoCov">          0 :     itsAl7075-&gt;AddElement(itsSi,0.002);</span>
<span class="lineNum">     907 </span><span class="lineNoCov">          0 :     itsAl7075-&gt;AddElement(itsTi,0.001);</span>
<span class="lineNum">     908 </span><span class="lineNoCov">          0 :     itsAl7075-&gt;AddElement(itsZn,0.056);</span>
<span class="lineNum">     909 </span><span class="lineNoCov">          0 :     itsAl7075-&gt;AddElement(itsAl,0.89395);</span>
<span class="lineNum">     910 </span><span class="lineNoCov">          0 :     itsAl7075-&gt;SetTitle(&quot;Aluminum Alloy 7075&quot;);</span>
<span class="lineNum">     911 </span><span class="lineNoCov">          0 :     itsAl7075-&gt;SetDensity(2.81*fgkgcm3);</span>
<span class="lineNum">     912 </span><span class="lineNoCov">          0 :     itsAl7075-&gt;SetTemperature(22.0*fgkCelsius);</span>
<span class="lineNum">     913 </span><span class="lineNoCov">          0 :     itsAl7075-&gt;SetState(TGeoMaterial::kMatStateSolid);</span>
<span class="lineNum">     914 </span>            :     //
<span class="lineNum">     915 </span>            :     // &quot;Ruby&quot; spheres, Al2 O3
<span class="lineNum">     916 </span>            :     // &quot;Ruby&quot; Sphere posts, Ryton R-4 04
<span class="lineNum">     917 </span>            :     //Begin_Html
<span class="lineNum">     918 </span>            :     /*
<span class="lineNum">     919 </span>            :       &lt;A HREF=&quot;&quot;&gt;
<span class="lineNum">     920 </span>            :       Ruby Sphere Posts
<span class="lineNum">     921 </span>            :       &lt;/A&gt;
<span class="lineNum">     922 </span>            :      */
<span class="lineNum">     923 </span>            :     //End_Html
<span class="lineNum">     924 </span><span class="lineNoCov">          0 :     TGeoMixture *itsRuby = new TGeoMixture(&quot;ITS_RubySphere&quot;,2);</span>
<span class="lineNum">     925 </span><span class="lineNoCov">          0 :     itsRuby-&gt;AddElement(itsAl,2);</span>
<span class="lineNum">     926 </span><span class="lineNoCov">          0 :     itsRuby-&gt;AddElement(itsO,3);</span>
<span class="lineNum">     927 </span><span class="lineNoCov">          0 :     itsRuby-&gt;SetTitle(&quot;Ruby reference sphere&quot;);</span>
<span class="lineNum">     928 </span><span class="lineNoCov">          0 :     itsRuby-&gt;SetDensity(2.81*fgkgcm3);</span>
<span class="lineNum">     929 </span><span class="lineNoCov">          0 :     itsRuby-&gt;SetTemperature(22.0*fgkCelsius);</span>
<span class="lineNum">     930 </span><span class="lineNoCov">          0 :     itsRuby-&gt;SetState(TGeoMaterial::kMatStateSolid);</span>
<span class="lineNum">     931 </span>            :     //
<span class="lineNum">     932 </span>            :     //
<span class="lineNum">     933 </span>            :     // Inox, AISI 304L, compoistion % by weight (assumed) 
<span class="lineNum">     934 </span>            :     // C Max 0.03 [0.015], Mn Max 2.00 [1.00], Si Max 1.00 [0.50]
<span class="lineNum">     935 </span>            :     // P Max 0.045 [0.0225], S Max 0.03 [0.015], Ni 8.0-10.5 [9.25]
<span class="lineNum">     936 </span>            :     // Cr 18-20 [19.], Mo 2.-2.5 [2.25], rest Fe: density 7.93 Kg/dm^3
<span class="lineNum">     937 </span>            :     //Begin_Html
<span class="lineNum">     938 </span>            :     /*
<span class="lineNum">     939 </span>            :       &lt;A HREF=&quot;http://www.cimap.fr/caracter.pdf&quot;&gt;
<span class="lineNum">     940 </span>            :       Stainless steal (INOX) AISI 304L composition
<span class="lineNum">     941 </span>            :       &lt;/A&gt;
<span class="lineNum">     942 </span>            :      */
<span class="lineNum">     943 </span>            :     //End_Html
<span class="lineNum">     944 </span><span class="lineNoCov">          0 :     TGeoMixture *itsInox304L = new TGeoMixture(&quot;ITS_Inox304L&quot;,9);</span>
<span class="lineNum">     945 </span><span class="lineNoCov">          0 :     itsInox304L-&gt;AddElement(itsC,0.00015);</span>
<span class="lineNum">     946 </span><span class="lineNoCov">          0 :     itsInox304L-&gt;AddElement(itsMn,0.010);</span>
<span class="lineNum">     947 </span><span class="lineNoCov">          0 :     itsInox304L-&gt;AddElement(itsSi,0.005);</span>
<span class="lineNum">     948 </span><span class="lineNoCov">          0 :     itsInox304L-&gt;AddElement(itsP,0.000225);</span>
<span class="lineNum">     949 </span><span class="lineNoCov">          0 :     itsInox304L-&gt;AddElement(itsS,0.00015);</span>
<span class="lineNum">     950 </span><span class="lineNoCov">          0 :     itsInox304L-&gt;AddElement(itsNi,0.0925);</span>
<span class="lineNum">     951 </span><span class="lineNoCov">          0 :     itsInox304L-&gt;AddElement(itsCr,0.1900);</span>
<span class="lineNum">     952 </span><span class="lineNoCov">          0 :     itsInox304L-&gt;AddElement(itsMo,0.0225);</span>
<span class="lineNum">     953 </span><span class="lineNoCov">          0 :     itsInox304L-&gt;AddElement(itsFe,0.679475); // Rest Fe</span>
<span class="lineNum">     954 </span><span class="lineNoCov">          0 :     itsInox304L-&gt;SetTitle(&quot;ITS Stainless Steal (Inox) type AISI 304L&quot;);</span>
<span class="lineNum">     955 </span><span class="lineNoCov">          0 :     itsInox304L-&gt;SetDensity(7.93*fgkKgdm3);</span>
<span class="lineNum">     956 </span><span class="lineNoCov">          0 :     itsInox304L-&gt;SetTemperature(22.0*fgkCelsius);</span>
<span class="lineNum">     957 </span><span class="lineNoCov">          0 :     itsInox304L-&gt;SetState(TGeoMaterial::kMatStateSolid);</span>
<span class="lineNum">     958 </span>            :     //
<span class="lineNum">     959 </span>            :     // Inox, AISI 316L, composition % by weight (assumed)
<span class="lineNum">     960 </span>            :     // C Max 0.03 [0.015], Mn Max 2.00 [1.00], Si Max 1.00 [0.50]
<span class="lineNum">     961 </span>            :     // P Max 0.045 [0.0225], S Max 0.03 [0.015], Ni 10.0-14. [12.]
<span class="lineNum">     962 </span>            :     // Cr 16-18 [17.], Mo 2-3 [2.5]: density 7.97 Kg/dm^3
<span class="lineNum">     963 </span>            :     //Begin_Html
<span class="lineNum">     964 </span>            :     /*
<span class="lineNum">     965 </span>            :       &lt;A HREF=&quot;http://www.cimap.fr/caracter.pdf&quot;&gt;
<span class="lineNum">     966 </span>            :       Stainless steal (INOX) AISI 316L composition
<span class="lineNum">     967 </span>            :       &lt;/A&gt;
<span class="lineNum">     968 </span>            :      */
<span class="lineNum">     969 </span>            :     //End_Html
<span class="lineNum">     970 </span><span class="lineNoCov">          0 :     TGeoMixture *itsInox316L = new TGeoMixture(&quot;ITS_Inox316L&quot;,9);</span>
<span class="lineNum">     971 </span><span class="lineNoCov">          0 :     itsInox316L-&gt;AddElement(itsC,0.00015);</span>
<span class="lineNum">     972 </span><span class="lineNoCov">          0 :     itsInox316L-&gt;AddElement(itsMn,0.010);</span>
<span class="lineNum">     973 </span><span class="lineNoCov">          0 :     itsInox316L-&gt;AddElement(itsSi,0.005);</span>
<span class="lineNum">     974 </span><span class="lineNoCov">          0 :     itsInox316L-&gt;AddElement(itsP,0.000225);</span>
<span class="lineNum">     975 </span><span class="lineNoCov">          0 :     itsInox316L-&gt;AddElement(itsS,0.00015);</span>
<span class="lineNum">     976 </span><span class="lineNoCov">          0 :     itsInox316L-&gt;AddElement(itsNi,0.12);</span>
<span class="lineNum">     977 </span><span class="lineNoCov">          0 :     itsInox316L-&gt;AddElement(itsCr,0.17);</span>
<span class="lineNum">     978 </span><span class="lineNoCov">          0 :     itsInox316L-&gt;AddElement(itsMo,0.025);</span>
<span class="lineNum">     979 </span><span class="lineNoCov">          0 :     itsInox316L-&gt;AddElement(itsFe,0.66945); // Rest Fe</span>
<span class="lineNum">     980 </span><span class="lineNoCov">          0 :     itsInox316L-&gt;SetTitle(&quot;ITS Stainless Steal (Inox) type AISI 316L&quot;);</span>
<span class="lineNum">     981 </span><span class="lineNoCov">          0 :     itsInox316L-&gt;SetDensity(7.97*fgkKgdm3);</span>
<span class="lineNum">     982 </span><span class="lineNoCov">          0 :     itsInox316L-&gt;SetTemperature(22.0*fgkCelsius);</span>
<span class="lineNum">     983 </span><span class="lineNoCov">          0 :     itsInox316L-&gt;SetState(TGeoMaterial::kMatStateSolid);</span>
<span class="lineNum">     984 </span>            :     //
<span class="lineNum">     985 </span>            :     // Inox, Phynox or Elgiloy AMS 5833, composition % by weight
<span class="lineNum">     986 </span>            :     // C Max 0.15 [0.15], Mn Max 2.00 [2.00], Be max 0.0001 [none]
<span class="lineNum">     987 </span>            :     // Ni 18. [18.], Cr 21.5 [21.5], Mo 7.5 [7.5], Co 42 [42.]: 
<span class="lineNum">     988 </span>            :     // density 8.3 Kg/dm^3
<span class="lineNum">     989 </span>            :     //Begin_Html
<span class="lineNum">     990 </span>            :     /*
<span class="lineNum">     991 </span>            :       &lt;A HREF=&quot;http://www.freepatentsonline.com/20070032816.html&quot;&gt;
<span class="lineNum">     992 </span>            :       Compostion of Phynox or Elgiloy AMS 5833, also see
<span class="lineNum">     993 </span>            :       &lt;/A&gt;
<span class="lineNum">     994 </span>            :       &lt;A HREF=&quot;http://www.alloywire.com/phynox_alloy.html&quot;&gt;
<span class="lineNum">     995 </span>            :       under corss reference number [0024].
<span class="lineNum">     996 </span>            :       &lt;/A&gt;
<span class="lineNum">     997 </span>            :      */
<span class="lineNum">     998 </span>            :     //End_Html
<span class="lineNum">     999 </span><span class="lineNoCov">          0 :     TGeoMixture *itsPhynox = new TGeoMixture(&quot;ITS_Phynox&quot;,7);</span>
<span class="lineNum">    1000 </span><span class="lineNoCov">          0 :     itsPhynox-&gt;AddElement(itsC,0.0015);</span>
<span class="lineNum">    1001 </span><span class="lineNoCov">          0 :     itsPhynox-&gt;AddElement(itsMn,0.020);</span>
<span class="lineNum">    1002 </span><span class="lineNoCov">          0 :     itsPhynox-&gt;AddElement(itsNi,0.18);</span>
<span class="lineNum">    1003 </span><span class="lineNoCov">          0 :     itsPhynox-&gt;AddElement(itsCr,0.215);</span>
<span class="lineNum">    1004 </span><span class="lineNoCov">          0 :     itsPhynox-&gt;AddElement(itsMo,0.075);</span>
<span class="lineNum">    1005 </span><span class="lineNoCov">          0 :     itsPhynox-&gt;AddElement(itsCo,0.42);</span>
<span class="lineNum">    1006 </span><span class="lineNoCov">          0 :     itsPhynox-&gt;AddElement(itsFe,0.885);</span>
<span class="lineNum">    1007 </span><span class="lineNoCov">          0 :     itsPhynox-&gt;SetTitle(&quot;ITS Cooling tube alloy&quot;);</span>
<span class="lineNum">    1008 </span><span class="lineNoCov">          0 :     itsPhynox-&gt;SetDensity(8.3*fgkgcm3);</span>
<span class="lineNum">    1009 </span><span class="lineNoCov">          0 :     itsPhynox-&gt;SetTemperature(22.0*fgkCelsius);</span>
<span class="lineNum">    1010 </span><span class="lineNoCov">          0 :     itsPhynox-&gt;SetState(TGeoMaterial::kMatStateSolid);</span>
<span class="lineNum">    1011 </span>            :     //
<span class="lineNum">    1012 </span>            :     // G10FR4
<span class="lineNum">    1013 </span>            :     //
<span class="lineNum">    1014 </span>            :     // Demineralized Water H2O SDD &amp; SSD Cooling liquid
<span class="lineNum">    1015 </span><span class="lineNoCov">          0 :     TGeoMixture *itsWater = new TGeoMixture(&quot;ITS_Water&quot;,2);</span>
<span class="lineNum">    1016 </span><span class="lineNoCov">          0 :     itsWater-&gt;AddElement(itsH,2);</span>
<span class="lineNum">    1017 </span><span class="lineNoCov">          0 :     itsWater-&gt;AddElement(itsO,1);</span>
<span class="lineNum">    1018 </span><span class="lineNoCov">          0 :     itsWater-&gt;SetTitle(&quot;ITS Cooling Water&quot;);</span>
<span class="lineNum">    1019 </span><span class="lineNoCov">          0 :     itsWater-&gt;SetDensity(1.0*fgkgcm3);</span>
<span class="lineNum">    1020 </span><span class="lineNoCov">          0 :     itsWater-&gt;SetTemperature(22.0*fgkCelsius);</span>
<span class="lineNum">    1021 </span><span class="lineNoCov">          0 :     itsWater-&gt;SetState(TGeoMaterial::kMatStateLiquid);</span>
<span class="lineNum">    1022 </span>            :     //
<span class="lineNum">    1023 </span>            :     // Freon SPD Cooling liquid PerFluorobuthane C4F10
<span class="lineNum">    1024 </span>            :     //Begin_Html
<span class="lineNum">    1025 </span>            :     /*
<span class="lineNum">    1026 </span>            :       &lt;A HREF=&quot; http://st-support-cooling-electronics.web.cern.ch/st-support-cooling-electronics/default.htm&quot;&gt;
<span class="lineNum">    1027 </span>            :       SPD 2 phase cooling using PerFluorobuthane
<span class="lineNum">    1028 </span>            :       &lt;/A&gt;
<span class="lineNum">    1029 </span>            :      */
<span class="lineNum">    1030 </span>            :     //End_Html
<span class="lineNum">    1031 </span><span class="lineNoCov">          0 :     TGeoMixture *itsFreon = new TGeoMixture(&quot;ITS_SPD_Freon&quot;,2);</span>
<span class="lineNum">    1032 </span><span class="lineNoCov">          0 :     itsFreon-&gt;AddElement(itsC,4);</span>
<span class="lineNum">    1033 </span><span class="lineNoCov">          0 :     itsFreon-&gt;AddElement(itsF,10);</span>
<span class="lineNum">    1034 </span><span class="lineNoCov">          0 :     itsFreon-&gt;SetTitle(&quot;ITS SPD 2 phase Cooling freon&quot;);</span>
<span class="lineNum">    1035 </span><span class="lineNoCov">          0 :     itsFreon-&gt;SetDensity(1.52*fgkgcm3);</span>
<span class="lineNum">    1036 </span><span class="lineNoCov">          0 :     itsFreon-&gt;SetTemperature(22.0*fgkCelsius);</span>
<span class="lineNum">    1037 </span><span class="lineNoCov">          0 :     itsFreon-&gt;SetState(TGeoMaterial::kMatStateLiquid);</span>
<span class="lineNum">    1038 </span>            :     //
<span class="lineNum">    1039 </span>            :     //    Int_t   ifield = ((AliMagF*)TGeoGlobalMagField::Instance()-&gt;GetField())-&gt;Integ();
<span class="lineNum">    1040 </span>            :     //    Float_t fieldm = ((AliMagF*)TGeoGlobalMagField::Instance()-&gt;GetField())-&gt;Max();
<span class="lineNum">    1041 </span>            : 
<span class="lineNum">    1042 </span>            :     //    Float_t tmaxfd = 0.1;//  1.0;//  Degree
<span class="lineNum">    1043 </span>            :     //    Float_t stemax = 1.0;//  cm
<span class="lineNum">    1044 </span>            :     //   Float_t deemax = 0.1;// 30.0;// Fraction of particle's energy 0&lt;deemax&lt;=1
<span class="lineNum">    1045 </span>            :     //    Float_t epsil  = 1.0E-4;//  1.0;  cm
<span class="lineNum">    1046 </span>            :     //    Float_t stmin  = 0.0; // cm &quot;Default value used&quot;
<span class="lineNum">    1047 </span>            : 
<span class="lineNum">    1048 </span>            :     //    Float_t tmaxfdSi = 0.1; // .10000E+01; // Degree
<span class="lineNum">    1049 </span>            :     //   Float_t stemaxSi = 0.0075; //  .10000E+01; // cm
<span class="lineNum">    1050 </span>            :     //   Float_t deemaxSi = 0.1; // Fraction of particle's energy 0&lt;deemax&lt;=1
<span class="lineNum">    1051 </span>            :     //    Float_t epsilSi  = 1.0E-4;// .10000E+01;
<span class="lineNum">    1052 </span>            :     /*
<span class="lineNum">    1053 </span>            :     Float_t stminSi  = 0.0; // cm &quot;Default value used&quot;
<span class="lineNum">    1054 </span>            : 
<span class="lineNum">    1055 </span>            :     Float_t tmaxfdAir = 0.1; // .10000E+01; // Degree
<span class="lineNum">    1056 </span>            :     Float_t stemaxAir = .10000E+01; // cm
<span class="lineNum">    1057 </span>            :     Float_t deemaxAir = 0.1; // 0.30000E-02; // Fraction of particle's energy 0&lt;deemax&lt;=1
<span class="lineNum">    1058 </span>            :     Float_t epsilAir  = 1.0E-4;// .10000E+01;
<span class="lineNum">    1059 </span>            :     Float_t stminAir  = 0.0; // cm &quot;Default value used&quot;
<span class="lineNum">    1060 </span>            : 
<span class="lineNum">    1061 </span>            :     Float_t tmaxfdServ = 1.0; // 10.0; // Degree
<span class="lineNum">    1062 </span>            :     Float_t stemaxServ = 1.0; // 0.01; // cm
<span class="lineNum">    1063 </span>            :     Float_t deemaxServ = 0.5; // 0.1; // Fraction of particle's energy 0&lt;deemax&lt;=1
<span class="lineNum">    1064 </span>            :     Float_t epsilServ  = 1.0E-3; // 0.003; // cm
<span class="lineNum">    1065 </span>            :     Float_t stminServ  = 0.0; //0.003; // cm &quot;Default value used&quot;
<span class="lineNum">    1066 </span>            : 
<span class="lineNum">    1067 </span>            :     // Freon PerFluorobuthane C4F10 see 
<span class="lineNum">    1068 </span>            :     // http://st-support-cooling-electronics.web.cern.ch/
<span class="lineNum">    1069 </span>            :     //        st-support-cooling-electronics/default.htm
<span class="lineNum">    1070 </span>            :     Float_t afre[2]  = { 12.011,18.9984032 };
<span class="lineNum">    1071 </span>            :     Float_t zfre[2]  = { 6., 9. };
<span class="lineNum">    1072 </span>            :     Float_t wfre[2]  = { 4.,10. };
<span class="lineNum">    1073 </span>            :     Float_t densfre  = 1.52;
<span class="lineNum">    1074 </span>            : 
<span class="lineNum">    1075 </span>            :     //CM55J
<span class="lineNum">    1076 </span>            :     Float_t aCM55J[4]={12.0107,14.0067,15.9994,1.00794};
<span class="lineNum">    1077 </span>            :     Float_t zCM55J[4]={6.,7.,8.,1.};
<span class="lineNum">    1078 </span>            :     Float_t wCM55J[4]={0.908508078,0.010387573,0.055957585,0.025146765};
<span class="lineNum">    1079 </span>            :     Float_t dCM55J = 1.63;
<span class="lineNum">    1080 </span>            : 
<span class="lineNum">    1081 </span>            :     //ALCM55J
<span class="lineNum">    1082 </span>            :     Float_t aALCM55J[5]={12.0107,14.0067,15.9994,1.00794,26.981538};
<span class="lineNum">    1083 </span>            :     Float_t zALCM55J[5]={6.,7.,8.,1.,13.};
<span class="lineNum">    1084 </span>            :     Float_t wALCM55J[5]={0.817657902,0.0093488157,0.0503618265,0.0226320885,0.1};
<span class="lineNum">    1085 </span>            :     Float_t dALCM55J = 1.9866;
<span class="lineNum">    1086 </span>            : 
<span class="lineNum">    1087 </span>            :     //Si Chips
<span class="lineNum">    1088 </span>            :     Float_t aSICHIP[6]={12.0107,14.0067,15.9994,1.00794,28.0855,107.8682};
<span class="lineNum">    1089 </span>            :     Float_t zSICHIP[6]={6.,7.,8.,1.,14., 47.};
<span class="lineNum">    1090 </span>            :     Float_t wSICHIP[6]={0.039730642,0.001396798,0.01169634,
<span class="lineNum">    1091 </span>            :                         0.004367771,0.844665,0.09814344903};
<span class="lineNum">    1092 </span>            :     Float_t dSICHIP = 2.36436;
<span class="lineNum">    1093 </span>            : 
<span class="lineNum">    1094 </span>            :     //Inox
<span class="lineNum">    1095 </span>            :     Float_t aINOX[9]={12.0107,54.9380, 28.0855,30.9738,32.066,
<span class="lineNum">    1096 </span>            :                       58.6928,55.9961,95.94,55.845};
<span class="lineNum">    1097 </span>            :     Float_t zINOX[9]={6.,25.,14.,15.,16., 28.,24.,42.,26.};
<span class="lineNum">    1098 </span>            :     Float_t wINOX[9]={0.0003,0.02,0.01,0.00045,0.0003,0.12,0.17,0.025,0.654};
<span class="lineNum">    1099 </span>            :     Float_t dINOX = 8.03;
<span class="lineNum">    1100 </span>            : 
<span class="lineNum">    1101 </span>            :     //SDD HV microcable
<span class="lineNum">    1102 </span>            :     Float_t aHVm[5]={12.0107,1.00794,14.0067,15.9994,26.981538};
<span class="lineNum">    1103 </span>            :     Float_t zHVm[5]={6.,1.,7.,8.,13.};
<span class="lineNum">    1104 </span>            :     Float_t wHVm[5]={0.520088819984,0.01983871336,0.0551367996,0.157399667056, 0.247536};
<span class="lineNum">    1105 </span>            :     Float_t dHVm = 1.6087;
<span class="lineNum">    1106 </span>            : 
<span class="lineNum">    1107 </span>            :     //SDD LV+signal cable
<span class="lineNum">    1108 </span>            :     Float_t aLVm[5]={12.0107,1.00794,14.0067,15.9994,26.981538};
<span class="lineNum">    1109 </span>            :     Float_t zLVm[5]={6.,1.,7.,8.,13.};
<span class="lineNum">    1110 </span>            :     Float_t wLVm[5]={0.21722436468,0.0082859922,0.023028867,0.06574077612, 0.68572};
<span class="lineNum">    1111 </span>            :     Float_t dLVm = 2.1035;
<span class="lineNum">    1112 </span>            : 
<span class="lineNum">    1113 </span>            :     //SDD hybrid microcab
<span class="lineNum">    1114 </span>            :     Float_t aHLVm[5]={12.0107,1.00794,14.0067,15.9994,26.981538};
<span class="lineNum">    1115 </span>            :     Float_t zHLVm[5]={6.,1.,7.,8.,13.};
<span class="lineNum">    1116 </span>            :     Float_t wHLVm[5]={0.24281879711,0.00926228815,0.02574224025,0.07348667449, 0.64869};
<span class="lineNum">    1117 </span>            :     Float_t dHLVm = 2.0502;
<span class="lineNum">    1118 </span>            : 
<span class="lineNum">    1119 </span>            :     //SDD anode microcab
<span class="lineNum">    1120 </span>            :     Float_t aALVm[5]={12.0107,1.00794,14.0067,15.9994,26.981538};
<span class="lineNum">    1121 </span>            :     Float_t zALVm[5]={6.,1.,7.,8.,13.};
<span class="lineNum">    1122 </span>            :     Float_t wALVm[5]={0.392653705471,0.0128595919215,
<span class="lineNum">    1123 </span>            :                       0.041626868025,0.118832707289, 0.431909};
<span class="lineNum">    1124 </span>            :     Float_t dALVm = 2.0502;
<span class="lineNum">    1125 </span>            : 
<span class="lineNum">    1126 </span>            :     //X7R capacitors
<span class="lineNum">    1127 </span>            :     Float_t aX7R[7]={137.327,47.867,15.9994,58.6928,63.5460,118.710,207.2};
<span class="lineNum">    1128 </span>            :     Float_t zX7R[7]={56.,22.,8.,28.,29.,50.,82.};
<span class="lineNum">    1129 </span>            :     Float_t wX7R[7]={0.251639432,0.084755042,0.085975822,
<span class="lineNum">    1130 </span>            :                      0.038244751,0.009471271,0.321736471,0.2081768};
<span class="lineNum">    1131 </span>            :     Float_t dX7R = 7.14567;
<span class="lineNum">    1132 </span>            : 
<span class="lineNum">    1133 </span>            :     // AIR
<span class="lineNum">    1134 </span>            :     Float_t aAir[4]={12.0107,14.0067,15.9994,39.948};
<span class="lineNum">    1135 </span>            :     Float_t zAir[4]={6.,7.,8.,18.};
<span class="lineNum">    1136 </span>            :     Float_t wAir[4]={0.000124,0.755267,0.231781,0.012827};
<span class="lineNum">    1137 </span>            :     Float_t dAir = 1.20479E-3;
<span class="lineNum">    1138 </span>            : 
<span class="lineNum">    1139 </span>            :     // Water
<span class="lineNum">    1140 </span>            :     Float_t aWater[2]={1.00794,15.9994};
<span class="lineNum">    1141 </span>            :     Float_t zWater[2]={1.,8.};
<span class="lineNum">    1142 </span>            :     Float_t wWater[2]={0.111894,0.888106};
<span class="lineNum">    1143 </span>            :     Float_t dWater   = 1.0;
<span class="lineNum">    1144 </span>            : 
<span class="lineNum">    1145 </span>            :     // CERAMICS
<span class="lineNum">    1146 </span>            :     //     94.4% Al2O3 , 2.8% SiO2 , 2.3% MnO , 0.5% Cr2O3
<span class="lineNum">    1147 </span>            :     Float_t acer[5]  = { 26.981539,15.9994,28.0855,54.93805,51.9961 };
<span class="lineNum">    1148 </span>            :     Float_t zcer[5]  = {       13.,     8.,    14.,     25.,    24. };
<span class="lineNum">    1149 </span>            :     Float_t wcer[5]  = {.4443408,.5213375,.0130872,.0178135,.003421};
<span class="lineNum">    1150 </span>            :     Float_t denscer  = 3.6;
<span class="lineNum">    1151 </span>            : 
<span class="lineNum">    1152 </span>            :     // G10FR4
<span class="lineNum">    1153 </span>            :     Float_t zG10FR4[14] = {14.00,       20.00,  13.00,  12.00,  5.00,
<span class="lineNum">    1154 </span>            :                            22.00,       11.00,  19.00,  26.00,  9.00,
<span class="lineNum">    1155 </span>            :                            8.00,        6.00,   7.00,   1.00};
<span class="lineNum">    1156 </span>            :     Float_t aG10FR4[14] = {28.0855000,40.0780000,26.9815380,24.3050000,
<span class="lineNum">    1157 </span>            :                            10.8110000,47.8670000,22.9897700,39.0983000,
<span class="lineNum">    1158 </span>            :                            55.8450000,18.9984000,15.9994000,12.0107000,
<span class="lineNum">    1159 </span>            :                            14.0067000,1.0079400};
<span class="lineNum">    1160 </span>            :     Float_t wG10FR4[14] = {0.15144894,0.08147477,0.04128158,0.00904554,
<span class="lineNum">    1161 </span>            :                            0.01397570,0.00287685,0.00445114,0.00498089,
<span class="lineNum">    1162 </span>            :                            0.00209828,0.00420000,0.36043788,0.27529426,
<span class="lineNum">    1163 </span>            :                            0.01415852,0.03427566};
<span class="lineNum">    1164 </span>            :     Float_t densG10FR4= 1.8;
<span class="lineNum">    1165 </span>            : 
<span class="lineNum">    1166 </span>            :     //--- EPOXY  --- C18 H19 O3
<span class="lineNum">    1167 </span>            :     Float_t aEpoxy[3] = {15.9994, 1.00794, 12.0107} ; 
<span class="lineNum">    1168 </span>            :     Float_t zEpoxy[3] = {     8.,      1.,      6.} ; 
<span class="lineNum">    1169 </span>            :     Float_t wEpoxy[3] = {     3.,     19.,     18.} ; 
<span class="lineNum">    1170 </span>            :     Float_t dEpoxy = 1.8 ;
<span class="lineNum">    1171 </span>            : 
<span class="lineNum">    1172 </span>            :     // rohacell: C9 H13 N1 O2
<span class="lineNum">    1173 </span>            :     Float_t arohac[4] = {12.01,  1.01, 14.010, 16.};
<span class="lineNum">    1174 </span>            :     Float_t zrohac[4] = { 6.,    1.,    7.,     8.};
<span class="lineNum">    1175 </span>            :     Float_t wrohac[4] = { 9.,   13.,    1.,     2.};
<span class="lineNum">    1176 </span>            :     Float_t drohac    = 0.05;
<span class="lineNum">    1177 </span>            : 
<span class="lineNum">    1178 </span>            :     // If he/she means stainless steel (inox) + Aluminium and Zeff=15.3383 then
<span class="lineNum">    1179 </span>            :     // %Al=81.6164 %inox=100-%Al
<span class="lineNum">    1180 </span>            :     Float_t aInAl[5] = {27., 55.847,51.9961,58.6934,28.0855 };
<span class="lineNum">    1181 </span>            :     Float_t zInAl[5] = {13., 26.,24.,28.,14. };
<span class="lineNum">    1182 </span>            :     Float_t wInAl[5] = {.816164, .131443,.0330906,.0183836,.000919182};
<span class="lineNum">    1183 </span>            :     Float_t dInAl    = 3.075;
<span class="lineNum">    1184 </span>            : 
<span class="lineNum">    1185 </span>            :     // Kapton
<span class="lineNum">    1186 </span>            :     Float_t aKapton[4]={1.00794,12.0107, 14.010,15.9994};
<span class="lineNum">    1187 </span>            :     Float_t zKapton[4]={1.,6.,7.,8.};
<span class="lineNum">    1188 </span>            :     Float_t wKapton[4]={0.026362,0.69113,0.07327,0.209235};
<span class="lineNum">    1189 </span>            :     Float_t dKapton   = 1.42;
<span class="lineNum">    1190 </span>            : 
<span class="lineNum">    1191 </span>            :     //SDD ruby sph.
<span class="lineNum">    1192 </span>            :     Float_t aAlOxide[2]  = { 26.981539,15.9994};
<span class="lineNum">    1193 </span>            :     Float_t zAlOxide[2]  = {       13.,     8.};
<span class="lineNum">    1194 </span>            :     Float_t wAlOxide[2]  = {0.4707, 0.5293};
<span class="lineNum">    1195 </span>            :     Float_t dAlOxide     = 3.97;
<span class="lineNum">    1196 </span>            :     */
<a name="1197"><span class="lineNum">    1197 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1198 </span>            : //---------------------------------------------------------------------
<span class="lineNum">    1199 </span>            : void AliITSv11Geometry::DrawCrossSection(const TGeoPcon *p,
<span class="lineNum">    1200 </span>            :                             Int_t fillc,Int_t fills,
<span class="lineNum">    1201 </span>            :                             Int_t linec,Int_t lines,Int_t linew,
<span class="lineNum">    1202 </span>            :                             Int_t markc,Int_t marks,Float_t marksize)const{
<span class="lineNum">    1203 </span>            :     // Draws a cross sectional view of the TGeoPcon, Primarily for debugging.
<span class="lineNum">    1204 </span>            :     // A TCanvas should exist first.
<span class="lineNum">    1205 </span>            :     //  Inputs:
<span class="lineNum">    1206 </span>            :     //    TGeoPcon  *p  The TGeoPcon to be &quot;drawn&quot;
<span class="lineNum">    1207 </span>            :     //    Int_t  fillc  The fill color to be used
<span class="lineNum">    1208 </span>            :     //    Int_t  fills  The fill style to be used
<span class="lineNum">    1209 </span>            :     //    Int_t  linec  The line color to be used
<span class="lineNum">    1210 </span>            :     //    Int_t  lines  The line style to be used
<span class="lineNum">    1211 </span>            :     //    Int_t  linew  The line width to be used
<span class="lineNum">    1212 </span>            :     //    Int_t  markc  The markder color to be used
<span class="lineNum">    1213 </span>            :     //    Int_t  marks  The markder style to be used
<span class="lineNum">    1214 </span>            :     //    Float_t marksize The marker size
<span class="lineNum">    1215 </span>            :     // Outputs:
<span class="lineNum">    1216 </span>            :     //   none.
<span class="lineNum">    1217 </span>            :     // Return:
<span class="lineNum">    1218 </span>            :     //   none.
<span class="lineNum">    1219 </span><span class="lineNoCov">          0 :     Int_t n=0,m=0,i=0;</span>
<span class="lineNum">    1220 </span>            :     Double_t *z=0,*r=0;
<span class="lineNum">    1221 </span>            :     TPolyMarker *pts=0;
<span class="lineNum">    1222 </span>            :     TPolyLine   *line=0;
<span class="lineNum">    1223 </span>            : 
<span class="lineNum">    1224 </span><span class="lineNoCov">          0 :     n = p-&gt;GetNz();</span>
<span class="lineNum">    1225 </span><span class="lineNoCov">          0 :     if(n&lt;=0) return;</span>
<span class="lineNum">    1226 </span><span class="lineNoCov">          0 :     m = 2*n+1;</span>
<span class="lineNum">    1227 </span><span class="lineNoCov">          0 :     z = new Double_t[m];</span>
<span class="lineNum">    1228 </span><span class="lineNoCov">          0 :     r = new Double_t[m];</span>
<span class="lineNum">    1229 </span>            : 
<span class="lineNum">    1230 </span><span class="lineNoCov">          0 :     for(i=0;i&lt;n;i++){</span>
<span class="lineNum">    1231 </span><span class="lineNoCov">          0 :         z[i] = p-&gt;GetZ(i);</span>
<span class="lineNum">    1232 </span><span class="lineNoCov">          0 :         r[i] = p-&gt;GetRmax(i);</span>
<span class="lineNum">    1233 </span><span class="lineNoCov">          0 :         z[i+n] = p-&gt;GetZ(n-1-i);</span>
<span class="lineNum">    1234 </span><span class="lineNoCov">          0 :         r[i+n] = p-&gt;GetRmin(n-1-i);</span>
<span class="lineNum">    1235 </span>            :     } //  end for i
<span class="lineNum">    1236 </span><span class="lineNoCov">          0 :     z[n-1] = z[0];</span>
<span class="lineNum">    1237 </span><span class="lineNoCov">          0 :     r[n-1] = r[0];</span>
<span class="lineNum">    1238 </span>            : 
<span class="lineNum">    1239 </span><span class="lineNoCov">          0 :     line = new TPolyLine(n,z,r);</span>
<span class="lineNum">    1240 </span><span class="lineNoCov">          0 :     pts  = new TPolyMarker(n,z,r);</span>
<span class="lineNum">    1241 </span>            : 
<span class="lineNum">    1242 </span><span class="lineNoCov">          0 :     line-&gt;SetFillColor(fillc);</span>
<span class="lineNum">    1243 </span><span class="lineNoCov">          0 :     line-&gt;SetFillStyle(fills);</span>
<span class="lineNum">    1244 </span><span class="lineNoCov">          0 :     line-&gt;SetLineColor(linec);</span>
<span class="lineNum">    1245 </span><span class="lineNoCov">          0 :     line-&gt;SetLineStyle(lines);</span>
<span class="lineNum">    1246 </span><span class="lineNoCov">          0 :     line-&gt;SetLineWidth(linew);</span>
<span class="lineNum">    1247 </span><span class="lineNoCov">          0 :     pts-&gt;SetMarkerColor(markc);</span>
<span class="lineNum">    1248 </span><span class="lineNoCov">          0 :     pts-&gt;SetMarkerStyle(marks);</span>
<span class="lineNum">    1249 </span><span class="lineNoCov">          0 :     pts-&gt;SetMarkerSize(marksize);</span>
<span class="lineNum">    1250 </span>            : 
<span class="lineNum">    1251 </span><span class="lineNoCov">          0 :     line-&gt;Draw(&quot;f&quot;);</span>
<span class="lineNum">    1252 </span><span class="lineNoCov">          0 :     line-&gt;Draw();</span>
<span class="lineNum">    1253 </span><span class="lineNoCov">          0 :     pts-&gt;Draw();</span>
<span class="lineNum">    1254 </span>            : 
<span class="lineNum">    1255 </span><span class="lineNoCov">          0 :     delete[] z;</span>
<span class="lineNum">    1256 </span><span class="lineNoCov">          0 :     delete[] r;</span>
<span class="lineNum">    1257 </span>            : 
<span class="lineNum">    1258 </span><span class="lineNoCov">          0 :     cout&lt;&lt;&quot;Hit Return to continue&quot;&lt;&lt;endl;</span>
<span class="lineNum">    1259 </span><span class="lineNoCov">          0 :     cin &gt;&gt; n;</span>
<span class="lineNum">    1260 </span><span class="lineNoCov">          0 :     delete line;</span>
<span class="lineNum">    1261 </span><span class="lineNoCov">          0 :     delete pts;</span>
<span class="lineNum">    1262 </span><span class="lineNoCov">          0 :     return;</span>
<a name="1263"><span class="lineNum">    1263 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1264 </span>            : //______________________________________________________________________
<span class="lineNum">    1265 </span>            : Bool_t AliITSv11Geometry::AngleOfIntersectionWithLine(Double_t x0,Double_t y0,
<span class="lineNum">    1266 </span>            :                                                       Double_t x1,Double_t y1,
<span class="lineNum">    1267 </span>            :                                                       Double_t xc,Double_t yc,
<span class="lineNum">    1268 </span>            :                                                       Double_t rc,Double_t &amp;t0,
<span class="lineNum">    1269 </span>            :                                                       Double_t &amp;t1)const{
<span class="lineNum">    1270 </span>            :     // Computes the angles, t0 and t1 corresponding to the intersection of
<span class="lineNum">    1271 </span>            :     // the line, defined by {x0,y0} {x1,y1}, and the circle, defined by
<span class="lineNum">    1272 </span>            :     // its center {xc,yc} and radius r. If the line does not intersect the
<span class="lineNum">    1273 </span>            :     // line, function returns kFALSE, otherwise it returns kTRUE. If the
<span class="lineNum">    1274 </span>            :     // line is tangent to the circle, the angles t0 and t1 will be the same.
<span class="lineNum">    1275 </span>            :     // Inputs:
<span class="lineNum">    1276 </span>            :     //   Double_t x0   X of first point defining the line
<span class="lineNum">    1277 </span>            :     //   Double_t y0   Y of first point defining the line
<span class="lineNum">    1278 </span>            :     //   Double_t x1   X of Second point defining the line
<span class="lineNum">    1279 </span>            :     //   Double_t y1   Y of Second point defining the line
<span class="lineNum">    1280 </span>            :     //   Double_t xc   X of Circle center point defining the line
<span class="lineNum">    1281 </span>            :     //   Double_t yc   Y of Circle center point defining the line
<span class="lineNum">    1282 </span>            :     //   Double_t r    radius of circle
<span class="lineNum">    1283 </span>            :     // Outputs:
<span class="lineNum">    1284 </span>            :     //   Double_t &amp;t0  First angle where line intersects circle
<span class="lineNum">    1285 </span>            :     //   Double_t &amp;t1  Second angle where line intersects circle
<span class="lineNum">    1286 </span>            :     // Return:
<span class="lineNum">    1287 </span>            :     //    kTRUE, line intersects circle, kFALSE line does not intersect circle
<span class="lineNum">    1288 </span>            :     //           or the line is not properly defined point {x0,y0} and {x1,y1}
<span class="lineNum">    1289 </span>            :     //           are the same point.
<span class="lineNum">    1290 </span><span class="lineNoCov">          0 :     Double_t dx,dy,cx,cy,s2,t[4];</span>
<span class="lineNum">    1291 </span>            :     Double_t a0,b0,c0,a1,b1,c1,sinthp,sinthm,costhp,costhm;
<span class="lineNum">    1292 </span>            :     Int_t i,j;
<span class="lineNum">    1293 </span>            : 
<span class="lineNum">    1294 </span><span class="lineNoCov">          0 :     t0 = 400.0;</span>
<span class="lineNum">    1295 </span><span class="lineNoCov">          0 :     t1 = 400.0;</span>
<span class="lineNum">    1296 </span><span class="lineNoCov">          0 :     dx = x1-x0;</span>
<span class="lineNum">    1297 </span><span class="lineNoCov">          0 :     dy = y1-y0;</span>
<span class="lineNum">    1298 </span><span class="lineNoCov">          0 :     cx = xc-x0;</span>
<span class="lineNum">    1299 </span><span class="lineNoCov">          0 :     cy = yc-y0;</span>
<span class="lineNum">    1300 </span><span class="lineNoCov">          0 :     s2 = dx*dx+dy*dy;</span>
<span class="lineNum">    1301 </span><span class="lineNoCov">          0 :     if(s2==0.0) return kFALSE;</span>
<span class="lineNum">    1302 </span>            : 
<span class="lineNum">    1303 </span><span class="lineNoCov">          0 :     a0 = rc*rc*s2;</span>
<span class="lineNum">    1304 </span><span class="lineNoCov">          0 :     if(a0==0.0) return kFALSE;</span>
<span class="lineNum">    1305 </span><span class="lineNoCov">          0 :     b0 = 2.0*rc*dx*(dx*cy-cx*dy);</span>
<span class="lineNum">    1306 </span><span class="lineNoCov">          0 :     c0 = dx*dx*cy*cy-2.0*dy*dx*cy*cx+cx*cx*dy*dy-rc*rc*dy*dy;</span>
<span class="lineNum">    1307 </span><span class="lineNoCov">          0 :     c0 = 0.25*b0*b0/(a0*a0)-c0/a0;</span>
<span class="lineNum">    1308 </span><span class="lineNoCov">          0 :     if(c0&lt;0.0) return kFALSE;</span>
<span class="lineNum">    1309 </span><span class="lineNoCov">          0 :     sinthp = -0.5*b0/a0+TMath::Sqrt(c0);</span>
<span class="lineNum">    1310 </span><span class="lineNoCov">          0 :     sinthm = -0.5*b0/a0-TMath::Sqrt(c0);</span>
<span class="lineNum">    1311 </span>            : 
<span class="lineNum">    1312 </span>            :     a1 = rc*rc*s2;
<span class="lineNum">    1313 </span><span class="lineNoCov">          0 :     if(a1==0.0) return kFALSE;</span>
<span class="lineNum">    1314 </span><span class="lineNoCov">          0 :     b1 = 2.0*rc*dy*(dy*cx-dx*cy);</span>
<span class="lineNum">    1315 </span><span class="lineNoCov">          0 :     c1 = dy*dy*cx*cx-2.0*dy*dx*cy*cx+dx*dx*cy*cy-rc*rc*dx*dx;</span>
<span class="lineNum">    1316 </span><span class="lineNoCov">          0 :     c1 = 0.25*b1*b1/(a1*a1)-c1/a1;</span>
<span class="lineNum">    1317 </span><span class="lineNoCov">          0 :     if(c1&lt;0.0) return kFALSE;</span>
<span class="lineNum">    1318 </span><span class="lineNoCov">          0 :     costhp = -0.5*b1/a1+TMath::Sqrt(c1);</span>
<span class="lineNum">    1319 </span><span class="lineNoCov">          0 :     costhm = -0.5*b1/a1-TMath::Sqrt(c1);</span>
<span class="lineNum">    1320 </span>            : 
<span class="lineNum">    1321 </span><span class="lineNoCov">          0 :     t[0] = t[1] = t[2] = t[3] = 400.;</span>
<span class="lineNum">    1322 </span><span class="lineNoCov">          0 :     a0 = TMath::ATan2(sinthp,costhp); if(a0&lt;0.0) a0 += 2.0*TMath::Pi();</span>
<span class="lineNum">    1323 </span><span class="lineNoCov">          0 :     a1 = TMath::ATan2(sinthp,costhm); if(a1&lt;0.0) a1 += 2.0*TMath::Pi();</span>
<span class="lineNum">    1324 </span><span class="lineNoCov">          0 :     b0 = TMath::ATan2(sinthm,costhp); if(b0&lt;0.0) b0 += 2.0*TMath::Pi();</span>
<span class="lineNum">    1325 </span><span class="lineNoCov">          0 :     b1 = TMath::ATan2(sinthm,costhm); if(b1&lt;0.0) b1 += 2.0*TMath::Pi();</span>
<span class="lineNum">    1326 </span><span class="lineNoCov">          0 :     x1 = xc+rc*TMath::Cos(a0);</span>
<span class="lineNum">    1327 </span><span class="lineNoCov">          0 :     y1 = yc+rc*TMath::Sin(a0);</span>
<span class="lineNum">    1328 </span><span class="lineNoCov">          0 :     s2 = dx*(y1-y0)-dy*(x1-x0);</span>
<span class="lineNum">    1329 </span><span class="lineNoCov">          0 :     if(s2*s2&lt;DBL_EPSILON) t[0] = a0*TMath::RadToDeg();</span>
<span class="lineNum">    1330 </span><span class="lineNoCov">          0 :     x1 = xc+rc*TMath::Cos(a1);</span>
<span class="lineNum">    1331 </span><span class="lineNoCov">          0 :     y1 = yc+rc*TMath::Sin(a1);</span>
<span class="lineNum">    1332 </span><span class="lineNoCov">          0 :     s2 = dx*(y1-y0)-dy*(x1-x0);</span>
<span class="lineNum">    1333 </span><span class="lineNoCov">          0 :     if(s2*s2&lt;DBL_EPSILON) t[1] = a1*TMath::RadToDeg();</span>
<span class="lineNum">    1334 </span><span class="lineNoCov">          0 :     x1 = xc+rc*TMath::Cos(b0);</span>
<span class="lineNum">    1335 </span><span class="lineNoCov">          0 :     y1 = yc+rc*TMath::Sin(b0);</span>
<span class="lineNum">    1336 </span><span class="lineNoCov">          0 :     s2 = dx*(y1-y0)-dy*(x1-x0);</span>
<span class="lineNum">    1337 </span><span class="lineNoCov">          0 :     if(s2*s2&lt;DBL_EPSILON) t[2] = b0*TMath::RadToDeg();</span>
<span class="lineNum">    1338 </span><span class="lineNoCov">          0 :     x1 = xc+rc*TMath::Cos(b1);</span>
<span class="lineNum">    1339 </span><span class="lineNoCov">          0 :     y1 = yc+rc*TMath::Sin(b1);</span>
<span class="lineNum">    1340 </span><span class="lineNoCov">          0 :     s2 = dx*(y1-y0)-dy*(x1-x0);</span>
<span class="lineNum">    1341 </span><span class="lineNoCov">          0 :     if(s2*s2&lt;DBL_EPSILON) t[3] = b1*TMath::RadToDeg();</span>
<span class="lineNum">    1342 </span><span class="lineNoCov">          0 :     for(i=0;i&lt;4;i++)for(j=i+1;j&lt;4;j++){</span>
<span class="lineNum">    1343 </span><span class="lineNoCov">          0 :         if(t[i]&gt;t[j]) {t0 = t[i];t[i] = t[j];t[j] = t0;}</span>
<span class="lineNum">    1344 </span>            :     } // end for i,j
<span class="lineNum">    1345 </span><span class="lineNoCov">          0 :     t0 = t[0];</span>
<span class="lineNum">    1346 </span><span class="lineNoCov">          0 :     t1 = t[1];</span>
<span class="lineNum">    1347 </span>            :     //
<span class="lineNum">    1348 </span><span class="lineNoCov">          0 :     return kTRUE;</span>
<a name="1349"><span class="lineNum">    1349 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1350 </span>            : //______________________________________________________________________
<span class="lineNum">    1351 </span>            : Double_t AliITSv11Geometry::AngleForRoundedCorners0(Double_t dx,Double_t dy,
<span class="lineNum">    1352 </span>            :                                                     Double_t sdr)const{
<span class="lineNum">    1353 </span>            :     // Basic function used to determine the ending angle and starting angles
<span class="lineNum">    1354 </span>            :     // for rounded corners given the relative distance between the centers
<span class="lineNum">    1355 </span>            :     // of the circles and the difference/sum of their radii. Case 0.
<span class="lineNum">    1356 </span>            :     // Inputs:
<span class="lineNum">    1357 </span>            :     //   Double_t dx    difference in x locations of the circle centers
<span class="lineNum">    1358 </span>            :     //   Double_t dy    difference in y locations of the circle centers
<span class="lineNum">    1359 </span>            :     //   Double_t sdr   difference or sum of the circle radii
<span class="lineNum">    1360 </span>            :     // Outputs:
<span class="lineNum">    1361 </span>            :     //   none.
<span class="lineNum">    1362 </span>            :     // Return:
<span class="lineNum">    1363 </span>            :     //   the angle in Degrees
<span class="lineNum">    1364 </span>            :     Double_t a,b;
<span class="lineNum">    1365 </span>            : 
<span class="lineNum">    1366 </span><span class="lineCov">         80 :     b = dy*dy+dx*dx-sdr*sdr;</span>
<span class="lineNum">    1367 </span><span class="lineCov">         40 :     if(b&lt;0.0) Error(&quot;AngleForRoundedCorners0&quot;,</span>
<span class="lineNum">    1368 </span>            :                     &quot;dx^2(%e)+dy^2(%e)-sdr^2(%e)=b=%e&lt;0&quot;,dx,dy,sdr,b);
<span class="lineNum">    1369 </span><span class="lineCov">         40 :     b = TMath::Sqrt(b);</span>
<span class="lineNum">    1370 </span><span class="lineCov">         40 :     a = -sdr*dy+dx*b;</span>
<span class="lineNum">    1371 </span><span class="lineCov">         40 :     b = -sdr*dx-dy*b;</span>
<span class="lineNum">    1372 </span><span class="lineCov">         40 :     return TMath::ATan2(a,b)*TMath::RadToDeg();</span>
<span class="lineNum">    1373 </span>            :     
<a name="1374"><span class="lineNum">    1374 </span>            : }</a>
<span class="lineNum">    1375 </span>            : //______________________________________________________________________
<span class="lineNum">    1376 </span>            : Double_t AliITSv11Geometry::AngleForRoundedCorners1(Double_t dx,Double_t dy,
<span class="lineNum">    1377 </span>            :                                                     Double_t sdr)const{
<span class="lineNum">    1378 </span>            :     // Basic function used to determine the ending angle and starting angles
<span class="lineNum">    1379 </span>            :     // for rounded corners given the relative distance between the centers
<span class="lineNum">    1380 </span>            :     // of the circles and the difference/sum of their radii. Case 1.
<span class="lineNum">    1381 </span>            :     // Inputs:
<span class="lineNum">    1382 </span>            :     //   Double_t dx    difference in x locations of the circle centers
<span class="lineNum">    1383 </span>            :     //   Double_t dy    difference in y locations of the circle centers
<span class="lineNum">    1384 </span>            :     //   Double_t sdr   difference or sum of the circle radii
<span class="lineNum">    1385 </span>            :     // Outputs:
<span class="lineNum">    1386 </span>            :     //   none.
<span class="lineNum">    1387 </span>            :     // Return:
<span class="lineNum">    1388 </span>            :     //   the angle in Degrees
<span class="lineNum">    1389 </span>            :     Double_t a,b;
<span class="lineNum">    1390 </span>            : 
<span class="lineNum">    1391 </span><span class="lineCov">        160 :     b = dy*dy+dx*dx-sdr*sdr;</span>
<span class="lineNum">    1392 </span><span class="lineCov">         80 :     if(b&lt;0.0) Error(&quot;AngleForRoundedCorners1&quot;,</span>
<span class="lineNum">    1393 </span>            :                     &quot;dx^2(%e)+dy^2(%e)-sdr^2(%e)=b=%e&lt;0&quot;,dx,dy,sdr,b);
<span class="lineNum">    1394 </span><span class="lineCov">         80 :     b = TMath::Sqrt(b);</span>
<span class="lineNum">    1395 </span><span class="lineCov">         80 :     a = -sdr*dy-dx*b;</span>
<span class="lineNum">    1396 </span><span class="lineCov">         80 :     b = -sdr*dx+dy*b;</span>
<span class="lineNum">    1397 </span><span class="lineCov">         80 :     return TMath::ATan2(a,b)*TMath::RadToDeg();</span>
<span class="lineNum">    1398 </span>            :     
<a name="1399"><span class="lineNum">    1399 </span>            : }</a>
<span class="lineNum">    1400 </span>            : //----------------------------------------------------------------------
<span class="lineNum">    1401 </span>            : void AliITSv11Geometry::AnglesForRoundedCorners(Double_t x0,Double_t y0,
<span class="lineNum">    1402 </span>            :                                                 Double_t r0,Double_t x1,
<span class="lineNum">    1403 </span>            :                                                 Double_t y1,Double_t r1,
<span class="lineNum">    1404 </span>            :                                                 Double_t &amp;t0,Double_t &amp;t1)
<span class="lineNum">    1405 </span>            :     const{
<span class="lineNum">    1406 </span>            :     // Function to compute the ending angle, for arc 0, and starting angle,
<span class="lineNum">    1407 </span>            :     // for arc 1, such that a straight line will connect them with no
<span class="lineNum">    1408 </span>            :     // discontinuities.
<span class="lineNum">    1409 </span>            :     //Begin_Html
<span class="lineNum">    1410 </span>            :     /*
<span class="lineNum">    1411 </span>            :       &lt;img src=&quot;picts/ITS/AliITSv11Geometry_AnglesForRoundedCorners.gif&quot;&gt;
<span class="lineNum">    1412 </span>            :      */
<span class="lineNum">    1413 </span>            :     //End_Html
<span class="lineNum">    1414 </span>            :     // Inputs:
<span class="lineNum">    1415 </span>            :     //    Double_t x0  X Coordinate of arc 0 center.
<span class="lineNum">    1416 </span>            :     //    Double_t y0  Y Coordinate of arc 0 center.
<span class="lineNum">    1417 </span>            :     //    Double_t r0  Radius of curvature of arc 0. For signe see figure.
<span class="lineNum">    1418 </span>            :     //    Double_t x1  X Coordinate of arc 1 center.
<span class="lineNum">    1419 </span>            :     //    Double_t y1  Y Coordinate of arc 1 center.
<span class="lineNum">    1420 </span>            :     //    Double_t r1  Radius of curvature of arc 1. For signe see figure.
<span class="lineNum">    1421 </span>            :     // Outputs:
<span class="lineNum">    1422 </span>            :     //    Double_t t0  Ending angle of arch 0, with respect to x axis, Degrees.
<span class="lineNum">    1423 </span>            :     //    Double_t t1  Starting angle of arch 1, with respect to x axis, 
<span class="lineNum">    1424 </span>            :     //                 Degrees.
<span class="lineNum">    1425 </span>            :     // Return:
<span class="lineNum">    1426 </span>            :     //    none.
<span class="lineNum">    1427 </span>            :     Double_t t;
<span class="lineNum">    1428 </span>            : 
<span class="lineNum">    1429 </span><span class="lineCov">        240 :     if(r0&gt;=0.0&amp;&amp;r1&gt;=0.0) { // Inside to inside    ++</span>
<span class="lineNum">    1430 </span><span class="lineCov">         30 :         t = AngleForRoundedCorners1(x1-x0,y1-y0,r1-r0);</span>
<span class="lineNum">    1431 </span><span class="lineCov">         30 :         t0 = t1 = t;</span>
<span class="lineNum">    1432 </span><span class="lineCov">         30 :         return;</span>
<span class="lineNum">    1433 </span><span class="lineCov">         90 :     }else if(r0&gt;=0.0&amp;&amp;r1&lt;=0.0){ // Inside to Outside  +-</span>
<span class="lineNum">    1434 </span><span class="lineCov">         40 :         r1 = -r1; // make positive</span>
<span class="lineNum">    1435 </span><span class="lineCov">         40 :         t = AngleForRoundedCorners0(x1-x0,y1-y0,r1+r0);</span>
<span class="lineNum">    1436 </span><span class="lineCov">         40 :         t0 = 180.0 + t;</span>
<span class="lineNum">    1437 </span><span class="lineCov">         40 :         if(t0&lt;0.0) t += 360.;</span>
<span class="lineNum">    1438 </span><span class="lineCov">         50 :         if(t&lt;0.0) t += 360.;</span>
<span class="lineNum">    1439 </span><span class="lineCov">         40 :         t1 = t;</span>
<span class="lineNum">    1440 </span><span class="lineCov">         40 :         return;</span>
<span class="lineNum">    1441 </span><span class="lineCov">         50 :     }else if(r0&lt;=0.0&amp;&amp;r1&gt;=0.0){ // Outside to Inside  -+</span>
<span class="lineNum">    1442 </span><span class="lineCov">         50 :         r0 = - r0; // make positive</span>
<span class="lineNum">    1443 </span><span class="lineCov">         50 :         t = AngleForRoundedCorners1(x1-x0,y1-y0,r1+r0);</span>
<span class="lineNum">    1444 </span><span class="lineCov">         50 :         t0 = 180.0 + t;</span>
<span class="lineNum">    1445 </span><span class="lineCov">         90 :         if(t0&gt;180.) t0 -= 360.;</span>
<span class="lineNum">    1446 </span><span class="lineCov">         50 :         if(t &gt;180.) t  -= 360.;</span>
<span class="lineNum">    1447 </span><span class="lineCov">         50 :         t1 = t;</span>
<span class="lineNum">    1448 </span><span class="lineCov">         50 :         return;</span>
<span class="lineNum">    1449 </span><span class="lineNoCov">          0 :     }else if(r0&lt;=0.0&amp;&amp;r1&lt;=0.0) { // Outside to outside --</span>
<span class="lineNum">    1450 </span><span class="lineNoCov">          0 :         r0 = -r0; // make positive</span>
<span class="lineNum">    1451 </span><span class="lineNoCov">          0 :         r1 = -r1; // make positive</span>
<span class="lineNum">    1452 </span><span class="lineNoCov">          0 :         t = AngleForRoundedCorners0(x1-x0,y1-y0,r1-r0);</span>
<span class="lineNum">    1453 </span><span class="lineNoCov">          0 :         t0 = t1 = t;</span>
<span class="lineNum">    1454 </span><span class="lineNoCov">          0 :         return;</span>
<span class="lineNum">    1455 </span>            :     } // end if
<span class="lineNum">    1456 </span><span class="lineNoCov">          0 :     return;</span>
<a name="1457"><span class="lineNum">    1457 </span><span class="lineCov">        120 : }</span></a>
<span class="lineNum">    1458 </span>            : //----------------------------------------------------------------------
<span class="lineNum">    1459 </span>            : void AliITSv11Geometry::MakeFigure1(Double_t x0,Double_t y0,Double_t r0,
<span class="lineNum">    1460 </span>            :                                     Double_t x1,Double_t y1,Double_t r1){
<span class="lineNum">    1461 </span>            :     // Function to create the figure discribing how the function 
<span class="lineNum">    1462 </span>            :     // AnglesForRoundedCorners works.
<span class="lineNum">    1463 </span>            :     //
<span class="lineNum">    1464 </span>            :     // Inputs:
<span class="lineNum">    1465 </span>            :     //    Double_t x0  X Coordinate of arc 0 center.
<span class="lineNum">    1466 </span>            :     //    Double_t y0  Y Coordinate of arc 0 center.
<span class="lineNum">    1467 </span>            :     //    Double_t r0  Radius of curvature of arc 0. For signe see figure.
<span class="lineNum">    1468 </span>            :     //    Double_t x1  X Coordinate of arc 1 center.
<span class="lineNum">    1469 </span>            :     //    Double_t y1  Y Coordinate of arc 1 center.
<span class="lineNum">    1470 </span>            :     //    Double_t r1  Radius of curvature of arc 1. For signe see figure.
<span class="lineNum">    1471 </span>            :     // Outputs:
<span class="lineNum">    1472 </span>            :     //    none.
<span class="lineNum">    1473 </span>            :     // Return:
<span class="lineNum">    1474 </span>            :     //    none.
<span class="lineNum">    1475 </span><span class="lineNoCov">          0 :     Double_t t0[4],t1[4],xa0[4],ya0[4],xa1[4],ya1[4],ra0[4],ra1[4];</span>
<span class="lineNum">    1476 </span>            :     Double_t xmin,ymin,xmax,ymax,h;
<span class="lineNum">    1477 </span>            :     Int_t j;
<span class="lineNum">    1478 </span>            : 
<span class="lineNum">    1479 </span><span class="lineNoCov">          0 :     for(j=0;j&lt;4;j++) {</span>
<span class="lineNum">    1480 </span><span class="lineNoCov">          0 :         ra0[j] = r0; if(j%2) ra0[j] = -r0;</span>
<span class="lineNum">    1481 </span><span class="lineNoCov">          0 :         ra1[j] = r1; if(j&gt;1) ra1[j] = -r1;</span>
<span class="lineNum">    1482 </span><span class="lineNoCov">          0 :         AnglesForRoundedCorners(x0,y0,ra0[j],x1,y1,ra1[j],t0[j],t1[j]);</span>
<span class="lineNum">    1483 </span><span class="lineNoCov">          0 :         xa0[j] = TMath::Abs(r0)*CosD(t0[j])+x0;</span>
<span class="lineNum">    1484 </span><span class="lineNoCov">          0 :         ya0[j] = TMath::Abs(r0)*SinD(t0[j])+y0;</span>
<span class="lineNum">    1485 </span><span class="lineNoCov">          0 :         xa1[j] = TMath::Abs(r1)*CosD(t1[j])+x1;</span>
<span class="lineNum">    1486 </span><span class="lineNoCov">          0 :         ya1[j] = TMath::Abs(r1)*SinD(t1[j])+y1;</span>
<span class="lineNum">    1487 </span>            :     } // end for j
<span class="lineNum">    1488 </span><span class="lineNoCov">          0 :     if(r0&lt;0.0) r0 = -r0;</span>
<span class="lineNum">    1489 </span><span class="lineNoCov">          0 :     if(r1&lt;0.0) r1 = -r1;</span>
<span class="lineNum">    1490 </span><span class="lineNoCov">          0 :     xmin = TMath::Min(x0 - r0,x1-r1);</span>
<span class="lineNum">    1491 </span><span class="lineNoCov">          0 :     ymin = TMath::Min(y0 - r0,y1-r1);</span>
<span class="lineNum">    1492 </span><span class="lineNoCov">          0 :     xmax = TMath::Max(x0 + r0,x1+r1);</span>
<span class="lineNum">    1493 </span><span class="lineNoCov">          0 :     ymax = TMath::Max(y0 + r0,y1+r1);</span>
<span class="lineNum">    1494 </span><span class="lineNoCov">          0 :     for(j=1;j&lt;4;j++) {</span>
<span class="lineNum">    1495 </span><span class="lineNoCov">          0 :         xmin = TMath::Min(xmin,xa0[j]);</span>
<span class="lineNum">    1496 </span><span class="lineNoCov">          0 :         xmin = TMath::Min(xmin,xa1[j]);</span>
<span class="lineNum">    1497 </span><span class="lineNoCov">          0 :         ymin = TMath::Min(ymin,ya0[j]);</span>
<span class="lineNum">    1498 </span><span class="lineNoCov">          0 :         ymin = TMath::Min(ymin,ya1[j]);</span>
<span class="lineNum">    1499 </span>            : 
<span class="lineNum">    1500 </span><span class="lineNoCov">          0 :         xmax = TMath::Max(xmax,xa0[j]);</span>
<span class="lineNum">    1501 </span><span class="lineNoCov">          0 :         xmax = TMath::Max(xmax,xa1[j]);</span>
<span class="lineNum">    1502 </span><span class="lineNoCov">          0 :         ymax = TMath::Max(ymax,ya0[j]);</span>
<span class="lineNum">    1503 </span><span class="lineNoCov">          0 :         ymax = TMath::Max(ymax,ya1[j]);</span>
<span class="lineNum">    1504 </span>            :     } // end for j
<span class="lineNum">    1505 </span><span class="lineNoCov">          0 :     if(xmin&lt;0.0) xmin *= 1.1; else xmin *= 0.9;</span>
<span class="lineNum">    1506 </span><span class="lineNoCov">          0 :     if(ymin&lt;0.0) ymin *= 1.1; else ymin *= 0.9;</span>
<span class="lineNum">    1507 </span><span class="lineNoCov">          0 :     if(xmax&lt;0.0) xmax *= 0.9; else xmax *= 1.1;</span>
<span class="lineNum">    1508 </span><span class="lineNoCov">          0 :     if(ymax&lt;0.0) ymax *= 0.9; else ymax *= 1.1;</span>
<span class="lineNum">    1509 </span><span class="lineNoCov">          0 :     j = (Int_t)(500.0*(ymax-ymin)/(xmax-xmin));</span>
<span class="lineNum">    1510 </span><span class="lineNoCov">          0 :     TCanvas *can = new TCanvas(&quot;AliITSv11Geometry_AnglesForRoundedCorners&quot;,</span>
<span class="lineNum">    1511 </span>            :                                &quot;Figure for AliITSv11Geometry&quot;,500,j);
<span class="lineNum">    1512 </span><span class="lineNoCov">          0 :     h = ymax-ymin; if(h&lt;0) h = -h;</span>
<span class="lineNum">    1513 </span><span class="lineNoCov">          0 :     can-&gt;Range(xmin,ymin,xmax,ymax);</span>
<span class="lineNum">    1514 </span><span class="lineNoCov">          0 :     TArc *c0 = new TArc(x0,y0,r0);</span>
<span class="lineNum">    1515 </span><span class="lineNoCov">          0 :     TArc *c1 = new TArc(x1,y1,r1);</span>
<span class="lineNum">    1516 </span><span class="lineNoCov">          0 :     TLine *line[4];</span>
<span class="lineNum">    1517 </span><span class="lineNoCov">          0 :     TArrow *ar0[4];</span>
<span class="lineNum">    1518 </span><span class="lineNoCov">          0 :     TArrow *ar1[4];</span>
<span class="lineNum">    1519 </span><span class="lineNoCov">          0 :     for(j=0;j&lt;4;j++){</span>
<span class="lineNum">    1520 </span><span class="lineNoCov">          0 :         ar0[j] = new TArrow(x0,y0,xa0[j],ya0[j]);</span>
<span class="lineNum">    1521 </span><span class="lineNoCov">          0 :         ar1[j] = new TArrow(x1,y1,xa1[j],ya1[j]);</span>
<span class="lineNum">    1522 </span><span class="lineNoCov">          0 :         line[j] = new TLine(xa0[j],ya0[j],xa1[j],ya1[j]);</span>
<span class="lineNum">    1523 </span><span class="lineNoCov">          0 :         ar0[j]-&gt;SetLineColor(j+1);</span>
<span class="lineNum">    1524 </span><span class="lineNoCov">          0 :         ar0[j]-&gt;SetArrowSize(0.1*r0/h);</span>
<span class="lineNum">    1525 </span><span class="lineNoCov">          0 :         ar1[j]-&gt;SetLineColor(j+1);</span>
<span class="lineNum">    1526 </span><span class="lineNoCov">          0 :         ar1[j]-&gt;SetArrowSize(0.1*r1/h);</span>
<span class="lineNum">    1527 </span><span class="lineNoCov">          0 :         line[j]-&gt;SetLineColor(j+1);</span>
<span class="lineNum">    1528 </span>            :     } // end for j
<span class="lineNum">    1529 </span><span class="lineNoCov">          0 :     c0-&gt;Draw();</span>
<span class="lineNum">    1530 </span><span class="lineNoCov">          0 :     c1-&gt;Draw();</span>
<span class="lineNum">    1531 </span><span class="lineNoCov">          0 :     for(j=0;j&lt;4;j++){</span>
<span class="lineNum">    1532 </span><span class="lineNoCov">          0 :         ar0[j]-&gt;Draw();</span>
<span class="lineNum">    1533 </span><span class="lineNoCov">          0 :         ar1[j]-&gt;Draw();</span>
<span class="lineNum">    1534 </span><span class="lineNoCov">          0 :         line[j]-&gt;Draw();</span>
<span class="lineNum">    1535 </span>            :     } // end for j
<span class="lineNum">    1536 </span><span class="lineNoCov">          0 :     TText *t = new TText();</span>
<span class="lineNum">    1537 </span><span class="lineNoCov">          0 :     t-&gt;SetTextSize(0.02);</span>
<span class="lineNum">    1538 </span><span class="lineNoCov">          0 :     Char_t txt[100];</span>
<span class="lineNum">    1539 </span><span class="lineNoCov">          0 :     snprintf(txt,99,&quot;(x0=%5.2f,y0=%5.2f)&quot;,x0,y0);</span>
<span class="lineNum">    1540 </span><span class="lineNoCov">          0 :     t-&gt;DrawText(x0,y0,txt);</span>
<span class="lineNum">    1541 </span><span class="lineNoCov">          0 :     snprintf(txt,99,&quot;(x1=%5.2f,y1=%5.2f)&quot;,x1,y1);</span>
<span class="lineNum">    1542 </span><span class="lineNoCov">          0 :     for(j=0;j&lt;4;j++) {</span>
<span class="lineNum">    1543 </span><span class="lineNoCov">          0 :         t-&gt;SetTextColor(j+1);</span>
<span class="lineNum">    1544 </span><span class="lineNoCov">          0 :         t-&gt;DrawText(x1,y1,txt);</span>
<span class="lineNum">    1545 </span><span class="lineNoCov">          0 :         snprintf(txt,99,&quot;r0=%5.2f&quot;,ra0[j]);</span>
<span class="lineNum">    1546 </span><span class="lineNoCov">          0 :         t-&gt;DrawText(0.5*(x0+xa0[j]),0.5*(y0+ya0[j]),txt);</span>
<span class="lineNum">    1547 </span><span class="lineNoCov">          0 :         snprintf(txt,99,&quot;r1=%5.2f&quot;,ra1[j]);</span>
<span class="lineNum">    1548 </span><span class="lineNoCov">          0 :         t-&gt;DrawText(0.5*(x1+xa1[j]),0.5*(y1+ya1[j]),txt);</span>
<span class="lineNum">    1549 </span>            :     } // end for j
<span class="lineNum">    1550 </span><span class="lineNoCov">          0 : }</span>
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.11</a></td></tr>
  </table>
  <br>

</body>
</html>
