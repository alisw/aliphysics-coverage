<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - coverage.info - ITS/ITSbase/AliITSQAChecker.cxx</title>
  <link rel="stylesheet" type="text/css" href="../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../index.html">top level</a> - <a href="index.html">ITS/ITSbase</a> - AliITSQAChecker.cxx<span style="font-size: 80%;"> (source / <a href="AliITSQAChecker.cxx.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">coverage.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">47</td>
            <td class="headerCovTableEntry">274</td>
            <td class="headerCovTableEntryLo">17.2 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2016-06-14 17:26:59</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">4</td>
            <td class="headerCovTableEntry">15</td>
            <td class="headerCovTableEntryLo">26.7 %</td>
          </tr>
          <tr><td><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            :  /**************************************************************************</a>
<span class="lineNum">       2 </span>            :  * Copyright(c) 2007-2009, ALICE Experiment at CERN, All rights reserved. *
<span class="lineNum">       3 </span>            :  *                                                                        *
<span class="lineNum">       4 </span>            :  * Author: The ALICE Off-line Project.                                    *
<span class="lineNum">       5 </span>            :  * Contributors are mentioned in the code where appropriate.              *
<span class="lineNum">       6 </span>            :  *                                                                        *
<span class="lineNum">       7 </span>            :  * Permission to use, copy, modify and distribute this software and its   *
<span class="lineNum">       8 </span>            :  * documentation strictly for non-commercial purposes is hereby granted   *
<span class="lineNum">       9 </span>            :  * without fee, provided that the above copyright notice appears in all   *
<span class="lineNum">      10 </span>            :  * copies and that both the copyright notice and this permission notice   *
<span class="lineNum">      11 </span>            :  * appear in the supporting documentation. The authors make no claims     *
<span class="lineNum">      12 </span>            :  * about the suitability of this software for any purpose. It is          *
<span class="lineNum">      13 </span>            :  * provided &quot;as is&quot; without express or implied warranty.                  *
<span class="lineNum">      14 </span>            :  **************************************************************************/
<span class="lineNum">      15 </span>            : 
<span class="lineNum">      16 </span>            : /* $Id$ */
<span class="lineNum">      17 </span>            : 
<span class="lineNum">      18 </span>            : // *****************************************
<span class="lineNum">      19 </span>            : //  Checks the quality assurance 
<span class="lineNum">      20 </span>            : //  by comparing with reference data
<span class="lineNum">      21 </span>            : //  W.Ferrarese  P.Cerello  Mag 2008
<span class="lineNum">      22 </span>            : //  INFN Torino
<span class="lineNum">      23 </span>            : 
<span class="lineNum">      24 </span>            : // --- ROOT system ---
<span class="lineNum">      25 </span>            : #include &quot;TH1.h&quot;
<span class="lineNum">      26 </span>            : #include &lt;Riostream.h&gt;
<span class="lineNum">      27 </span>            : #include &quot;TStyle.h&quot;
<span class="lineNum">      28 </span>            : 
<span class="lineNum">      29 </span>            : // --- AliRoot header files ---
<span class="lineNum">      30 </span>            : #include &quot;AliITSQAChecker.h&quot;
<span class="lineNum">      31 </span>            : #include &quot;AliITSQASPDChecker.h&quot;
<span class="lineNum">      32 </span>            : #include &quot;AliITSQASDDChecker.h&quot;
<span class="lineNum">      33 </span>            : #include &quot;AliITSQASSDChecker.h&quot;
<a name="34"><span class="lineNum">      34 </span>            : #include &quot;AliITSQADataMakerRec.h&quot;</a>
<span class="lineNum">      35 </span>            : 
<span class="lineNum">      36 </span><span class="lineCov">        118 : ClassImp(AliITSQAChecker)</span>
<a name="37"><span class="lineNum">      37 </span>            : </a>
<span class="lineNum">      38 </span>            : //____________________________________________________________________________
<span class="lineNum">      39 </span>            : AliITSQAChecker::AliITSQAChecker(Bool_t kMode, Short_t subDet, Short_t ldc) :
<span class="lineNum">      40 </span><span class="lineCov">          3 : AliQACheckerBase(&quot;ITS&quot;,&quot;SDD Quality Assurance Checker&quot;),</span>
<span class="lineNum">      41 </span><span class="lineCov">          3 : fkOnline(0),</span>
<span class="lineNum">      42 </span><span class="lineCov">          3 : fDet(0),  </span>
<span class="lineNum">      43 </span><span class="lineCov">          3 : fLDC(0),</span>
<span class="lineNum">      44 </span><span class="lineCov">          3 : fSPDOffset(0), </span>
<span class="lineNum">      45 </span><span class="lineCov">          3 : fSDDOffset(0), </span>
<span class="lineNum">      46 </span><span class="lineCov">          3 : fSSDOffset(0),</span>
<span class="lineNum">      47 </span><span class="lineCov">          3 : fSPDHisto(0),</span>
<span class="lineNum">      48 </span><span class="lineCov">          3 : fSDDHisto(0),</span>
<span class="lineNum">      49 </span><span class="lineCov">          3 : fSSDHisto(0),</span>
<span class="lineNum">      50 </span><span class="lineCov">          3 : fSPDChecker(0),  // SPD Checker</span>
<span class="lineNum">      51 </span><span class="lineCov">          3 : fSDDChecker(0),  // SDD Checker</span>
<span class="lineNum">      52 </span><span class="lineCov">          3 : fSSDChecker(0)  // SSD Checker</span>
<span class="lineNum">      53 </span>            : 
<span class="lineNum">      54 </span><span class="lineCov">          9 : {</span>
<span class="lineNum">      55 </span>            :   // Standard constructor
<span class="lineNum">      56 </span><span class="lineCov">          3 :   fkOnline = kMode; fDet = subDet; fLDC = ldc;</span>
<span class="lineNum">      57 </span><span class="lineCov">          3 :   if(fDet == 0 || fDet == 1) {</span>
<span class="lineNum">      58 </span><span class="lineCov">         15 :     AliDebug(AliQAv1::GetQADebugLevel(),&quot;AliITSQAChecker::Create SPD Checker\n&quot;);</span>
<span class="lineNum">      59 </span><span class="lineCov">          9 :     fSPDChecker = new AliITSQASPDChecker();</span>
<span class="lineNum">      60 </span><span class="lineCov">          3 :   }</span>
<span class="lineNum">      61 </span><span class="lineCov">          3 :   if(fDet == 0 || fDet == 2) {</span>
<span class="lineNum">      62 </span><span class="lineCov">         15 :     AliDebug(AliQAv1::GetQADebugLevel(),&quot;AliITSQAChecker::Create SDD Checker\n&quot;);</span>
<span class="lineNum">      63 </span><span class="lineCov">          9 :     fSDDChecker = new AliITSQASDDChecker();</span>
<span class="lineNum">      64 </span><span class="lineCov">          3 :   }</span>
<span class="lineNum">      65 </span><span class="lineCov">          3 :   if(fDet == 0 || fDet == 3) {</span>
<span class="lineNum">      66 </span><span class="lineCov">         15 :     AliDebug(AliQAv1::GetQADebugLevel(),&quot;AliITSQAChecker::Create SSD Checker\n&quot;);</span>
<span class="lineNum">      67 </span><span class="lineCov">          9 :     fSSDChecker = new AliITSQASSDChecker();</span>
<span class="lineNum">      68 </span><span class="lineCov">          3 :   }</span>
<span class="lineNum">      69 </span><span class="lineCov">          3 :   InitQACheckerLimits();</span>
<span class="lineNum">      70 </span><span class="lineCov">          6 : }</span>
<a name="71"><span class="lineNum">      71 </span>            : </a>
<span class="lineNum">      72 </span>            : //____________________________________________________________________________
<span class="lineNum">      73 </span><span class="lineNoCov">          0 : AliITSQAChecker::~AliITSQAChecker(){</span>
<span class="lineNum">      74 </span>            :   // destructor
<span class="lineNum">      75 </span><span class="lineNoCov">          0 :   if(fSPDChecker)delete fSPDChecker;</span>
<span class="lineNum">      76 </span><span class="lineNoCov">          0 :   if(fSDDChecker)delete fSDDChecker;</span>
<span class="lineNum">      77 </span><span class="lineNoCov">          0 :   if(fSSDChecker)delete fSSDChecker;</span>
<span class="lineNum">      78 </span>            : 
<a name="79"><span class="lineNum">      79 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">      80 </span>            : //____________________________________________________________________________
<span class="lineNum">      81 </span>            : void AliITSQAChecker::Check(Double_t * rv, AliQAv1::ALITASK_t index, TObjArray ** list, const AliDetectorRecoParam * recoParam)
<span class="lineNum">      82 </span>            : {
<span class="lineNum">      83 </span>            : 
<span class="lineNum">      84 </span>            : 
<span class="lineNum">      85 </span>            :   // basic checks on the QA histograms on the input list
<span class="lineNum">      86 </span>            :   //for the ITS subdetectorQA (Raws Digits Hits RecPoints SDigits) return the worst value of the three result
<span class="lineNum">      87 </span><span class="lineNoCov">          0 :   if(index == AliQAv1::kESD){</span>
<span class="lineNum">      88 </span>            :     
<span class="lineNum">      89 </span><span class="lineNoCov">          0 :     for (Int_t specie = 0 ; specie &lt; AliRecoParam::kNSpecies ; specie++) {</span>
<span class="lineNum">      90 </span><span class="lineNoCov">          0 :       rv[specie] = 0.0 ; </span>
<span class="lineNum">      91 </span><span class="lineNoCov">          0 :       if ( !AliQAv1::Instance()-&gt;IsEventSpecieSet(specie) ) </span>
<span class="lineNum">      92 </span>            :         continue ; 
<span class="lineNum">      93 </span><span class="lineNoCov">          0 :       AliDebug(AliQAv1::GetQADebugLevel(),&quot;Checker for ESD&quot;);</span>
<span class="lineNum">      94 </span>            :       Int_t tested = 0;
<span class="lineNum">      95 </span>            :       Int_t empty = 0;
<span class="lineNum">      96 </span>            :       // The following flags are set to kTRUE if the corresponding
<span class="lineNum">      97 </span>            :       // QA histograms exceed a given quality threshold
<span class="lineNum">      98 </span>            :       Bool_t cluMapSA = kFALSE;
<span class="lineNum">      99 </span>            :       Bool_t cluMapMI = kFALSE;
<span class="lineNum">     100 </span>            :       Bool_t cluMI = kFALSE;
<span class="lineNum">     101 </span>            :       Bool_t cluSA = kFALSE;
<span class="lineNum">     102 </span>            :       Bool_t verSPDZ = kFALSE;
<span class="lineNum">     103 </span><span class="lineNoCov">          0 :       if (list[specie]-&gt;GetEntries() == 0) {</span>
<span class="lineNum">     104 </span><span class="lineNoCov">          0 :         rv[specie] = 0.; // nothing to check</span>
<span class="lineNum">     105 </span><span class="lineNoCov">          0 :       }</span>
<span class="lineNum">     106 </span>            :       else {
<span class="lineNum">     107 </span><span class="lineNoCov">          0 :         Double_t stepbit[AliQAv1::kNBIT];</span>
<span class="lineNum">     108 </span><span class="lineNoCov">          0 :         Double_t histonumb= list[specie]-&gt;GetEntries();</span>
<span class="lineNum">     109 </span><span class="lineNoCov">          0 :         CreateStepForBit(histonumb,stepbit); </span>
<span class="lineNum">     110 </span><span class="lineNoCov">          0 :         TIter next1(list[specie]);</span>
<span class="lineNum">     111 </span>            :         TH1 * hdata;
<span class="lineNum">     112 </span>            :         Int_t nskipped=0;
<span class="lineNum">     113 </span><span class="lineNoCov">          0 :         Bool_t skipped[6]={kFALSE,kFALSE,kFALSE,kFALSE,kFALSE,kFALSE};</span>
<span class="lineNum">     114 </span>            :         // look for layers that we wanted to skip
<span class="lineNum">     115 </span><span class="lineNoCov">          0 :         while ( (hdata = dynamic_cast&lt;TH1 *&gt;(next1())) ) {</span>
<span class="lineNum">     116 </span><span class="lineNoCov">          0 :           if(hdata){</span>
<span class="lineNum">     117 </span><span class="lineNoCov">          0 :             TString hname = hdata-&gt;GetName();</span>
<span class="lineNum">     118 </span><span class="lineNoCov">          0 :             if(!hname.Contains(&quot;hESDSkippedLayers&quot;)) continue;</span>
<span class="lineNum">     119 </span><span class="lineNoCov">          0 :             for(Int_t k=1; k&lt;7; k++) {</span>
<span class="lineNum">     120 </span><span class="lineNoCov">          0 :               if(hdata-&gt;GetBinContent(k)&gt;0) { </span>
<span class="lineNum">     121 </span><span class="lineNoCov">          0 :                 nskipped++; </span>
<span class="lineNum">     122 </span><span class="lineNoCov">          0 :                 skipped[k-1]=kTRUE; </span>
<span class="lineNum">     123 </span><span class="lineNoCov">          0 :               } </span>
<span class="lineNum">     124 </span>            :             } 
<span class="lineNum">     125 </span><span class="lineNoCov">          0 :           }</span>
<span class="lineNum">     126 </span>            :         }
<span class="lineNum">     127 </span><span class="lineNoCov">          0 :         TIter next(list[specie]);</span>
<span class="lineNum">     128 </span><span class="lineNoCov">          0 :         while ( (hdata = dynamic_cast&lt;TH1 *&gt;(next())) ) {</span>
<span class="lineNum">     129 </span><span class="lineNoCov">          0 :           if(hdata){</span>
<span class="lineNum">     130 </span><span class="lineNoCov">          0 :             TString hname = hdata-&gt;GetName();</span>
<span class="lineNum">     131 </span><span class="lineNoCov">          0 :             Double_t entries = hdata-&gt;GetEntries();</span>
<span class="lineNum">     132 </span><span class="lineNoCov">          0 :             ++tested;</span>
<span class="lineNum">     133 </span><span class="lineNoCov">          0 :             if(!(entries&gt;0.))++empty;</span>
<span class="lineNum">     134 </span><span class="lineNoCov">          0 :             AliDebug(AliQAv1::GetQADebugLevel(),Form(&quot;ESD hist name %s - entries %12.1g&quot;,hname.Data(),entries));</span>
<span class="lineNum">     135 </span><span class="lineNoCov">          0 :             if(hname.Contains(&quot;hESDClusterMapSA&quot;) &amp;&amp; entries&gt;0.){</span>
<span class="lineNum">     136 </span>            :               cluMapSA = kTRUE;
<span class="lineNum">     137 </span><span class="lineNoCov">          0 :               AliDebug(AliQAv1::GetQADebugLevel(),Form(&quot;Processing histogram %s&quot;,hname.Data()));</span>
<span class="lineNum">     138 </span>            :               // Check if there are layers with anomalously low 
<span class="lineNum">     139 </span>            :               // contributing points to SA reconstructed tracks
<span class="lineNum">     140 </span><span class="lineNoCov">          0 :               for(Int_t k=1;k&lt;7;k++){</span>
<span class="lineNum">     141 </span>            :                 // check if the layer was skipped
<span class="lineNum">     142 </span><span class="lineNoCov">          0 :                 if(skipped[k-1]) continue;</span>
<span class="lineNum">     143 </span><span class="lineNoCov">          0 :                 if(hdata-&gt;GetBinContent(k)&lt;0.5*(entries/6.)){</span>
<span class="lineNum">     144 </span>            :                   cluMapSA = kFALSE;
<span class="lineNum">     145 </span><span class="lineNoCov">          0 :                   AliDebug(AliQAv1::GetQADebugLevel(),Form(&quot;SA tracks have few points on layer %d - look at histogram hESDClustersSA&quot;,k));</span>
<span class="lineNum">     146 </span>            :                 }
<span class="lineNum">     147 </span>            :               }  
<span class="lineNum">     148 </span><span class="lineNoCov">          0 :             }//end clustermapsa </span>
<span class="lineNum">     149 </span>            :             
<span class="lineNum">     150 </span><span class="lineNoCov">          0 :             else if(hname.Contains(&quot;hESDClusterMapMI&quot;) &amp;&amp; entries&gt;0.){</span>
<span class="lineNum">     151 </span>            :               // Check if there are layers with anomalously low 
<span class="lineNum">     152 </span>            :               // contributing points to MI reconstructed tracks
<span class="lineNum">     153 </span><span class="lineNoCov">          0 :               AliDebug(AliQAv1::GetQADebugLevel(),Form(&quot;Processing histogram %s&quot;,hname.Data()));</span>
<span class="lineNum">     154 </span>            :               cluMapMI = kTRUE;
<span class="lineNum">     155 </span><span class="lineNoCov">          0 :               for(Int_t k=1;k&lt;7;k++){</span>
<span class="lineNum">     156 </span>            :                 // check if the layer was skipped
<span class="lineNum">     157 </span><span class="lineNoCov">          0 :                 if(skipped[k-1]) continue;</span>
<span class="lineNum">     158 </span><span class="lineNoCov">          0 :                 if(hdata-&gt;GetBinContent(k)&lt;0.5*(entries/6.)){</span>
<span class="lineNum">     159 </span>            :                   cluMapMI = kFALSE;
<span class="lineNum">     160 </span><span class="lineNoCov">          0 :                   AliDebug(AliQAv1::GetQADebugLevel(),Form(&quot;MI tracks have few points on layer %d - look at histogram hESDClustersMI&quot;,k));</span>
<span class="lineNum">     161 </span>            :                 }
<span class="lineNum">     162 </span>            :               }  
<span class="lineNum">     163 </span><span class="lineNoCov">          0 :             }//end clustermapmi</span>
<span class="lineNum">     164 </span>            :             
<span class="lineNum">     165 </span><span class="lineNoCov">          0 :             else if(hname.Contains(&quot;hESDClustersMI&quot;) &amp;&amp; entries&gt;0.){</span>
<span class="lineNum">     166 </span>            :               // Check if 6 clusters MI tracks are the majority
<span class="lineNum">     167 </span><span class="lineNoCov">          0 :               AliDebug(AliQAv1::GetQADebugLevel(),Form(&quot;Processing histogram %s&quot;,hname.Data()));</span>
<span class="lineNum">     168 </span>            :               cluMI = kTRUE;
<span class="lineNum">     169 </span><span class="lineNoCov">          0 :               Double_t maxlaytracks = hdata-&gt;GetBinContent(7-nskipped);</span>
<span class="lineNum">     170 </span><span class="lineNoCov">          0 :               for(Int_t k=2; k&lt;7-nskipped; k++){</span>
<span class="lineNum">     171 </span><span class="lineNoCov">          0 :                 if(hdata-&gt;GetBinContent(k)&gt;maxlaytracks){</span>
<span class="lineNum">     172 </span>            :                   cluMI = kFALSE;
<span class="lineNum">     173 </span><span class="lineNoCov">          0 :                   AliDebug(AliQAv1::GetQADebugLevel(),Form(&quot;MI Tracks with %d clusters are more than tracks with %d clusters. Look at histogram hESDClustersMI&quot;,k-1,6-nskipped));</span>
<span class="lineNum">     174 </span>            :                 }
<span class="lineNum">     175 </span>            :               }
<span class="lineNum">     176 </span><span class="lineNoCov">          0 :             }//end clustersmi</span>
<span class="lineNum">     177 </span>            :             
<span class="lineNum">     178 </span><span class="lineNoCov">          0 :             else if(hname.Contains(&quot;hESDClustersSA&quot;) &amp;&amp; entries&gt;0.){</span>
<span class="lineNum">     179 </span>            :               // Check if 6 clusters SA tracks are the majority
<span class="lineNum">     180 </span><span class="lineNoCov">          0 :               AliDebug(AliQAv1::GetQADebugLevel(),Form(&quot;Processing histogram %s&quot;,hname.Data()));</span>
<span class="lineNum">     181 </span>            :               cluSA = kTRUE;
<span class="lineNum">     182 </span><span class="lineNoCov">          0 :               Double_t maxlaytracks = hdata-&gt;GetBinContent(7-nskipped);</span>
<span class="lineNum">     183 </span><span class="lineNoCov">          0 :               for(Int_t k=2; k&lt;7-nskipped; k++){</span>
<span class="lineNum">     184 </span><span class="lineNoCov">          0 :                 if(hdata-&gt;GetBinContent(k)&gt;maxlaytracks){</span>
<span class="lineNum">     185 </span>            :                   cluSA = kFALSE;
<span class="lineNum">     186 </span><span class="lineNoCov">          0 :                   AliDebug(AliQAv1::GetQADebugLevel(), Form(&quot;SA Tracks with %d clusters are more than tracks with %d clusters. Look at histogram hESDClustersSA&quot;,k-1,6-nskipped));</span>
<span class="lineNum">     187 </span>            :                 }
<span class="lineNum">     188 </span>            :               }
<span class="lineNum">     189 </span><span class="lineNoCov">          0 :             }//end clusterssa</span>
<span class="lineNum">     190 </span>            :             
<span class="lineNum">     191 </span><span class="lineNoCov">          0 :             else if(hname.Contains(&quot;hSPDVertexZ&quot;) &amp;&amp; entries&gt;0.){</span>
<span class="lineNum">     192 </span>            :               // Check if average Z vertex coordinate is -5 &lt; z &lt; 5 cm
<span class="lineNum">     193 </span><span class="lineNoCov">          0 :               AliDebug(AliQAv1::GetQADebugLevel(),Form(&quot;Processing histogram %s&quot;,hname.Data()));</span>
<span class="lineNum">     194 </span>            :               verSPDZ = kTRUE;
<span class="lineNum">     195 </span><span class="lineNoCov">          0 :               if(hdata-&gt;GetMean()&lt;-5. &amp;&amp; hdata-&gt;GetMean()&gt;5.){</span>
<span class="lineNum">     196 </span>            :                 verSPDZ = kFALSE;
<span class="lineNum">     197 </span><span class="lineNoCov">          0 :                 AliDebug(AliQAv1::GetQADebugLevel(),Form(&quot;Average z vertex coordinate is at z= %10.4g cm&quot;,hdata-&gt;GetMean()));</span>
<span class="lineNum">     198 </span>            :               }
<span class="lineNum">     199 </span>            :             }//end spdvertexz
<span class="lineNum">     200 </span>            :             
<span class="lineNum">     201 </span><span class="lineNoCov">          0 :             else{ AliError(&quot;ESD Checker - invalid data type&quot;);}//end else</span>
<span class="lineNum">     202 </span>            :             
<span class="lineNum">     203 </span><span class="lineNoCov">          0 :             rv[specie] = 0.;</span>
<span class="lineNum">     204 </span><span class="lineNoCov">          0 :             if(tested&gt;0){</span>
<span class="lineNum">     205 </span><span class="lineNoCov">          0 :               if(tested == empty){</span>
<span class="lineNum">     206 </span><span class="lineNoCov">          0 :                 rv[specie] = 2500.; // set to error</span>
<span class="lineNum">     207 </span><span class="lineNoCov">          0 :                 AliWarning(Form(&quot;All ESD histograms are empty - specie=%d&quot;,specie));</span>
<span class="lineNum">     208 </span>            :               }
<span class="lineNum">     209 </span>            :               else {
<span class="lineNum">     210 </span><span class="lineNoCov">          0 :                 rv[specie] = 2500.-1500.*(static_cast&lt;Double_t&gt;(tested-empty)/static_cast&lt;Double_t&gt;(tested)); // INFO if all histos are filled</span>
<span class="lineNum">     211 </span><span class="lineNoCov">          0 :                 if(cluMapSA)rv[specie]-=200.;</span>
<span class="lineNum">     212 </span><span class="lineNoCov">          0 :                 if(cluMapMI)rv[specie]-=200.;</span>
<span class="lineNum">     213 </span><span class="lineNoCov">          0 :                 if(cluMI)rv[specie]-=200.;</span>
<span class="lineNum">     214 </span><span class="lineNoCov">          0 :                 if(cluSA)rv[specie]-=200.;</span>
<span class="lineNum">     215 </span><span class="lineNoCov">          0 :                 if(verSPDZ)rv[specie]-=199.;  // down to 1 if everything is OK</span>
<span class="lineNum">     216 </span>            :               }
<span class="lineNum">     217 </span>            :             }//end tested
<span class="lineNum">     218 </span><span class="lineNoCov">          0 :           }//end hdata</span>
<span class="lineNum">     219 </span>            :         }//end while
<span class="lineNum">     220 </span>            :         //     AliDebug(AliQAv1::GetQADebugLevel(), Form(&quot;ESD - Tested %d histograms, Return value %f \n&quot;,tested,rv[specie]));
<span class="lineNum">     221 </span><span class="lineNoCov">          0 :         AliInfo(Form(&quot;ESD - Tested %d histograms, Return value %f \n&quot;,tested,rv[specie]));</span>
<span class="lineNum">     222 </span><span class="lineNoCov">          0 :       }</span>
<span class="lineNum">     223 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">     224 </span><span class="lineNoCov">          0 :   } // end of ESD QA</span>
<span class="lineNum">     225 </span>            :   else{
<span class="lineNum">     226 </span>            :     
<span class="lineNum">     227 </span>            :     //____________________________________________________________________________
<span class="lineNum">     228 </span>            : 
<span class="lineNum">     229 </span><span class="lineNoCov">          0 :     Double_t spdCheck[AliRecoParam::kNSpecies] ;</span>
<span class="lineNum">     230 </span><span class="lineNoCov">          0 :     Double_t sddCheck[AliRecoParam::kNSpecies] ;</span>
<span class="lineNum">     231 </span><span class="lineNoCov">          0 :     Double_t ssdCheck[AliRecoParam::kNSpecies] ;</span>
<span class="lineNum">     232 </span>            : 
<span class="lineNum">     233 </span>            : 
<span class="lineNum">     234 </span>            : 
<span class="lineNum">     235 </span><span class="lineNoCov">          0 :     for (Int_t specie = 0 ; specie &lt; AliRecoParam::kNSpecies ; specie++) {</span>
<span class="lineNum">     236 </span><span class="lineNoCov">          0 :       if ( !AliQAv1::Instance()-&gt;IsEventSpecieSet(specie)) continue; </span>
<span class="lineNum">     237 </span><span class="lineNoCov">          0 :       if ( AliQAv1::Instance()-&gt;IsEventSpecieSet(specie) ) {</span>
<span class="lineNum">     238 </span><span class="lineNoCov">          0 :         Double_t histotot=list[specie]-&gt;GetEntries();</span>
<span class="lineNum">     239 </span><span class="lineNoCov">          0 :         if(histotot!=0)</span>
<span class="lineNum">     240 </span>            :           {
<span class="lineNum">     241 </span><span class="lineNoCov">          0 :             spdCheck[specie]=0.;</span>
<span class="lineNum">     242 </span><span class="lineNoCov">          0 :             sddCheck[specie]=0.;</span>
<span class="lineNum">     243 </span><span class="lineNoCov">          0 :             ssdCheck[specie]=0.;</span>
<span class="lineNum">     244 </span><span class="lineNoCov">          0 :             rv[specie] = 0.0 ;// </span>
<span class="lineNum">     245 </span>            :             //pixel
<span class="lineNum">     246 </span><span class="lineNoCov">          0 :             if(fDet == 0 || fDet == 1) {</span>
<span class="lineNum">     247 </span><span class="lineNoCov">          0 :               fSPDChecker-&gt;SetTaskOffset(fSPDOffset);</span>
<span class="lineNum">     248 </span>            :               //printf(&quot;spdoffset = %i \n&quot;,fSPDOffset );
<span class="lineNum">     249 </span><span class="lineNoCov">          0 :               Double_t histoSPD=double(GetSPDHisto());</span>
<span class="lineNum">     250 </span><span class="lineNoCov">          0 :               if(AliITSQADataMakerRec::AreEqual(histoSPD,0)==kFALSE){</span>
<span class="lineNum">     251 </span><span class="lineNoCov">          0 :                 Double_t *stepSPD=new Double_t[AliQAv1::kNBIT];</span>
<span class="lineNum">     252 </span><span class="lineNoCov">          0 :                 CreateStepForBit(histoSPD,stepSPD);</span>
<span class="lineNum">     253 </span><span class="lineNoCov">          0 :                 fSPDChecker-&gt;SetStepBit(stepSPD);</span>
<span class="lineNum">     254 </span><span class="lineNoCov">          0 :                 spdCheck[specie] = fSPDChecker-&gt;Check(index, list[specie], recoParam);</span>
<span class="lineNum">     255 </span><span class="lineNoCov">          0 :                 if(spdCheck[specie]&gt;fUpTestValue[AliQAv1::kFATAL]||spdCheck[specie]&lt;0.)</span>
<span class="lineNum">     256 </span>            :                   {
<span class="lineNum">     257 </span><span class="lineNoCov">          0 :                     AliInfo(Form(&quot;SPD check result for %s  is out of range (%f)!!! Retval of specie %s is sit to -1\n &quot;,AliQAv1::GetAliTaskName(index),spdCheck[specie],AliRecoParam::GetEventSpecieName(specie)));</span>
<span class="lineNum">     258 </span><span class="lineNoCov">          0 :                     spdCheck[specie]=fUpTestValue[AliQAv1::kFATAL];</span>
<span class="lineNum">     259 </span><span class="lineNoCov">          0 :                   }</span>
<span class="lineNum">     260 </span><span class="lineNoCov">          0 :                 delete []stepSPD;</span>
<span class="lineNum">     261 </span><span class="lineNoCov">          0 :               }//end check SPD entries</span>
<span class="lineNum">     262 </span><span class="lineNoCov">          0 :               else{spdCheck[specie]=fUpTestValue[AliQAv1::kFATAL];}</span>
<span class="lineNum">     263 </span><span class="lineNoCov">          0 :               rv[specie]=spdCheck[specie];</span>
<span class="lineNum">     264 </span><span class="lineNoCov">          0 :             }//end SPD check</span>
<span class="lineNum">     265 </span>            :             //drift
<span class="lineNum">     266 </span><span class="lineNoCov">          0 :             if(fDet == 0 || fDet == 2) {</span>
<span class="lineNum">     267 </span><span class="lineNoCov">          0 :               fSDDChecker-&gt;SetTaskOffset(fSDDOffset);</span>
<span class="lineNum">     268 </span><span class="lineNoCov">          0 :               fSDDChecker-&gt;SetEventSpecieForCheck(specie);</span>
<span class="lineNum">     269 </span><span class="lineNoCov">          0 :               Double_t histoSDD=double(GetSDDHisto());</span>
<span class="lineNum">     270 </span><span class="lineNoCov">          0 :               if(AliITSQADataMakerRec::AreEqual(histoSDD,0)==kFALSE){</span>
<span class="lineNum">     271 </span><span class="lineNoCov">          0 :                 Double_t *stepSDD=new Double_t[AliQAv1::kNBIT];</span>
<span class="lineNum">     272 </span><span class="lineNoCov">          0 :                 CreateStepForBit(histoSDD,stepSDD);</span>
<span class="lineNum">     273 </span><span class="lineNoCov">          0 :                 fSDDChecker-&gt;SetStepBit(stepSDD);</span>
<span class="lineNum">     274 </span><span class="lineNoCov">          0 :                 sddCheck[specie] = fSDDChecker-&gt;Check(index, list[specie], recoParam);       </span>
<span class="lineNum">     275 </span><span class="lineNoCov">          0 :                 if(sddCheck[specie]&gt;fUpTestValue[AliQAv1::kFATAL]||sddCheck[specie]&lt;0.)</span>
<span class="lineNum">     276 </span>            :                   {
<span class="lineNum">     277 </span><span class="lineNoCov">          0 :                     AliInfo(Form(&quot;SDD check result for %s  is out of range (%f)!!! Retval of specie %s is sit to -1\n &quot;,AliQAv1::GetAliTaskName(index),sddCheck[specie],AliRecoParam::GetEventSpecieName(specie)));</span>
<span class="lineNum">     278 </span><span class="lineNoCov">          0 :                     sddCheck[specie]=fUpTestValue[AliQAv1::kFATAL];</span>
<span class="lineNum">     279 </span><span class="lineNoCov">          0 :                   }</span>
<span class="lineNum">     280 </span><span class="lineNoCov">          0 :                 delete []stepSDD;</span>
<span class="lineNum">     281 </span><span class="lineNoCov">          0 :               }//end check SDD entries</span>
<span class="lineNum">     282 </span><span class="lineNoCov">          0 :               else{ssdCheck[specie]=fUpTestValue[AliQAv1::kFATAL];}</span>
<span class="lineNum">     283 </span><span class="lineNoCov">          0 :               if(sddCheck[specie]&gt;rv[specie])rv[specie]=sddCheck[specie];  </span>
<span class="lineNum">     284 </span><span class="lineNoCov">          0 :             }//end SDD</span>
<span class="lineNum">     285 </span>            :             //strip
<span class="lineNum">     286 </span><span class="lineNoCov">          0 :             if(fDet == 0 || fDet == 3) {</span>
<span class="lineNum">     287 </span><span class="lineNoCov">          0 :               fSSDChecker-&gt;SetTaskOffset(fSSDOffset);</span>
<span class="lineNum">     288 </span><span class="lineNoCov">          0 :               Double_t histoSSD=double(GetSSDHisto());</span>
<span class="lineNum">     289 </span><span class="lineNoCov">          0 :               if(AliITSQADataMakerRec::AreEqual(histoSSD,0)==kFALSE){</span>
<span class="lineNum">     290 </span><span class="lineNoCov">          0 :               Double_t *stepSSD=new Double_t[AliQAv1::kNBIT];</span>
<span class="lineNum">     291 </span><span class="lineNoCov">          0 :               CreateStepForBit(histoSSD,stepSSD);</span>
<span class="lineNum">     292 </span><span class="lineNoCov">          0 :               fSSDChecker-&gt;SetStepBit(stepSSD);</span>
<span class="lineNum">     293 </span><span class="lineNoCov">          0 :               ssdCheck[specie] = fSSDChecker-&gt;Check(index, list[specie], recoParam);</span>
<span class="lineNum">     294 </span><span class="lineNoCov">          0 :               if(ssdCheck[specie]&gt;fUpTestValue[AliQAv1::kFATAL]||ssdCheck[specie]&lt;0.)</span>
<span class="lineNum">     295 </span>            :                 {
<span class="lineNum">     296 </span><span class="lineNoCov">          0 :                   AliInfo(Form(&quot;SSD check result for %s is out of range (%f)!!! Retval of specie %s is sit to -1\n &quot;,AliQAv1::GetAliTaskName(index),ssdCheck[specie],AliRecoParam::GetEventSpecieName(specie)));</span>
<span class="lineNum">     297 </span><span class="lineNoCov">          0 :                   ssdCheck[specie]=fUpTestValue[AliQAv1::kFATAL];</span>
<span class="lineNum">     298 </span><span class="lineNoCov">          0 :                 }</span>
<span class="lineNum">     299 </span><span class="lineNoCov">          0 :               delete [] stepSSD;</span>
<span class="lineNum">     300 </span><span class="lineNoCov">          0 :               }//end check SSD entries</span>
<span class="lineNum">     301 </span><span class="lineNoCov">          0 :               else{ssdCheck[specie]=fUpTestValue[AliQAv1::kFATAL];}</span>
<span class="lineNum">     302 </span><span class="lineNoCov">          0 :               if(ssdCheck[specie]&gt;rv[specie])rv[specie]=ssdCheck[specie];</span>
<span class="lineNum">     303 </span><span class="lineNoCov">          0 :             }//end SSD</span>
<span class="lineNum">     304 </span>            :             
<span class="lineNum">     305 </span><span class="lineNoCov">          0 :             AliInfo(Form(&quot;Check result for %s: \n\t  SPD %f \n\t  SDD %f \n\t  SSD %f \n Check result %f \n &quot;,AliQAv1::GetAliTaskName(index),spdCheck[specie],sddCheck[specie],ssdCheck[specie],rv[specie]));</span>
<span class="lineNum">     306 </span>            :             // here merging part for common ITS QA result
<span class="lineNum">     307 </span>            :             // 
<span class="lineNum">     308 </span><span class="lineNoCov">          0 :           }//end entries</span>
<span class="lineNum">     309 </span><span class="lineNoCov">          0 :       }//end if event specie</span>
<span class="lineNum">     310 </span>            :     }//end for
<span class="lineNum">     311 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">     312 </span><span class="lineNoCov">          0 : }</span>
<a name="313"><span class="lineNum">     313 </span>            : </a>
<span class="lineNum">     314 </span>            : //____________________________________________________________________________
<span class="lineNum">     315 </span>            : void AliITSQAChecker::SetTaskOffset(Int_t SPDOffset, Int_t SDDOffset, Int_t SSDOffset)
<span class="lineNum">     316 </span>            : {
<span class="lineNum">     317 </span>            :   //Setting the 3 offsets for each task called
<span class="lineNum">     318 </span><span class="lineNoCov">          0 :   fSPDOffset = SPDOffset;</span>
<span class="lineNum">     319 </span><span class="lineNoCov">          0 :   fSDDOffset = SDDOffset;</span>
<span class="lineNum">     320 </span><span class="lineNoCov">          0 :   fSSDOffset = SSDOffset;</span>
<span class="lineNum">     321 </span><span class="lineNoCov">          0 : }</span>
<a name="322"><span class="lineNum">     322 </span>            : </a>
<span class="lineNum">     323 </span>            : //____________________________________________________________________________
<span class="lineNum">     324 </span>            : void AliITSQAChecker::SetHisto(Int_t SPDhisto, Int_t SDDhisto, Int_t SSDhisto)
<span class="lineNum">     325 </span>            : {
<span class="lineNum">     326 </span>            :   //Setting the 3 offsets for each task called
<span class="lineNum">     327 </span><span class="lineNoCov">          0 :   fSPDHisto = SPDhisto;</span>
<span class="lineNum">     328 </span><span class="lineNoCov">          0 :   fSDDHisto = SDDhisto;</span>
<span class="lineNum">     329 </span><span class="lineNoCov">          0 :   fSSDHisto = SSDhisto;</span>
<span class="lineNum">     330 </span><span class="lineNoCov">          0 : }</span>
<a name="331"><span class="lineNum">     331 </span>            : </a>
<span class="lineNum">     332 </span>            :  //____________________________________________________________________________
<span class="lineNum">     333 </span>            :  void AliITSQAChecker::SetDetTaskOffset(Int_t subdet,Int_t offset)
<span class="lineNum">     334 </span>            :  {
<span class="lineNum">     335 </span>            :    //returns the offset for each task and for each subdetector
<span class="lineNum">     336 </span><span class="lineNoCov">          0 :    switch(subdet){</span>
<span class="lineNum">     337 </span>            :    case 1:
<span class="lineNum">     338 </span><span class="lineNoCov">          0 :      SetSPDTaskOffset(offset);</span>
<span class="lineNum">     339 </span><span class="lineNoCov">          0 :      break;</span>
<span class="lineNum">     340 </span>            :    case 2:
<span class="lineNum">     341 </span><span class="lineNoCov">          0 :      SetSDDTaskOffset(offset);</span>
<span class="lineNum">     342 </span><span class="lineNoCov">          0 :      break;</span>
<span class="lineNum">     343 </span>            :    case 3:
<span class="lineNum">     344 </span><span class="lineNoCov">          0 :      SetSSDTaskOffset(offset);</span>
<span class="lineNum">     345 </span><span class="lineNoCov">          0 :      break;</span>
<span class="lineNum">     346 </span>            :    default:
<span class="lineNum">     347 </span><span class="lineNoCov">          0 :      AliWarning(&quot;No specific (SPD,SDD or SSD) subdetector correspond to to this number!!! all offsets set to zero for all the detectors\n&quot;);</span>
<span class="lineNum">     348 </span><span class="lineNoCov">          0 :      SetTaskOffset(0, 0, 0);</span>
<span class="lineNum">     349 </span><span class="lineNoCov">          0 :      break;</span>
<span class="lineNum">     350 </span>            :    }
<span class="lineNum">     351 </span><span class="lineNoCov">          0 :  }</span>
<a name="352"><span class="lineNum">     352 </span>            : </a>
<span class="lineNum">     353 </span>            :  //____________________________________________________________________________
<span class="lineNum">     354 </span>            :  void AliITSQAChecker::SetDetHisto(Int_t subdet,Int_t histo)
<span class="lineNum">     355 </span>            :  {
<span class="lineNum">     356 </span>            :    //set the number od histograms for the subdetector
<span class="lineNum">     357 </span><span class="lineNoCov">          0 :    switch(subdet){</span>
<span class="lineNum">     358 </span>            :    case 1:
<span class="lineNum">     359 </span><span class="lineNoCov">          0 :      SetSPDHisto(histo);</span>
<span class="lineNum">     360 </span><span class="lineNoCov">          0 :      break;</span>
<span class="lineNum">     361 </span>            :    case 2:
<span class="lineNum">     362 </span><span class="lineNoCov">          0 :      SetSDDHisto(histo);</span>
<span class="lineNum">     363 </span><span class="lineNoCov">          0 :      break;</span>
<span class="lineNum">     364 </span>            :    case 3:
<span class="lineNum">     365 </span><span class="lineNoCov">          0 :      SetSSDHisto(histo);</span>
<span class="lineNum">     366 </span><span class="lineNoCov">          0 :      break;</span>
<span class="lineNum">     367 </span>            :    default:
<span class="lineNum">     368 </span><span class="lineNoCov">          0 :      AliWarning(&quot;No specific (SPD,SDD or SSD) subdetector correspond to to this number!!! all offsets set to zero for all the detectors\n&quot;);</span>
<span class="lineNum">     369 </span><span class="lineNoCov">          0 :      SetHisto(0, 0, 0);</span>
<span class="lineNum">     370 </span><span class="lineNoCov">          0 :      break;</span>
<span class="lineNum">     371 </span>            :    }
<span class="lineNum">     372 </span><span class="lineNoCov">          0 :  }</span>
<span class="lineNum">     373 </span>            : 
<a name="374"><span class="lineNum">     374 </span>            : //_____________________________________________________________________________</a>
<span class="lineNum">     375 </span>            : 
<span class="lineNum">     376 </span>            : void AliITSQAChecker::InitQACheckerLimits()
<span class="lineNum">     377 </span>            : {
<span class="lineNum">     378 </span>            :   //init the tolerance range for each QA bit 
<span class="lineNum">     379 </span><span class="lineCov">          6 :   AliInfo(&quot;Setting of tolerance values\n&quot;);</span>
<span class="lineNum">     380 </span>            : 
<span class="lineNum">     381 </span><span class="lineCov">          3 :   Float_t lowtolerancevalue[AliQAv1::kNBIT];</span>
<span class="lineNum">     382 </span>            : 
<span class="lineNum">     383 </span><span class="lineCov">          3 :   Float_t hightolerancevalue[AliQAv1::kNBIT];</span>
<span class="lineNum">     384 </span><span class="lineCov">         30 :   for(Int_t bit=0;bit&lt;AliQAv1::kNBIT;bit++)</span>
<span class="lineNum">     385 </span>            :     {
<span class="lineNum">     386 </span><span class="lineCov">         12 :       lowtolerancevalue[bit]=(bit*1000.);</span>
<span class="lineNum">     387 </span><span class="lineCov">         12 :       hightolerancevalue[bit]=((bit+1.)*1000.);</span>
<span class="lineNum">     388 </span>            :     }
<span class="lineNum">     389 </span><span class="lineCov">          3 :   SetHiLo(hightolerancevalue,lowtolerancevalue);</span>
<span class="lineNum">     390 </span>            :   //  AliInfo(Form(&quot;Range Value  \n INFO    -&gt; %f &lt;  value &lt;  %f \n WARNING -&gt; %f &lt;  value &lt;= %f \n ERROR   -&gt; %f &lt;  value &lt;= %f \n FATAL   -&gt; %f &lt;= value &lt;  %f \n&quot;, fLowTestValue[AliQAv1::kINFO], fUpTestValue[AliQAv1::kINFO], fLowTestValue[AliQAv1::kWARNING], fUpTestValue[AliQAv1::kWARNING], fLowTestValue[AliQAv1::kERROR], fUpTestValue[AliQAv1::kERROR], fLowTestValue[AliQAv1::kFATAL], fUpTestValue[AliQAv1::kFATAL]  ));
<span class="lineNum">     391 </span>            : 
<span class="lineNum">     392 </span><span class="lineCov">          3 :   if(fDet == 0 || fDet == 1) {</span>
<span class="lineNum">     393 </span><span class="lineCov">          3 :     fSPDChecker-&gt;SetSPDLimits( lowtolerancevalue,hightolerancevalue );</span>
<span class="lineNum">     394 </span><span class="lineCov">          3 :   }</span>
<span class="lineNum">     395 </span><span class="lineCov">          3 :   if(fDet == 0 || fDet == 2) {</span>
<span class="lineNum">     396 </span><span class="lineCov">          3 :     fSDDChecker-&gt;SetSDDLimits( lowtolerancevalue,hightolerancevalue );</span>
<span class="lineNum">     397 </span><span class="lineCov">          3 :   }</span>
<span class="lineNum">     398 </span><span class="lineCov">          3 :   if(fDet == 0 || fDet == 3) {</span>
<span class="lineNum">     399 </span><span class="lineCov">          3 :     fSSDChecker-&gt;SetSSDLimits( lowtolerancevalue,hightolerancevalue );</span>
<span class="lineNum">     400 </span><span class="lineCov">          3 :   }</span>
<span class="lineNum">     401 </span>            : 
<span class="lineNum">     402 </span>            : 
<span class="lineNum">     403 </span>            :   
<span class="lineNum">     404 </span><span class="lineCov">          3 : }</span>
<span class="lineNum">     405 </span>            : 
<span class="lineNum">     406 </span>            : 
<a name="407"><span class="lineNum">     407 </span>            : //_____________________________________________________________________________</a>
<span class="lineNum">     408 </span>            : 
<span class="lineNum">     409 </span>            : void AliITSQAChecker::CreateStepForBit(Double_t histonumb,Double_t *steprange)
<span class="lineNum">     410 </span>            : {
<span class="lineNum">     411 </span>            :   //creation of the step bit for each QA bit 
<span class="lineNum">     412 </span><span class="lineNoCov">          0 :   for(Int_t bit=0;bit &lt; AliQAv1::kNBIT; bit++)</span>
<span class="lineNum">     413 </span>            :     {       
<span class="lineNum">     414 </span>            :       //printf(&quot;%i\t %f \t %f \t %f \n&quot;,bit, fUpTestValue[bit],fLowTestValue[AliQAv1::kINFO],histonumb);
<span class="lineNum">     415 </span><span class="lineNoCov">          0 :       steprange[bit]=double((fUpTestValue[bit] - fLowTestValue[AliQAv1::kINFO])/histonumb);</span>
<span class="lineNum">     416 </span>            :       //printf(&quot;%i\t %f \t %f \t %f \t %f\n&quot;,bit, fUpTestValue[bit],fLowTestValue[AliQAv1::kINFO],histonumb,steprange[bit] );
<span class="lineNum">     417 </span>            :     }
<span class="lineNum">     418 </span>            :   //AliInfo(Form(&quot;StepBitValue:numner of histo %f\n\t INFO %f \t WARNING %f \t ERROR %f \t FATAL %f \n&quot;,histonumb, steprange[AliQAv1::kINFO],steprange[AliQAv1::kWARNING],steprange[AliQAv1::kERROR],steprange[AliQAv1::kFATAL]));
<span class="lineNum">     419 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">     420 </span>            : 
<a name="421"><span class="lineNum">     421 </span>            : </a>
<span class="lineNum">     422 </span>            : //_____________________________________________________________________________
<span class="lineNum">     423 </span>            : void AliITSQAChecker::SetQA(AliQAv1::ALITASK_t index, Double_t * value) const
<span class="lineNum">     424 </span>            : {
<span class="lineNum">     425 </span>            :   //Setting of the QA tolerance values
<span class="lineNum">     426 </span><span class="lineNoCov">          0 :   AliQAv1 * qa = AliQAv1::Instance(index) ;</span>
<span class="lineNum">     427 </span>            : 
<span class="lineNum">     428 </span>            : 
<span class="lineNum">     429 </span><span class="lineNoCov">          0 :   for (Int_t specie = 0 ; specie &lt; AliRecoParam::kNSpecies ; specie++) {</span>
<span class="lineNum">     430 </span>            : 
<span class="lineNum">     431 </span><span class="lineNoCov">          0 :     if (! qa-&gt;IsEventSpecieSet(AliRecoParam::ConvertIndex(specie)))</span>
<span class="lineNum">     432 </span>            :       continue ;
<span class="lineNum">     433 </span><span class="lineNoCov">          0 :     if (  value == NULL ) { // No checker is implemented, set all QA to Fatal</span>
<span class="lineNum">     434 </span><span class="lineNoCov">          0 :       qa-&gt;Set(AliQAv1::kFATAL, specie) ; </span>
<span class="lineNum">     435 </span><span class="lineNoCov">          0 :     } else {</span>
<span class="lineNum">     436 </span><span class="lineNoCov">          0 :       if ( value[specie] &gt; fLowTestValue[AliQAv1::kFATAL] &amp;&amp; value[specie] &lt;= fUpTestValue[AliQAv1::kFATAL] ) </span>
<span class="lineNum">     437 </span><span class="lineNoCov">          0 :         qa-&gt;Set(AliQAv1::kFATAL, AliRecoParam::ConvertIndex(specie)) ; </span>
<span class="lineNum">     438 </span><span class="lineNoCov">          0 :       else if ( value[specie] &gt; fLowTestValue[AliQAv1::kERROR] &amp;&amp; value[specie] &lt;= fUpTestValue[AliQAv1::kERROR]  )</span>
<span class="lineNum">     439 </span><span class="lineNoCov">          0 :         qa-&gt;Set(AliQAv1::kERROR, AliRecoParam::ConvertIndex(specie)) ; </span>
<span class="lineNum">     440 </span><span class="lineNoCov">          0 :       else if ( value[specie] &gt; fLowTestValue[AliQAv1::kWARNING] &amp;&amp; value[specie] &lt;= fUpTestValue[AliQAv1::kWARNING]  )</span>
<span class="lineNum">     441 </span><span class="lineNoCov">          0 :         qa-&gt;Set(AliQAv1::kWARNING, AliRecoParam::ConvertIndex(specie)) ;</span>
<span class="lineNum">     442 </span><span class="lineNoCov">          0 :       else if ( value[specie] &gt; fLowTestValue[AliQAv1::kINFO] &amp;&amp; value[specie] &lt;= fUpTestValue[AliQAv1::kINFO] ) </span>
<span class="lineNum">     443 </span><span class="lineNoCov">          0 :         qa-&gt;Set(AliQAv1::kINFO, AliRecoParam::ConvertIndex(specie)) ;        </span>
<span class="lineNum">     444 </span>            :       //else if(value[specie]==0) qa-&gt;Set(AliQAv1::kFATAL, AliRecoParam::ConvertIndex(specie)) ; //no ckeck has been done
<span class="lineNum">     445 </span>            :     }
<span class="lineNum">     446 </span><span class="lineNoCov">          0 :     qa-&gt;ShowStatus(AliQAv1::kITS,index,AliRecoParam::ConvertIndex(specie));</span>
<span class="lineNum">     447 </span><span class="lineNoCov">          0 :   }//end for</span>
<span class="lineNum">     448 </span>            : 
<span class="lineNum">     449 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">     450 </span>            : 
<a name="451"><span class="lineNum">     451 </span>            : </a>
<span class="lineNum">     452 </span>            : //__________________________________________________________________
<span class="lineNum">     453 </span>            : void  AliITSQAChecker::MakeImage( TObjArray ** list, AliQAv1::TASKINDEX_t task, AliQAv1::MODE_t mode)
<span class="lineNum">     454 </span>            : {
<span class="lineNum">     455 </span>            :   //make a summary image
<span class="lineNum">     456 </span>            :   //gStyle-&gt;SetPalette(1);
<span class="lineNum">     457 </span>            : 
<span class="lineNum">     458 </span>            :   //Int_t nImages = 0 ;
<span class="lineNum">     459 </span>            :   //Int_t imageindex=0;
<span class="lineNum">     460 </span><span class="lineNoCov">          0 :   for (Int_t esIndex = 0 ; esIndex &lt; AliRecoParam::kNSpecies ; esIndex++) {</span>
<span class="lineNum">     461 </span><span class="lineNoCov">          0 :     if (! AliQAv1::Instance(AliQAv1::GetDetIndex(GetName()))-&gt;IsEventSpecieSet(AliRecoParam::ConvertIndex(esIndex)) ) </span>
<span class="lineNum">     462 </span>            :       continue ;
<span class="lineNum">     463 </span>            :     //else imageindex=esIndex;
<span class="lineNum">     464 </span>            : 
<span class="lineNum">     465 </span><span class="lineNoCov">          0 :     TIter next(list[esIndex]) ;  </span>
<span class="lineNum">     466 </span>            :     TH1 * hdata = NULL ; 
<span class="lineNum">     467 </span><span class="lineNoCov">          0 :     while ( (hdata=static_cast&lt;TH1 *&gt;(next())) ) {</span>
<span class="lineNum">     468 </span><span class="lineNoCov">          0 :       TString cln(hdata-&gt;ClassName()) ; </span>
<span class="lineNum">     469 </span><span class="lineNoCov">          0 :       if ( ! cln.Contains(&quot;TH&quot;) )</span>
<span class="lineNum">     470 </span><span class="lineNoCov">          0 :         continue ; </span>
<span class="lineNum">     471 </span><span class="lineNoCov">          0 :       if(cln.Contains(&quot;TH2&quot;)) </span>
<span class="lineNum">     472 </span>            :         {
<span class="lineNum">     473 </span><span class="lineNoCov">          0 :           Float_t min=hdata-&gt;GetMinimum();</span>
<span class="lineNum">     474 </span><span class="lineNoCov">          0 :           Float_t max=hdata-&gt;GetMaximum();</span>
<span class="lineNum">     475 </span><span class="lineNoCov">          0 :           if(max&gt;min) hdata-&gt;SetOption(&quot;colz&quot;);</span>
<span class="lineNum">     476 </span><span class="lineNoCov">          0 :         }</span>
<span class="lineNum">     477 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">     478 </span>            :     break ; 
<span class="lineNum">     479 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">     480 </span>            : 
<span class="lineNum">     481 </span>            :   Bool_t retvalue=kFALSE;
<span class="lineNum">     482 </span>            : 
<span class="lineNum">     483 </span><span class="lineNoCov">          0 :   if(GetSubDet()==0) MakeITSImage(list,task, mode);</span>
<span class="lineNum">     484 </span><span class="lineNoCov">          0 :   else if(GetSubDet()==1) </span>
<span class="lineNum">     485 </span>            :     {
<span class="lineNum">     486 </span><span class="lineNoCov">          0 :       retvalue=fSPDChecker-&gt;MakeSPDImage(list,task, mode) ; </span>
<span class="lineNum">     487 </span><span class="lineNoCov">          0 :       if(retvalue==kFALSE)AliQACheckerBase::MakeImage(list,task, mode);</span>
<span class="lineNum">     488 </span>            :     }
<span class="lineNum">     489 </span><span class="lineNoCov">          0 :   else if(GetSubDet()==2){ retvalue=fSDDChecker-&gt;MakeSDDImage(list,task, mode) ;if(retvalue==kFALSE)AliQACheckerBase::MakeImage(list,task,mode); }</span>
<span class="lineNum">     490 </span><span class="lineNoCov">          0 :   else if(GetSubDet()==3) </span>
<span class="lineNum">     491 </span>            :     {
<span class="lineNum">     492 </span><span class="lineNoCov">          0 :       retvalue=fSSDChecker-&gt;MakeSSDImage(list,task, mode) ;</span>
<span class="lineNum">     493 </span><span class="lineNoCov">          0 :       if(retvalue==kFALSE)AliQACheckerBase::MakeImage(list,task, mode); </span>
<span class="lineNum">     494 </span>            :     }
<span class="lineNum">     495 </span>            : 
<span class="lineNum">     496 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">     497 </span>            : 
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.11</a></td></tr>
  </table>
  <br>

</body>
</html>
