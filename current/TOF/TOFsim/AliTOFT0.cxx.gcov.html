<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - coverage.info - TOF/TOFsim/AliTOFT0.cxx</title>
  <link rel="stylesheet" type="text/css" href="../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../index.html">top level</a> - <a href="index.html">TOF/TOFsim</a> - AliTOFT0.cxx<span style="font-size: 80%;"> (source / <a href="AliTOFT0.cxx.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">coverage.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">1</td>
            <td class="headerCovTableEntry">260</td>
            <td class="headerCovTableEntryLo">0.4 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2016-06-14 17:26:59</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">1</td>
            <td class="headerCovTableEntry">15</td>
            <td class="headerCovTableEntryLo">6.7 %</td>
          </tr>
          <tr><td><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            : /**************************************************************************</a>
<span class="lineNum">       2 </span>            :  * Copyright(c) 1998-1999, ALICE Experiment at CERN, All rights reserved. *
<span class="lineNum">       3 </span>            :  *                                                                        *
<span class="lineNum">       4 </span>            :  * Author: The ALICE Off-line Project.                                    *
<span class="lineNum">       5 </span>            :  * Contributors are mentioned in the code where appropriate.              *
<span class="lineNum">       6 </span>            :  *                                                                        *
<span class="lineNum">       7 </span>            :  * Permission to use, copy, modify and distribute this software and its   *
<span class="lineNum">       8 </span>            :  * documentation strictly for non-commercial purposes is hereby granted   *
<span class="lineNum">       9 </span>            :  * without fee, provided that the above copyright notice appears in all   *
<span class="lineNum">      10 </span>            :  * copies and that both the copyright notice and this permission notice   *
<span class="lineNum">      11 </span>            :  * appear in the supporting documentation. The authors make no claims     *
<span class="lineNum">      12 </span>            :  * about the suitability of this software for any purpose. It is          *
<span class="lineNum">      13 </span>            :  * provided &quot;as is&quot; without express or implied warranty.                  *
<span class="lineNum">      14 </span>            :  **************************************************************************/
<span class="lineNum">      15 </span>            : 
<span class="lineNum">      16 </span>            : /* $Id$ */
<span class="lineNum">      17 </span>            : 
<span class="lineNum">      18 </span>            : //_________________________________________________________________________
<span class="lineNum">      19 </span>            : //
<span class="lineNum">      20 </span>            : // This is a TTask that made the calculation of the Time zero using TOF.
<span class="lineNum">      21 </span>            : // Description: The algorithm used to calculate the time zero of
<span class="lineNum">      22 </span>            : // interaction using TOF detector is the following.
<span class="lineNum">      23 </span>            : // We select in the MonteCarlo some primary particles - or tracks in
<span class="lineNum">      24 </span>            : // the following - that strike the TOF detector (the larger part are
<span class="lineNum">      25 </span>            : // pions, kaons or protons).
<span class="lineNum">      26 </span>            : // We choose a set of 10 selected tracks, for each track You have the
<span class="lineNum">      27 </span>            : // length of the track when the TOF is reached (a standard TOF hit
<span class="lineNum">      28 </span>            : // does not contain this additional information, this is the reason
<span class="lineNum">      29 </span>            : // why we implemented a new time zero dedicated TOF hit class
<span class="lineNum">      30 </span>            : // AliTOFhitT0; in order to store this type of hit You have to use the
<span class="lineNum">      31 </span>            : // AliTOFv4T0 as TOF class in Your Config.C. In AliTOFv4T0 the
<span class="lineNum">      32 </span>            : // StepManager was modified in order to fill the TOF hit branch with
<span class="lineNum">      33 </span>            : // this type of hits; in fact the AliTOF::AddT0Hit is called rather
<span class="lineNum">      34 </span>            : // that the usual AliTOF::AddHit), the momentum at generation (from
<span class="lineNum">      35 </span>            : // TreeK) and the time of flight given by the TOF detector.
<span class="lineNum">      36 </span>            : // (Observe that the ctor of the AliTOF class, when the AliTOFv4T0
<span class="lineNum">      37 </span>            : // class is used, is called with the &quot;tzero&quot; option: it is in order
<span class="lineNum">      38 </span>            : // create the fHits TClonesArray filled with AliTOFhitT0 objects,
<span class="lineNum">      39 </span>            : // rather than with normal AliTOFhit)
<span class="lineNum">      40 </span>            : // Then Momentum and time of flight for each track are smeared
<span class="lineNum">      41 </span>            : // according to known experimental resolution (all sources of error
<span class="lineNum">      42 </span>            : // have been token into account).
<span class="lineNum">      43 </span>            : // Let consider now only one set of 10 tracks (the algorithm is the
<span class="lineNum">      44 </span>            : // same for all sets).
<span class="lineNum">      45 </span>            : // Assuming the (mass) hypothesis that each track can be AUT a pion,
<span class="lineNum">      46 </span>            : // AUT a kaon, AUT a proton, we consider all the 3 at 10 possible
<span class="lineNum">      47 </span>            : // cases.
<span class="lineNum">      48 </span>            : // For each track in each (mass) configuration
<span class="lineNum">      49 </span>            : // (a configuration can be
<span class="lineNum">      50 </span>            : // e.g. pion/pion/kaon/proton/pion/proton/kaon/kaon/pion/pion)
<span class="lineNum">      51 </span>            : // we calculate the time zero (we know in fact the velocity of the
<span class="lineNum">      52 </span>            : // track after the assumption about its mass, the time of flight given
<span class="lineNum">      53 </span>            : // by the TOF, and the corresponding path travelled till the TOF
<span class="lineNum">      54 </span>            : // detector). Then for each mass configuration we have 10 time zero
<span class="lineNum">      55 </span>            : // and we can calculate the ChiSquare for the current configuration
<span class="lineNum">      56 </span>            : // using the weighted mean over all 10 time zero.
<span class="lineNum">      57 </span>            : // We call the best assignment the mass configuration that gives the
<span class="lineNum">      58 </span>            : // minimum value of the ChiSquare.
<span class="lineNum">      59 </span>            : // We plot the weighted mean over all 10 time zero for the best
<span class="lineNum">      60 </span>            : // assignment, the ChiSquare for the best assignment and the
<span class="lineNum">      61 </span>            : // corresponding confidence level.
<span class="lineNum">      62 </span>            : // The strong assumption is the MC selection of primary particles. It
<span class="lineNum">      63 </span>            : // will be introduced in the future also some more realistic
<span class="lineNum">      64 </span>            : // simulation about this point.
<span class="lineNum">      65 </span>            : //
<span class="lineNum">      66 </span>            : // Use case:
<span class="lineNum">      67 </span>            : // root [0] AliTOFT0 * tzero = new AliTOFT0(&quot;galice.root&quot;)
<span class="lineNum">      68 </span>            : // Warning in &lt;TDatabasePDG::TDatabasePDG&gt;: object already instantiated
<span class="lineNum">      69 </span>            : // root [1] tzero-&gt;ExecuteTask()
<span class="lineNum">      70 </span>            : // root [2] tzero-&gt;ExecuteTask(&quot;tim&quot;)
<span class="lineNum">      71 </span>            : //             // available parameters:
<span class="lineNum">      72 </span>            : //             tim - print benchmarking information
<span class="lineNum">      73 </span>            : //             all - print usefull informations about the number of
<span class="lineNum">      74 </span>            : //                   misidentified tracks and a comparison about the
<span class="lineNum">      75 </span>            : //                   true configuration (known from MC) and the best
<span class="lineNum">      76 </span>            : //                   assignment
<span class="lineNum">      77 </span>            : //
<span class="lineNum">      78 </span>            : //-- Author: F. Pierella
<span class="lineNum">      79 </span>            : //
<span class="lineNum">      80 </span>            : //_________________________________________________________________________
<span class="lineNum">      81 </span>            : 
<span class="lineNum">      82 </span>            : #include &lt;TCanvas.h&gt;
<span class="lineNum">      83 </span>            : #include &lt;TClonesArray.h&gt;
<span class="lineNum">      84 </span>            : #include &lt;TFile.h&gt;
<span class="lineNum">      85 </span>            : //#include &lt;TFolder.h&gt;
<span class="lineNum">      86 </span>            : #include &lt;TFrame.h&gt;
<span class="lineNum">      87 </span>            : #include &lt;TH1.h&gt;
<span class="lineNum">      88 </span>            : #include &lt;TParticle.h&gt;
<span class="lineNum">      89 </span>            : #include &lt;TBenchmark.h&gt;
<span class="lineNum">      90 </span>            : #include &lt;TTask.h&gt;
<span class="lineNum">      91 </span>            : #include &lt;TTree.h&gt;
<span class="lineNum">      92 </span>            : #include &lt;TRandom.h&gt;
<span class="lineNum">      93 </span>            : #include &lt;TROOT.h&gt;
<span class="lineNum">      94 </span>            : 
<span class="lineNum">      95 </span>            : #include &quot;AliLoader.h&quot;
<span class="lineNum">      96 </span>            : #include &quot;AliMC.h&quot;
<span class="lineNum">      97 </span>            : #include &quot;AliRun.h&quot;
<span class="lineNum">      98 </span>            : 
<span class="lineNum">      99 </span>            : #include &quot;AliTOFhitT0.h&quot;
<span class="lineNum">     100 </span>            : #include &quot;AliTOFT0.h&quot;
<span class="lineNum">     101 </span>            : #include &quot;AliTOF.h&quot;
<span class="lineNum">     102 </span>            : 
<span class="lineNum">     103 </span>            : //extern TROOT *gROOT;
<span class="lineNum">     104 </span>            : extern TRandom *gRandom;
<span class="lineNum">     105 </span>            : extern TBenchmark *gBenchmark;
<span class="lineNum">     106 </span>            : 
<a name="107"><span class="lineNum">     107 </span>            : extern AliRun *gAlice;</a>
<span class="lineNum">     108 </span>            : 
<span class="lineNum">     109 </span><span class="lineCov">         26 : ClassImp(AliTOFT0)</span>
<a name="110"><span class="lineNum">     110 </span>            : </a>
<span class="lineNum">     111 </span>            : //____________________________________________________________________________ 
<span class="lineNum">     112 </span>            : AliTOFT0::AliTOFT0():
<span class="lineNum">     113 </span><span class="lineNoCov">          0 :   TTask(&quot;AliTOFT0&quot;,&quot;&quot;),</span>
<span class="lineNum">     114 </span><span class="lineNoCov">          0 :   fNevents(0),</span>
<span class="lineNum">     115 </span><span class="lineNoCov">          0 :   fTimeResolution(0),</span>
<span class="lineNum">     116 </span><span class="lineNoCov">          0 :   fLowerMomBound(0),</span>
<span class="lineNum">     117 </span><span class="lineNoCov">          0 :   fUpperMomBound(0),</span>
<span class="lineNum">     118 </span><span class="lineNoCov">          0 :   fT0File(&quot;&quot;),</span>
<span class="lineNum">     119 </span><span class="lineNoCov">          0 :   fHeadersFile(&quot;&quot;)</span>
<span class="lineNum">     120 </span><span class="lineNoCov">          0 : {</span>
<span class="lineNum">     121 </span>            :   // ctor
<span class="lineNum">     122 </span><span class="lineNoCov">          0 : }</span>
<a name="123"><span class="lineNum">     123 </span>            :            </a>
<span class="lineNum">     124 </span>            : //____________________________________________________________________________ 
<span class="lineNum">     125 </span>            : AliTOFT0::AliTOFT0(char* headerFile, Int_t nEvents):
<span class="lineNum">     126 </span><span class="lineNoCov">          0 :   TTask(&quot;AliTOFT0&quot;,&quot;&quot;), </span>
<span class="lineNum">     127 </span><span class="lineNoCov">          0 :   fNevents(nEvents),</span>
<span class="lineNum">     128 </span><span class="lineNoCov">          0 :   fTimeResolution(1.2e-10),</span>
<span class="lineNum">     129 </span><span class="lineNoCov">          0 :   fLowerMomBound(1.5),</span>
<span class="lineNum">     130 </span><span class="lineNoCov">          0 :   fUpperMomBound(2.),</span>
<span class="lineNum">     131 </span><span class="lineNoCov">          0 :   fT0File(&quot;&quot;),</span>
<span class="lineNum">     132 </span><span class="lineNoCov">          0 :   fHeadersFile(headerFile)</span>
<span class="lineNum">     133 </span><span class="lineNoCov">          0 : {</span>
<span class="lineNum">     134 </span>            :   //
<span class="lineNum">     135 </span>            :   //
<span class="lineNum">     136 </span>            :   //
<span class="lineNum">     137 </span>            : 
<span class="lineNum">     138 </span>            :   //fNevents=nEvents ; // Number of events for which calculate the T0, 
<span class="lineNum">     139 </span>            :                      // default 0: it means all evens in current file
<span class="lineNum">     140 </span>            :   //fLowerMomBound=1.5; // [GeV/c] default value
<span class="lineNum">     141 </span>            :   //fUpperMomBound=2. ; // [GeV/c] default value
<span class="lineNum">     142 </span>            :   //fTimeResolution   = 1.2e-10; // 120 ps by default   
<span class="lineNum">     143 </span>            :   //fHeadersFile = headerFile ;
<span class="lineNum">     144 </span>            : 
<span class="lineNum">     145 </span><span class="lineNoCov">          0 :   TFile * file = (TFile*) gROOT-&gt;GetFile(fHeadersFile.Data() ) ;</span>
<span class="lineNum">     146 </span>            : 
<span class="lineNum">     147 </span>            :   //File was not opened yet
<span class="lineNum">     148 </span><span class="lineNoCov">          0 :   if(file == 0){</span>
<span class="lineNum">     149 </span><span class="lineNoCov">          0 :     if(fHeadersFile.Contains(&quot;rfio&quot;))</span>
<span class="lineNum">     150 </span><span class="lineNoCov">          0 :       file =    TFile::Open(fHeadersFile,&quot;update&quot;) ;</span>
<span class="lineNum">     151 </span>            :     else
<span class="lineNum">     152 </span><span class="lineNoCov">          0 :       file = new TFile(fHeadersFile.Data(),&quot;update&quot;) ;</span>
<span class="lineNum">     153 </span><span class="lineNoCov">          0 :     gAlice = (AliRun *) file-&gt;Get(&quot;gAlice&quot;) ;</span>
<span class="lineNum">     154 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">     155 </span>            : 
<span class="lineNum">     156 </span>            :   // add Task to //root/Tasks folder
<span class="lineNum">     157 </span><span class="lineNoCov">          0 :   TTask * roottasks = (TTask*)gROOT-&gt;GetRootFolder()-&gt;FindObject(&quot;Tasks&quot;) ; </span>
<span class="lineNum">     158 </span><span class="lineNoCov">          0 :   roottasks-&gt;Add(this) ; </span>
<span class="lineNum">     159 </span><span class="lineNoCov">          0 : }</span>
<a name="160"><span class="lineNum">     160 </span>            : </a>
<span class="lineNum">     161 </span>            : //____________________________________________________________________________ 
<span class="lineNum">     162 </span>            : AliTOFT0::AliTOFT0(const AliTOFT0 &amp; tzero):
<span class="lineNum">     163 </span><span class="lineNoCov">          0 :   TTask(&quot;AliTOFT0&quot;,&quot;&quot;),</span>
<span class="lineNum">     164 </span><span class="lineNoCov">          0 :   fNevents(0),</span>
<span class="lineNum">     165 </span><span class="lineNoCov">          0 :   fTimeResolution(0),</span>
<span class="lineNum">     166 </span><span class="lineNoCov">          0 :   fLowerMomBound(0),</span>
<span class="lineNum">     167 </span><span class="lineNoCov">          0 :   fUpperMomBound(0),</span>
<span class="lineNum">     168 </span><span class="lineNoCov">          0 :   fT0File(&quot;&quot;),</span>
<span class="lineNum">     169 </span><span class="lineNoCov">          0 :   fHeadersFile(&quot;&quot;)</span>
<span class="lineNum">     170 </span><span class="lineNoCov">          0 : {</span>
<span class="lineNum">     171 </span>            :   // copy ctr
<span class="lineNum">     172 </span>            : 
<span class="lineNum">     173 </span><span class="lineNoCov">          0 : ( (AliTOFT0 &amp;)tzero ).Copy(*this);</span>
<span class="lineNum">     174 </span><span class="lineNoCov">          0 : }</span>
<a name="175"><span class="lineNum">     175 </span>            : </a>
<span class="lineNum">     176 </span>            : //____________________________________________________________________________ 
<span class="lineNum">     177 </span>            : AliTOFT0&amp; AliTOFT0::operator = (const AliTOFT0 &amp; tzero)
<span class="lineNum">     178 </span>            : {
<span class="lineNum">     179 </span><span class="lineNoCov">          0 :   if (this==&amp;tzero) return *this;</span>
<span class="lineNum">     180 </span>            : 
<span class="lineNum">     181 </span><span class="lineNoCov">          0 :   fNevents=tzero.fNevents;</span>
<span class="lineNum">     182 </span><span class="lineNoCov">          0 :   fTimeResolution=tzero.fTimeResolution;</span>
<span class="lineNum">     183 </span><span class="lineNoCov">          0 :   fLowerMomBound=tzero.fLowerMomBound;</span>
<span class="lineNum">     184 </span><span class="lineNoCov">          0 :   fUpperMomBound=tzero.fUpperMomBound;</span>
<span class="lineNum">     185 </span><span class="lineNoCov">          0 :   fT0File=tzero.fT0File;</span>
<span class="lineNum">     186 </span><span class="lineNoCov">          0 :   fHeadersFile=tzero.fHeadersFile;</span>
<span class="lineNum">     187 </span><span class="lineNoCov">          0 :   return *this;</span>
<span class="lineNum">     188 </span>            : 
<span class="lineNum">     189 </span><span class="lineNoCov">          0 : }</span>
<a name="190"><span class="lineNum">     190 </span>            : </a>
<span class="lineNum">     191 </span>            : //____________________________________________________________________________ 
<span class="lineNum">     192 </span>            :   AliTOFT0::~AliTOFT0()
<span class="lineNum">     193 </span><span class="lineNoCov">          0 : {</span>
<span class="lineNum">     194 </span>            :   // dtor
<span class="lineNum">     195 </span><span class="lineNoCov">          0 : }</span>
<a name="196"><span class="lineNum">     196 </span>            : </a>
<span class="lineNum">     197 </span>            : //____________________________________________________________________________
<span class="lineNum">     198 </span>            : void AliTOFT0::Exec(Option_t *option) 
<span class="lineNum">     199 </span>            : { 
<span class="lineNum">     200 </span>            :   //
<span class="lineNum">     201 </span>            :   // calculate T0 distribution for all events using chisquare 
<span class="lineNum">     202 </span>            :   //
<span class="lineNum">     203 </span>            :   Int_t ngood=0;
<span class="lineNum">     204 </span>            :   Int_t nmisidentified=0;
<span class="lineNum">     205 </span>            :   Int_t nmisidentified0=0;
<span class="lineNum">     206 </span>            :   Int_t nmisidentified1=0;
<span class="lineNum">     207 </span>            :   Int_t nmisidentified2=0;
<span class="lineNum">     208 </span>            :   Int_t nmisidentified3=0;
<span class="lineNum">     209 </span>            :   Int_t nmisidentified4=0;
<span class="lineNum">     210 </span>            :   Int_t nmisidentified5=0;
<span class="lineNum">     211 </span>            :   Int_t nmisidentified6=0;
<span class="lineNum">     212 </span>            :   Int_t nmisidentified7=0;
<span class="lineNum">     213 </span>            :   Int_t nmisidentified8=0;
<span class="lineNum">     214 </span>            :   Int_t nmisidentified9=0;
<span class="lineNum">     215 </span>            :   Int_t ipartold = -1;
<span class="lineNum">     216 </span>            :   Int_t ipart;
<span class="lineNum">     217 </span>            :   Int_t selected=0;
<span class="lineNum">     218 </span>            :   Int_t istop=0;
<span class="lineNum">     219 </span><span class="lineNoCov">          0 :   Float_t timeresolutioninns=fTimeResolution*(1.e+9); // convert in [ns]</span>
<span class="lineNum">     220 </span>            :   const Int_t kUPDATE = 5; // for visual option
<span class="lineNum">     221 </span>            :   Int_t itimes=0;
<span class="lineNum">     222 </span>            :   TCanvas* c1=0;
<span class="lineNum">     223 </span>            :   TCanvas* c2=0;
<span class="lineNum">     224 </span>            :   TCanvas* c3=0;
<span class="lineNum">     225 </span>            : 
<span class="lineNum">     226 </span><span class="lineNoCov">          0 :   if(strstr(option,&quot;visual&quot;)){</span>
<span class="lineNum">     227 </span>            :     // Create a new canvas.
<span class="lineNum">     228 </span>            :     //c1 = new TCanvas(&quot;c1&quot;,&quot;Dynamic Visual Filling of time zero histo&quot;,10,10,500,500);
<span class="lineNum">     229 </span><span class="lineNoCov">          0 :     c1 = new TCanvas(&quot;c1&quot;,&quot;Dynamic Visual Filling of time zero histo&quot;,10,10,370,370);</span>
<span class="lineNum">     230 </span><span class="lineNoCov">          0 :     c1-&gt;SetFillColor(35);</span>
<span class="lineNum">     231 </span><span class="lineNoCov">          0 :     c1-&gt;GetFrame()-&gt;SetFillColor(21);</span>
<span class="lineNum">     232 </span><span class="lineNoCov">          0 :     c1-&gt;GetFrame()-&gt;SetBorderSize(6);</span>
<span class="lineNum">     233 </span><span class="lineNoCov">          0 :     c1-&gt;GetFrame()-&gt;SetBorderMode(-1);</span>
<span class="lineNum">     234 </span>            : 
<span class="lineNum">     235 </span>            :     //c2 = new TCanvas(&quot;c2&quot;,&quot;Dynamic Visual Filling of chisquare histo&quot;,550,10,500,500);
<span class="lineNum">     236 </span><span class="lineNoCov">          0 :     c2 = new TCanvas(&quot;c2&quot;,&quot;Dynamic Visual Filling of chisquare histo&quot;,380,10,370,370);</span>
<span class="lineNum">     237 </span><span class="lineNoCov">          0 :     c2-&gt;SetFillColor(35);</span>
<span class="lineNum">     238 </span><span class="lineNoCov">          0 :     c2-&gt;GetFrame()-&gt;SetFillColor(21);</span>
<span class="lineNum">     239 </span><span class="lineNoCov">          0 :     c2-&gt;GetFrame()-&gt;SetBorderSize(6);</span>
<span class="lineNum">     240 </span><span class="lineNoCov">          0 :     c2-&gt;GetFrame()-&gt;SetBorderMode(-1);</span>
<span class="lineNum">     241 </span>            : 
<span class="lineNum">     242 </span>            :     //c3 = new TCanvas(&quot;c3&quot;,&quot;Dynamic Visual Filling of confidence level histo&quot;,280,550,500,500);
<span class="lineNum">     243 </span><span class="lineNoCov">          0 :     c3 = new TCanvas(&quot;c3&quot;,&quot;Dynamic Visual Filling of confidence level histo&quot;,760,10,370,370);</span>
<span class="lineNum">     244 </span><span class="lineNoCov">          0 :     c3-&gt;SetFillColor(35);</span>
<span class="lineNum">     245 </span><span class="lineNoCov">          0 :     c3-&gt;GetFrame()-&gt;SetFillColor(21);</span>
<span class="lineNum">     246 </span><span class="lineNoCov">          0 :     c3-&gt;GetFrame()-&gt;SetBorderSize(6);</span>
<span class="lineNum">     247 </span><span class="lineNoCov">          0 :     c3-&gt;GetFrame()-&gt;SetBorderMode(-1);</span>
<span class="lineNum">     248 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">     249 </span>            : 
<span class="lineNum">     250 </span><span class="lineNoCov">          0 :   if(strstr(option,&quot;tim&quot;) || strstr(option,&quot;all&quot;))</span>
<span class="lineNum">     251 </span><span class="lineNoCov">          0 :     gBenchmark-&gt;Start(&quot;TOFT0&quot;);</span>
<span class="lineNum">     252 </span>            : 
<span class="lineNum">     253 </span><span class="lineNoCov">          0 :   TH1F *htzerobest= new TH1F(&quot;htzerobest&quot;,&quot;T0 for best assignment&quot;,200,-1.,1.);</span>
<span class="lineNum">     254 </span><span class="lineNoCov">          0 :   TH1F* hchibest  = new TH1F(&quot;hchibest&quot;,&quot;ChiSquare Min Distribution&quot;,80,0.,40.);</span>
<span class="lineNum">     255 </span><span class="lineNoCov">          0 :   TH1F* hchibestconflevel  = new TH1F(&quot;hchibestconflevel&quot;,&quot;ChiSquare Min Confidence Level&quot;,10,0.,1.);</span>
<span class="lineNum">     256 </span>            : 
<span class="lineNum">     257 </span>            :   // setting histo colors
<span class="lineNum">     258 </span><span class="lineNoCov">          0 :   if(strstr(option,&quot;visual&quot;)){</span>
<span class="lineNum">     259 </span><span class="lineNoCov">          0 :     htzerobest-&gt;SetFillColor(48);</span>
<span class="lineNum">     260 </span><span class="lineNoCov">          0 :     hchibest-&gt;SetFillColor(50);</span>
<span class="lineNum">     261 </span><span class="lineNoCov">          0 :     hchibestconflevel-&gt;SetFillColor(52);</span>
<span class="lineNum">     262 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">     263 </span>            : 
<span class="lineNum">     264 </span>            :   Int_t   assparticle[10]={3,3,3,3,3,3,3,3,3,3};
<span class="lineNum">     265 </span><span class="lineNoCov">          0 :   Int_t   truparticle[10]={3,3,3,3,3,3,3,3,3,3};</span>
<span class="lineNum">     266 </span>            :   Float_t t0best=999.;
<span class="lineNum">     267 </span><span class="lineNoCov">          0 :   Float_t timeofflight[10]={0.,0.,0.,0.,0.,0.,0.,0.,0.,0.};</span>
<span class="lineNum">     268 </span><span class="lineNoCov">          0 :   Float_t momentum[10]={0.,0.,0.,0.,0.,0.,0.,0.,0.,0.};</span>
<span class="lineNum">     269 </span><span class="lineNoCov">          0 :   Float_t timezero[10];</span>
<span class="lineNum">     270 </span><span class="lineNoCov">          0 :   Float_t weightedtimezero[10];</span>
<span class="lineNum">     271 </span><span class="lineNoCov">          0 :   Float_t beta[10]={0.,0.,0.,0.,0.,0.,0.,0.,0.,0.};</span>
<span class="lineNum">     272 </span><span class="lineNoCov">          0 :   Float_t sqMomError[10]={0.,0.,0.,0.,0.,0.,0.,0.,0.,0.};</span>
<span class="lineNum">     273 </span><span class="lineNoCov">          0 :   Float_t sqTrackError[10]={0.,0.,0.,0.,0.,0.,0.,0.,0.,0.};</span>
<span class="lineNum">     274 </span><span class="lineNoCov">          0 :   Float_t massarray[3]={0.13957,0.493677,0.9382723};</span>
<span class="lineNum">     275 </span>            :   Float_t dummychisquare=0.;
<span class="lineNum">     276 </span>            :   Float_t chisquare=999.;
<span class="lineNum">     277 </span><span class="lineNoCov">          0 :   Float_t tracktoflen[10]={0.,0.,0.,0.,0.,0.,0.,0.,0.,0.};</span>
<span class="lineNum">     278 </span>            : 
<span class="lineNum">     279 </span><span class="lineNoCov">          0 :   AliTOF *detTOF = (AliTOF *) gAlice-&gt;GetDetector (&quot;TOF&quot;);</span>
<span class="lineNum">     280 </span>            : 
<span class="lineNum">     281 </span><span class="lineNoCov">          0 :   if (!detTOF) {</span>
<span class="lineNum">     282 </span><span class="lineNoCov">          0 :     Error(&quot;AliTOFT0&quot;,&quot;TOF not found&quot;);</span>
<span class="lineNum">     283 </span><span class="lineNoCov">          0 :     return;</span>
<span class="lineNum">     284 </span>            :   }
<span class="lineNum">     285 </span>            : 
<span class="lineNum">     286 </span><span class="lineNoCov">          0 :   if(strstr(option,&quot;all&quot;)){</span>
<span class="lineNum">     287 </span><span class="lineNoCov">          0 :     AliInfo(Form(&quot;Selecting primary tracks with momentum between %f GeV/c and %f GeV/c&quot;,  fLowerMomBound, fUpperMomBound));</span>
<span class="lineNum">     288 </span><span class="lineNoCov">          0 :     AliInfo(&quot;Memorandum: 0 means PION | 1 means KAON | 2 means PROTON&quot;);</span>
<span class="lineNum">     289 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">     290 </span>            : 
<span class="lineNum">     291 </span><span class="lineNoCov">          0 :   if (fNevents == 0) fNevents = (Int_t) AliRunLoader::Instance()-&gt;TreeE()-&gt;GetEntries();</span>
<span class="lineNum">     292 </span>            : 
<span class="lineNum">     293 </span><span class="lineNoCov">          0 :   for (Int_t ievent = 0; ievent &lt; fNevents; ievent++) {</span>
<span class="lineNum">     294 </span><span class="lineNoCov">          0 :     gAlice-&gt;GetEvent(ievent);</span>
<span class="lineNum">     295 </span><span class="lineNoCov">          0 :     TTree *hitTree = detTOF-&gt;GetLoader()-&gt;TreeH ();</span>
<span class="lineNum">     296 </span><span class="lineNoCov">          0 :     if (!hitTree)</span>
<span class="lineNum">     297 </span><span class="lineNoCov">          0 :       return;</span>
<span class="lineNum">     298 </span>            :     TParticle*    particle;
<span class="lineNum">     299 </span>            :     AliTOFhitT0*  tofHit;
<span class="lineNum">     300 </span><span class="lineNoCov">          0 :     TClonesArray* tofHits = detTOF-&gt;Hits();</span>
<span class="lineNum">     301 </span>            : 
<span class="lineNum">     302 </span>            :     Int_t lasttrack=-1;
<span class="lineNum">     303 </span>            :     Int_t nset=0;
<span class="lineNum">     304 </span>            : 
<span class="lineNum">     305 </span><span class="lineNoCov">          0 :     hitTree-&gt;SetBranchStatus(&quot;*&quot;,0); // switch off all branches</span>
<span class="lineNum">     306 </span><span class="lineNoCov">          0 :     hitTree-&gt;SetBranchStatus(&quot;TOF*&quot;,1); // switch on only TOF</span>
<span class="lineNum">     307 </span>            : 
<span class="lineNum">     308 </span>            :     // Start loop on primary tracks in the hits containers
<span class="lineNum">     309 </span>            : 
<span class="lineNum">     310 </span><span class="lineNoCov">          0 :     Int_t ntracks = static_cast&lt;Int_t&gt;(hitTree-&gt;GetEntries());</span>
<span class="lineNum">     311 </span><span class="lineNoCov">          0 :     for (Int_t track = 0; track &lt; ntracks; track++)</span>
<span class="lineNum">     312 </span>            :     {
<span class="lineNum">     313 </span><span class="lineNoCov">          0 :       if(nset&gt;=5) break; // check on the number of set analyzed</span>
<span class="lineNum">     314 </span>            :       
<span class="lineNum">     315 </span><span class="lineNoCov">          0 :       gAlice-&gt;GetMCApp()-&gt;ResetHits();</span>
<span class="lineNum">     316 </span><span class="lineNoCov">          0 :       hitTree-&gt;GetEvent(track);</span>
<span class="lineNum">     317 </span>            : 
<span class="lineNum">     318 </span>            :       //AliMC *mcApplication = (AliMC*)gAlice-&gt;GetMCApp();
<span class="lineNum">     319 </span>            : 
<span class="lineNum">     320 </span>            :       //particle = mcApplication-&gt;Particle(track);
<span class="lineNum">     321 </span><span class="lineNoCov">          0 :       Int_t nhits = tofHits-&gt;GetEntriesFast();</span>
<span class="lineNum">     322 </span>            : 
<span class="lineNum">     323 </span><span class="lineNoCov">          0 :       for (Int_t hit = 0; hit &lt; nhits; hit++)</span>
<span class="lineNum">     324 </span>            :       {
<span class="lineNum">     325 </span><span class="lineNoCov">          0 :         tofHit = (AliTOFhitT0 *) tofHits-&gt;UncheckedAt(hit);</span>
<span class="lineNum">     326 </span><span class="lineNoCov">          0 :         ipart    = tofHit-&gt;GetTrack();</span>
<span class="lineNum">     327 </span>            :         // check to discard the case when the same particle is selected more than one
<span class="lineNum">     328 </span>            :         // time 
<span class="lineNum">     329 </span>            : 
<span class="lineNum">     330 </span><span class="lineNoCov">          0 :         if (ipart != ipartold){</span>
<span class="lineNum">     331 </span>            :           
<span class="lineNum">     332 </span><span class="lineNoCov">          0 :           particle = (TParticle*)gAlice-&gt;GetMCApp()-&gt;Particle(ipart);</span>
<span class="lineNum">     333 </span>            :           
<span class="lineNum">     334 </span><span class="lineNoCov">          0 :           Float_t idealtime=tofHit-&gt;GetTof();</span>
<span class="lineNum">     335 </span>            :           //       Float_t time=idealtime;
<span class="lineNum">     336 </span><span class="lineNoCov">          0 :           Float_t time   = gRandom-&gt;Gaus(idealtime, fTimeResolution);</span>
<span class="lineNum">     337 </span><span class="lineNoCov">          0 :           Float_t toflen=tofHit-&gt;GetLen();</span>
<span class="lineNum">     338 </span><span class="lineNoCov">          0 :           toflen=toflen/100.; // toflen given in m</span>
<span class="lineNum">     339 </span><span class="lineNoCov">          0 :           Int_t pdg   = particle-&gt;GetPdgCode();</span>
<span class="lineNum">     340 </span><span class="lineNoCov">          0 :           Int_t abspdg   =TMath::Abs(pdg);</span>
<span class="lineNum">     341 </span><span class="lineNoCov">          0 :           Float_t idealmom  = particle-&gt;P();</span>
<span class="lineNum">     342 </span><span class="lineNoCov">          0 :           Float_t momres=idealmom*0.025; // 2.5% res token into account for all momenta</span>
<span class="lineNum">     343 </span><span class="lineNoCov">          0 :           Float_t mom =gRandom-&gt;Gaus(idealmom,momres);</span>
<span class="lineNum">     344 </span>            : 
<span class="lineNum">     345 </span><span class="lineNoCov">          0 :           Bool_t isgoodpart=(abspdg==211 || abspdg==2212 || abspdg==321);</span>
<span class="lineNum">     346 </span>            : 
<span class="lineNum">     347 </span><span class="lineNoCov">          0 :           time*=1.E+9; // tof given in nanoseconds         </span>
<span class="lineNum">     348 </span><span class="lineNoCov">          0 :           if (particle-&gt;GetFirstMother() &lt; 0 &amp;&amp; isgoodpart &amp;&amp; mom&lt;=fUpperMomBound &amp;&amp; mom&gt;=fLowerMomBound){</span>
<span class="lineNum">     349 </span><span class="lineNoCov">          0 :             selected+=1;</span>
<span class="lineNum">     350 </span>            :             istop=selected;
<span class="lineNum">     351 </span><span class="lineNoCov">          0 :             if(istop&gt;10) break;</span>
<span class="lineNum">     352 </span>            :             Int_t index=selected-1;
<span class="lineNum">     353 </span><span class="lineNoCov">          0 :             timeofflight[index]=time;</span>
<span class="lineNum">     354 </span><span class="lineNoCov">          0 :             tracktoflen[index]=toflen;</span>
<span class="lineNum">     355 </span><span class="lineNoCov">          0 :             momentum[index]=mom;</span>
<span class="lineNum">     356 </span>            :             //AliInfo(Form(&quot; %d  %d  %d &quot;, timeofflight[index], tracktoflen[index], momentum[index]));
<span class="lineNum">     357 </span><span class="lineNoCov">          0 :             switch (abspdg) {</span>
<span class="lineNum">     358 </span>            :             case 211:
<span class="lineNum">     359 </span><span class="lineNoCov">          0 :               truparticle[index]=0;</span>
<span class="lineNum">     360 </span><span class="lineNoCov">          0 :               break ;</span>
<span class="lineNum">     361 </span>            :             case 321:
<span class="lineNum">     362 </span><span class="lineNoCov">          0 :               truparticle[index]=1;</span>
<span class="lineNum">     363 </span><span class="lineNoCov">          0 :               break ;</span>
<span class="lineNum">     364 </span>            :             case 2212: 
<span class="lineNum">     365 </span><span class="lineNoCov">          0 :               truparticle[index]=2;</span>
<span class="lineNum">     366 </span><span class="lineNoCov">          0 :               break ;</span>
<span class="lineNum">     367 </span>            :             }
<span class="lineNum">     368 </span>            :             
<span class="lineNum">     369 </span><span class="lineNoCov">          0 :           }</span>
<span class="lineNum">     370 </span>            :           ipartold = ipart;
<span class="lineNum">     371 </span>            :           
<span class="lineNum">     372 </span><span class="lineNoCov">          0 :           if(istop==10){ // start analysis on current set</span>
<span class="lineNum">     373 </span><span class="lineNoCov">          0 :             nset+=1;</span>
<span class="lineNum">     374 </span>            :             lasttrack=track;
<span class="lineNum">     375 </span>            :             istop=0;
<span class="lineNum">     376 </span>            :             selected=0;
<span class="lineNum">     377 </span>            :             //AliInfo(&quot;starting t0 calculation for current set&quot;);
<span class="lineNum">     378 </span><span class="lineNoCov">          0 :             for (Int_t i1=0; i1&lt;3;i1++) {</span>
<span class="lineNum">     379 </span><span class="lineNoCov">          0 :               beta[0]=momentum[0]/sqrt(massarray[i1]*massarray[i1]+momentum[0]*momentum[0]);</span>
<span class="lineNum">     380 </span><span class="lineNoCov">          0 :               for (Int_t i2=0; i2&lt;3;i2++) { </span>
<span class="lineNum">     381 </span><span class="lineNoCov">          0 :                 beta[1]=momentum[1]/sqrt(massarray[i2]*massarray[i2]+momentum[1]*momentum[1]);</span>
<span class="lineNum">     382 </span><span class="lineNoCov">          0 :                 for (Int_t i3=0; i3&lt;3;i3++) {</span>
<span class="lineNum">     383 </span><span class="lineNoCov">          0 :                   beta[2]=momentum[2]/sqrt(massarray[i3]*massarray[i3]+momentum[2]*momentum[2]);</span>
<span class="lineNum">     384 </span><span class="lineNoCov">          0 :                   for (Int_t i4=0; i4&lt;3;i4++) {</span>
<span class="lineNum">     385 </span><span class="lineNoCov">          0 :                     beta[3]=momentum[3]/sqrt(massarray[i4]*massarray[i4]+momentum[3]*momentum[3]);</span>
<span class="lineNum">     386 </span><span class="lineNoCov">          0 :                     for (Int_t i5=0; i5&lt;3;i5++) {</span>
<span class="lineNum">     387 </span><span class="lineNoCov">          0 :                       beta[4]=momentum[4]/sqrt(massarray[i5]*massarray[i5]+momentum[4]*momentum[4]);</span>
<span class="lineNum">     388 </span><span class="lineNoCov">          0 :                       for (Int_t i6=0; i6&lt;3;i6++) {</span>
<span class="lineNum">     389 </span><span class="lineNoCov">          0 :                         beta[5]=momentum[5]/sqrt(massarray[i6]*massarray[i6]+momentum[5]*momentum[5]);</span>
<span class="lineNum">     390 </span><span class="lineNoCov">          0 :                         for (Int_t i7=0; i7&lt;3;i7++) { </span>
<span class="lineNum">     391 </span><span class="lineNoCov">          0 :                           beta[6]=momentum[6]/sqrt(massarray[i7]*massarray[i7]+momentum[6]*momentum[6]);</span>
<span class="lineNum">     392 </span><span class="lineNoCov">          0 :                           for (Int_t i8=0; i8&lt;3;i8++) {</span>
<span class="lineNum">     393 </span><span class="lineNoCov">          0 :                             beta[7]=momentum[7]/sqrt(massarray[i8]*massarray[i8]+momentum[7]*momentum[7]);</span>
<span class="lineNum">     394 </span><span class="lineNoCov">          0 :                             for (Int_t i9=0; i9&lt;3;i9++) {</span>
<span class="lineNum">     395 </span><span class="lineNoCov">          0 :                               beta[8]=momentum[8]/sqrt(massarray[i9]*massarray[i9]+momentum[8]*momentum[8]);</span>
<span class="lineNum">     396 </span><span class="lineNoCov">          0 :                               for (Int_t i10=0; i10&lt;3;i10++) {       </span>
<span class="lineNum">     397 </span><span class="lineNoCov">          0 :                                 beta[9]=momentum[9]/sqrt(massarray[i10]*massarray[i10]+momentum[9]*momentum[9]);</span>
<span class="lineNum">     398 </span>            :                                 
<span class="lineNum">     399 </span>            :                                 Float_t meantzero=0.;
<span class="lineNum">     400 </span>            :                                 Float_t sumAllweights=0.;
<span class="lineNum">     401 </span><span class="lineNoCov">          0 :                                 for (Int_t itz=0; itz&lt;10;itz++) {</span>
<span class="lineNum">     402 </span><span class="lineNoCov">          0 :                                   sqMomError[itz]=((1.-beta[itz]*beta[itz])*0.025)*((1.-beta[itz]*beta[itz])*0.025)*(tracktoflen[itz]/(0.299792*beta[itz]))*(tracktoflen[itz]/(0.299792*beta[itz])); // this gives the square of the momentum error in nanoseconds</span>
<span class="lineNum">     403 </span><span class="lineNoCov">          0 :                                   sqTrackError[itz]=(timeresolutioninns*timeresolutioninns+sqMomError[itz]); // total error for the current track</span>
<span class="lineNum">     404 </span><span class="lineNoCov">          0 :                                   sumAllweights+=1./sqTrackError[itz];</span>
<span class="lineNum">     405 </span>            : 
<span class="lineNum">     406 </span><span class="lineNoCov">          0 :                                   timezero[itz]=(tracktoflen[itz]/(beta[itz]*0.299792))-timeofflight[itz];</span>
<span class="lineNum">     407 </span><span class="lineNoCov">          0 :                                   weightedtimezero[itz]=((tracktoflen[itz]/(beta[itz]*0.299792))-timeofflight[itz])/sqTrackError[itz];// weighted time zero for current track</span>
<span class="lineNum">     408 </span><span class="lineNoCov">          0 :                                   meantzero+=weightedtimezero[itz];</span>
<span class="lineNum">     409 </span>            :                                 } // end loop for (Int_t itz=0; itz&lt;10;itz++)
<span class="lineNum">     410 </span><span class="lineNoCov">          0 :                                 meantzero=meantzero/sumAllweights; // it is given in [ns]</span>
<span class="lineNum">     411 </span>            :                                 
<span class="lineNum">     412 </span>            :                                 dummychisquare=0.;
<span class="lineNum">     413 </span>            :                                 // calculate the chisquare for the current assignment
<span class="lineNum">     414 </span><span class="lineNoCov">          0 :                                 for (Int_t icsq=0; icsq&lt;10;icsq++) {</span>
<span class="lineNum">     415 </span><span class="lineNoCov">          0 :                                   dummychisquare+=(timezero[icsq]-meantzero)*(timezero[icsq]-meantzero)/sqTrackError[icsq];</span>
<span class="lineNum">     416 </span>            :                                 } // end loop for (Int_t icsq=0; icsq&lt;10;icsq++) 
<span class="lineNum">     417 </span>            : 
<span class="lineNum">     418 </span><span class="lineNoCov">          0 :                                 if(dummychisquare&lt;=chisquare){</span>
<span class="lineNum">     419 </span>            :                                   assparticle[0]=i1;
<span class="lineNum">     420 </span>            :                                   assparticle[1]=i2;
<span class="lineNum">     421 </span>            :                                   assparticle[2]=i3;
<span class="lineNum">     422 </span>            :                                   assparticle[3]=i4;
<span class="lineNum">     423 </span>            :                                   assparticle[4]=i5;
<span class="lineNum">     424 </span>            :                                   assparticle[5]=i6;
<span class="lineNum">     425 </span>            :                                   assparticle[6]=i7;
<span class="lineNum">     426 </span>            :                                   assparticle[7]=i8;
<span class="lineNum">     427 </span>            :                                   assparticle[8]=i9;
<span class="lineNum">     428 </span>            :                                   assparticle[9]=i10;
<span class="lineNum">     429 </span>            :                                   chisquare=dummychisquare;
<span class="lineNum">     430 </span>            :                                   t0best=meantzero;
<span class="lineNum">     431 </span><span class="lineNoCov">          0 :                                 } // close if(dummychisquare&lt;=chisquare)</span>
<span class="lineNum">     432 </span>            :                                 
<span class="lineNum">     433 </span>            :                               } // end loop on i10
<span class="lineNum">     434 </span>            :                             } // end loop on i9
<span class="lineNum">     435 </span>            :                           } // end loop on i8
<span class="lineNum">     436 </span>            :                         } // end loop on i7
<span class="lineNum">     437 </span>            :                       } // end loop on i6
<span class="lineNum">     438 </span>            :                     } // end loop on i5
<span class="lineNum">     439 </span>            :                   } // end loop on i4
<span class="lineNum">     440 </span>            :                 } // end loop on i3
<span class="lineNum">     441 </span>            :               } // end loop on i2
<span class="lineNum">     442 </span>            :             } // end loop on i1
<span class="lineNum">     443 </span>            : 
<span class="lineNum">     444 </span><span class="lineNoCov">          0 :             if(truparticle[0]==assparticle[0] &amp;&amp; truparticle[1]==assparticle[1] &amp;&amp; truparticle[2]==assparticle[2]  &amp;&amp; truparticle[3]==assparticle[3] &amp;&amp; truparticle[4]==assparticle[4]&amp;&amp; truparticle[5]==assparticle[5] &amp;&amp; truparticle[6]==assparticle[6] &amp;&amp; truparticle[7]==assparticle[7]  &amp;&amp; truparticle[8]==assparticle[8] &amp;&amp; truparticle[9]==assparticle[9]) ngood+=1;</span>
<span class="lineNum">     445 </span><span class="lineNoCov">          0 :             if(truparticle[0]!=assparticle[0]) nmisidentified0+=1;</span>
<span class="lineNum">     446 </span><span class="lineNoCov">          0 :             if(truparticle[1]!=assparticle[1]) nmisidentified1+=1;</span>
<span class="lineNum">     447 </span><span class="lineNoCov">          0 :             if(truparticle[2]!=assparticle[2]) nmisidentified2+=1;</span>
<span class="lineNum">     448 </span><span class="lineNoCov">          0 :             if(truparticle[3]!=assparticle[3]) nmisidentified3+=1;</span>
<span class="lineNum">     449 </span><span class="lineNoCov">          0 :             if(truparticle[4]!=assparticle[4]) nmisidentified4+=1;</span>
<span class="lineNum">     450 </span><span class="lineNoCov">          0 :             if(truparticle[5]!=assparticle[5]) nmisidentified5+=1;</span>
<span class="lineNum">     451 </span><span class="lineNoCov">          0 :             if(truparticle[6]!=assparticle[6]) nmisidentified6+=1;</span>
<span class="lineNum">     452 </span><span class="lineNoCov">          0 :             if(truparticle[7]!=assparticle[7]) nmisidentified7+=1;</span>
<span class="lineNum">     453 </span><span class="lineNoCov">          0 :             if(truparticle[8]!=assparticle[8]) nmisidentified8+=1;</span>
<span class="lineNum">     454 </span><span class="lineNoCov">          0 :             if(truparticle[9]!=assparticle[9]) nmisidentified9+=1;</span>
<span class="lineNum">     455 </span>            :             // filling histos
<span class="lineNum">     456 </span><span class="lineNoCov">          0 :             htzerobest-&gt;Fill(t0best);</span>
<span class="lineNum">     457 </span><span class="lineNoCov">          0 :             hchibest-&gt;Fill(chisquare);</span>
<span class="lineNum">     458 </span>            :             Double_t dblechisquare=(Double_t)chisquare;
<span class="lineNum">     459 </span><span class="lineNoCov">          0 :             Float_t confLevel=(Float_t)TMath::Prob(dblechisquare,9); // ndf 10-1=9</span>
<span class="lineNum">     460 </span><span class="lineNoCov">          0 :             hchibestconflevel-&gt;Fill(confLevel);</span>
<span class="lineNum">     461 </span><span class="lineNoCov">          0 :             itimes++;</span>
<span class="lineNum">     462 </span><span class="lineNoCov">          0 :             if(strstr(option,&quot;all&quot;)){</span>
<span class="lineNum">     463 </span><span class="lineNoCov">          0 :               AliInfo(Form(&quot;True Assignment %d  %d  %d  %d  %d  %d  %d  %d  %d  %d&quot;, truparticle[0], truparticle[1], truparticle[2], truparticle[3], truparticle[4], truparticle[5], truparticle[6], truparticle[7], truparticle[8], truparticle[9]));</span>
<span class="lineNum">     464 </span><span class="lineNoCov">          0 :               AliInfo(Form(&quot;Best Assignment %d  %d  %d  %d  %d  %d  %d  %d  %d  %d&quot;, assparticle[0], assparticle[1], assparticle[2], assparticle[3], assparticle[4], assparticle[5], assparticle[6], assparticle[7], assparticle[8], assparticle[9]));</span>
<span class="lineNum">     465 </span><span class="lineNoCov">          0 :               AliInfo(Form(&quot;Minimum ChiSquare for current set   %f &quot;, chisquare));</span>
<span class="lineNum">     466 </span><span class="lineNoCov">          0 :               AliInfo(Form(&quot;Confidence Level (Minimum ChiSquare) %f&quot;, confLevel));</span>
<span class="lineNum">     467 </span><span class="lineNoCov">          0 :             }</span>
<span class="lineNum">     468 </span><span class="lineNoCov">          0 :             if (strstr(option,&quot;visual&quot;) &amp;&amp; itimes &amp;&amp; (itimes%kUPDATE) == 0) {</span>
<span class="lineNum">     469 </span><span class="lineNoCov">          0 :               if (itimes == kUPDATE){</span>
<span class="lineNum">     470 </span><span class="lineNoCov">          0 :                 c1-&gt;cd();</span>
<span class="lineNum">     471 </span><span class="lineNoCov">          0 :                 htzerobest-&gt;Draw();</span>
<span class="lineNum">     472 </span><span class="lineNoCov">          0 :                 c2-&gt;cd();</span>
<span class="lineNum">     473 </span><span class="lineNoCov">          0 :                 hchibest-&gt;Draw();</span>
<span class="lineNum">     474 </span><span class="lineNoCov">          0 :                 c3-&gt;cd();</span>
<span class="lineNum">     475 </span><span class="lineNoCov">          0 :                 hchibestconflevel-&gt;Draw();</span>
<span class="lineNum">     476 </span><span class="lineNoCov">          0 :               }</span>
<span class="lineNum">     477 </span><span class="lineNoCov">          0 :               c1-&gt;Modified();</span>
<span class="lineNum">     478 </span><span class="lineNoCov">          0 :               c1-&gt;Update();</span>
<span class="lineNum">     479 </span><span class="lineNoCov">          0 :               c2-&gt;Modified();</span>
<span class="lineNum">     480 </span><span class="lineNoCov">          0 :               c2-&gt;Update();</span>
<span class="lineNum">     481 </span><span class="lineNoCov">          0 :               c3-&gt;Modified();</span>
<span class="lineNum">     482 </span><span class="lineNoCov">          0 :               c3-&gt;Update();</span>
<span class="lineNum">     483 </span><span class="lineNoCov">          0 :               if (gSystem-&gt;ProcessEvents())</span>
<span class="lineNum">     484 </span><span class="lineNoCov">          0 :                 break;</span>
<span class="lineNum">     485 </span>            :             }
<span class="lineNum">     486 </span>            :             chisquare=999.;
<span class="lineNum">     487 </span>            :             t0best=999.;
<span class="lineNum">     488 </span>            :             
<span class="lineNum">     489 </span><span class="lineNoCov">          0 :           } // end for the current set. close if(istop==5)</span>
<span class="lineNum">     490 </span><span class="lineNoCov">          0 :         } // end condition on ipartold</span>
<span class="lineNum">     491 </span>            :       } // end loop on hits for the current track
<span class="lineNum">     492 </span><span class="lineNoCov">          0 :       if(istop&gt;=10) break;</span>
<span class="lineNum">     493 </span><span class="lineNoCov">          0 :     } // end loop on ntracks  </span>
<span class="lineNum">     494 </span><span class="lineNoCov">          0 :   } //event loop</span>
<span class="lineNum">     495 </span>            :   
<span class="lineNum">     496 </span><span class="lineNoCov">          0 :   if(strstr(option,&quot;all&quot;)){</span>
<span class="lineNum">     497 </span><span class="lineNoCov">          0 :     nmisidentified=(nmisidentified0+nmisidentified1+nmisidentified2+nmisidentified3+nmisidentified4+nmisidentified5+nmisidentified6+nmisidentified7+nmisidentified8+nmisidentified9);</span>
<span class="lineNum">     498 </span><span class="lineNoCov">          0 :     AliInfo(Form(&quot;total number of tracks token into account  %i&quot;, 10*5*fNevents));</span>
<span class="lineNum">     499 </span><span class="lineNoCov">          0 :     Float_t badPercentage=100.*(Float_t)nmisidentified/(10*5*fNevents);</span>
<span class="lineNum">     500 </span><span class="lineNoCov">          0 :     AliInfo(Form(&quot;total misidentified                       %i (%f %%) &quot;, nmisidentified, badPercentage));</span>
<span class="lineNum">     501 </span><span class="lineNoCov">          0 :     AliInfo(Form(&quot;Total Number of set token into account     %i&quot;, 5*fNevents));</span>
<span class="lineNum">     502 </span><span class="lineNoCov">          0 :     Float_t goodSetPercentage=100.*(Float_t)ngood/(5*fNevents);</span>
<span class="lineNum">     503 </span><span class="lineNoCov">          0 :     AliInfo(Form(&quot;Number of set with no misidentified tracks %i (%f %%)&quot;, ngood, goodSetPercentage));</span>
<span class="lineNum">     504 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">     505 </span>            : 
<span class="lineNum">     506 </span>            :   // free used memory for canvas
<span class="lineNum">     507 </span><span class="lineNoCov">          0 :   delete c1; c1=0;</span>
<span class="lineNum">     508 </span><span class="lineNoCov">          0 :   delete c2; c2=0;</span>
<span class="lineNum">     509 </span><span class="lineNoCov">          0 :   delete c3; c3=0;</span>
<span class="lineNum">     510 </span>            : 
<span class="lineNum">     511 </span>            :   // generating output filename only if not previously specified using SetTZeroFile
<span class="lineNum">     512 </span>            : 
<span class="lineNum">     513 </span><span class="lineNoCov">          0 :   /*const*/ Int_t kSize = 70+fHeadersFile.Length()+1;</span>
<span class="lineNum">     514 </span><span class="lineNoCov">          0 :   char outFileName[kSize];</span>
<span class="lineNum">     515 </span>            :   
<span class="lineNum">     516 </span><span class="lineNoCov">          0 :   strncpy(outFileName, &quot;ht010tr120ps&quot;, sizeof(&quot;ht010tr120ps&quot;)); // global time resolution has to be converted from Int_t to char</span>
<span class="lineNum">     517 </span>            :                                       // in order to have in the output filename this parameter
<span class="lineNum">     518 </span><span class="lineNoCov">          0 :   strncat(outFileName, fHeadersFile, sizeof(fHeadersFile));</span>
<span class="lineNum">     519 </span>            : 
<span class="lineNum">     520 </span><span class="lineNoCov">          0 :   if(fT0File.IsNull()) fT0File=outFileName;</span>
<span class="lineNum">     521 </span>            : 
<span class="lineNum">     522 </span><span class="lineNoCov">          0 :   TFile* houtfile = new TFile(fT0File,&quot;recreate&quot;);</span>
<span class="lineNum">     523 </span><span class="lineNoCov">          0 :   houtfile-&gt;cd();</span>
<span class="lineNum">     524 </span><span class="lineNoCov">          0 :   htzerobest-&gt;Write(0,TObject::kOverwrite);</span>
<span class="lineNum">     525 </span><span class="lineNoCov">          0 :   hchibest-&gt;Write(0,TObject::kOverwrite);</span>
<span class="lineNum">     526 </span><span class="lineNoCov">          0 :   hchibestconflevel-&gt;Write(0,TObject::kOverwrite);</span>
<span class="lineNum">     527 </span><span class="lineNoCov">          0 :   houtfile-&gt;Close();  </span>
<span class="lineNum">     528 </span>            :   
<span class="lineNum">     529 </span>            :   
<span class="lineNum">     530 </span><span class="lineNoCov">          0 :   if(strstr(option,&quot;tim&quot;) || strstr(option,&quot;all&quot;)){</span>
<span class="lineNum">     531 </span><span class="lineNoCov">          0 :     gBenchmark-&gt;Stop(&quot;TOFT0&quot;);</span>
<span class="lineNum">     532 </span><span class="lineNoCov">          0 :     AliInfo(&quot;AliTOFT0:&quot;);</span>
<span class="lineNum">     533 </span>            :     /*
<span class="lineNum">     534 </span>            :     cout &lt;&lt; &quot;   took &quot; &lt;&lt; gBenchmark-&gt;GetCpuTime(&quot;TOFT0&quot;) &lt;&lt; &quot; seconds in order to calculate T0 &quot; 
<span class="lineNum">     535 </span>            :          &lt;&lt; gBenchmark-&gt;GetCpuTime(&quot;TOFT0&quot;)/fNevents &lt;&lt; &quot; seconds per event &quot; &lt;&lt; endl ;
<span class="lineNum">     536 </span>            :     */
<span class="lineNum">     537 </span><span class="lineNoCov">          0 :     gBenchmark-&gt;Print(&quot;TOFT0&quot;);</span>
<span class="lineNum">     538 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">     539 </span><span class="lineNoCov">          0 : }</span>
<a name="540"><span class="lineNum">     540 </span>            :  </a>
<span class="lineNum">     541 </span>            : //__________________________________________________________________
<span class="lineNum">     542 </span>            : void AliTOFT0::SetTZeroFile(char * file )
<span class="lineNum">     543 </span>            : {
<span class="lineNum">     544 </span>            :   //
<span class="lineNum">     545 </span>            :   // Set T0 file name
<span class="lineNum">     546 </span>            :   //
<span class="lineNum">     547 </span><span class="lineNoCov">          0 :   printf(&quot;Destination file : %s \n&quot;, file) ;</span>
<span class="lineNum">     548 </span><span class="lineNoCov">          0 :   fT0File=file;</span>
<span class="lineNum">     549 </span>            : 
<span class="lineNum">     550 </span><span class="lineNoCov">          0 : }</span>
<a name="551"><span class="lineNum">     551 </span>            : </a>
<span class="lineNum">     552 </span>            : //__________________________________________________________________
<span class="lineNum">     553 </span>            : void AliTOFT0::Print(Option_t* /*option*/)const
<span class="lineNum">     554 </span>            : {
<span class="lineNum">     555 </span>            :   //
<span class="lineNum">     556 </span>            :   // Print class content
<span class="lineNum">     557 </span>            :   //
<span class="lineNum">     558 </span><span class="lineNoCov">          0 :   printf(&quot;------------------- %s -------------\n&quot;, GetName()) ;</span>
<span class="lineNum">     559 </span><span class="lineNoCov">          0 :   if(!fT0File.IsNull())</span>
<span class="lineNum">     560 </span><span class="lineNoCov">          0 :     printf(&quot;  Writing T0 Distribution to file  %s \n&quot;,(char*) fT0File.Data());</span>
<span class="lineNum">     561 </span>            : 
<span class="lineNum">     562 </span><span class="lineNoCov">          0 : }</span>
<a name="563"><span class="lineNum">     563 </span>            : </a>
<span class="lineNum">     564 </span>            : //__________________________________________________________________
<span class="lineNum">     565 </span>            : Bool_t AliTOFT0::operator==( AliTOFT0 const &amp;tzero )const
<span class="lineNum">     566 </span>            : {
<span class="lineNum">     567 </span>            :   //
<span class="lineNum">     568 </span>            :   // Equal operator
<span class="lineNum">     569 </span>            :   // 
<span class="lineNum">     570 </span>            : 
<span class="lineNum">     571 </span><span class="lineNoCov">          0 :   if( (fTimeResolution==tzero.fTimeResolution)&amp;&amp;</span>
<span class="lineNum">     572 </span><span class="lineNoCov">          0 :       (fLowerMomBound==tzero.fLowerMomBound)&amp;&amp;</span>
<span class="lineNum">     573 </span><span class="lineNoCov">          0 :       (fUpperMomBound==tzero.fUpperMomBound))</span>
<span class="lineNum">     574 </span><span class="lineNoCov">          0 :     return kTRUE ;</span>
<span class="lineNum">     575 </span>            :   else
<span class="lineNum">     576 </span><span class="lineNoCov">          0 :     return kFALSE ;</span>
<span class="lineNum">     577 </span><span class="lineNoCov">          0 : }</span>
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.11</a></td></tr>
  </table>
  <br>

</body>
</html>
