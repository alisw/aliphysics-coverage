<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - coverage.info - FMD/FMDbase/AliFMDRing.cxx</title>
  <link rel="stylesheet" type="text/css" href="../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../index.html">top level</a> - <a href="index.html">FMD/FMDbase</a> - AliFMDRing.cxx<span style="font-size: 80%;"> (source / <a href="AliFMDRing.cxx.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">coverage.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">115</td>
            <td class="headerCovTableEntry">180</td>
            <td class="headerCovTableEntryLo">63.9 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2016-06-14 17:26:59</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">9</td>
            <td class="headerCovTableEntry">15</td>
            <td class="headerCovTableEntryLo">60.0 %</td>
          </tr>
          <tr><td><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            : /**************************************************************************</a>
<span class="lineNum">       2 </span>            :  * Copyright(c) 2004, ALICE Experiment at CERN, All rights reserved.      *
<span class="lineNum">       3 </span>            :  *                                                                        *
<span class="lineNum">       4 </span>            :  * Author: The ALICE Off-line Project.                                    *
<span class="lineNum">       5 </span>            :  * Contributors are mentioned in the code where appropriate.              *
<span class="lineNum">       6 </span>            :  *                                                                        *
<span class="lineNum">       7 </span>            :  * Permission to use, copy, modify and distribute this software and its   *
<span class="lineNum">       8 </span>            :  * documentation strictly for non-commercial purposes is hereby granted   *
<span class="lineNum">       9 </span>            :  * without fee, provided that the above copyright notice appears in all   *
<span class="lineNum">      10 </span>            :  * copies and that both the copyright notice and this permission notice   *
<span class="lineNum">      11 </span>            :  * appear in the supporting documentation. The authors make no claims     *
<span class="lineNum">      12 </span>            :  * about the suitability of this software for any purpose. It is          *
<span class="lineNum">      13 </span>            :  * provided &quot;as is&quot; without express or implied warranty.                  *
<span class="lineNum">      14 </span>            :  **************************************************************************/
<span class="lineNum">      15 </span>            : /* $Id$ */
<span class="lineNum">      16 </span>            : /** @file    AliFMDRing.cxx
<span class="lineNum">      17 </span>            :     @author  Christian Holm Christensen &lt;cholm@nbi.dk&gt;
<span class="lineNum">      18 </span>            :     @date    Mon Mar 27 12:47:43 2006
<span class="lineNum">      19 </span>            :     @brief   FMD ring geometry parameters 
<span class="lineNum">      20 </span>            : */
<span class="lineNum">      21 </span>            : //__________________________________________________________________
<span class="lineNum">      22 </span>            : //
<span class="lineNum">      23 </span>            : // Utility class to help implement collection of FMD modules into
<span class="lineNum">      24 </span>            : // rings.  This is used by AliFMDDetector and AliFMDGeometry.
<span class="lineNum">      25 </span>            : // The AliFMDGeometry object owns the AliFMDRing objects, and the
<span class="lineNum">      26 </span>            : // AliFMDDetector objects reference these.  That is, the AliFMDRing
<span class="lineNum">      27 </span>            : // objects are share amoung the AliFMDDetector objects.
<span class="lineNum">      28 </span>            : //
<span class="lineNum">      29 </span>            : // Latest changes by Christian Holm Christensen
<span class="lineNum">      30 </span>            : //
<span class="lineNum">      31 </span>            : 
<span class="lineNum">      32 </span>            : #include &lt;TMath.h&gt;                // ROOT_TMath
<span class="lineNum">      33 </span>            : #include &lt;TVector2.h&gt;             // ROOT_TVector2
<span class="lineNum">      34 </span>            : 
<span class="lineNum">      35 </span>            : // #include &lt;AliLog.h&gt;            // ALILOG_H
<span class="lineNum">      36 </span>            : #include &quot;AliFMDRing.h&quot;               // ALIFMDRING_H
<a name="37"><span class="lineNum">      37 </span>            : </a>
<span class="lineNum">      38 </span>            : //====================================================================
<span class="lineNum">      39 </span><span class="lineCov">         12 : ClassImp(AliFMDRing)</span>
<span class="lineNum">      40 </span>            : #if 0
<span class="lineNum">      41 </span>            :   ; // This is here to keep Emacs for indenting the next line
<span class="lineNum">      42 </span>            : #endif
<a name="43"><span class="lineNum">      43 </span>            : </a>
<span class="lineNum">      44 </span>            : //____________________________________________________________________
<span class="lineNum">      45 </span>            : AliFMDRing::AliFMDRing(Char_t id) 
<span class="lineNum">      46 </span><span class="lineCov">          6 :   : TNamed(Form(&quot;FMD%c&quot;, id), &quot;Forward multiplicity ring&quot;), </span>
<span class="lineNum">      47 </span><span class="lineCov">          6 :     fId(id), </span>
<span class="lineNum">      48 </span><span class="lineCov">          6 :     fBondingWidth(0),</span>
<span class="lineNum">      49 </span><span class="lineCov">          6 :     fWaferRadius(0),</span>
<span class="lineNum">      50 </span><span class="lineCov">          6 :     fSiThickness(0),</span>
<span class="lineNum">      51 </span><span class="lineCov">          6 :     fLowR(0),</span>
<span class="lineNum">      52 </span><span class="lineCov">          6 :     fHighR(0),</span>
<span class="lineNum">      53 </span><span class="lineCov">          6 :     fMinR(0),</span>
<span class="lineNum">      54 </span><span class="lineCov">          6 :     fMaxR(0),</span>
<span class="lineNum">      55 </span><span class="lineCov">          6 :     fTheta(0),</span>
<span class="lineNum">      56 </span><span class="lineCov">          6 :     fNStrips(0),</span>
<span class="lineNum">      57 </span><span class="lineCov">          6 :     fRingDepth(0),</span>
<span class="lineNum">      58 </span><span class="lineCov">          6 :     fLegRadius(0),</span>
<span class="lineNum">      59 </span><span class="lineCov">          6 :     fLegLength(0),</span>
<span class="lineNum">      60 </span><span class="lineCov">          6 :     fLegOffset(0),</span>
<span class="lineNum">      61 </span><span class="lineCov">          6 :     fModuleSpacing(0),</span>
<span class="lineNum">      62 </span><span class="lineCov">          6 :     fPrintboardThickness(0),</span>
<span class="lineNum">      63 </span><span class="lineCov">          6 :     fCopperThickness(0),</span>
<span class="lineNum">      64 </span><span class="lineCov">          6 :     fChipThickness(0),</span>
<span class="lineNum">      65 </span><span class="lineCov">          6 :     fSpacing(0),</span>
<span class="lineNum">      66 </span><span class="lineCov">          6 :     fHoneycombThickness(0.),</span>
<span class="lineNum">      67 </span><span class="lineCov">          6 :     fAlThickness(0.),</span>
<span class="lineNum">      68 </span><span class="lineCov">          6 :     fVerticies(0), </span>
<span class="lineNum">      69 </span><span class="lineCov">          6 :     fSensorVerticies(0),</span>
<span class="lineNum">      70 </span><span class="lineCov">          6 :     fHybridVerticies(0),</span>
<span class="lineNum">      71 </span><span class="lineCov">          6 :     fFeetPositions(0)</span>
<span class="lineNum">      72 </span><span class="lineCov">         30 : {</span>
<span class="lineNum">      73 </span>            :   // Constructor 
<span class="lineNum">      74 </span>            :   // 
<span class="lineNum">      75 </span>            :   // Parameters: 
<span class="lineNum">      76 </span>            :   //    id      Type of ring (either 'I' or 'O') 
<span class="lineNum">      77 </span>            :   // 
<span class="lineNum">      78 </span><span class="lineCov">          6 :   SetBondingWidth();</span>
<span class="lineNum">      79 </span><span class="lineCov">          6 :   SetWaferRadius();</span>
<span class="lineNum">      80 </span><span class="lineCov">          6 :   SetSiThickness();</span>
<span class="lineNum">      81 </span><span class="lineCov">          6 :   SetLegRadius();</span>
<span class="lineNum">      82 </span><span class="lineCov">          6 :   SetLegLength();</span>
<span class="lineNum">      83 </span><span class="lineCov">          6 :   SetLegOffset();</span>
<span class="lineNum">      84 </span><span class="lineCov">          6 :   SetModuleSpacing();</span>
<span class="lineNum">      85 </span><span class="lineCov">          6 :   SetPrintboardThickness();</span>
<span class="lineNum">      86 </span><span class="lineCov">          6 :   SetCopperThickness();</span>
<span class="lineNum">      87 </span><span class="lineCov">          6 :   SetChipThickness();</span>
<span class="lineNum">      88 </span><span class="lineCov">          6 :   SetSpacing();</span>
<span class="lineNum">      89 </span><span class="lineCov">          6 :   SetHoneycombThickness();</span>
<span class="lineNum">      90 </span><span class="lineCov">          6 :   SetAlThickness();</span>
<span class="lineNum">      91 </span>            :   
<span class="lineNum">      92 </span><span class="lineCov">          9 :   if (fId == 'I' || fId == 'i') {</span>
<span class="lineNum">      93 </span><span class="lineCov">          3 :     SetLowR(4.3);</span>
<span class="lineNum">      94 </span><span class="lineCov">          3 :     SetHighR(17.2);</span>
<span class="lineNum">      95 </span><span class="lineCov">          3 :     SetTheta(36/2);</span>
<span class="lineNum">      96 </span><span class="lineCov">          3 :     SetNStrips(512);</span>
<span class="lineNum">      97 </span>            :     Double_t base = 0; // 4.1915;
<span class="lineNum">      98 </span><span class="lineCov">          9 :     fFeetPositions.Add(new TVector2( 0.0551687, 8.0534-base));</span>
<span class="lineNum">      99 </span><span class="lineCov">          9 :     fFeetPositions.Add(new TVector2( 2.9993,   12.9457-base));</span>
<span class="lineNum">     100 </span><span class="lineCov">          9 :     fFeetPositions.Add(new TVector2(-2.9062,   12.9508-base));</span>
<span class="lineNum">     101 </span>            :     
<span class="lineNum">     102 </span><span class="lineCov">          9 :     fHybridVerticies.Add(new TVector2(0.0000,  4.1700));</span>
<span class="lineNum">     103 </span><span class="lineCov">          9 :     fHybridVerticies.Add(new TVector2(1.0574,  4.1700));</span>
<span class="lineNum">     104 </span><span class="lineCov">          9 :     fHybridVerticies.Add(new TVector2(4.6614, 15.2622));</span>
<span class="lineNum">     105 </span><span class="lineCov">          9 :     fHybridVerticies.Add(new TVector2(0.9643, 17.4000));</span>
<span class="lineNum">     106 </span><span class="lineCov">          9 :     fHybridVerticies.Add(new TVector2(0.0000, 17.4000));</span>
<span class="lineNum">     107 </span>            : 
<span class="lineNum">     108 </span><span class="lineCov">          9 :     fSensorVerticies.Add(new TVector2(0.0000,  4.1915));</span>
<span class="lineNum">     109 </span><span class="lineCov">          9 :     fSensorVerticies.Add(new TVector2(1.5793,  4.1915));</span>
<span class="lineNum">     110 </span><span class="lineCov">          9 :     fSensorVerticies.Add(new TVector2(5.2293, 15.4251));</span>
<span class="lineNum">     111 </span><span class="lineCov">          9 :     fSensorVerticies.Add(new TVector2(1.9807, 17.3035));</span>
<span class="lineNum">     112 </span><span class="lineCov">          9 :     fSensorVerticies.Add(new TVector2(0.0000, 17.3035));</span>
<span class="lineNum">     113 </span>            : 
<span class="lineNum">     114 </span><span class="lineCov">          9 :     fVerticies.Add(new TVector2(0.0000,  4.3000));</span>
<span class="lineNum">     115 </span><span class="lineCov">          9 :     fVerticies.Add(new TVector2(1.3972,  4.3000));</span>
<span class="lineNum">     116 </span><span class="lineCov">          9 :     fVerticies.Add(new TVector2(4.9895, 15.3560));</span>
<span class="lineNum">     117 </span><span class="lineCov">          9 :     fVerticies.Add(new TVector2(1.8007, 17.2000));</span>
<span class="lineNum">     118 </span><span class="lineCov">          9 :     fVerticies.Add(new TVector2(0.0000, 17.2000));</span>
<span class="lineNum">     119 </span><span class="lineCov">          3 :   }</span>
<span class="lineNum">     120 </span><span class="lineCov">          3 :   else if (fId == 'O' || fId == 'o') {</span>
<span class="lineNum">     121 </span><span class="lineCov">          3 :     SetLowR(15.6);</span>
<span class="lineNum">     122 </span><span class="lineCov">          3 :     SetHighR(28.0);</span>
<span class="lineNum">     123 </span><span class="lineCov">          3 :     SetTheta(18/2);</span>
<span class="lineNum">     124 </span><span class="lineCov">          3 :     SetNStrips(256);</span>
<span class="lineNum">     125 </span>            :     Double_t base = 0; // 14.9104;
<span class="lineNum">     126 </span><span class="lineCov">          9 :     fFeetPositions.Add(new TVector2(-1.72540000, 20.6267-base));</span>
<span class="lineNum">     127 </span><span class="lineCov">          9 :     fFeetPositions.Add(new TVector2( 1.72900000, 20.6267-base));</span>
<span class="lineNum">     128 </span><span class="lineCov">          9 :     fFeetPositions.Add(new TVector2( 0.00177616, 26.6007-base));</span>
<span class="lineNum">     129 </span>            : 
<span class="lineNum">     130 </span><span class="lineCov">          9 :     fHybridVerticies.Add(new TVector2(0.0000, 14.9104));</span>
<span class="lineNum">     131 </span><span class="lineCov">          9 :     fHybridVerticies.Add(new TVector2(2.0783, 14.9104));</span>
<span class="lineNum">     132 </span><span class="lineCov">          9 :     fHybridVerticies.Add(new TVector2(3.9202, 26.5395));</span>
<span class="lineNum">     133 </span><span class="lineCov">          9 :     fHybridVerticies.Add(new TVector2(0.6784, 28.2500));</span>
<span class="lineNum">     134 </span><span class="lineCov">          9 :     fHybridVerticies.Add(new TVector2(0.0000, 28.2500));</span>
<span class="lineNum">     135 </span>            : 
<span class="lineNum">     136 </span><span class="lineCov">          9 :     fSensorVerticies.Add(new TVector2(0.0000, 15.0104));</span>
<span class="lineNum">     137 </span><span class="lineCov">          9 :     fSensorVerticies.Add(new TVector2(2.5799, 15.0104));</span>
<span class="lineNum">     138 </span><span class="lineCov">          9 :     fSensorVerticies.Add(new TVector2(4.4439, 26.7766));</span>
<span class="lineNum">     139 </span><span class="lineCov">          9 :     fSensorVerticies.Add(new TVector2(1.8350, 28.1500));</span>
<span class="lineNum">     140 </span><span class="lineCov">          9 :     fSensorVerticies.Add(new TVector2(0.0000, 28.1500));</span>
<span class="lineNum">     141 </span>            : 
<span class="lineNum">     142 </span><span class="lineCov">          9 :     fVerticies.Add(new TVector2(0.0000, 15.2104));</span>
<span class="lineNum">     143 </span><span class="lineCov">          9 :     fVerticies.Add(new TVector2(2.4091, 15.2104));</span>
<span class="lineNum">     144 </span><span class="lineCov">          9 :     fVerticies.Add(new TVector2(4.2231, 26.6638));</span>
<span class="lineNum">     145 </span><span class="lineCov">          9 :     fVerticies.Add(new TVector2(1.8357, 27.9500));</span>
<span class="lineNum">     146 </span><span class="lineCov">          9 :     fVerticies.Add(new TVector2(0.0000, 27.9500));</span>
<span class="lineNum">     147 </span><span class="lineCov">          3 :   }</span>
<span class="lineNum">     148 </span><span class="lineCov">         12 : }</span>
<span class="lineNum">     149 </span>            : 
<a name="150"><span class="lineNum">     150 </span>            : //____________________________________________________________________</a>
<span class="lineNum">     151 </span>            : void
<span class="lineNum">     152 </span>            : AliFMDRing::Init()
<span class="lineNum">     153 </span>            : {
<span class="lineNum">     154 </span>            :   // Initialize 
<span class="lineNum">     155 </span>            :   // 
<span class="lineNum">     156 </span>            :   // All derived quantities are calculated here. 
<span class="lineNum">     157 </span>            :   // 
<span class="lineNum">     158 </span>            : #if 0
<span class="lineNum">     159 </span>            :   Double_t tanTheta  = TMath::Tan(fTheta * TMath::Pi() / 180.);
<span class="lineNum">     160 </span>            :   Double_t tanTheta2 = TMath::Power(tanTheta,2);
<span class="lineNum">     161 </span>            :   Double_t r2        = TMath::Power(fWaferRadius,2);
<span class="lineNum">     162 </span>            :   Double_t yA        = tanTheta * fLowR;
<span class="lineNum">     163 </span>            :   Double_t lr2       = TMath::Power(fLowR, 2);
<span class="lineNum">     164 </span>            :   Double_t hr2       = TMath::Power(fHighR,2);
<span class="lineNum">     165 </span>            :   Double_t xD        = fLowR + TMath::Sqrt(r2 - tanTheta2 * lr2);
<span class="lineNum">     166 </span>            :   Double_t xD2       = TMath::Power(xD,2);
<span class="lineNum">     167 </span>            :   Double_t yB        = TMath::Sqrt(r2 - hr2 + 2 * fHighR * xD - xD2);
<span class="lineNum">     168 </span>            :   Double_t xC        = ((xD + TMath::Sqrt(-tanTheta2 * xD2 + r2
<span class="lineNum">     169 </span>            :                                           + r2 * tanTheta2)) 
<span class="lineNum">     170 </span>            :                         / (1 + tanTheta2));
<span class="lineNum">     171 </span>            :   Double_t yC        = tanTheta * xC;
<span class="lineNum">     172 </span>            :   
<span class="lineNum">     173 </span>            :   fVerticies.Expand(6);
<span class="lineNum">     174 </span>            :   fVerticies.AddAt(new TVector2(fLowR,  -yA), 0);
<span class="lineNum">     175 </span>            :   fVerticies.AddAt(new TVector2(xC,     -yC), 1);
<span class="lineNum">     176 </span>            :   fVerticies.AddAt(new TVector2(fHighR, -yB), 2);
<span class="lineNum">     177 </span>            :   fVerticies.AddAt(new TVector2(fHighR,  yB), 3);
<span class="lineNum">     178 </span>            :   fVerticies.AddAt(new TVector2(xC,      yC), 4);
<span class="lineNum">     179 </span>            :   fVerticies.AddAt(new TVector2(fLowR,   yA), 5);  
<span class="lineNum">     180 </span>            : #endif
<span class="lineNum">     181 </span>            : 
<span class="lineNum">     182 </span>            :   // A's length. Corresponds to distance from nominal beam line to the
<span class="lineNum">     183 </span>            :   // cornor of the active silicon element. 
<span class="lineNum">     184 </span><span class="lineCov">         44 :   fMinR = GetVertex(1)-&gt;Mod(); // GetVertex(5)-&gt;Mod();</span>
<span class="lineNum">     185 </span>            :   // A's length. Corresponds to distance from nominal beam line to the
<span class="lineNum">     186 </span>            :   // cornor of the active silicon element. 
<span class="lineNum">     187 </span><span class="lineCov">         22 :   fMaxR = fHighR;</span>
<span class="lineNum">     188 </span>            : 
<span class="lineNum">     189 </span><span class="lineCov">         44 :   fRingDepth = (fSiThickness + fPrintboardThickness </span>
<span class="lineNum">     190 </span><span class="lineCov">         22 :                 + fCopperThickness + fChipThickness </span>
<span class="lineNum">     191 </span><span class="lineCov">         22 :                 + fLegLength + fModuleSpacing + fSpacing);</span>
<span class="lineNum">     192 </span><span class="lineCov">         22 : }</span>
<span class="lineNum">     193 </span>            : 
<a name="194"><span class="lineNum">     194 </span>            : //____________________________________________________________________</a>
<span class="lineNum">     195 </span>            : TVector2*
<span class="lineNum">     196 </span>            : AliFMDRing::GetVertex(Int_t i) const
<span class="lineNum">     197 </span>            : {
<span class="lineNum">     198 </span>            :   // Get the i'th vertex of polygon shape
<span class="lineNum">     199 </span>            :   // 
<span class="lineNum">     200 </span>            :   // the polygon shape describes the shape of the rings' sensors
<span class="lineNum">     201 </span>            :   // 
<span class="lineNum">     202 </span>            :   // Parameters: 
<span class="lineNum">     203 </span>            :   //     i    The vertex number to get (from 0 to 5)
<span class="lineNum">     204 </span><span class="lineCov">         44 :   return static_cast&lt;TVector2*&gt;(fVerticies.At(i));</span>
<span class="lineNum">     205 </span>            : }
<span class="lineNum">     206 </span>            : 
<a name="207"><span class="lineNum">     207 </span>            : //____________________________________________________________________</a>
<span class="lineNum">     208 </span>            : TVector2*
<span class="lineNum">     209 </span>            : AliFMDRing::GetSensorVertex(Int_t i) const
<span class="lineNum">     210 </span>            : {
<span class="lineNum">     211 </span>            :   // Get the i'th vertex of polygon shape
<span class="lineNum">     212 </span>            :   // 
<span class="lineNum">     213 </span>            :   // the polygon shape describes the shape of the rings' sensors
<span class="lineNum">     214 </span>            :   // 
<span class="lineNum">     215 </span>            :   // Parameters: 
<span class="lineNum">     216 </span>            :   //     i    The vertex number to get (from 0 to 5)
<span class="lineNum">     217 </span><span class="lineNoCov">          0 :   return static_cast&lt;TVector2*&gt;(fSensorVerticies.At(i));</span>
<span class="lineNum">     218 </span>            : }
<span class="lineNum">     219 </span>            : 
<a name="220"><span class="lineNum">     220 </span>            : //____________________________________________________________________</a>
<span class="lineNum">     221 </span>            : TVector2*
<span class="lineNum">     222 </span>            : AliFMDRing::GetHybridVertex(Int_t i) const
<span class="lineNum">     223 </span>            : {
<span class="lineNum">     224 </span>            :   // Get the i'th vertex of polygon shape
<span class="lineNum">     225 </span>            :   // 
<span class="lineNum">     226 </span>            :   // the polygon shape describes the shape of the rings' hybrid cards
<span class="lineNum">     227 </span>            :   // 
<span class="lineNum">     228 </span>            :   // Parameters: 
<span class="lineNum">     229 </span>            :   //     i    The vertex number to get (from 0 to 5)
<span class="lineNum">     230 </span><span class="lineNoCov">          0 :   return static_cast&lt;TVector2*&gt;(fHybridVerticies.At(i));</span>
<span class="lineNum">     231 </span>            : }
<span class="lineNum">     232 </span>            : 
<a name="233"><span class="lineNum">     233 </span>            : //____________________________________________________________________</a>
<span class="lineNum">     234 </span>            : TVector2*
<span class="lineNum">     235 </span>            : AliFMDRing::GetFootPosition(Int_t i) const
<span class="lineNum">     236 </span>            : {
<span class="lineNum">     237 </span>            :   // Get the i'th vertex of polygon shape
<span class="lineNum">     238 </span>            :   // 
<span class="lineNum">     239 </span>            :   // The feet are attached to the hybrid cards
<span class="lineNum">     240 </span>            :   // 
<span class="lineNum">     241 </span>            :   // Parameters: 
<span class="lineNum">     242 </span>            :   //     i    The foot number to get (from 0 to 2)
<span class="lineNum">     243 </span><span class="lineCov">         12 :   return static_cast&lt;TVector2*&gt;(fFeetPositions.At(i));</span>
<span class="lineNum">     244 </span>            : }
<span class="lineNum">     245 </span>            : 
<a name="246"><span class="lineNum">     246 </span>            : //____________________________________________________________________</a>
<span class="lineNum">     247 </span>            : Double_t
<span class="lineNum">     248 </span>            : AliFMDRing::GetStripRadius(UShort_t strip) const
<span class="lineNum">     249 </span>            : {
<span class="lineNum">     250 </span>            :   // Return the nominal strip radius 
<span class="lineNum">     251 </span>            :   // 
<span class="lineNum">     252 </span>            :   // Parameter 
<span class="lineNum">     253 </span>            :   //   strip    Strip number (0-511 for inners, 0-255 for outers)
<span class="lineNum">     254 </span><span class="lineCov">     884736 :   Double_t rmax     = GetMaxR();</span>
<span class="lineNum">     255 </span><span class="lineCov">     442368 :   Double_t stripoff = GetMinR();</span>
<span class="lineNum">     256 </span><span class="lineCov">     442368 :   Double_t dstrip   = (rmax - stripoff) / GetNStrips();</span>
<span class="lineNum">     257 </span><span class="lineCov">     442368 :   return (strip + .5) * dstrip + stripoff; // fLowR</span>
<span class="lineNum">     258 </span>            : }
<span class="lineNum">     259 </span>            :  
<a name="260"><span class="lineNum">     260 </span>            : //____________________________________________________________________</a>
<span class="lineNum">     261 </span>            : Double_t
<span class="lineNum">     262 </span>            : AliFMDRing::GetModuleDepth() const
<span class="lineNum">     263 </span>            : {
<span class="lineNum">     264 </span>            :   // Get the total depth of a module (sensor + hybrid card) 
<span class="lineNum">     265 </span>            :   // 
<span class="lineNum">     266 </span>            :   // The depth is the sum of 
<span class="lineNum">     267 </span>            :   // 
<span class="lineNum">     268 </span>            :   //   The silicon thickness 
<span class="lineNum">     269 </span>            :   //   The thickness of spacers between the silicon and hybrid
<span class="lineNum">     270 </span>            :   //   The thickness of the hybrid PCB
<span class="lineNum">     271 </span>            :   //   The thickness of the copper layer in the PCB
<span class="lineNum">     272 </span>            :   //   The thickness of the chip layer in the PCB
<span class="lineNum">     273 </span>            :   //   The height of the legs
<span class="lineNum">     274 </span><span class="lineCov">         36 :   return (GetSiThickness() </span>
<span class="lineNum">     275 </span><span class="lineCov">         12 :           + GetSpacing() </span>
<span class="lineNum">     276 </span><span class="lineCov">         12 :           + GetPrintboardThickness()</span>
<span class="lineNum">     277 </span><span class="lineCov">         12 :           + GetCopperThickness()</span>
<span class="lineNum">     278 </span><span class="lineCov">         12 :           + GetChipThickness()</span>
<span class="lineNum">     279 </span><span class="lineCov">         12 :           + GetLegLength());</span>
<span class="lineNum">     280 </span>            :   
<span class="lineNum">     281 </span>            : }
<span class="lineNum">     282 </span>            : 
<a name="283"><span class="lineNum">     283 </span>            : //____________________________________________________________________</a>
<span class="lineNum">     284 </span>            : Double_t
<span class="lineNum">     285 </span>            : AliFMDRing::GetFullDepth() const
<span class="lineNum">     286 </span>            : {
<span class="lineNum">     287 </span>            :   // Get the full depth of this ring, including the honeycomb, 
<span class="lineNum">     288 </span>            :   // digitizer and card. 
<span class="lineNum">     289 </span><span class="lineCov">          6 :   return (GetModuleDepth() </span>
<span class="lineNum">     290 </span><span class="lineCov">          2 :           + GetModuleSpacing()</span>
<span class="lineNum">     291 </span><span class="lineCov">          2 :           + GetHoneycombThickness()</span>
<span class="lineNum">     292 </span><span class="lineCov">          2 :           + GetFMDDPrintboardThickness()</span>
<span class="lineNum">     293 </span><span class="lineCov">          2 :           + GetFMDDCopperThickness()</span>
<span class="lineNum">     294 </span><span class="lineCov">          2 :           + GetFMDDChipThickness() </span>
<span class="lineNum">     295 </span><span class="lineCov">          2 :           + 0.5);</span>
<span class="lineNum">     296 </span>            : }
<span class="lineNum">     297 </span>            : 
<a name="298"><span class="lineNum">     298 </span>            : //____________________________________________________________________</a>
<span class="lineNum">     299 </span>            : void
<span class="lineNum">     300 </span>            : AliFMDRing::Detector2XYZ(UShort_t sector,
<span class="lineNum">     301 </span>            :                          UShort_t strip, 
<span class="lineNum">     302 </span>            :                          Double_t&amp; x, 
<span class="lineNum">     303 </span>            :                          Double_t&amp; y, 
<span class="lineNum">     304 </span>            :                          Double_t&amp; z) const
<span class="lineNum">     305 </span>            : {
<span class="lineNum">     306 </span>            :   // Translate detector coordinates (this,sector,strip) to global
<span class="lineNum">     307 </span>            :   // coordinates (x,y,z)
<span class="lineNum">     308 </span>            :   // 
<span class="lineNum">     309 </span>            :   // Parameters 
<span class="lineNum">     310 </span>            :   //    sector        Sector number in this ring 
<span class="lineNum">     311 </span>            :   //    strip         Strip number in this ring 
<span class="lineNum">     312 </span>            :   //    x             On return, the global X coordinate
<span class="lineNum">     313 </span>            :   //    y             On return, the global Y coordinate 
<span class="lineNum">     314 </span>            :   //    z             On return, the z coordinate in the ring plane 
<span class="lineNum">     315 </span>            :   //
<span class="lineNum">     316 </span>            :   // The ring plane is the plane half way between the two sensor
<span class="lineNum">     317 </span>            :   // layers. 
<span class="lineNum">     318 </span><span class="lineNoCov">          0 :   if (sector &gt;= GetNSectors()) {</span>
<span class="lineNum">     319 </span><span class="lineNoCov">          0 :     Error(&quot;Detector2XYZ&quot;, &quot;Invalid sector number %d (&gt;=%d) in ring %c&quot;, </span>
<span class="lineNum">     320 </span><span class="lineNoCov">          0 :           sector, GetNSectors(), fId);</span>
<span class="lineNum">     321 </span><span class="lineNoCov">          0 :     return;</span>
<span class="lineNum">     322 </span>            :   }
<span class="lineNum">     323 </span><span class="lineNoCov">          0 :   if (strip &gt;= GetNStrips()) {</span>
<span class="lineNum">     324 </span><span class="lineNoCov">          0 :     Error(&quot;Detector2XYZ&quot;, &quot;Invalid strip number %d (&gt;=%d) for ring type '%c'&quot;, </span>
<span class="lineNum">     325 </span><span class="lineNoCov">          0 :           strip, GetNStrips(), fId);</span>
<span class="lineNum">     326 </span><span class="lineNoCov">          0 :     return;</span>
<span class="lineNum">     327 </span>            :   }
<span class="lineNum">     328 </span><span class="lineNoCov">          0 :   Double_t phi = Float_t(sector + .5) / GetNSectors() * 2 * TMath::Pi();</span>
<span class="lineNum">     329 </span><span class="lineNoCov">          0 :   Double_t r   = Float_t(strip + .5) / GetNStrips() * (fHighR - fLowR) + fLowR;</span>
<span class="lineNum">     330 </span><span class="lineNoCov">          0 :   x = r * TMath::Cos(phi);</span>
<span class="lineNum">     331 </span><span class="lineNoCov">          0 :   y = r * TMath::Sin(phi);</span>
<span class="lineNum">     332 </span><span class="lineNoCov">          0 :   if (((sector / 2) % 2) == 1) </span>
<span class="lineNum">     333 </span><span class="lineNoCov">          0 :     z += TMath::Sign(fModuleSpacing, z);</span>
<span class="lineNum">     334 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">     335 </span>            : 
<a name="336"><span class="lineNum">     336 </span>            : //____________________________________________________________________</a>
<span class="lineNum">     337 </span>            : Bool_t
<span class="lineNum">     338 </span>            : AliFMDRing::XYZ2Detector(Double_t  x, 
<span class="lineNum">     339 </span>            :                          Double_t  y, 
<span class="lineNum">     340 </span>            :                          Double_t  z,
<span class="lineNum">     341 </span>            :                          UShort_t&amp; sector,
<span class="lineNum">     342 </span>            :                          UShort_t&amp; strip) const
<span class="lineNum">     343 </span>            : {
<span class="lineNum">     344 </span>            :   // Translate global coordinates (x,y,z) to detector coordinates
<span class="lineNum">     345 </span>            :   // (this,sector,strip)
<span class="lineNum">     346 </span>            :   // 
<span class="lineNum">     347 </span>            :   //  Parameters: 
<span class="lineNum">     348 </span>            :   //     x       Global x coordinate 
<span class="lineNum">     349 </span>            :   //     y       Global y coordinate
<span class="lineNum">     350 </span>            :   //     z       Global y coordinate
<span class="lineNum">     351 </span>            :   //     sector  On return, the sector number in this ring
<span class="lineNum">     352 </span>            :   //     strip   On return, the strip number in this ring
<span class="lineNum">     353 </span>            :   // 
<span class="lineNum">     354 </span><span class="lineNoCov">          0 :   sector = strip = 0;</span>
<span class="lineNum">     355 </span><span class="lineNoCov">          0 :   Double_t r = TMath::Sqrt(x * x + y * y);</span>
<span class="lineNum">     356 </span><span class="lineNoCov">          0 :   Int_t str = Int_t((r - fMinR) / GetPitch());</span>
<span class="lineNum">     357 </span><span class="lineNoCov">          0 :   if (str &lt; 0 || str &gt;= GetNStrips()) return kFALSE;</span>
<span class="lineNum">     358 </span>            : 
<span class="lineNum">     359 </span><span class="lineNoCov">          0 :   Double_t phi = TMath::ATan2(y, x) * 180. / TMath::Pi();</span>
<span class="lineNum">     360 </span><span class="lineNoCov">          0 :   if (phi &lt; 0) phi = 360. + phi;</span>
<span class="lineNum">     361 </span><span class="lineNoCov">          0 :   Int_t sec = Int_t(phi / fTheta);</span>
<span class="lineNum">     362 </span><span class="lineNoCov">          0 :   if (sec &lt; 0 || sec &gt;= GetNSectors()) return kFALSE;</span>
<span class="lineNum">     363 </span><span class="lineNoCov">          0 :   if ((sec / 2) % 2 == 1) {</span>
<span class="lineNum">     364 </span><span class="lineNoCov">          0 :     if (TMath::Abs(z - TMath::Sign(fModuleSpacing, z)) &gt;= 0.01)</span>
<span class="lineNum">     365 </span><span class="lineNoCov">          0 :       return kFALSE;</span>
<span class="lineNum">     366 </span>            :   }
<span class="lineNum">     367 </span><span class="lineNoCov">          0 :   else if (TMath::Abs(z) &gt;= 0.01) return kFALSE;</span>
<span class="lineNum">     368 </span>            : 
<span class="lineNum">     369 </span><span class="lineNoCov">          0 :   strip  = str;</span>
<span class="lineNum">     370 </span><span class="lineNoCov">          0 :   sector = sec;</span>
<span class="lineNum">     371 </span><span class="lineNoCov">          0 :   return kTRUE;</span>
<span class="lineNum">     372 </span><span class="lineNoCov">          0 : }</span>
<a name="373"><span class="lineNum">     373 </span>            : //____________________________________________________________________</a>
<span class="lineNum">     374 </span>            : Float_t 
<span class="lineNum">     375 </span>            : AliFMDRing::GetStripLength(UShort_t strip) const 
<span class="lineNum">     376 </span>            : {
<span class="lineNum">     377 </span>            :   // Get the length of a strip 
<span class="lineNum">     378 </span>            :   // 
<span class="lineNum">     379 </span>            :   // Parameters:
<span class="lineNum">     380 </span>            :   //   strip     Strip number (0-511 for inners, 0-255 for outers)
<span class="lineNum">     381 </span>            :   // 
<span class="lineNum">     382 </span><span class="lineNoCov">          0 :   if(strip &gt;= GetNStrips())</span>
<span class="lineNum">     383 </span><span class="lineNoCov">          0 :     Error(&quot;GetStripLength&quot;, &quot;Invalid strip number %d (&gt;=%d) for ring type %c&quot;, </span>
<span class="lineNum">     384 </span><span class="lineNoCov">          0 :           strip, GetNStrips(), fId);</span>
<span class="lineNum">     385 </span>            :   
<span class="lineNum">     386 </span><span class="lineNoCov">          0 :   Float_t rad        = GetMaxR()-GetMinR();</span>
<span class="lineNum">     387 </span>            :   
<span class="lineNum">     388 </span><span class="lineNoCov">          0 :   Float_t segment    = rad / GetNStrips();</span>
<span class="lineNum">     389 </span>            :   
<span class="lineNum">     390 </span><span class="lineNoCov">          0 :   TVector2* corner1  = GetVertex(2);  </span>
<span class="lineNum">     391 </span><span class="lineNoCov">          0 :   TVector2* corner2  = GetVertex(3);</span>
<span class="lineNum">     392 </span>            :   
<span class="lineNum">     393 </span><span class="lineNoCov">          0 :   Float_t slope      = ((corner1-&gt;Y() - corner2-&gt;Y()) / </span>
<span class="lineNum">     394 </span><span class="lineNoCov">          0 :                         (corner1-&gt;X() - corner2-&gt;X()));</span>
<span class="lineNum">     395 </span><span class="lineNoCov">          0 :   Float_t constant   = ((corner2-&gt;Y() * corner1-&gt;X() - </span>
<span class="lineNum">     396 </span><span class="lineNoCov">          0 :                          (corner2-&gt;X()*corner1-&gt;Y())) / </span>
<span class="lineNum">     397 </span><span class="lineNoCov">          0 :                         (corner1-&gt;X() - corner2-&gt;X()));</span>
<span class="lineNum">     398 </span><span class="lineNoCov">          0 :   Float_t radius     = GetMinR() + strip*segment;</span>
<span class="lineNum">     399 </span>            :   
<span class="lineNum">     400 </span><span class="lineNoCov">          0 :   Float_t d          = (TMath::Power(TMath::Abs(radius*slope),2) + </span>
<span class="lineNum">     401 </span><span class="lineNoCov">          0 :                         TMath::Power(radius,2) - TMath::Power(constant,2));</span>
<span class="lineNum">     402 </span>            :   
<span class="lineNum">     403 </span><span class="lineNoCov">          0 :   Float_t arclength  = GetBaseStripLength(strip);</span>
<span class="lineNum">     404 </span><span class="lineNoCov">          0 :   if(d&gt;0) {</span>
<span class="lineNum">     405 </span><span class="lineNoCov">          0 :     Float_t x        = ((-1 * TMath::Sqrt(d) -slope*constant) / </span>
<span class="lineNum">     406 </span><span class="lineNoCov">          0 :                         (1 + TMath::Power(slope,2)));</span>
<span class="lineNum">     407 </span><span class="lineNoCov">          0 :     Float_t y        = slope*x + constant;</span>
<span class="lineNum">     408 </span><span class="lineNoCov">          0 :     Float_t theta    = TMath::ATan2(x,y);</span>
<span class="lineNum">     409 </span>            :     
<span class="lineNum">     410 </span><span class="lineNoCov">          0 :     if(x &lt; corner1-&gt;X() &amp;&amp; y &gt; corner1-&gt;Y()) {</span>
<span class="lineNum">     411 </span>            :       //One sector since theta is by definition half-hybrid
<span class="lineNum">     412 </span><span class="lineNoCov">          0 :       arclength = radius*theta;</span>
<span class="lineNum">     413 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">     414 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">     415 </span>            :   
<span class="lineNum">     416 </span><span class="lineNoCov">          0 :   return arclength;</span>
<span class="lineNum">     417 </span>            :   
<span class="lineNum">     418 </span>            :   
<span class="lineNum">     419 </span>            : }
<a name="420"><span class="lineNum">     420 </span>            : //____________________________________________________________________</a>
<span class="lineNum">     421 </span>            : Float_t 
<span class="lineNum">     422 </span>            : AliFMDRing::GetBaseStripLength(UShort_t strip) const 
<span class="lineNum">     423 </span>            : {  
<span class="lineNum">     424 </span>            :   // Get the basic strip length 
<span class="lineNum">     425 </span>            :   // 
<span class="lineNum">     426 </span>            :   // Parameters:
<span class="lineNum">     427 </span>            :   //   strip    Strip number
<span class="lineNum">     428 </span><span class="lineNoCov">          0 :   Float_t rad             = GetMaxR()-GetMinR();</span>
<span class="lineNum">     429 </span><span class="lineNoCov">          0 :   Float_t segment         = rad / GetNStrips();</span>
<span class="lineNum">     430 </span><span class="lineNoCov">          0 :   Float_t basearc         = 2*TMath::Pi() / (0.5*GetNSectors()); </span>
<span class="lineNum">     431 </span><span class="lineNoCov">          0 :   Float_t radius          = GetMinR() + strip*segment;</span>
<span class="lineNum">     432 </span><span class="lineNoCov">          0 :   Float_t basearclength   = 0.5*basearc * radius;                </span>
<span class="lineNum">     433 </span>            :   
<span class="lineNum">     434 </span><span class="lineNoCov">          0 :   return basearclength;</span>
<span class="lineNum">     435 </span>            : }
<span class="lineNum">     436 </span>            : //
<span class="lineNum">     437 </span>            : // EOF
<span class="lineNum">     438 </span>            : //
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.11</a></td></tr>
  </table>
  <br>

</body>
</html>
