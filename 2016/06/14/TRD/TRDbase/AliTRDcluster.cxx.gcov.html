<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - coverage.info - TRD/TRDbase/AliTRDcluster.cxx</title>
  <link rel="stylesheet" type="text/css" href="../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../index.html">top level</a> - <a href="index.html">TRD/TRDbase</a> - AliTRDcluster.cxx<span style="font-size: 80%;"> (source / <a href="AliTRDcluster.cxx.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">coverage.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">162</td>
            <td class="headerCovTableEntry">297</td>
            <td class="headerCovTableEntryLo">54.5 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2016-06-14 17:26:59</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">18</td>
            <td class="headerCovTableEntry">32</td>
            <td class="headerCovTableEntryLo">56.2 %</td>
          </tr>
          <tr><td><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            : /**************************************************************************</a>
<span class="lineNum">       2 </span>            :  * Copyright(c) 1998-1999, ALICE Experiment at CERN, All rights reserved. *
<span class="lineNum">       3 </span>            :  *                                                                        *
<span class="lineNum">       4 </span>            :  * Author: The ALICE Off-line Project.                                    *
<span class="lineNum">       5 </span>            :  * Contributors are mentioned in the code where appropriate.              *
<span class="lineNum">       6 </span>            :  *                                                                        *
<span class="lineNum">       7 </span>            :  * Permission to use, copy, modify and distribute this software and its   *
<span class="lineNum">       8 </span>            :  * documentation strictly for non-commercial purposes is hereby granted   *
<span class="lineNum">       9 </span>            :  * without fee, provided that the above copyright notice appears in all   *
<span class="lineNum">      10 </span>            :  * copies and that both the copyright notice and this permission notice   *
<span class="lineNum">      11 </span>            :  * appear in the supporting documentation. The authors make no claims     *
<span class="lineNum">      12 </span>            :  * about the suitability of this software for any purpose. It is          *
<span class="lineNum">      13 </span>            :  * provided &quot;as is&quot; without express or implied warranty.                  *
<span class="lineNum">      14 </span>            :  **************************************************************************/
<span class="lineNum">      15 </span>            : 
<span class="lineNum">      16 </span>            : /* $Id$ */
<span class="lineNum">      17 </span>            :  
<span class="lineNum">      18 </span>            : ///////////////////////////////////////////////////////////////////////////////
<span class="lineNum">      19 </span>            : //                                                                           //
<span class="lineNum">      20 </span>            : //  TRD cluster                                                              //
<span class="lineNum">      21 </span>            : //                                                                           //
<span class="lineNum">      22 </span>            : /////////////////////////////////////////////////////////////////////////////// 
<span class="lineNum">      23 </span>            : 
<span class="lineNum">      24 </span>            : #include &lt;TMath.h&gt;
<span class="lineNum">      25 </span>            : 
<span class="lineNum">      26 </span>            : #include &quot;AliLog.h&quot;
<span class="lineNum">      27 </span>            : 
<span class="lineNum">      28 </span>            : #include &quot;AliTRDcluster.h&quot;
<span class="lineNum">      29 </span>            : #include &quot;AliTRDgeometry.h&quot;
<span class="lineNum">      30 </span>            : #include &quot;AliTRDCommonParam.h&quot;
<a name="31"><span class="lineNum">      31 </span>            : #include &quot;AliTRDtrackletWord.h&quot;</a>
<span class="lineNum">      32 </span>            : 
<span class="lineNum">      33 </span><span class="lineCov">         48 : ClassImp(AliTRDcluster)</span>
<span class="lineNum">      34 </span>            : 
<span class="lineNum">      35 </span>            : const Int_t AliTRDcluster::fgkNlut = 128;
<span class="lineNum">      36 </span>            : Double_t *AliTRDcluster::fgLUT = 0x0;
<a name="37"><span class="lineNum">      37 </span>            : </a>
<span class="lineNum">      38 </span>            : //___________________________________________________________________________
<span class="lineNum">      39 </span>            : AliTRDcluster::AliTRDcluster() 
<span class="lineNum">      40 </span><span class="lineCov">      18452 :   :AliCluster() </span>
<span class="lineNum">      41 </span><span class="lineCov">      18452 :   ,fPadCol(0)</span>
<span class="lineNum">      42 </span><span class="lineCov">      18452 :   ,fPadRow(0)</span>
<span class="lineNum">      43 </span><span class="lineCov">      18452 :   ,fPadTime(0)</span>
<span class="lineNum">      44 </span><span class="lineCov">      18452 :   ,fLocalTimeBin(0)</span>
<span class="lineNum">      45 </span><span class="lineCov">      18452 :   ,fNPads(0)</span>
<span class="lineNum">      46 </span><span class="lineCov">      18452 :   ,fClusterMasking(0)</span>
<span class="lineNum">      47 </span><span class="lineCov">      18452 :   ,fDetector(0)</span>
<span class="lineNum">      48 </span><span class="lineCov">      18452 :   ,fQ(0)</span>
<span class="lineNum">      49 </span><span class="lineCov">      18452 :   ,fCenter(0)</span>
<span class="lineNum">      50 </span><span class="lineCov">      92260 : { </span>
<span class="lineNum">      51 </span>            :   //
<span class="lineNum">      52 </span>            :   // Default constructor
<span class="lineNum">      53 </span>            :   //
<span class="lineNum">      54 </span>            : 
<span class="lineNum">      55 </span><span class="lineCov">     295232 :   for (Int_t i = 0; i &lt; 7; i++) {</span>
<span class="lineNum">      56 </span><span class="lineCov">     129164 :     fSignals[i] = 0;</span>
<span class="lineNum">      57 </span>            :   }
<span class="lineNum">      58 </span><span class="lineCov">      18452 :   SetBit(kLUT);</span>
<span class="lineNum">      59 </span><span class="lineCov">      36904 : }</span>
<a name="60"><span class="lineNum">      60 </span>            : </a>
<span class="lineNum">      61 </span>            : //___________________________________________________________________________
<span class="lineNum">      62 </span>            : AliTRDcluster::AliTRDcluster(Int_t det, UChar_t col, UChar_t row, UChar_t time
<span class="lineNum">      63 </span>            :                            , const Short_t *sig, UShort_t vid) 
<span class="lineNum">      64 </span><span class="lineCov">      19320 :   :AliCluster() </span>
<span class="lineNum">      65 </span><span class="lineCov">      19320 :   ,fPadCol(col)</span>
<span class="lineNum">      66 </span><span class="lineCov">      19320 :   ,fPadRow(row)</span>
<span class="lineNum">      67 </span><span class="lineCov">      19320 :   ,fPadTime(time)</span>
<span class="lineNum">      68 </span><span class="lineCov">      19320 :   ,fLocalTimeBin(0)</span>
<span class="lineNum">      69 </span><span class="lineCov">      19320 :   ,fNPads(0)</span>
<span class="lineNum">      70 </span><span class="lineCov">      19320 :   ,fClusterMasking(0)</span>
<span class="lineNum">      71 </span><span class="lineCov">      19320 :   ,fDetector(det)</span>
<span class="lineNum">      72 </span><span class="lineCov">      19320 :   ,fQ(0.)</span>
<span class="lineNum">      73 </span><span class="lineCov">      19320 :   ,fCenter(0.)</span>
<span class="lineNum">      74 </span><span class="lineCov">      96600 : { </span>
<span class="lineNum">      75 </span>            :   //
<span class="lineNum">      76 </span>            :   // Constructor for self constructing cluster. In this approach the information is inserted gradualy into the 
<span class="lineNum">      77 </span>            :   // cluster and all dependencies are (re)calculated inside the cluster itself.
<span class="lineNum">      78 </span>            :   //
<span class="lineNum">      79 </span>            :   // A.Bercuci &lt;A.Bercuci@gsi.de&gt;
<span class="lineNum">      80 </span>            : 
<span class="lineNum">      81 </span><span class="lineCov">      19320 :   memcpy(&amp;fSignals, sig, 7*sizeof(Short_t));</span>
<span class="lineNum">      82 </span><span class="lineCov">      19320 :   fQ = fSignals[2]+fSignals[3]+fSignals[4];</span>
<span class="lineNum">      83 </span><span class="lineCov">      19320 :   SetVolumeId(vid);</span>
<span class="lineNum">      84 </span><span class="lineCov">      19320 :   SetBit(kLUT);</span>
<span class="lineNum">      85 </span><span class="lineCov">      38640 : }</span>
<a name="86"><span class="lineNum">      86 </span>            : </a>
<span class="lineNum">      87 </span>            : //___________________________________________________________________________
<span class="lineNum">      88 </span>            : AliTRDcluster::AliTRDcluster(Int_t det, Float_t q
<span class="lineNum">      89 </span>            :                            , const Float_t *pos, const Float_t *sig
<span class="lineNum">      90 </span>            :                            , const Int_t *tracks, Char_t npads, Short_t * const signals
<span class="lineNum">      91 </span>            :                            , UChar_t col, UChar_t row, UChar_t time
<span class="lineNum">      92 </span>            :                            , Char_t timebin, Float_t center, UShort_t volid)
<span class="lineNum">      93 </span><span class="lineNoCov">          0 :   :AliCluster(volid,pos[0],pos[1],pos[2],sig[0],sig[1],0.0,0x0) </span>
<span class="lineNum">      94 </span><span class="lineNoCov">          0 :   ,fPadCol(col)</span>
<span class="lineNum">      95 </span><span class="lineNoCov">          0 :   ,fPadRow(row)</span>
<span class="lineNum">      96 </span><span class="lineNoCov">          0 :   ,fPadTime(time)</span>
<span class="lineNum">      97 </span><span class="lineNoCov">          0 :   ,fLocalTimeBin(timebin)</span>
<span class="lineNum">      98 </span><span class="lineNoCov">          0 :   ,fNPads(npads)</span>
<span class="lineNum">      99 </span><span class="lineNoCov">          0 :   ,fClusterMasking(0)</span>
<span class="lineNum">     100 </span><span class="lineNoCov">          0 :   ,fDetector(det)</span>
<span class="lineNum">     101 </span><span class="lineNoCov">          0 :   ,fQ(q)</span>
<span class="lineNum">     102 </span><span class="lineNoCov">          0 :   ,fCenter(center)</span>
<span class="lineNum">     103 </span><span class="lineNoCov">          0 : { </span>
<span class="lineNum">     104 </span>            :   //
<span class="lineNum">     105 </span>            :   // Constructor
<span class="lineNum">     106 </span>            :   //
<span class="lineNum">     107 </span>            : 
<span class="lineNum">     108 </span><span class="lineNoCov">          0 :   for (Int_t i = 0; i &lt; 7; i++) {</span>
<span class="lineNum">     109 </span><span class="lineNoCov">          0 :     fSignals[i] = signals[i];</span>
<span class="lineNum">     110 </span>            :   }
<span class="lineNum">     111 </span>            : 
<span class="lineNum">     112 </span><span class="lineNoCov">          0 :   if (tracks) {</span>
<span class="lineNum">     113 </span><span class="lineNoCov">          0 :     AddTrackIndex(tracks);</span>
<span class="lineNum">     114 </span>            :   }
<span class="lineNum">     115 </span><span class="lineNoCov">          0 :   SetBit(kLUT);</span>
<span class="lineNum">     116 </span><span class="lineNoCov">          0 : }</span>
<a name="117"><span class="lineNum">     117 </span>            : </a>
<span class="lineNum">     118 </span>            : //_____________________________________________________________________________
<span class="lineNum">     119 </span>            : AliTRDcluster::AliTRDcluster(const AliTRDtrackletWord *const tracklet, Int_t det, UShort_t volid)
<span class="lineNum">     120 </span><span class="lineNoCov">          0 :   :AliCluster(volid,tracklet-&gt;GetX(),tracklet-&gt;GetY(),tracklet-&gt;GetZ(),0,0,0)</span>
<span class="lineNum">     121 </span><span class="lineNoCov">          0 :   ,fPadCol(0)</span>
<span class="lineNum">     122 </span><span class="lineNoCov">          0 :   ,fPadRow(0)</span>
<span class="lineNum">     123 </span><span class="lineNoCov">          0 :   ,fPadTime(0)</span>
<span class="lineNum">     124 </span><span class="lineNoCov">          0 :   ,fLocalTimeBin(0)</span>
<span class="lineNum">     125 </span><span class="lineNoCov">          0 :   ,fNPads(0)</span>
<span class="lineNum">     126 </span><span class="lineNoCov">          0 :   ,fClusterMasking(0)</span>
<span class="lineNum">     127 </span><span class="lineNoCov">          0 :   ,fDetector(det)</span>
<span class="lineNum">     128 </span><span class="lineNoCov">          0 :   ,fQ(0.)</span>
<span class="lineNum">     129 </span><span class="lineNoCov">          0 :   ,fCenter(0.)</span>
<span class="lineNum">     130 </span><span class="lineNoCov">          0 : {</span>
<span class="lineNum">     131 </span>            :   //
<span class="lineNum">     132 </span>            :   // Constructor from online tracklet 
<span class="lineNum">     133 </span>            :   //
<span class="lineNum">     134 </span>            : 
<span class="lineNum">     135 </span><span class="lineNoCov">          0 :   for (Int_t i = 0; i &lt; 7; i++) {</span>
<span class="lineNum">     136 </span><span class="lineNoCov">          0 :     fSignals[i] = 0;</span>
<span class="lineNum">     137 </span>            :   }
<span class="lineNum">     138 </span>            : 
<span class="lineNum">     139 </span><span class="lineNoCov">          0 : }</span>
<a name="140"><span class="lineNum">     140 </span>            : </a>
<span class="lineNum">     141 </span>            : //_____________________________________________________________________________
<span class="lineNum">     142 </span>            : AliTRDcluster::AliTRDcluster(const AliTRDcluster &amp;c)
<span class="lineNum">     143 </span><span class="lineCov">      41384 :   :AliCluster(c)</span>
<span class="lineNum">     144 </span><span class="lineCov">      41384 :   ,fPadCol(c.fPadCol)</span>
<span class="lineNum">     145 </span><span class="lineCov">      41384 :   ,fPadRow(c.fPadRow)</span>
<span class="lineNum">     146 </span><span class="lineCov">      41384 :   ,fPadTime(c.fPadTime)</span>
<span class="lineNum">     147 </span><span class="lineCov">      41384 :   ,fLocalTimeBin(c.fLocalTimeBin)</span>
<span class="lineNum">     148 </span><span class="lineCov">      41384 :   ,fNPads(c.fNPads)</span>
<span class="lineNum">     149 </span><span class="lineCov">      41384 :   ,fClusterMasking(c.fClusterMasking)</span>
<span class="lineNum">     150 </span><span class="lineCov">      41384 :   ,fDetector(c.fDetector)</span>
<span class="lineNum">     151 </span><span class="lineCov">      41384 :   ,fQ(c.fQ)</span>
<span class="lineNum">     152 </span><span class="lineCov">      41384 :   ,fCenter(c.fCenter)</span>
<span class="lineNum">     153 </span><span class="lineCov">     206920 : {</span>
<span class="lineNum">     154 </span>            :   //
<span class="lineNum">     155 </span>            :   // Copy constructor 
<span class="lineNum">     156 </span>            :   //
<span class="lineNum">     157 </span>            : 
<span class="lineNum">     158 </span><span class="lineCov">      41384 :   SetLabel(c.GetLabel(0),0);</span>
<span class="lineNum">     159 </span><span class="lineCov">      41384 :   SetLabel(c.GetLabel(1),1);</span>
<span class="lineNum">     160 </span><span class="lineCov">      41384 :   SetLabel(c.GetLabel(2),2);</span>
<span class="lineNum">     161 </span>            : 
<span class="lineNum">     162 </span><span class="lineCov">      41384 :   SetY(c.GetY());</span>
<span class="lineNum">     163 </span><span class="lineCov">      41384 :   SetZ(c.GetZ());</span>
<span class="lineNum">     164 </span><span class="lineCov">      41384 :   AliCluster::SetSigmaY2(c.GetSigmaY2());</span>
<span class="lineNum">     165 </span><span class="lineCov">      41384 :   SetSigmaZ2(c.GetSigmaZ2());  </span>
<span class="lineNum">     166 </span>            : 
<span class="lineNum">     167 </span><span class="lineCov">     662144 :   for (Int_t i = 0; i &lt; 7; i++) {</span>
<span class="lineNum">     168 </span><span class="lineCov">     289688 :     fSignals[i] = c.fSignals[i];</span>
<span class="lineNum">     169 </span>            :   }
<span class="lineNum">     170 </span>            : 
<span class="lineNum">     171 </span><span class="lineCov">      82768 : }</span>
<a name="172"><span class="lineNum">     172 </span>            : </a>
<span class="lineNum">     173 </span>            : //_____________________________________________________________________________
<span class="lineNum">     174 </span>            : AliTRDcluster &amp;AliTRDcluster::operator=(const AliTRDcluster &amp;c)
<span class="lineNum">     175 </span>            : {
<span class="lineNum">     176 </span>            :   //
<span class="lineNum">     177 </span>            :   // Assignment operator
<span class="lineNum">     178 </span>            :   //
<span class="lineNum">     179 </span>            : 
<span class="lineNum">     180 </span><span class="lineNoCov">          0 :   if (&amp;c == this) {</span>
<span class="lineNum">     181 </span><span class="lineNoCov">          0 :      return *this;</span>
<span class="lineNum">     182 </span>            :   }
<span class="lineNum">     183 </span>            : 
<span class="lineNum">     184 </span>            :   // Call the assignment operator of the base class
<span class="lineNum">     185 </span><span class="lineNoCov">          0 :   AliCluster::operator=(c);</span>
<span class="lineNum">     186 </span>            : 
<span class="lineNum">     187 </span><span class="lineNoCov">          0 :   fPadCol         = c.fPadCol;</span>
<span class="lineNum">     188 </span><span class="lineNoCov">          0 :   fPadRow         = c.fPadRow;</span>
<span class="lineNum">     189 </span><span class="lineNoCov">          0 :   fPadTime        = c.fPadTime;</span>
<span class="lineNum">     190 </span><span class="lineNoCov">          0 :   fLocalTimeBin   = c.fLocalTimeBin;</span>
<span class="lineNum">     191 </span><span class="lineNoCov">          0 :   fNPads          = c.fNPads;</span>
<span class="lineNum">     192 </span><span class="lineNoCov">          0 :   fClusterMasking = c.fClusterMasking;</span>
<span class="lineNum">     193 </span><span class="lineNoCov">          0 :   fDetector       = c.fDetector;</span>
<span class="lineNum">     194 </span><span class="lineNoCov">          0 :   fQ              = c.fQ;</span>
<span class="lineNum">     195 </span><span class="lineNoCov">          0 :   fCenter         = c.fCenter;</span>
<span class="lineNum">     196 </span>            : 
<span class="lineNum">     197 </span><span class="lineNoCov">          0 :   SetLabel(c.GetLabel(0),0);</span>
<span class="lineNum">     198 </span><span class="lineNoCov">          0 :   SetLabel(c.GetLabel(1),1);</span>
<span class="lineNum">     199 </span><span class="lineNoCov">          0 :   SetLabel(c.GetLabel(2),2);</span>
<span class="lineNum">     200 </span>            : 
<span class="lineNum">     201 </span><span class="lineNoCov">          0 :   SetY(c.GetY());</span>
<span class="lineNum">     202 </span><span class="lineNoCov">          0 :   SetZ(c.GetZ());</span>
<span class="lineNum">     203 </span><span class="lineNoCov">          0 :   SetSigmaZ2(c.GetSigmaZ2());</span>
<span class="lineNum">     204 </span>            : 
<span class="lineNum">     205 </span><span class="lineNoCov">          0 :   for (Int_t i = 0; i &lt; 7; i++) {</span>
<span class="lineNum">     206 </span><span class="lineNoCov">          0 :     fSignals[i] = c.fSignals[i];</span>
<span class="lineNum">     207 </span>            :   }
<span class="lineNum">     208 </span>            : 
<span class="lineNum">     209 </span><span class="lineNoCov">          0 :   return *this;</span>
<span class="lineNum">     210 </span>            : 
<span class="lineNum">     211 </span><span class="lineNoCov">          0 : } </span>
<a name="212"><span class="lineNum">     212 </span>            : </a>
<span class="lineNum">     213 </span>            : //_____________________________________________________________________________
<span class="lineNum">     214 </span>            : void AliTRDcluster::AddTrackIndex(const Int_t * const track)
<span class="lineNum">     215 </span>            : {
<span class="lineNum">     216 </span>            :   //
<span class="lineNum">     217 </span>            :   // Adds track index. Currently assumed that track is an array of
<span class="lineNum">     218 </span>            :   // size 9, and up to 3 track indexes are stored in fTracks[3].
<span class="lineNum">     219 </span>            :   // Indexes are sorted according to:
<span class="lineNum">     220 </span>            :   //  1) index of max number of appearances is stored first
<span class="lineNum">     221 </span>            :   //  2) if two or more indexes appear equal number of times, the lowest
<span class="lineNum">     222 </span>            :   //     ones are stored first;
<span class="lineNum">     223 </span>            :   //
<span class="lineNum">     224 </span>            : 
<span class="lineNum">     225 </span>            :   const Int_t kSize = 9;
<span class="lineNum">     226 </span><span class="lineCov">      19068 :   Int_t  entries[kSize][2];</span>
<span class="lineNum">     227 </span>            : 
<span class="lineNum">     228 </span>            :   Int_t  i = 0;
<span class="lineNum">     229 </span>            :   Int_t  j = 0;
<span class="lineNum">     230 </span>            :   Int_t  k = 0;
<span class="lineNum">     231 </span>            :   Int_t  index;
<span class="lineNum">     232 </span>            :   Bool_t indexAdded;
<span class="lineNum">     233 </span>            : 
<span class="lineNum">     234 </span><span class="lineCov">     190680 :   for (i = 0; i &lt; kSize; i++) {</span>
<span class="lineNum">     235 </span><span class="lineCov">      85806 :     entries[i][0] = -1;</span>
<span class="lineNum">     236 </span><span class="lineCov">      85806 :     entries[i][1] =  0;</span>
<span class="lineNum">     237 </span>            :   }                                 
<span class="lineNum">     238 </span>            : 
<span class="lineNum">     239 </span><span class="lineCov">     190680 :   for (k = 0; k &lt; kSize; k++) {</span>
<span class="lineNum">     240 </span>            : 
<span class="lineNum">     241 </span><span class="lineCov">      85806 :     index      = track[k];</span>
<span class="lineNum">     242 </span>            :     indexAdded = kFALSE; 
<span class="lineNum">     243 </span>            : 
<span class="lineNum">     244 </span>            :     j = 0;
<span class="lineNum">     245 </span><span class="lineCov">      85806 :     if (index &gt;= 0) {</span>
<span class="lineNum">     246 </span><span class="lineCov">     125490 :       while ((!indexAdded) &amp;&amp; (j &lt; kSize)) {</span>
<span class="lineNum">     247 </span><span class="lineCov">      66851 :         if ((entries[j][0] == index) || </span>
<span class="lineNum">     248 </span><span class="lineCov">      21911 :             (entries[j][1] ==     0)) {</span>
<span class="lineNum">     249 </span><span class="lineCov">      35610 :           entries[j][0] = index;</span>
<span class="lineNum">     250 </span><span class="lineCov">      35610 :           entries[j][1] = entries[j][1] + 1;</span>
<span class="lineNum">     251 </span>            :           indexAdded    = kTRUE;
<span class="lineNum">     252 </span><span class="lineCov">      35610 :         }</span>
<span class="lineNum">     253 </span><span class="lineCov">      44940 :         j++;</span>
<span class="lineNum">     254 </span>            :       }
<span class="lineNum">     255 </span>            :     }
<span class="lineNum">     256 </span>            : 
<span class="lineNum">     257 </span>            :   }
<span class="lineNum">     258 </span>            : 
<span class="lineNum">     259 </span>            :   // Sort by number of appearances and index value
<span class="lineNum">     260 </span>            :   Int_t swap = 1;
<span class="lineNum">     261 </span>            :   Int_t tmp0;
<span class="lineNum">     262 </span>            :   Int_t tmp1;
<span class="lineNum">     263 </span><span class="lineCov">      29041 :   while (swap &gt; 0) {</span>
<span class="lineNum">     264 </span>            :     swap = 0;
<span class="lineNum">     265 </span><span class="lineCov">     179514 :     for (i = 0; i &lt; (kSize - 1); i++) {</span>
<span class="lineNum">     266 </span><span class="lineCov">      93971 :       if ((entries[i][0]   &gt;= 0) &amp;&amp; </span>
<span class="lineNum">     267 </span><span class="lineCov">      14187 :           (entries[i+1][0] &gt;= 0)) {</span>
<span class="lineNum">     268 </span><span class="lineCov">       6590 :         if ((entries[i][1] &lt; entries[i+1][1]) ||</span>
<span class="lineNum">     269 </span><span class="lineCov">       3822 :             ((entries[i][1] == entries[i+1][1]) &amp;&amp;</span>
<span class="lineNum">     270 </span><span class="lineCov">       2374 :              (entries[i][0] &gt;  entries[i+1][0]))) {</span>
<span class="lineNum">     271 </span><span class="lineCov">        621 :           tmp0            = entries[i][0];</span>
<span class="lineNum">     272 </span><span class="lineCov">        621 :           tmp1            = entries[i][1];</span>
<span class="lineNum">     273 </span><span class="lineCov">        621 :           entries[i][0]   = entries[i+1][0];</span>
<span class="lineNum">     274 </span><span class="lineCov">        621 :           entries[i][1]   = entries[i+1][1];</span>
<span class="lineNum">     275 </span><span class="lineCov">        621 :           entries[i+1][0] = tmp0;</span>
<span class="lineNum">     276 </span><span class="lineCov">        621 :           entries[i+1][1] = tmp1;</span>
<span class="lineNum">     277 </span><span class="lineCov">        621 :           swap++;</span>
<span class="lineNum">     278 </span><span class="lineCov">        621 :         }</span>
<span class="lineNum">     279 </span>            :       }
<span class="lineNum">     280 </span>            :     }
<span class="lineNum">     281 </span>            :   }               
<span class="lineNum">     282 </span>            : 
<span class="lineNum">     283 </span>            :   // Set track indexes
<span class="lineNum">     284 </span><span class="lineCov">      76272 :   for (i = 0; i &lt; 3; i++) {</span>
<span class="lineNum">     285 </span><span class="lineCov">      28602 :     SetLabel(entries[i][0],i);</span>
<span class="lineNum">     286 </span>            :   }
<span class="lineNum">     287 </span>            : 
<span class="lineNum">     288 </span>            :   return;
<span class="lineNum">     289 </span>            : 
<span class="lineNum">     290 </span><span class="lineCov">       9534 : }          </span>
<a name="291"><span class="lineNum">     291 </span>            : </a>
<span class="lineNum">     292 </span>            : //_____________________________________________________________________________
<span class="lineNum">     293 </span>            : void AliTRDcluster::Clear(Option_t *)
<span class="lineNum">     294 </span>            : {
<span class="lineNum">     295 </span>            :   //
<span class="lineNum">     296 </span>            :   // Reset all member to the default value
<span class="lineNum">     297 </span>            :   //
<span class="lineNum">     298 </span><span class="lineNoCov">          0 :   fPadCol=0;</span>
<span class="lineNum">     299 </span><span class="lineNoCov">          0 :   fPadRow=0;</span>
<span class="lineNum">     300 </span><span class="lineNoCov">          0 :   fPadTime=0;</span>
<span class="lineNum">     301 </span><span class="lineNoCov">          0 :   fLocalTimeBin=0;</span>
<span class="lineNum">     302 </span><span class="lineNoCov">          0 :   fNPads=0;</span>
<span class="lineNum">     303 </span><span class="lineNoCov">          0 :   fClusterMasking=0;</span>
<span class="lineNum">     304 </span><span class="lineNoCov">          0 :   fDetector=0;</span>
<span class="lineNum">     305 </span><span class="lineNoCov">          0 :   for (Int_t i=0; i &lt; 7; i++) fSignals[i]=0;</span>
<span class="lineNum">     306 </span><span class="lineNoCov">          0 :   fQ = 0;</span>
<span class="lineNum">     307 </span><span class="lineNoCov">          0 :   fCenter = 0;</span>
<span class="lineNum">     308 </span><span class="lineNoCov">          0 :   for (Int_t i = 0; i &lt; 3; i++) SetLabel(0,i);</span>
<span class="lineNum">     309 </span><span class="lineNoCov">          0 :   SetX(0.);</span>
<span class="lineNum">     310 </span><span class="lineNoCov">          0 :   SetY(0.);</span>
<span class="lineNum">     311 </span><span class="lineNoCov">          0 :   SetZ(0.);</span>
<span class="lineNum">     312 </span><span class="lineNoCov">          0 :   AliCluster::SetSigmaY2(0.);</span>
<span class="lineNum">     313 </span><span class="lineNoCov">          0 :   SetSigmaZ2(0.);</span>
<span class="lineNum">     314 </span><span class="lineNoCov">          0 :   SetVolumeId(0);</span>
<span class="lineNum">     315 </span><span class="lineNoCov">          0 : }</span>
<a name="316"><span class="lineNum">     316 </span>            : </a>
<span class="lineNum">     317 </span>            : //_____________________________________________________________________________
<span class="lineNum">     318 </span>            : Float_t AliTRDcluster::GetSumS() const
<span class="lineNum">     319 </span>            : {
<span class="lineNum">     320 </span>            :   //
<span class="lineNum">     321 </span>            :   // Returns the total charge from a not unfolded cluster
<span class="lineNum">     322 </span>            :   //
<span class="lineNum">     323 </span>            : 
<span class="lineNum">     324 </span>            :   Float_t sum = 0.0;
<span class="lineNum">     325 </span><span class="lineNoCov">          0 :   for (Int_t i = 0; i &lt; 7; i++) {</span>
<span class="lineNum">     326 </span><span class="lineNoCov">          0 :     sum += fSignals[i];</span>
<span class="lineNum">     327 </span>            :   }
<span class="lineNum">     328 </span>            : 
<span class="lineNum">     329 </span><span class="lineNoCov">          0 :   return sum;</span>
<span class="lineNum">     330 </span>            : 
<span class="lineNum">     331 </span>            : }
<a name="332"><span class="lineNum">     332 </span>            : </a>
<span class="lineNum">     333 </span>            : //___________________________________________________________________________
<span class="lineNum">     334 </span>            : Double_t AliTRDcluster::GetSX(Int_t tb, Double_t z)
<span class="lineNum">     335 </span>            : {
<span class="lineNum">     336 </span>            :   //
<span class="lineNum">     337 </span>            :   // Returns the error parameterization in the radial direction for TRD clusters as function of 
<span class="lineNum">     338 </span>            :   // the calibrated time bin (tb) and optionally distance to anode wire (z). By default (no z information) 
<span class="lineNum">     339 </span>            :   // the mean value over all cluster to wire distance is chosen.
<span class="lineNum">     340 </span>            :   // 
<span class="lineNum">     341 </span>            :   // There are several contributions which are entering in the definition of the radial errors of the clusters. 
<span class="lineNum">     342 </span>            :   // Although an analytic defition should be possible for the moment this is not yet available but instead a 
<span class="lineNum">     343 </span>            :   // numerical parameterization is provided (see AliTRDclusterResolution::ProcessSigma() for the calibration 
<span class="lineNum">     344 </span>            :   // method). The result is displayed in the figure below as a 2D plot and also as the projection on the drift axis. 
<span class="lineNum">     345 </span>            :   //
<span class="lineNum">     346 </span>            :   //Begin_Html
<span class="lineNum">     347 </span>            :   //&lt;img src=&quot;TRD/clusterXerrorDiff2D.gif&quot;&gt;
<span class="lineNum">     348 </span>            :   //End_Html
<span class="lineNum">     349 </span>            :   //
<span class="lineNum">     350 </span>            :   // Here is a list of uncertainty components:
<span class="lineNum">     351 </span>            :   // - Time Response Function (TRF) - the major contribution. since TRF is also not symmetric (even if tail is 
<span class="lineNum">     352 </span>            :   //   cancelled) it also creates a systematic shift dependent on the charge distribution before and after the cluster.
<span class="lineNum">     353 </span>            :   // - longitudinal diffusion - increase the width of TRF and scales with square root of drift length
<span class="lineNum">     354 </span>            :   // - variation in the drift velocity within the drift cell 
<span class="lineNum">     355 </span>            :   //
<span class="lineNum">     356 </span>            :   // Author
<span class="lineNum">     357 </span>            :   // A.Bercuci &lt;A.Bercuci@gsi.de&gt;
<span class="lineNum">     358 </span>            :   //
<span class="lineNum">     359 </span>            : 
<span class="lineNum">     360 </span><span class="lineCov">      68611 :   if(tb&lt;1 || tb&gt;=24) return 10.; // return huge [10cm]</span>
<span class="lineNum">     361 </span>            :   static const Double_t sx[24][10]={
<span class="lineNum">     362 </span>            :     {0.000e+00, 9.352e-01, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 2.309e+00},
<span class="lineNum">     363 </span>            :     {8.387e-02, 8.718e-02, 8.816e-02, 9.444e-02, 9.993e-02, 1.083e-01, 1.161e-01, 1.280e-01, 1.417e-01, 1.406e-01},
<span class="lineNum">     364 </span>            :     {1.097e-01, 1.105e-01, 1.127e-01, 1.151e-01, 1.186e-01, 1.223e-01, 1.272e-01, 1.323e-01, 1.389e-01, 1.490e-01},
<span class="lineNum">     365 </span>            :     {1.407e-01, 1.404e-01, 1.414e-01, 1.430e-01, 1.429e-01, 1.449e-01, 1.476e-01, 1.494e-01, 1.515e-01, 1.589e-01},
<span class="lineNum">     366 </span>            :     {1.681e-01, 1.679e-01, 1.666e-01, 1.657e-01, 1.656e-01, 1.649e-01, 1.652e-01, 1.662e-01, 1.671e-01, 1.694e-01},
<span class="lineNum">     367 </span>            :     {1.745e-01, 1.737e-01, 1.707e-01, 1.690e-01, 1.643e-01, 1.610e-01, 1.612e-01, 1.628e-01, 1.638e-01, 1.659e-01},
<span class="lineNum">     368 </span>            :     {1.583e-01, 1.558e-01, 1.535e-01, 1.488e-01, 1.445e-01, 1.419e-01, 1.428e-01, 1.451e-01, 1.462e-01, 1.494e-01},
<span class="lineNum">     369 </span>            :     {1.414e-01, 1.391e-01, 1.368e-01, 1.300e-01, 1.256e-01, 1.259e-01, 1.285e-01, 1.326e-01, 1.358e-01, 1.406e-01},
<span class="lineNum">     370 </span>            :     {1.307e-01, 1.289e-01, 1.261e-01, 1.216e-01, 1.193e-01, 1.165e-01, 1.201e-01, 1.241e-01, 1.274e-01, 1.344e-01},
<span class="lineNum">     371 </span>            :     {1.251e-01, 1.227e-01, 1.208e-01, 1.155e-01, 1.110e-01, 1.116e-01, 1.133e-01, 1.187e-01, 1.229e-01, 1.308e-01},
<span class="lineNum">     372 </span>            :     {1.234e-01, 1.209e-01, 1.175e-01, 1.127e-01, 1.094e-01, 1.093e-01, 1.109e-01, 1.155e-01, 1.210e-01, 1.275e-01},
<span class="lineNum">     373 </span>            :     {1.215e-01, 1.187e-01, 1.156e-01, 1.108e-01, 1.070e-01, 1.065e-01, 1.090e-01, 1.134e-01, 1.196e-01, 1.251e-01},
<span class="lineNum">     374 </span>            :     {1.202e-01, 1.180e-01, 1.151e-01, 1.108e-01, 1.070e-01, 1.058e-01, 1.089e-01, 1.127e-01, 1.183e-01, 1.256e-01},
<span class="lineNum">     375 </span>            :     {1.207e-01, 1.176e-01, 1.142e-01, 1.109e-01, 1.072e-01, 1.069e-01, 1.088e-01, 1.122e-01, 1.182e-01, 1.252e-01},
<span class="lineNum">     376 </span>            :     {1.213e-01, 1.182e-01, 1.156e-01, 1.102e-01, 1.076e-01, 1.063e-01, 1.091e-01, 1.132e-01, 1.181e-01, 1.243e-01},
<span class="lineNum">     377 </span>            :     {1.205e-01, 1.180e-01, 1.150e-01, 1.104e-01, 1.072e-01, 1.063e-01, 1.083e-01, 1.132e-01, 1.183e-01, 1.243e-01},
<span class="lineNum">     378 </span>            :     {1.212e-01, 1.195e-01, 1.135e-01, 1.107e-01, 1.070e-01, 1.065e-01, 1.097e-01, 1.126e-01, 1.185e-01, 1.238e-01},
<span class="lineNum">     379 </span>            :     {1.201e-01, 1.184e-01, 1.155e-01, 1.111e-01, 1.088e-01, 1.075e-01, 1.089e-01, 1.131e-01, 1.189e-01, 1.237e-01},
<span class="lineNum">     380 </span>            :     {1.197e-01, 1.186e-01, 1.147e-01, 1.113e-01, 1.085e-01, 1.077e-01, 1.105e-01, 1.137e-01, 1.188e-01, 1.245e-01},
<span class="lineNum">     381 </span>            :     {1.213e-01, 1.194e-01, 1.154e-01, 1.114e-01, 1.091e-01, 1.082e-01, 1.098e-01, 1.140e-01, 1.194e-01, 1.247e-01},
<span class="lineNum">     382 </span>            :     {1.210e-01, 1.189e-01, 1.155e-01, 1.119e-01, 1.088e-01, 1.080e-01, 1.105e-01, 1.141e-01, 1.195e-01, 1.244e-01},
<span class="lineNum">     383 </span>            :     {1.196e-01, 1.189e-01, 1.145e-01, 1.105e-01, 1.095e-01, 1.083e-01, 1.087e-01, 1.121e-01, 1.173e-01, 1.208e-01},
<span class="lineNum">     384 </span>            :     {1.123e-01, 1.129e-01, 1.108e-01, 1.110e-01, 1.080e-01, 1.065e-01, 1.056e-01, 1.066e-01, 1.071e-01, 1.095e-01},
<span class="lineNum">     385 </span>            :     {1.136e-01, 1.135e-01, 1.130e-01, 1.122e-01, 1.113e-01, 1.071e-01, 1.041e-01, 1.025e-01, 1.014e-01, 9.973e-02}
<span class="lineNum">     386 </span>            :   };
<span class="lineNum">     387 </span><span class="lineCov">      32926 :   if(z&gt;=0. &amp;&amp; z&lt;.25) return sx[tb][Int_t(z/.025)];</span>
<span class="lineNum">     388 </span>            :   
<span class="lineNum">     389 </span><span class="lineCov">     696036 :   Double_t m = 0.; for(Int_t id=10; id--;) m+=sx[tb][id];</span>
<span class="lineNum">     390 </span><span class="lineCov">      31638 :   return m*.1;</span>
<span class="lineNum">     391 </span>            : 
<span class="lineNum">     392 </span><span class="lineCov">      33631 : }</span>
<a name="393"><span class="lineNum">     393 </span>            : </a>
<span class="lineNum">     394 </span>            : //___________________________________________________________________________
<span class="lineNum">     395 </span>            : Double_t AliTRDcluster::GetSYdrift(Int_t tb, Int_t ly, Double_t/* z*/)
<span class="lineNum">     396 </span>            : {
<span class="lineNum">     397 </span>            :   //
<span class="lineNum">     398 </span>            :   // Returns the error parameterization for TRD clusters as function of the drift length (here calibrated time bin tb)
<span class="lineNum">     399 </span>            :   // and optionally distance to anode wire (z) for the LUT r-phi cluster shape. By default (no z information) the largest 
<span class="lineNum">     400 </span>            :   // value over all cluster to wire values is chosen.
<span class="lineNum">     401 </span>            :   // 
<span class="lineNum">     402 </span>            :   // For the LUT method the dependence of s_y with x and d is obtained via a fit to the cluster to MC 
<span class="lineNum">     403 </span>            :   // resolution. (see class AliTRDclusterResolution for more details). A normalization to the reference radial position
<span class="lineNum">     404 </span>            :   // x0 = 0.675 (tb=5 for ideal vd) is also applied (see GetSYprf()). The function is *NOT* calibration aware ! 
<span class="lineNum">     405 </span>            :   // The result is displayed in the figure below as a 2D plot and also as the projection on the drift axis. A comparison 
<span class="lineNum">     406 </span>            :   // with the GAUS parameterization is also given
<span class="lineNum">     407 </span>            :   //
<span class="lineNum">     408 </span>            :   // For the GAUS method the dependence of s_y with x is *analytic* and it is expressed by the relation.
<span class="lineNum">     409 </span>            :   // BEGIN_LATEX
<span class="lineNum">     410 </span>            :   // #sigma^{2}_{y} = #sigma^{2}_{PRF} + #frac{x#delta_{t}^{2}}{(1+tg(#alpha_{L}))^{2}}
<span class="lineNum">     411 </span>            :   // END_LATEX
<span class="lineNum">     412 </span>            :   // The result is displayed in the figure below as function of the drift time and compared with the LUT parameterization.
<span class="lineNum">     413 </span>            :   //Begin_Html
<span class="lineNum">     414 </span>            :   //&lt;img src=&quot;TRD/clusterYerrorDiff2D.gif&quot;&gt;
<span class="lineNum">     415 </span>            :   //&lt;img src=&quot;TRD/clusterYerrorDiff1D.gif&quot;&gt;
<span class="lineNum">     416 </span>            :   //End_Html
<span class="lineNum">     417 </span>            :   //
<span class="lineNum">     418 </span>            :   // Author
<span class="lineNum">     419 </span>            :   // A.Bercuci &lt;A.Bercuci@gsi.de&gt;
<span class="lineNum">     420 </span>            :   //
<span class="lineNum">     421 </span>            : 
<span class="lineNum">     422 </span><span class="lineCov">      59327 :   if(tb&lt;1 || tb&gt;=24) return 10.; // return huge [10cm]</span>
<span class="lineNum">     423 </span>            :   static const Float_t lSy[6][24] = {
<span class="lineNum">     424 </span>            :     {75.7561, 0.0325, 0.0175, 0.0174, 0.0206, 0.0232,
<span class="lineNum">     425 </span>            :      0.0253, 0.0262, 0.0265, 0.0264, 0.0266, 0.0257,
<span class="lineNum">     426 </span>            :      0.0258, 0.0261, 0.0259, 0.0253, 0.0257, 0.0261,
<span class="lineNum">     427 </span>            :      0.0255, 0.0250, 0.0259, 0.0266, 0.0278, 0.0319
<span class="lineNum">     428 </span>            :     },
<span class="lineNum">     429 </span>            :     {49.2252, 0.0371, 0.0204, 0.0189, 0.0230, 0.0261,
<span class="lineNum">     430 </span>            :      0.0281, 0.0290, 0.0292, 0.0286, 0.0277, 0.0279,
<span class="lineNum">     431 </span>            :      0.0285, 0.0281, 0.0291, 0.0281, 0.0281, 0.0282,
<span class="lineNum">     432 </span>            :      0.0272, 0.0282, 0.0282, 0.0284, 0.0310, 0.0334
<span class="lineNum">     433 </span>            :     },
<span class="lineNum">     434 </span>            :     {55.1674, 0.0388, 0.0212, 0.0200, 0.0239, 0.0271,
<span class="lineNum">     435 </span>            :      0.0288, 0.0299, 0.0306, 0.0300, 0.0296, 0.0303,
<span class="lineNum">     436 </span>            :      0.0293, 0.0290, 0.0291, 0.0294, 0.0295, 0.0290,
<span class="lineNum">     437 </span>            :      0.0293, 0.0292, 0.0292, 0.0293, 0.0316, 0.0358
<span class="lineNum">     438 </span>            :     },
<span class="lineNum">     439 </span>            :     {45.1004, 0.0411, 0.0225, 0.0215, 0.0249, 0.0281,
<span class="lineNum">     440 </span>            :      0.0301, 0.0315, 0.0320, 0.0308, 0.0318, 0.0321,
<span class="lineNum">     441 </span>            :      0.0312, 0.0311, 0.0316, 0.0315, 0.0310, 0.0308,
<span class="lineNum">     442 </span>            :      0.0313, 0.0303, 0.0314, 0.0314, 0.0324, 0.0369
<span class="lineNum">     443 </span>            :     },
<span class="lineNum">     444 </span>            :     {43.8614, 0.0420, 0.0239, 0.0224, 0.0268, 0.0296,
<span class="lineNum">     445 </span>            :      0.0322, 0.0336, 0.0333, 0.0326, 0.0321, 0.0325,
<span class="lineNum">     446 </span>            :      0.0329, 0.0326, 0.0323, 0.0322, 0.0326, 0.0320,
<span class="lineNum">     447 </span>            :      0.0329, 0.0319, 0.0314, 0.0329, 0.0341, 0.0373
<span class="lineNum">     448 </span>            :     },
<span class="lineNum">     449 </span>            :     {40.5440, 0.0434, 0.0246, 0.0236, 0.0275, 0.0311,
<span class="lineNum">     450 </span>            :      0.0332, 0.0345, 0.0347, 0.0347, 0.0340, 0.0336,
<span class="lineNum">     451 </span>            :      0.0339, 0.0344, 0.0339, 0.0341, 0.0341, 0.0342,
<span class="lineNum">     452 </span>            :      0.0345, 0.0328, 0.0341, 0.0332, 0.0356, 0.0398
<span class="lineNum">     453 </span>            :     },
<span class="lineNum">     454 </span>            :   };
<span class="lineNum">     455 </span>            :   // adjusted ...
<span class="lineNum">     456 </span><span class="lineCov">      27640 :   return TMath::Max(lSy[ly][tb]-0.0150, 0.0010);</span>
<span class="lineNum">     457 </span>            : 
<span class="lineNum">     458 </span>            : /*  const Double_t sy[24][10]={
<span class="lineNum">     459 </span>            :     {0.000e+00, 2.610e-01, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 4.680e-01},
<span class="lineNum">     460 </span>            :     {3.019e-02, 3.036e-02, 3.131e-02, 3.203e-02, 3.294e-02, 3.407e-02, 3.555e-02, 3.682e-02, 3.766e-02, 3.824e-02},
<span class="lineNum">     461 </span>            :     {1.773e-02, 1.778e-02, 1.772e-02, 1.790e-02, 1.807e-02, 1.833e-02, 1.873e-02, 1.905e-02, 1.958e-02, 2.029e-02},
<span class="lineNum">     462 </span>            :     {1.774e-02, 1.772e-02, 1.746e-02, 1.738e-02, 1.756e-02, 1.756e-02, 1.739e-02, 1.720e-02, 1.743e-02, 1.769e-02},
<span class="lineNum">     463 </span>            :     {2.064e-02, 2.078e-02, 2.069e-02, 2.060e-02, 2.033e-02, 2.024e-02, 2.022e-02, 1.961e-02, 1.922e-02, 1.901e-02},
<span class="lineNum">     464 </span>            :     {2.382e-02, 2.379e-02, 2.371e-02, 2.333e-02, 2.318e-02, 2.285e-02, 2.255e-02, 2.244e-02, 2.174e-02, 2.132e-02},
<span class="lineNum">     465 </span>            :     {2.615e-02, 2.589e-02, 2.539e-02, 2.493e-02, 2.420e-02, 2.396e-02, 2.362e-02, 2.342e-02, 2.321e-02, 2.330e-02},
<span class="lineNum">     466 </span>            :     {2.640e-02, 2.638e-02, 2.577e-02, 2.548e-02, 2.477e-02, 2.436e-02, 2.416e-02, 2.401e-02, 2.399e-02, 2.402e-02},
<span class="lineNum">     467 </span>            :     {2.647e-02, 2.632e-02, 2.587e-02, 2.546e-02, 2.465e-02, 2.447e-02, 2.429e-02, 2.415e-02, 2.429e-02, 2.475e-02},
<span class="lineNum">     468 </span>            :     {2.657e-02, 2.637e-02, 2.580e-02, 2.525e-02, 2.492e-02, 2.441e-02, 2.446e-02, 2.441e-02, 2.478e-02, 2.491e-02},
<span class="lineNum">     469 </span>            :     {2.640e-02, 2.608e-02, 2.583e-02, 2.539e-02, 2.478e-02, 2.440e-02, 2.456e-02, 2.464e-02, 2.486e-02, 2.533e-02},
<span class="lineNum">     470 </span>            :     {2.636e-02, 2.630e-02, 2.584e-02, 2.542e-02, 2.483e-02, 2.451e-02, 2.449e-02, 2.467e-02, 2.496e-02, 2.554e-02},
<span class="lineNum">     471 </span>            :     {2.634e-02, 2.629e-02, 2.583e-02, 2.526e-02, 2.480e-02, 2.460e-02, 2.458e-02, 2.472e-02, 2.518e-02, 2.549e-02},
<span class="lineNum">     472 </span>            :     {2.629e-02, 2.621e-02, 2.581e-02, 2.527e-02, 2.480e-02, 2.458e-02, 2.451e-02, 2.485e-02, 2.516e-02, 2.547e-02},
<span class="lineNum">     473 </span>            :     {2.629e-02, 2.607e-02, 2.573e-02, 2.543e-02, 2.485e-02, 2.464e-02, 2.452e-02, 2.476e-02, 2.505e-02, 2.550e-02},
<span class="lineNum">     474 </span>            :     {2.635e-02, 2.613e-02, 2.578e-02, 2.523e-02, 2.491e-02, 2.465e-02, 2.470e-02, 2.467e-02, 2.515e-02, 2.564e-02},
<span class="lineNum">     475 </span>            :     {2.613e-02, 2.602e-02, 2.587e-02, 2.526e-02, 2.507e-02, 2.482e-02, 2.456e-02, 2.486e-02, 2.509e-02, 2.572e-02},
<span class="lineNum">     476 </span>            :     {2.620e-02, 2.599e-02, 2.563e-02, 2.528e-02, 2.484e-02, 2.462e-02, 2.464e-02, 2.476e-02, 2.513e-02, 2.571e-02},
<span class="lineNum">     477 </span>            :     {2.634e-02, 2.596e-02, 2.565e-02, 2.519e-02, 2.497e-02, 2.457e-02, 2.450e-02, 2.481e-02, 2.511e-02, 2.540e-02},
<span class="lineNum">     478 </span>            :     {2.593e-02, 2.589e-02, 2.563e-02, 2.511e-02, 2.472e-02, 2.453e-02, 2.452e-02, 2.474e-02, 2.501e-02, 2.543e-02},
<span class="lineNum">     479 </span>            :     {2.576e-02, 2.582e-02, 2.526e-02, 2.505e-02, 2.462e-02, 2.446e-02, 2.445e-02, 2.466e-02, 2.486e-02, 2.510e-02},
<span class="lineNum">     480 </span>            :     {2.571e-02, 2.549e-02, 2.533e-02, 2.501e-02, 2.453e-02, 2.443e-02, 2.445e-02, 2.450e-02, 2.448e-02, 2.469e-02},
<span class="lineNum">     481 </span>            :     {2.812e-02, 2.786e-02, 2.776e-02, 2.723e-02, 2.695e-02, 2.650e-02, 2.642e-02, 2.617e-02, 2.612e-02, 2.610e-02},
<span class="lineNum">     482 </span>            :     {3.251e-02, 3.267e-02, 3.223e-02, 3.183e-02, 3.125e-02, 3.106e-02, 3.067e-02, 3.010e-02, 2.936e-02, 2.927e-02}
<span class="lineNum">     483 </span>            :   };
<span class="lineNum">     484 </span>            :   if(z&gt;=0. &amp;&amp; z&lt;.25) return sy[tb][Int_t(z/.025)] -  sy[5][Int_t(z/.025)];
<span class="lineNum">     485 </span>            : 
<span class="lineNum">     486 </span>            :   Double_t m = -1.e8; for(Int_t id=10; id--;) if((sy[tb][id] - sy[5][id])&gt;m) m=sy[tb][id]-sy[5][id];
<span class="lineNum">     487 </span>            : 
<span class="lineNum">     488 </span>            :   return m;*/
<span class="lineNum">     489 </span><span class="lineCov">      28989 : }</span>
<a name="490"><span class="lineNum">     490 </span>            : </a>
<span class="lineNum">     491 </span>            : //___________________________________________________________________________
<span class="lineNum">     492 </span>            : Double_t AliTRDcluster::GetSYcharge(Float_t q)
<span class="lineNum">     493 </span>            : {
<span class="lineNum">     494 </span>            :   //
<span class="lineNum">     495 </span>            :   // Parameterization of the r-phi resolution component due to cluster charge.
<span class="lineNum">     496 </span>            :   // The value is the offset from the nominal cluster resolution defined as the
<span class="lineNum">     497 </span>            :   // cluster resolution at average cluster charge (q0).
<span class="lineNum">     498 </span>            :   // 
<span class="lineNum">     499 </span>            :   // BEGIN_LATEX
<span class="lineNum">     500 </span>            :   // #Delta #sigma_{y}(q) = a*(#frac{1}{q} - #frac{1}{q_{0}})
<span class="lineNum">     501 </span>            :   // q_{0} #approx 50
<span class="lineNum">     502 </span>            :   // END_LATEX
<span class="lineNum">     503 </span>            :   // The definition is *NOT* robust against gain fluctuations and thus two approaches are possible
<span class="lineNum">     504 </span>            :   // when residual miscalibration are available:
<span class="lineNum">     505 </span>            :   //   - determine parameterization with a resolution matching those of the gain
<span class="lineNum">     506 </span>            :   //   - define an analytic model which scales with the gain.
<span class="lineNum">     507 </span>            :   // 
<span class="lineNum">     508 </span>            :   // For more details please see AliTRDclusterResolution::ProcessCharge()
<span class="lineNum">     509 </span>            :   //
<span class="lineNum">     510 </span>            :   //Begin_Html
<span class="lineNum">     511 </span>            :   //&lt;img src=&quot;TRD/clusterQerror.gif&quot;&gt;
<span class="lineNum">     512 </span>            :   //End_Html
<span class="lineNum">     513 </span>            :   //
<span class="lineNum">     514 </span>            :   // Author
<span class="lineNum">     515 </span>            :   // A.Bercuci &lt;A.Bercuci@gsi.de&gt;
<span class="lineNum">     516 </span>            :   //
<span class="lineNum">     517 </span>            : 
<span class="lineNum">     518 </span>            :   const Float_t sq0inv = 0.019962; // [1/q0]
<span class="lineNum">     519 </span>            :   const Float_t sqb    = 0.037328; // [cm]
<span class="lineNum">     520 </span>            : 
<span class="lineNum">     521 </span><span class="lineCov">      57978 :   return sqb*(1./q - sq0inv);</span>
<span class="lineNum">     522 </span>            : }
<a name="523"><span class="lineNum">     523 </span>            : </a>
<span class="lineNum">     524 </span>            : //___________________________________________________________________________
<span class="lineNum">     525 </span>            : Double_t AliTRDcluster::GetSYprf(Int_t ly, Double_t center, Double_t s2)
<span class="lineNum">     526 </span>            : {
<span class="lineNum">     527 </span>            :   //
<span class="lineNum">     528 </span>            :   // Parameterization of the cluster error in the r-phi direction due to charge sharing between 
<span class="lineNum">     529 </span>            :   // adiacent pads. Should be identical to what is provided in the OCDB as PRF [TODO]
<span class="lineNum">     530 </span>            :   //
<span class="lineNum">     531 </span>            :   // The parameterization is obtained from fitting cluster resolution at phi=exb and |x-0.675|&lt;0.225. 
<span class="lineNum">     532 </span>            :   // For more details see AliTRDclusterResolution::ProcessCenter().
<span class="lineNum">     533 </span>            :   //
<span class="lineNum">     534 </span>            :   //Begin_Html
<span class="lineNum">     535 </span>            :   //&lt;img src=&quot;TRD/clusterPRFerror.gif&quot;&gt;
<span class="lineNum">     536 </span>            :   //End_Html
<span class="lineNum">     537 </span>            :   //
<span class="lineNum">     538 </span>            :   // Author
<span class="lineNum">     539 </span>            :   // A.Bercuci &lt;A.Bercuci@gsi.de&gt;
<span class="lineNum">     540 </span>            :   //
<span class="lineNum">     541 </span>            : 
<span class="lineNum">     542 </span>            : /*  const Float_t scy[AliTRDgeometry::kNlayer][4] = {
<span class="lineNum">     543 </span>            :     {2.827e-02, 9.600e-04, 4.296e-01, 2.271e-02},
<span class="lineNum">     544 </span>            :     {2.952e-02,-2.198e-04, 4.146e-01, 2.339e-02},
<span class="lineNum">     545 </span>            :     {3.090e-02, 1.514e-03, 4.020e-01, 2.402e-02},
<span class="lineNum">     546 </span>            :     {3.260e-02,-2.037e-03, 3.946e-01, 2.509e-02},
<span class="lineNum">     547 </span>            :     {3.439e-02,-3.601e-04, 3.883e-01, 2.623e-02},
<span class="lineNum">     548 </span>            :     {3.510e-02, 2.066e-03, 3.651e-01, 2.588e-02},
<span class="lineNum">     549 </span>            :   };*/
<span class="lineNum">     550 </span>            :   const Float_t lPRF[] = {0.438, 0.403, 0.393, 0.382, 0.376, 0.345};
<span class="lineNum">     551 </span>            : 
<span class="lineNum">     552 </span><span class="lineCov">      57978 :   return s2*TMath::Gaus(center, 0., lPRF[ly]);</span>
<span class="lineNum">     553 </span>            : }
<span class="lineNum">     554 </span>            : 
<a name="555"><span class="lineNum">     555 </span>            : </a>
<span class="lineNum">     556 </span>            : //___________________________________________________________________________
<span class="lineNum">     557 </span>            : Double_t AliTRDcluster::GetXcorr(Int_t tb, Double_t z)
<span class="lineNum">     558 </span>            : {
<span class="lineNum">     559 </span>            :   //
<span class="lineNum">     560 </span>            :   // Drift length correction [cm]. Due to variation of mean drift velocity along the drift region
<span class="lineNum">     561 </span>            :   // from nominal vd at xd-&gt;infinity. For drift velocity determination based on tracking information 
<span class="lineNum">     562 </span>            :   // the correction should be negligible.
<span class="lineNum">     563 </span>            :   //Begin_Html
<span class="lineNum">     564 </span>            :   //&lt;img src=&quot;TRD/clusterXcorr.gif&quot;&gt;
<span class="lineNum">     565 </span>            :   //End_Html
<span class="lineNum">     566 </span>            :   // TODO to be parametrized in term of drift velocity at infinite drift length
<span class="lineNum">     567 </span>            :   // A.Bercuci (Mar 28 2009)
<span class="lineNum">     568 </span>            :   //
<span class="lineNum">     569 </span>            : 
<span class="lineNum">     570 </span><span class="lineNoCov">          0 :   if(tb&lt;0 || tb&gt;=24) return 0.;</span>
<span class="lineNum">     571 </span>            :   const Int_t nd = 5;
<span class="lineNum">     572 </span>            :   static const Double_t dx[24][nd]={
<span class="lineNum">     573 </span>            :     {+1.747e-01,+3.195e-01,+1.641e-01,+1.607e-01,+6.002e-01},
<span class="lineNum">     574 </span>            :     {+5.468e-02,+5.760e-02,+6.365e-02,+8.003e-02,+1.067e-01},
<span class="lineNum">     575 </span>            :     {-6.327e-02,-6.339e-02,-6.423e-02,-6.900e-02,-7.949e-02},
<span class="lineNum">     576 </span>            :     {-1.417e-01,-1.424e-01,-1.450e-01,-1.465e-01,-1.514e-01},
<span class="lineNum">     577 </span>            :     {-1.637e-01,-1.619e-01,-1.622e-01,-1.613e-01,-1.648e-01},
<span class="lineNum">     578 </span>            :     {-1.386e-01,-1.334e-01,-1.261e-01,-1.276e-01,-1.314e-01},
<span class="lineNum">     579 </span>            :     {-8.799e-02,-8.299e-02,-7.861e-02,-8.038e-02,-8.436e-02},
<span class="lineNum">     580 </span>            :     {-5.139e-02,-4.849e-02,-4.641e-02,-4.965e-02,-5.286e-02},
<span class="lineNum">     581 </span>            :     {-2.927e-02,-2.773e-02,-2.807e-02,-3.021e-02,-3.378e-02},
<span class="lineNum">     582 </span>            :     {-1.380e-02,-1.229e-02,-1.335e-02,-1.547e-02,-1.984e-02},
<span class="lineNum">     583 </span>            :     {-4.168e-03,-4.601e-03,-5.462e-03,-8.164e-03,-1.035e-02},
<span class="lineNum">     584 </span>            :     {+2.044e-03,+1.889e-03,+9.603e-04,-1.342e-03,-3.736e-03},
<span class="lineNum">     585 </span>            :     {+3.568e-03,+3.581e-03,+2.391e-03,+2.942e-05,-1.585e-03},
<span class="lineNum">     586 </span>            :     {+4.403e-03,+4.571e-03,+3.509e-03,+8.703e-04,-1.425e-03},
<span class="lineNum">     587 </span>            :     {+4.941e-03,+4.808e-03,+3.284e-03,+1.105e-03,-1.208e-03},
<span class="lineNum">     588 </span>            :     {+5.124e-03,+5.022e-03,+4.305e-03,+2.023e-03,-1.145e-03},
<span class="lineNum">     589 </span>            :     {+4.882e-03,+4.008e-03,+3.408e-03,+7.886e-04,-1.356e-03},
<span class="lineNum">     590 </span>            :     {+3.852e-03,+3.539e-03,+2.057e-03,+1.670e-04,-1.993e-03},
<span class="lineNum">     591 </span>            :     {+2.154e-03,+2.111e-03,+5.723e-04,-1.254e-03,-3.256e-03},
<span class="lineNum">     592 </span>            :     {+1.755e-03,+2.101e-03,+9.516e-04,-1.649e-03,-3.394e-03},
<span class="lineNum">     593 </span>            :     {+1.617e-03,+1.662e-03,+4.169e-04,-9.843e-04,-4.309e-03},
<span class="lineNum">     594 </span>            :     {-9.204e-03,-9.069e-03,-1.182e-02,-1.458e-02,-1.880e-02},
<span class="lineNum">     595 </span>            :     {-6.727e-02,-6.820e-02,-6.804e-02,-7.134e-02,-7.615e-02},
<span class="lineNum">     596 </span>            :     {-1.802e-01,-1.733e-01,-1.633e-01,-1.601e-01,-1.632e-01}
<span class="lineNum">     597 </span>            :   };
<span class="lineNum">     598 </span>            : //   const Double_t dx[24][nd]={
<span class="lineNum">     599 </span>            : //     {+0.000e+00,+0.000e+00,+0.000e+00,+0.000e+00,+0.000e+00,+0.000e+00,+0.000e+00,+0.000e+00,+0.000e+00,+0.000e+00},
<span class="lineNum">     600 </span>            : //     {-2.763e-04,-2.380e-04,-6.286e-04,-9.424e-04,+1.046e-03,+1.932e-03,+1.620e-03,+1.951e-03,-1.321e-03,-1.115e-03},
<span class="lineNum">     601 </span>            : //     {-1.825e-03,-9.245e-04,-1.012e-03,-8.215e-04,+2.703e-05,+1.403e-03,+2.340e-03,+2.577e-03,+2.017e-03,+8.006e-04},
<span class="lineNum">     602 </span>            : //     {-3.070e-03,-8.563e-04,-1.257e-03,+8.491e-05,+4.503e-04,-2.467e-05,-1.793e-04,+5.085e-04,+1.321e-03,+4.056e-04},
<span class="lineNum">     603 </span>            : //     {-3.637e-03,-2.857e-03,-3.098e-03,-2.304e-03,-1.467e-03,-1.755e-03,+4.585e-04,+2.757e-03,+3.184e-03,+3.525e-03},
<span class="lineNum">     604 </span>            : //     {-9.884e-03,-7.695e-03,-7.290e-03,-3.990e-03,-9.982e-04,+2.226e-03,+3.375e-03,+6.419e-03,+7.209e-03,+6.891e-03},
<span class="lineNum">     605 </span>            : //     {-6.844e-03,-5.807e-03,-4.012e-03,-1.566e-03,+5.035e-04,+2.024e-03,+3.225e-03,+3.918e-03,+5.942e-03,+6.024e-03},
<span class="lineNum">     606 </span>            : //     {-2.628e-03,-2.201e-03,-4.562e-04,+9.832e-04,+3.411e-03,+2.062e-03,+1.526e-03,+9.350e-04,+8.842e-04,+1.007e-03},
<span class="lineNum">     607 </span>            : //     {+6.603e-04,+1.545e-03,+1.681e-03,+1.918e-03,+2.165e-03,+1.825e-03,+1.691e-03,-1.923e-04,+1.835e-04,-1.284e-03},
<span class="lineNum">     608 </span>            : //     {+1.895e-03,+1.586e-03,+2.000e-03,+3.537e-03,+2.526e-03,+1.316e-03,+8.229e-04,-7.671e-05,-2.175e-03,-3.528e-03},
<span class="lineNum">     609 </span>            : //     {+2.927e-03,+3.369e-03,+3.603e-03,+2.675e-03,+2.737e-03,+1.133e-03,+4.318e-04,-1.215e-03,-2.443e-03,-3.116e-03},
<span class="lineNum">     610 </span>            : //     {+3.072e-03,+3.564e-03,+3.612e-03,+3.149e-03,+2.768e-03,+1.186e-03,+3.083e-04,-1.447e-03,-2.480e-03,-3.263e-03},
<span class="lineNum">     611 </span>            : //     {+2.697e-03,+3.565e-03,+3.759e-03,+2.855e-03,+2.909e-03,+6.564e-04,-5.224e-04,-3.309e-04,-1.636e-03,-3.739e-03},
<span class="lineNum">     612 </span>            : //     {+3.633e-03,+3.232e-03,+3.727e-03,+3.024e-03,+3.365e-03,+1.598e-03,-6.903e-04,-1.039e-03,-3.176e-03,-4.472e-03},
<span class="lineNum">     613 </span>            : //     {+2.999e-03,+3.942e-03,+3.322e-03,+3.162e-03,+1.978e-03,+1.657e-03,-4.760e-04,-8.343e-04,-2.346e-03,-3.281e-03},
<span class="lineNum">     614 </span>            : //     {+3.734e-03,+3.098e-03,+3.435e-03,+2.512e-03,+2.651e-03,+1.745e-03,+9.424e-04,-1.404e-03,-3.177e-03,-4.444e-03},
<span class="lineNum">     615 </span>            : //     {+3.204e-03,+4.003e-03,+3.068e-03,+2.697e-03,+3.187e-03,+3.878e-04,-1.124e-04,-1.855e-03,-2.584e-03,-3.807e-03},
<span class="lineNum">     616 </span>            : //     {+2.653e-03,+3.631e-03,+2.327e-03,+3.460e-03,+1.810e-03,+1.244e-03,-3.651e-04,-2.664e-04,-2.307e-03,-3.642e-03},
<span class="lineNum">     617 </span>            : //     {+2.538e-03,+3.208e-03,+2.390e-03,+3.519e-03,+1.763e-03,+1.330e-04,+1.669e-04,-1.422e-03,-1.685e-03,-3.519e-03},
<span class="lineNum">     618 </span>            : //     {+2.605e-03,+2.465e-03,+2.771e-03,+2.966e-03,+2.361e-03,+6.029e-04,-4.435e-04,-1.876e-03,-1.694e-03,-3.757e-03},
<span class="lineNum">     619 </span>            : //     {+2.866e-03,+3.315e-03,+3.146e-03,+2.117e-03,+1.933e-03,+9.339e-04,+9.556e-04,-1.314e-03,-3.615e-03,-3.558e-03},
<span class="lineNum">     620 </span>            : //     {+4.002e-03,+3.543e-03,+3.631e-03,+4.127e-03,+1.919e-03,-2.852e-04,-9.484e-04,-2.060e-03,-4.477e-03,-5.491e-03},
<span class="lineNum">     621 </span>            : //     {+6.029e-03,+5.147e-03,+4.286e-03,+2.215e-03,+9.240e-04,-1.554e-03,-2.366e-03,-3.635e-03,-5.372e-03,-6.467e-03},
<span class="lineNum">     622 </span>            : //     {+3.941e-03,+3.995e-03,+5.638e-04,-3.332e-04,-2.539e-03,-3.764e-03,-3.647e-03,-4.900e-03,-5.414e-03,-5.202e-03}
<span class="lineNum">     623 </span>            : //   };
<span class="lineNum">     624 </span><span class="lineNoCov">          0 :   if(z&gt;=0. &amp;&amp; z&lt;.25) return dx[tb][Int_t(z/.025)];</span>
<span class="lineNum">     625 </span>            : 
<span class="lineNum">     626 </span><span class="lineNoCov">          0 :   Double_t m = 0.; for(Int_t id=nd; id--;) m+=dx[tb][id];</span>
<span class="lineNum">     627 </span><span class="lineNoCov">          0 :   return m/nd;</span>
<span class="lineNum">     628 </span><span class="lineNoCov">          0 : }</span>
<a name="629"><span class="lineNum">     629 </span>            : </a>
<span class="lineNum">     630 </span>            : //___________________________________________________________________________
<span class="lineNum">     631 </span>            : Double_t AliTRDcluster::GetYcorr(Int_t ly, Float_t y)
<span class="lineNum">     632 </span>            : {
<span class="lineNum">     633 </span>            :   //
<span class="lineNum">     634 </span>            :   // PRF correction for the LUT r-phi cluster shape.
<span class="lineNum">     635 </span>            :   //Begin_Html
<span class="lineNum">     636 </span>            :   //&lt;img src=&quot;TRD/clusterYcorr.gif&quot;&gt;
<span class="lineNum">     637 </span>            :   //End_Html
<span class="lineNum">     638 </span>            :   //
<span class="lineNum">     639 </span>            : 
<span class="lineNum">     640 </span>            :   static const Float_t cy[AliTRDgeometry::kNlayer][3] = {
<span class="lineNum">     641 </span>            :     { 4.014e-04, 8.605e-03, -6.880e+00},
<span class="lineNum">     642 </span>            :     {-3.061e-04, 9.663e-03, -6.789e+00},
<span class="lineNum">     643 </span>            :     { 1.124e-03, 1.105e-02, -6.825e+00},
<span class="lineNum">     644 </span>            :     {-1.527e-03, 1.231e-02, -6.777e+00},
<span class="lineNum">     645 </span>            :     { 2.150e-03, 1.387e-02, -6.783e+00},
<span class="lineNum">     646 </span>            :     {-1.296e-03, 1.486e-02, -6.825e+00}
<span class="lineNum">     647 </span>            :   }; 
<span class="lineNum">     648 </span>            : 
<span class="lineNum">     649 </span><span class="lineCov">      36904 :   return cy[ly][0] + cy[ly][1] * TMath::Sin(cy[ly][2] * y);</span>
<span class="lineNum">     650 </span>            : }
<a name="651"><span class="lineNum">     651 </span>            : </a>
<span class="lineNum">     652 </span>            : //_____________________________________________________________________________
<span class="lineNum">     653 </span>            : Float_t AliTRDcluster::GetXloc(Double_t t0, Double_t vd
<span class="lineNum">     654 </span>            :                              , const Double_t *const /*q*/
<span class="lineNum">     655 </span>            :                              , const Double_t *const /*xq*/
<span class="lineNum">     656 </span>            :                              , Double_t /*z*/)
<span class="lineNum">     657 </span>            : {
<span class="lineNum">     658 </span>            :   //
<span class="lineNum">     659 </span>            :   // (Re)Calculate cluster position in the x direction in local chamber coordinates (with respect to the anode wire 
<span class="lineNum">     660 </span>            :   // position) using all available information from tracking.
<span class="lineNum">     661 </span>            :   // Input parameters:
<span class="lineNum">     662 </span>            :   //   t0 - calibration aware trigger delay [us]
<span class="lineNum">     663 </span>            :   //   vd - drift velocity in the region of the cluster [cm/us]
<span class="lineNum">     664 </span>            :   //   z  - distance to the anode wire [cm]. By default average over the drift cell width.
<span class="lineNum">     665 </span>            :   //   q &amp; xq - array of charges and cluster positions from previous clusters in the tracklet [a.u.]
<span class="lineNum">     666 </span>            :   // Output values :
<span class="lineNum">     667 </span>            :   //   return x position of the cluster with respect to the 
<span class="lineNum">     668 </span>            :   //   anode wire using all tracking information
<span class="lineNum">     669 </span>            :   //
<span class="lineNum">     670 </span>            :   // The estimation of the radial position is based on calculating the drift time and the drift velocity at the point of 
<span class="lineNum">     671 </span>            :   // estimation. The drift time can be estimated according to the expression:
<span class="lineNum">     672 </span>            :   // BEGIN_LATEX
<span class="lineNum">     673 </span>            :   // t_{drift} = t_{bin} - t_{0} - t_{cause}(x) - t_{TC}(q_{i-1}, q_{i-2}, ...)
<span class="lineNum">     674 </span>            :   // END_LATEX
<span class="lineNum">     675 </span>            :   // where t_0 is the delay of the trigger signal. t_cause is the causality delay between ionisation electrons hitting 
<span class="lineNum">     676 </span>            :   // the anode and the registration of maximum signal by the electronics - it is due to the rising time of the TRF 
<span class="lineNum">     677 </span>            :   // A second order correction here comes from the fact that the time spreading of charge at anode is the convolution of
<span class="lineNum">     678 </span>            :   // TRF with the diffusion and thus cross-talk between clusters before and after local clusters changes with drift length. 
<span class="lineNum">     679 </span>            :   // t_TC is the residual charge from previous (in time) clusters due to residual tails after tail cancellation. 
<span class="lineNum">     680 </span>            :   // This tends to push cluster forward and depends on the magnitude of their charge.
<span class="lineNum">     681 </span>            :   //
<span class="lineNum">     682 </span>            :   // The drift velocity varies with the drift length (and distance to anode wire) as described by cell structure simulation. 
<span class="lineNum">     683 </span>            :   // Thus one, in principle, can calculate iteratively the drift length from the expression:
<span class="lineNum">     684 </span>            :   // BEGIN_LATEX
<span class="lineNum">     685 </span>            :   // x = t_{drift}(x)*v_{drift}(x)
<span class="lineNum">     686 </span>            :   // END_LATEX
<span class="lineNum">     687 </span>            :   // In practice we use a numerical approach (AliTRDcluster::GetXcorr()) to correct for anisochronity obtained from MC 
<span class="lineNum">     688 </span>            :   // comparison (see AliTRDclusterResolution::ProcessSigma()). Also the calibration of 0 approximation (no x dependence)
<span class="lineNum">     689 </span>            :   // for t_cause is obtained from MC comparisons and impossible to disentangle in real life from trigger delay.
<span class="lineNum">     690 </span>            :   //
<span class="lineNum">     691 </span>            :   // Author
<span class="lineNum">     692 </span>            :   // Alex Bercuci &lt;A.Bercuci@gsi.de&gt;
<span class="lineNum">     693 </span>            :   //
<span class="lineNum">     694 </span>            : 
<span class="lineNum">     695 </span><span class="lineCov">      36904 :   AliTRDCommonParam *cp = AliTRDCommonParam::Instance(); </span>
<span class="lineNum">     696 </span><span class="lineCov">      18452 :   Double_t fFreq = cp-&gt;GetSamplingFrequency();</span>
<span class="lineNum">     697 </span>            : 
<span class="lineNum">     698 </span>            :   //drift time corresponding to the center of the time bin
<span class="lineNum">     699 </span><span class="lineCov">      18452 :   Double_t td = (fPadTime + .5)/fFreq; // [us] </span>
<span class="lineNum">     700 </span>            :   // correction for t0
<span class="lineNum">     701 </span><span class="lineCov">      18452 :   td -= t0;</span>
<span class="lineNum">     702 </span>            :   // time bin corrected for t0
<span class="lineNum">     703 </span>            :   // Bug in TMath::Nint().root-5.23.02
<span class="lineNum">     704 </span>            :   // TMath::Nint(3.5) = 4 and TMath::Nint(4.5) = 4
<span class="lineNum">     705 </span><span class="lineCov">      18452 :   Double_t tmp = td*fFreq;</span>
<span class="lineNum">     706 </span><span class="lineCov">      18452 :   fLocalTimeBin = Char_t(TMath::Floor(tmp));</span>
<span class="lineNum">     707 </span><span class="lineCov">      18452 :   if(tmp-fLocalTimeBin &gt; .5) fLocalTimeBin++;</span>
<span class="lineNum">     708 </span><span class="lineCov">      18978 :   if(td &lt; .2) return 0.;</span>
<span class="lineNum">     709 </span>            :   // TRF rising time (fitted)
<span class="lineNum">     710 </span>            :   // It should be absorbed by the t0. For the moment t0 is 0 for simulations.
<span class="lineNum">     711 </span>            :   // A.Bercuci (Mar 26 2009)
<span class="lineNum">     712 </span><span class="lineCov">      17926 :   td -= 0.189;</span>
<span class="lineNum">     713 </span>            : 
<span class="lineNum">     714 </span>            :   // apply fitted correction 
<span class="lineNum">     715 </span><span class="lineCov">      35852 :   Float_t x = td*vd + (HasXcorr() ? GetXcorr(fLocalTimeBin) : 0.);</span>
<span class="lineNum">     716 </span><span class="lineCov">      52743 :   if(x&gt;0.&amp;&amp;x&lt;.5*AliTRDgeometry::CamHght()+AliTRDgeometry::CdrHght()) SetInChamber();</span>
<span class="lineNum">     717 </span>            : 
<span class="lineNum">     718 </span>            :   return x;
<span class="lineNum">     719 </span><span class="lineCov">      18452 : }</span>
<a name="720"><span class="lineNum">     720 </span>            : </a>
<span class="lineNum">     721 </span>            : //_____________________________________________________________________________
<span class="lineNum">     722 </span>            : Float_t AliTRDcluster::GetYloc(Double_t y0, Double_t s2, Double_t W
<span class="lineNum">     723 </span>            :                              , Double_t *const y1, Double_t *const y2)
<span class="lineNum">     724 </span>            : {
<span class="lineNum">     725 </span>            :   //
<span class="lineNum">     726 </span>            :   // Calculate, in tracking cooordinate system, the r-phi offset the cluster
<span class="lineNum">     727 </span>            :   // from the middle of the center pad. Three possible methods are implemented:
<span class="lineNum">     728 </span>            :   //   - Center of Gravity (COG) see AliTRDcluster::GetDYcog()
<span class="lineNum">     729 </span>            :   //   - Look-up Table (LUT) see AliTRDcluster::GetDYlut()
<span class="lineNum">     730 </span>            :   //   - Gauss shape (GAUS) see AliTRDcluster::GetDYgauss()
<span class="lineNum">     731 </span>            :   // In addition for the case of LUT method position corrections are also
<span class="lineNum">     732 </span>            :   // applied (see AliTRDcluster::GetYcorr())
<span class="lineNum">     733 </span>            :   //
<span class="lineNum">     734 </span>            : 
<span class="lineNum">     735 </span><span class="lineCov">      36904 :   if(IsRPhiMethod(kCOG)) GetDYcog();</span>
<span class="lineNum">     736 </span><span class="lineCov">      36904 :   else if(IsRPhiMethod(kLUT)) GetDYlut();</span>
<span class="lineNum">     737 </span><span class="lineNoCov">          0 :   else if(IsRPhiMethod(kGAUS)) GetDYgauss(s2/W/W, y1, y2);</span>
<span class="lineNum">     738 </span><span class="lineNoCov">          0 :   else return 0.;</span>
<span class="lineNum">     739 </span>            : 
<span class="lineNum">     740 </span><span class="lineCov">      18452 :   if(y1) (*y1)*=W;</span>
<span class="lineNum">     741 </span><span class="lineCov">      18452 :   if(y2) (*y2)*=W;</span>
<span class="lineNum">     742 </span>            : 
<span class="lineNum">     743 </span><span class="lineCov">      55356 :   return y0+fCenter*W+(IsRPhiMethod(kLUT)?GetYcorr(AliTRDgeometry::GetLayer(fDetector), fCenter):0.);</span>
<span class="lineNum">     744 </span><span class="lineCov">      18452 : }</span>
<a name="745"><span class="lineNum">     745 </span>            : </a>
<span class="lineNum">     746 </span>            : //___________________________________________________________________________
<span class="lineNum">     747 </span>            : void AliTRDcluster::SetSigmaY2(Float_t s2, Float_t dt, Float_t exb, Float_t x, Float_t z, Float_t tgp)
<span class="lineNum">     748 </span>            : {
<span class="lineNum">     749 </span>            :   //
<span class="lineNum">     750 </span>            :   // Set variance of TRD cluster in the r-phi direction for each method.
<span class="lineNum">     751 </span>            :   // Parameters :
<span class="lineNum">     752 </span>            :   //   - s2  - variance due to PRF width for the case of Gauss model. Replaced by parameterization in case of LUT.
<span class="lineNum">     753 </span>            :   //   - dt  - transversal diffusion coeficient 
<span class="lineNum">     754 </span>            :   //   - exb - tg of lorentz angle
<span class="lineNum">     755 </span>            :   //   - x   - drift length - with respect to the anode wire
<span class="lineNum">     756 </span>            :   //   - z   - offset from the anode wire
<span class="lineNum">     757 </span>            :   //   - tgp - local tangent of the track momentum azimuthal angle
<span class="lineNum">     758 </span>            :   //
<span class="lineNum">     759 </span>            :   // The ingredients from which the error is computed are:
<span class="lineNum">     760 </span>            :   //   - PRF (charge sharing on adjacent pads)  - see AliTRDcluster::GetSYprf()
<span class="lineNum">     761 </span>            :   //   - diffusion (dependence with drift length and [2nd order] distance to anode wire) - see AliTRDcluster::GetSYdrift()
<span class="lineNum">     762 </span>            :   //   - charge of the cluster (complex dependence on gain and tail cancellation) - see AliTRDcluster::GetSYcharge()
<span class="lineNum">     763 </span>            :   //   - lorentz angle (dependence on the drift length and [2nd order] distance to anode wire) - see AliTRDcluster::GetSX()
<span class="lineNum">     764 </span>            :   //   - track angle (superposition of charges on the anode wire) - see AliTRDseedV1::Fit()
<span class="lineNum">     765 </span>            :   //   - projection of radial(x) error on r-phi due to fixed value assumed in tracking for x - see AliTRDseedV1::Fit()
<span class="lineNum">     766 </span>            :   //
<span class="lineNum">     767 </span>            :   // The last 2 contributions to cluster error can be estimated only during tracking when the track angle 
<span class="lineNum">     768 </span>            :   // is known (tgp). For this reason the errors (and optional position) of TRD clusters are recalculated during 
<span class="lineNum">     769 </span>            :   // tracking and thus clusters attached to tracks might differ from bare clusters.
<span class="lineNum">     770 </span>            :   // 
<span class="lineNum">     771 </span>            :   // Taking into account all contributions one can write the the TRD cluster error parameterization as:
<span class="lineNum">     772 </span>            :   // BEGIN_LATEX
<span class="lineNum">     773 </span>            :   // #sigma_{y}^{2} = (#sigma_{diff}*Gauss(0, s_{ly}) + #delta_{#sigma}(q))^{2} + tg^{2}(#alpha_{L})*#sigma_{x}^{2} + tg^{2}(#phi-#alpha_{L})*#sigma_{x}^{2}+[tg(#phi-#alpha_{L})*tg(#alpha_{L})*x]^{2}/12
<span class="lineNum">     774 </span>            :   // END_LATEX
<span class="lineNum">     775 </span>            :   // From this formula one can deduce a that the simplest calibration method for PRF and diffusion contributions is 
<span class="lineNum">     776 </span>            :   // by measuring resolution at B=0T and phi=0. To disentangle further the two remaining contributions one has 
<span class="lineNum">     777 </span>            :   // to represent s2 as a function of drift length. 
<span class="lineNum">     778 </span>            :   // 
<span class="lineNum">     779 </span>            :   // In the gaussian model the diffusion contribution can be expressed as:
<span class="lineNum">     780 </span>            :   // BEGIN_LATEX
<span class="lineNum">     781 </span>            :   // #sigma^{2}_{y} = #sigma^{2}_{PRF} + #frac{x#delta_{t}^{2}}{(1+tg(#alpha_{L}))^{2}}
<span class="lineNum">     782 </span>            :   // END_LATEX
<span class="lineNum">     783 </span>            :   // thus resulting the PRF contribution. For the case of the LUT model both contributions have to be determined from 
<span class="lineNum">     784 </span>            :   // the fit (see AliTRDclusterResolution::ProcessCenter() for details).
<span class="lineNum">     785 </span>            :   // 
<span class="lineNum">     786 </span>            :   // Author:
<span class="lineNum">     787 </span>            :   // A.Bercuci &lt;A.Bercuci@gsi.de&gt;
<span class="lineNum">     788 </span>            :   //
<span class="lineNum">     789 </span>            : 
<span class="lineNum">     790 </span>            :   Float_t sigmaY2 = 0.;
<span class="lineNum">     791 </span><span class="lineCov">      57978 :   Int_t ly = AliTRDgeometry::GetLayer(fDetector);</span>
<span class="lineNum">     792 </span><span class="lineCov">      28989 :   if(IsRPhiMethod(kCOG)) sigmaY2 = 4.e-4;</span>
<span class="lineNum">     793 </span><span class="lineCov">      28989 :   else if(IsRPhiMethod(kLUT)){ </span>
<span class="lineNum">     794 </span><span class="lineCov">      28989 :     Float_t sd = GetSYdrift(fLocalTimeBin, ly, z); //printf(&quot;drift[%6.2f] &quot;, 1.e4*sd);</span>
<span class="lineNum">     795 </span><span class="lineCov">      28989 :     sigmaY2 = GetSYprf(ly, fCenter, sd); //printf(&quot;PRF[%6.2f] &quot;, 1.e4*sigmaY2);</span>
<span class="lineNum">     796 </span>            :     // add charge contribution TODO scale with respect to s2
<span class="lineNum">     797 </span><span class="lineCov">      28989 :     sigmaY2+= GetSYcharge(TMath::Abs(fQ)); //printf(&quot;Q[%6.2f] &quot;, 1.e4*sigmaY2);</span>
<span class="lineNum">     798 </span><span class="lineCov">      28989 :     sigmaY2 = TMath::Max(sigmaY2, Float_t(0.0010)); //!! protection </span>
<span class="lineNum">     799 </span><span class="lineCov">      28989 :     sigmaY2*= sigmaY2;</span>
<span class="lineNum">     800 </span><span class="lineCov">      28989 :   } else if(IsRPhiMethod(kGAUS)){</span>
<span class="lineNum">     801 </span>            :     // PRF contribution
<span class="lineNum">     802 </span>            :     sigmaY2 = s2;
<span class="lineNum">     803 </span>            :     // Diffusion contribution
<span class="lineNum">     804 </span><span class="lineNoCov">          0 :     Double_t sD2 = dt/(1.+exb); sD2 *= sD2; sD2 *= x;</span>
<span class="lineNum">     805 </span><span class="lineNoCov">          0 :     sigmaY2+= sD2; </span>
<span class="lineNum">     806 </span>            :     // add charge contribution TODO scale with respect to s2
<span class="lineNum">     807 </span>            :     //sigmaY2+= GetSYcharge(TMath::Abs(fQ));
<span class="lineNum">     808 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">     809 </span>            : 
<span class="lineNum">     810 </span>            :   // store tg^2(phi-a_L) and tg^2(a_L)
<span class="lineNum">     811 </span>            :   // limit parametrization to a maximum angle of 25 deg
<span class="lineNum">     812 </span><span class="lineCov">      29855 :   if(TMath::Abs(tgp)&gt;0.466) tgp = (tgp&gt;0.)?0.466:-0.466;</span>
<span class="lineNum">     813 </span><span class="lineCov">      28989 :   Double_t tgg = (tgp-exb)/(1.+tgp*exb); tgg *= tgg;</span>
<span class="lineNum">     814 </span><span class="lineCov">      28989 :   Double_t exb2= exb*exb;</span>
<span class="lineNum">     815 </span>            : 
<span class="lineNum">     816 </span>            :   // Lorentz angle shift contribution 
<span class="lineNum">     817 </span><span class="lineCov">      28989 :   Float_t sx = GetSX(fLocalTimeBin, z); sx*=sx;</span>
<span class="lineNum">     818 </span><span class="lineCov">      28989 :   sigmaY2+= exb2*sx; //printf(&quot;Al[%6.2f] &quot;, 1.e4*TMath::Sqrt(sigmaY2));</span>
<span class="lineNum">     819 </span>            : 
<span class="lineNum">     820 </span>            :   // Radial contribution due to not measuring x in Kalman model 
<span class="lineNum">     821 </span><span class="lineCov">      28989 :   sigmaY2+= tgg*sx; //printf(&quot;x[%6.2f] &quot;, 1.e4*TMath::Sqrt(sigmaY2));</span>
<span class="lineNum">     822 </span>            : 
<span class="lineNum">     823 </span>            :   // Track angle contribution
<span class="lineNum">     824 </span><span class="lineCov">      28989 :   sigmaY2+= tgg*x*x*exb2/12.; //printf(&quot;angle[%6.2f]\n&quot;, 1.e4*TMath::Sqrt(sigmaY2));</span>
<span class="lineNum">     825 </span>            : 
<span class="lineNum">     826 </span><span class="lineCov">      28989 :   AliCluster::SetSigmaY2(sigmaY2);</span>
<span class="lineNum">     827 </span>            : 
<span class="lineNum">     828 </span><span class="lineCov">      28989 : }</span>
<a name="829"><span class="lineNum">     829 </span>            : </a>
<span class="lineNum">     830 </span>            : //_____________________________________________________________________________
<span class="lineNum">     831 </span>            : Bool_t AliTRDcluster::IsEqual(const TObject *o) const
<span class="lineNum">     832 </span>            : {
<span class="lineNum">     833 </span>            :   //
<span class="lineNum">     834 </span>            :   // Compare relevant information of this cluster with another one
<span class="lineNum">     835 </span>            :   //
<span class="lineNum">     836 </span>            :   
<span class="lineNum">     837 </span><span class="lineNoCov">          0 :   const AliTRDcluster *inCluster = dynamic_cast&lt;const AliTRDcluster*&gt;(o);</span>
<span class="lineNum">     838 </span><span class="lineNoCov">          0 :   if (!o || !inCluster) return kFALSE;</span>
<span class="lineNum">     839 </span>            : 
<span class="lineNum">     840 </span><span class="lineNoCov">          0 :   if ( AliCluster::GetX() != inCluster-&gt;GetX() ) return kFALSE;</span>
<span class="lineNum">     841 </span><span class="lineNoCov">          0 :   if ( AliCluster::GetY() != inCluster-&gt;GetY() ) return kFALSE;</span>
<span class="lineNum">     842 </span><span class="lineNoCov">          0 :   if ( AliCluster::GetZ() != inCluster-&gt;GetZ() ) return kFALSE;</span>
<span class="lineNum">     843 </span><span class="lineNoCov">          0 :   if ( fQ != inCluster-&gt;fQ ) return kFALSE;</span>
<span class="lineNum">     844 </span><span class="lineNoCov">          0 :   if ( fDetector != inCluster-&gt;fDetector ) return kFALSE;</span>
<span class="lineNum">     845 </span><span class="lineNoCov">          0 :   if ( fPadCol != inCluster-&gt;fPadCol ) return kFALSE;</span>
<span class="lineNum">     846 </span><span class="lineNoCov">          0 :   if ( fPadRow != inCluster-&gt;fPadRow ) return kFALSE;</span>
<span class="lineNum">     847 </span><span class="lineNoCov">          0 :   if ( fPadTime != inCluster-&gt;fPadTime ) return kFALSE;</span>
<span class="lineNum">     848 </span><span class="lineNoCov">          0 :   if ( fClusterMasking != inCluster-&gt;fClusterMasking ) return kFALSE;</span>
<span class="lineNum">     849 </span><span class="lineNoCov">          0 :   if ( IsInChamber() != inCluster-&gt;IsInChamber() ) return kFALSE;</span>
<span class="lineNum">     850 </span><span class="lineNoCov">          0 :   if ( IsShared() != inCluster-&gt;IsShared() ) return kFALSE;</span>
<span class="lineNum">     851 </span><span class="lineNoCov">          0 :   if ( IsUsed() != inCluster-&gt;IsUsed() ) return kFALSE;</span>
<span class="lineNum">     852 </span>            :   
<span class="lineNum">     853 </span><span class="lineNoCov">          0 :   return kTRUE;</span>
<span class="lineNum">     854 </span>            : 
<span class="lineNum">     855 </span><span class="lineNoCov">          0 : }</span>
<a name="856"><span class="lineNum">     856 </span>            : </a>
<span class="lineNum">     857 </span>            : //_____________________________________________________________________________
<span class="lineNum">     858 </span>            : void AliTRDcluster::Print(Option_t *o) const
<span class="lineNum">     859 </span>            : {
<span class="lineNum">     860 </span>            :   //
<span class="lineNum">     861 </span>            :   // Print cluster information
<span class="lineNum">     862 </span>            :   //
<span class="lineNum">     863 </span>            : 
<span class="lineNum">     864 </span><span class="lineNoCov">          0 :   if(strcmp(o, &quot;a&quot;)==0) {</span>
<span class="lineNum">     865 </span><span class="lineNoCov">          0 :     Char_t mcInfo[100]; if(IsMCcluster()) snprintf(mcInfo, 100, &quot;\n         MC[%5d %5d %5d]&quot;, GetLabel(0), GetLabel(1), GetLabel(2));</span>
<span class="lineNum">     866 </span><span class="lineNoCov">          0 :     AliInfo(Form(</span>
<span class="lineNum">     867 </span>            :     &quot;\nDet[%3d] LTrC[%+6.2f %+6.2f %+6.2f] Q[%6.2f] Qr[%4d] FLAG[in(%c) use(%c) sh(%c)] Y[%s]&quot;
<span class="lineNum">     868 </span>            :     &quot;\n         LChC[c(%3d) r(%2d) t(%2d)] t-t0[%2d] Npad[%d] cen[%5.3f] mask[%d]&quot;
<span class="lineNum">     869 </span>            :     &quot;\n         QS[%s][%3d %3d %3d %3d %3d %3d %3d]&quot;
<span class="lineNum">     870 </span>            :     &quot;\n         S2Y[%e] S2Z[%e]&quot;
<span class="lineNum">     871 </span>            :     &quot;%s&quot;
<span class="lineNum">     872 </span>            :     , fDetector, GetX(), GetY(), GetZ(), fQ, GetRawQ(),  
<span class="lineNum">     873 </span>            :     IsInChamber() ? 'y' : 'n', 
<span class="lineNum">     874 </span>            :     IsUsed() ? 'y' : 'n', 
<span class="lineNum">     875 </span>            :     IsShared() ? 'y' : 'n',
<span class="lineNum">     876 </span>            :     IsRPhiMethod(kGAUS)?&quot;GAUS&quot;:(IsRPhiMethod(kLUT)?&quot;LUT&quot;:&quot;COG&quot;)
<span class="lineNum">     877 </span>            :     , fPadCol, fPadRow, fPadTime, fLocalTimeBin, fNPads, fCenter, fClusterMasking
<span class="lineNum">     878 </span>            :     , TestBit(kRawSignals)?&quot;raw&quot;:&quot;cal&quot;, fSignals[0], fSignals[1], fSignals[2], fSignals[3]
<span class="lineNum">     879 </span>            :     , fSignals[4], fSignals[5], fSignals[6]
<span class="lineNum">     880 </span>            :     , GetSigmaY2(), GetSigmaZ2()
<span class="lineNum">     881 </span>            :     , IsMCcluster()?mcInfo:&quot;&quot;
<span class="lineNum">     882 </span>            :     ));
<span class="lineNum">     883 </span><span class="lineNoCov">          0 :   } else { </span>
<span class="lineNum">     884 </span><span class="lineNoCov">          0 :     AliInfo(Form(&quot;Det[%3d] LTrC[%+6.2f %+6.2f %+6.2f] Q[%6.2f] FLAG[in(%c) use(%c) sh(%c)] Y[%s]&quot;,</span>
<span class="lineNum">     885 </span>            :     fDetector, GetX(), GetY(), GetZ(), fQ, 
<span class="lineNum">     886 </span>            :     IsInChamber() ? 'y' : 'n', 
<span class="lineNum">     887 </span>            :     IsUsed() ? 'y' : 'n', 
<span class="lineNum">     888 </span>            :     IsShared() ? 'y' : 'n',
<span class="lineNum">     889 </span>            :     IsRPhiMethod(kGAUS)?&quot;GAUS&quot;:(IsRPhiMethod(kLUT)?&quot;LUT&quot;:&quot;COG&quot;)
<span class="lineNum">     890 </span>            :     ));
<span class="lineNum">     891 </span>            :   }
<span class="lineNum">     892 </span><span class="lineNoCov">          0 : }</span>
<a name="893"><span class="lineNum">     893 </span>            : </a>
<span class="lineNum">     894 </span>            : //_____________________________________________________________________________
<span class="lineNum">     895 </span>            : void AliTRDcluster::SetPadMaskedPosition(UChar_t position)
<span class="lineNum">     896 </span>            : {
<span class="lineNum">     897 </span>            :   //
<span class="lineNum">     898 </span>            :   // Store the pad corruption position code
<span class="lineNum">     899 </span>            :   // 
<span class="lineNum">     900 </span>            :   // Code: 1 = left cluster
<span class="lineNum">     901 </span>            :   //       2 = middle cluster;
<span class="lineNum">     902 </span>            :   //       4 = right cluster
<span class="lineNum">     903 </span>            :   //
<span class="lineNum">     904 </span>            : 
<span class="lineNum">     905 </span><span class="lineNoCov">          0 :   for (Int_t ipos = 0; ipos &lt; 3; ipos++) {</span>
<span class="lineNum">     906 </span><span class="lineNoCov">          0 :     if (TESTBIT(position, ipos))</span>
<span class="lineNum">     907 </span><span class="lineNoCov">          0 :       SETBIT(fClusterMasking, ipos);</span>
<span class="lineNum">     908 </span>            :   }
<span class="lineNum">     909 </span><span class="lineNoCov">          0 : }</span>
<a name="910"><span class="lineNum">     910 </span>            : </a>
<span class="lineNum">     911 </span>            : //_____________________________________________________________________________
<span class="lineNum">     912 </span>            : void AliTRDcluster::SetPadMaskedStatus(UChar_t status)
<span class="lineNum">     913 </span>            : {
<span class="lineNum">     914 </span>            :   //
<span class="lineNum">     915 </span>            :   // Store the status of the corrupted pad
<span class="lineNum">     916 </span>            :   //
<span class="lineNum">     917 </span>            :   // Code: 2 = noisy
<span class="lineNum">     918 </span>            :   //       4 = Bridged Left
<span class="lineNum">     919 </span>            :   //       8 = Bridged Right
<span class="lineNum">     920 </span>            :   //      32 = Not Connected
<span class="lineNum">     921 </span>            :   //
<span class="lineNum">     922 </span>            : 
<span class="lineNum">     923 </span><span class="lineNoCov">          0 :   for (Int_t ipos = 0; ipos &lt; 5; ipos++) {</span>
<span class="lineNum">     924 </span><span class="lineNoCov">          0 :     if(TESTBIT(status, ipos))</span>
<span class="lineNum">     925 </span><span class="lineNoCov">          0 :       SETBIT(fClusterMasking, ipos + 3);</span>
<span class="lineNum">     926 </span>            :   }
<span class="lineNum">     927 </span>            : 
<span class="lineNum">     928 </span><span class="lineNoCov">          0 : }</span>
<a name="929"><span class="lineNum">     929 </span>            : </a>
<span class="lineNum">     930 </span>            : //___________________________________________________________________________
<span class="lineNum">     931 </span>            : Float_t AliTRDcluster::GetDYcog(const Double_t *const, const Double_t *const)
<span class="lineNum">     932 </span>            : {
<span class="lineNum">     933 </span>            :   //
<span class="lineNum">     934 </span>            :   // Get COG position
<span class="lineNum">     935 </span>            :   // Used for clusters with more than 3 pads - where LUT not applicable
<span class="lineNum">     936 </span>            :   //
<span class="lineNum">     937 </span>            : 
<span class="lineNum">     938 </span><span class="lineNoCov">          0 :   Double_t sum = fSignals[1]</span>
<span class="lineNum">     939 </span><span class="lineNoCov">          0 :                 +fSignals[2]</span>
<span class="lineNum">     940 </span><span class="lineNoCov">          0 :                 +fSignals[3] </span>
<span class="lineNum">     941 </span><span class="lineNoCov">          0 :                 +fSignals[4]</span>
<span class="lineNum">     942 </span><span class="lineNoCov">          0 :                 +fSignals[5];</span>
<span class="lineNum">     943 </span>            : 
<span class="lineNum">     944 </span>            :   // ???????????? CBL
<span class="lineNum">     945 </span>            :   // Go to 3 pad COG ????
<span class="lineNum">     946 </span>            :   // ???????????? CBL
<span class="lineNum">     947 </span><span class="lineNoCov">          0 :   fCenter = (0.0 * (-fSignals[1] + fSignals[5])</span>
<span class="lineNum">     948 </span><span class="lineNoCov">          0 :                     + (-fSignals[2] + fSignals[4])) / sum;</span>
<span class="lineNum">     949 </span>            : 
<span class="lineNum">     950 </span><span class="lineNoCov">          0 :   return fCenter;</span>
<span class="lineNum">     951 </span>            : }
<a name="952"><span class="lineNum">     952 </span>            : </a>
<span class="lineNum">     953 </span>            : //___________________________________________________________________________
<span class="lineNum">     954 </span>            : Float_t AliTRDcluster::GetDYlut(const Double_t *const, const Double_t *const)
<span class="lineNum">     955 </span>            : {
<span class="lineNum">     956 </span>            :   //
<span class="lineNum">     957 </span>            :   // Calculates the cluster position using the lookup table.
<span class="lineNum">     958 </span>            :   // Method provided by Bogdan Vulpescu.
<span class="lineNum">     959 </span>            :   //
<span class="lineNum">     960 </span>            : 
<span class="lineNum">     961 </span><span class="lineCov">      36906 :   if(!fgLUT) FillLUT();</span>
<span class="lineNum">     962 </span>            : 
<span class="lineNum">     963 </span><span class="lineCov">      18452 :   Double_t ampL = fSignals[2],</span>
<span class="lineNum">     964 </span><span class="lineCov">      18452 :            ampC = fSignals[3],</span>
<span class="lineNum">     965 </span><span class="lineCov">      18452 :            ampR = fSignals[4];</span>
<span class="lineNum">     966 </span><span class="lineCov">      18452 :   Int_t ilayer = AliTRDgeometry::GetLayer(fDetector);</span>
<span class="lineNum">     967 </span>            : 
<span class="lineNum">     968 </span>            :   Double_t x    = 0.0;
<span class="lineNum">     969 </span>            :   Double_t xmin, xmax, xwid;
<span class="lineNum">     970 </span>            : 
<span class="lineNum">     971 </span>            :   Int_t    side = 0;
<span class="lineNum">     972 </span>            :   Int_t    ix;
<span class="lineNum">     973 </span>            : 
<span class="lineNum">     974 </span><span class="lineCov">      18452 :   Double_t xMin[AliTRDgeometry::kNlayer] = { </span>
<span class="lineNum">     975 </span>            :     0.006492, 0.006377, 0.006258, 0.006144, 0.006030, 0.005980 
<span class="lineNum">     976 </span>            :   };
<span class="lineNum">     977 </span><span class="lineCov">      18452 :   Double_t xMax[AliTRDgeometry::kNlayer] = { </span>
<span class="lineNum">     978 </span>            :     0.960351, 0.965870, 0.970445, 0.974352, 0.977667, 0.996101 
<span class="lineNum">     979 </span>            :   };
<span class="lineNum">     980 </span>            : 
<span class="lineNum">     981 </span><span class="lineCov">      18452 :   if      (ampL &gt; ampR) {</span>
<span class="lineNum">     982 </span><span class="lineCov">       9143 :     x    = (ampL - ampR) / ampC;</span>
<span class="lineNum">     983 </span>            :     side = -1;
<span class="lineNum">     984 </span><span class="lineCov">       9143 :   } </span>
<span class="lineNum">     985 </span><span class="lineCov">       9309 :   else if (ampL &lt; ampR) {</span>
<span class="lineNum">     986 </span><span class="lineCov">       8897 :     x    = (ampR - ampL) / ampC;</span>
<span class="lineNum">     987 </span>            :     side = +1;
<span class="lineNum">     988 </span><span class="lineCov">       8897 :   }</span>
<span class="lineNum">     989 </span>            : 
<span class="lineNum">     990 </span><span class="lineCov">      18452 :   if (ampL != ampR) {</span>
<span class="lineNum">     991 </span>            : 
<span class="lineNum">     992 </span><span class="lineCov">      18040 :     xmin = xMin[ilayer] + 0.000005;</span>
<span class="lineNum">     993 </span><span class="lineCov">      18040 :     xmax = xMax[ilayer] - 0.000005;</span>
<span class="lineNum">     994 </span><span class="lineCov">      18040 :     xwid = (xmax - xmin) / 127.0;</span>
<span class="lineNum">     995 </span>            : 
<span class="lineNum">     996 </span><span class="lineCov">      18058 :     if      (x &lt; xmin) fCenter = 0.0000;</span>
<span class="lineNum">     997 </span><span class="lineCov">      18153 :     else if (x &gt; xmax) fCenter = side * 0.5000;</span>
<span class="lineNum">     998 </span>            :     else {
<span class="lineNum">     999 </span><span class="lineCov">      17891 :       ix      = (Int_t) ((x - xmin) / xwid);</span>
<span class="lineNum">    1000 </span><span class="lineCov">      17891 :       fCenter = side * fgLUT[ilayer*fgkNlut+ix];</span>
<span class="lineNum">    1001 </span>            :     }
<span class="lineNum">    1002 </span><span class="lineCov">        412 :   } else fCenter = 0.0;</span>
<span class="lineNum">    1003 </span>            : 
<span class="lineNum">    1004 </span><span class="lineCov">      36904 :   return fCenter;</span>
<span class="lineNum">    1005 </span><span class="lineCov">      18452 : }</span>
<a name="1006"><span class="lineNum">    1006 </span>            : </a>
<span class="lineNum">    1007 </span>            : //___________________________________________________________________________
<span class="lineNum">    1008 </span>            : Float_t AliTRDcluster::GetDYgauss(Double_t s2w, Double_t *const y1, Double_t *const y2)
<span class="lineNum">    1009 </span>            : {
<span class="lineNum">    1010 </span>            : //
<span class="lineNum">    1011 </span>            : // (Re)Calculate cluster position in the y direction in local chamber coordinates using all available information from tracking.
<span class="lineNum">    1012 </span>            : //
<span class="lineNum">    1013 </span>            : // Input parameters:
<span class="lineNum">    1014 </span>            : //   s2 - sigma of gaussian parameterization (see bellow for the exact parameterization)
<span class="lineNum">    1015 </span>            : //   W  - pad width
<span class="lineNum">    1016 </span>            : //   xd - drift length (with respect to the anode wire) [cm]
<span class="lineNum">    1017 </span>            : //   wt - omega*tau = tg(a_L)
<span class="lineNum">    1018 </span>            : // Output values :
<span class="lineNum">    1019 </span>            : //   y1 and y2 - partial positions based on 2 pads clusters
<span class="lineNum">    1020 </span>            : //   return y position of the cluster from all information
<span class="lineNum">    1021 </span>            : //
<span class="lineNum">    1022 </span>            : // Estimation of y coordinate is based on the gaussian approximation of the PRF. Thus one may
<span class="lineNum">    1023 </span>            : // calculate the y position knowing the signals q_i-1, q_i and q_i+1 in the 3 adiacent pads by:
<span class="lineNum">    1024 </span>            : // BEGIN_LATEX
<span class="lineNum">    1025 </span>            : // y = #frac{1}{w_{1}+w_{2}}#[]{w_{1}#(){y_{0}-#frac{W}{2}+#frac{s^{2}}{W}ln#frac{q_{i}}{q_{i-1}}}+w_{2}#(){y_{0}+ #frac{W}{2}+#frac{s^{2}}{W}ln#frac{q_{i+1}}{q_{i}}}}
<span class="lineNum">    1026 </span>            : // END_LATEX
<span class="lineNum">    1027 </span>            : // where W is the pad width, y_0 is the position of the center pad and s^2 is given by
<span class="lineNum">    1028 </span>            : // BEGIN_LATEX
<span class="lineNum">    1029 </span>            : // s^{2} = s^{2}_{0} + s^{2}_{diff} (x,B) + #frac{tg^{2}(#phi-#alpha_{L})*l^{2}}{12}
<span class="lineNum">    1030 </span>            : // END_LATEX
<span class="lineNum">    1031 </span>            : // with s_0 being the PRF for 0 drift and track incidence phi equal to the lorentz angle a_L and the diffusion term 
<span class="lineNum">    1032 </span>            : // being described by:
<span class="lineNum">    1033 </span>            : // BEGIN_LATEX
<span class="lineNum">    1034 </span>            : // s_{diff} (x,B) = #frac{D_{L}#sqrt{x}}{1+#(){#omega#tau}^{2}}
<span class="lineNum">    1035 </span>            : // END_LATEX
<span class="lineNum">    1036 </span>            : // with x being the drift length. The weights w_1 and w_2 are taken to be q_i-1^2 and q_i+1^2 respectively
<span class="lineNum">    1037 </span>            : // 
<span class="lineNum">    1038 </span>            : // Authors
<span class="lineNum">    1039 </span>            : // Alex Bercuci &lt;A.Bercuci@gsi.de&gt;
<span class="lineNum">    1040 </span>            : // Theodor Rascanu &lt;trascanu@stud.uni-frankfurt.de&gt;
<span class="lineNum">    1041 </span>            : //
<span class="lineNum">    1042 </span><span class="lineNoCov">          0 :   Double_t w1 = fSignals[2]*fSignals[2];</span>
<span class="lineNum">    1043 </span><span class="lineNoCov">          0 :   Double_t w2 = fSignals[4]*fSignals[4];</span>
<span class="lineNum">    1044 </span><span class="lineNoCov">          0 :   Double_t w = w1+w2;</span>
<span class="lineNum">    1045 </span><span class="lineNoCov">          0 :   if(w&lt;1.){</span>
<span class="lineNum">    1046 </span><span class="lineNoCov">          0 :     AliError(&quot;Missing side signals for cluster.&quot;);</span>
<span class="lineNum">    1047 </span><span class="lineNoCov">          0 :     Print(&quot;a&quot;);</span>
<span class="lineNum">    1048 </span><span class="lineNoCov">          0 :     return 0.;</span>
<span class="lineNum">    1049 </span>            :   }  
<span class="lineNum">    1050 </span>            : 
<span class="lineNum">    1051 </span>            :   //Double_t s2w = s2/W/W;
<span class="lineNum">    1052 </span><span class="lineNoCov">          0 :   Float_t y1r  = fSignals[2]&gt;0 ? (-0.5 + s2w*TMath::Log(fSignals[3]/(Float_t)fSignals[2])) : 0.;</span>
<span class="lineNum">    1053 </span><span class="lineNoCov">          0 :   Float_t y2r  = fSignals[4]&gt;0 ? (0.5 + s2w*TMath::Log(fSignals[4]/(Float_t)fSignals[3])) : 0.;</span>
<span class="lineNum">    1054 </span>            : 
<span class="lineNum">    1055 </span><span class="lineNoCov">          0 :   if(y1) (*y1) = y1r;</span>
<span class="lineNum">    1056 </span><span class="lineNoCov">          0 :   if(y2) (*y2) = y2r;</span>
<span class="lineNum">    1057 </span>            : 
<span class="lineNum">    1058 </span><span class="lineNoCov">          0 :   return fCenter      = (w1*y1r+w2*y2r)/w;</span>
<span class="lineNum">    1059 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">    1060 </span>            : 
<span class="lineNum">    1061 </span>            : 
<a name="1062"><span class="lineNum">    1062 </span>            : </a>
<span class="lineNum">    1063 </span>            : //_____________________________________________________________________________
<span class="lineNum">    1064 </span>            : void AliTRDcluster::FillLUT()
<span class="lineNum">    1065 </span>            : {
<span class="lineNum">    1066 </span>            :   //
<span class="lineNum">    1067 </span>            :   // Create the LUT
<span class="lineNum">    1068 </span>            :   //
<span class="lineNum">    1069 </span>            : 
<span class="lineNum">    1070 </span>            :   // The lookup table from Bogdan
<span class="lineNum">    1071 </span><span class="lineCov">          4 :   Float_t lut[AliTRDgeometry::kNlayer][fgkNlut] = {  </span>
<span class="lineNum">    1072 </span>            :     {
<span class="lineNum">    1073 </span>            :       0.0070, 0.0150, 0.0224, 0.0298, 0.0374, 0.0454, 0.0533, 0.0611, 
<span class="lineNum">    1074 </span>            :       0.0684, 0.0755, 0.0827, 0.0900, 0.0975, 0.1049, 0.1120, 0.1187, 
<span class="lineNum">    1075 </span>            :       0.1253, 0.1318, 0.1385, 0.1453, 0.1519, 0.1584, 0.1646, 0.1704, 
<span class="lineNum">    1076 </span>            :       0.1762, 0.1821, 0.1879, 0.1938, 0.1996, 0.2053, 0.2108, 0.2160, 
<span class="lineNum">    1077 </span>            :       0.2210, 0.2260, 0.2310, 0.2361, 0.2411, 0.2461, 0.2509, 0.2557, 
<span class="lineNum">    1078 </span>            :       0.2602, 0.2646, 0.2689, 0.2732, 0.2774, 0.2816, 0.2859, 0.2901, 
<span class="lineNum">    1079 </span>            :       0.2942, 0.2983, 0.3022, 0.3061, 0.3099, 0.3136, 0.3172, 0.3207, 
<span class="lineNum">    1080 </span>            :       0.3242, 0.3278, 0.3312, 0.3347, 0.3382, 0.3416, 0.3450, 0.3483, 
<span class="lineNum">    1081 </span>            :       0.3515, 0.3547, 0.3579, 0.3609, 0.3639, 0.3669, 0.3698, 0.3727, 
<span class="lineNum">    1082 </span>            :       0.3756, 0.3785, 0.3813, 0.3842, 0.3870, 0.3898, 0.3926, 0.3952, 
<span class="lineNum">    1083 </span>            :       0.3979, 0.4005, 0.4032, 0.4057, 0.4082, 0.4108, 0.4132, 0.4157, 
<span class="lineNum">    1084 </span>            :       0.4181, 0.4205, 0.4228, 0.4252, 0.4275, 0.4299, 0.4322, 0.4345, 
<span class="lineNum">    1085 </span>            :       0.4367, 0.4390, 0.4412, 0.4434, 0.4456, 0.4478, 0.4499, 0.4520, 
<span class="lineNum">    1086 </span>            :       0.4541, 0.4562, 0.4583, 0.4603, 0.4623, 0.4643, 0.4663, 0.4683, 
<span class="lineNum">    1087 </span>            :       0.4702, 0.4722, 0.4741, 0.4758, 0.4774, 0.4790, 0.4805, 0.4824, 
<span class="lineNum">    1088 </span>            :       0.4844, 0.4863, 0.4883, 0.4902, 0.4921, 0.4940, 0.4959, 0.4978 
<span class="lineNum">    1089 </span>            :     },
<span class="lineNum">    1090 </span>            :     {
<span class="lineNum">    1091 </span>            :       0.0072, 0.0156, 0.0235, 0.0313, 0.0394, 0.0478, 0.0561, 0.0642, 
<span class="lineNum">    1092 </span>            :       0.0718, 0.0792, 0.0868, 0.0947, 0.1025, 0.1101, 0.1172, 0.1241, 
<span class="lineNum">    1093 </span>            :       0.1309, 0.1378, 0.1449, 0.1518, 0.1586, 0.1650, 0.1710, 0.1770, 
<span class="lineNum">    1094 </span>            :       0.1830, 0.1891, 0.1952, 0.2011, 0.2070, 0.2125, 0.2177, 0.2229, 
<span class="lineNum">    1095 </span>            :       0.2280, 0.2332, 0.2383, 0.2435, 0.2484, 0.2533, 0.2581, 0.2627, 
<span class="lineNum">    1096 </span>            :       0.2670, 0.2714, 0.2757, 0.2799, 0.2842, 0.2884, 0.2927, 0.2968, 
<span class="lineNum">    1097 </span>            :       0.3008, 0.3048, 0.3086, 0.3123, 0.3159, 0.3195, 0.3231, 0.3266, 
<span class="lineNum">    1098 </span>            :       0.3301, 0.3335, 0.3370, 0.3404, 0.3438, 0.3471, 0.3504, 0.3536, 
<span class="lineNum">    1099 </span>            :       0.3567, 0.3598, 0.3628, 0.3657, 0.3686, 0.3715, 0.3744, 0.3772, 
<span class="lineNum">    1100 </span>            :       0.3800, 0.3828, 0.3856, 0.3884, 0.3911, 0.3938, 0.3965, 0.3991, 
<span class="lineNum">    1101 </span>            :       0.4016, 0.4042, 0.4067, 0.4092, 0.4116, 0.4140, 0.4164, 0.4187, 
<span class="lineNum">    1102 </span>            :       0.4211, 0.4234, 0.4257, 0.4280, 0.4302, 0.4325, 0.4347, 0.4369, 
<span class="lineNum">    1103 </span>            :       0.4391, 0.4413, 0.4434, 0.4456, 0.4477, 0.4497, 0.4518, 0.4538, 
<span class="lineNum">    1104 </span>            :       0.4558, 0.4578, 0.4598, 0.4618, 0.4637, 0.4656, 0.4675, 0.4694, 
<span class="lineNum">    1105 </span>            :       0.4713, 0.4732, 0.4750, 0.4766, 0.4781, 0.4797, 0.4813, 0.4832, 
<span class="lineNum">    1106 </span>            :       0.4851, 0.4870, 0.4888, 0.4906, 0.4925, 0.4942, 0.4960, 0.4978
<span class="lineNum">    1107 </span>            :     },
<span class="lineNum">    1108 </span>            :     {
<span class="lineNum">    1109 </span>            :       0.0075, 0.0163, 0.0246, 0.0328, 0.0415, 0.0504, 0.0592, 0.0674, 
<span class="lineNum">    1110 </span>            :       0.0753, 0.0832, 0.0914, 0.0996, 0.1077, 0.1154, 0.1225, 0.1296, 
<span class="lineNum">    1111 </span>            :       0.1369, 0.1442, 0.1515, 0.1585, 0.1652, 0.1714, 0.1776, 0.1839, 
<span class="lineNum">    1112 </span>            :       0.1902, 0.1965, 0.2025, 0.2085, 0.2141, 0.2194, 0.2247, 0.2299, 
<span class="lineNum">    1113 </span>            :       0.2352, 0.2405, 0.2457, 0.2507, 0.2557, 0.2604, 0.2649, 0.2693, 
<span class="lineNum">    1114 </span>            :       0.2737, 0.2780, 0.2823, 0.2867, 0.2909, 0.2951, 0.2992, 0.3033, 
<span class="lineNum">    1115 </span>            :       0.3072, 0.3110, 0.3146, 0.3182, 0.3218, 0.3253, 0.3288, 0.3323, 
<span class="lineNum">    1116 </span>            :       0.3357, 0.3392, 0.3426, 0.3459, 0.3492, 0.3524, 0.3555, 0.3586, 
<span class="lineNum">    1117 </span>            :       0.3616, 0.3645, 0.3674, 0.3703, 0.3731, 0.3759, 0.3787, 0.3815, 
<span class="lineNum">    1118 </span>            :       0.3843, 0.3870, 0.3897, 0.3925, 0.3950, 0.3976, 0.4002, 0.4027, 
<span class="lineNum">    1119 </span>            :       0.4052, 0.4076, 0.4101, 0.4124, 0.4148, 0.4171, 0.4194, 0.4217, 
<span class="lineNum">    1120 </span>            :       0.4239, 0.4262, 0.4284, 0.4306, 0.4328, 0.4350, 0.4371, 0.4393, 
<span class="lineNum">    1121 </span>            :       0.4414, 0.4435, 0.4455, 0.4476, 0.4496, 0.4516, 0.4536, 0.4555, 
<span class="lineNum">    1122 </span>            :       0.4575, 0.4594, 0.4613, 0.4632, 0.4650, 0.4669, 0.4687, 0.4705, 
<span class="lineNum">    1123 </span>            :       0.4723, 0.4741, 0.4758, 0.4773, 0.4789, 0.4804, 0.4821, 0.4839, 
<span class="lineNum">    1124 </span>            :       0.4857, 0.4875, 0.4893, 0.4910, 0.4928, 0.4945, 0.4961, 0.4978
<span class="lineNum">    1125 </span>            :     },
<span class="lineNum">    1126 </span>            :     {
<span class="lineNum">    1127 </span>            :       0.0078, 0.0171, 0.0258, 0.0345, 0.0438, 0.0532, 0.0624, 0.0708, 
<span class="lineNum">    1128 </span>            :       0.0791, 0.0875, 0.0962, 0.1048, 0.1130, 0.1206, 0.1281, 0.1356, 
<span class="lineNum">    1129 </span>            :       0.1432, 0.1508, 0.1582, 0.1651, 0.1716, 0.1780, 0.1845, 0.1910, 
<span class="lineNum">    1130 </span>            :       0.1975, 0.2038, 0.2099, 0.2155, 0.2210, 0.2263, 0.2317, 0.2371, 
<span class="lineNum">    1131 </span>            :       0.2425, 0.2477, 0.2528, 0.2578, 0.2626, 0.2671, 0.2715, 0.2759, 
<span class="lineNum">    1132 </span>            :       0.2803, 0.2846, 0.2890, 0.2933, 0.2975, 0.3016, 0.3056, 0.3095, 
<span class="lineNum">    1133 </span>            :       0.3132, 0.3168, 0.3204, 0.3239, 0.3274, 0.3309, 0.3344, 0.3378, 
<span class="lineNum">    1134 </span>            :       0.3412, 0.3446, 0.3479, 0.3511, 0.3543, 0.3574, 0.3603, 0.3633, 
<span class="lineNum">    1135 </span>            :       0.3662, 0.3690, 0.3718, 0.3747, 0.3774, 0.3802, 0.3829, 0.3857, 
<span class="lineNum">    1136 </span>            :       0.3883, 0.3910, 0.3936, 0.3962, 0.3987, 0.4012, 0.4037, 0.4061, 
<span class="lineNum">    1137 </span>            :       0.4085, 0.4109, 0.4132, 0.4155, 0.4177, 0.4200, 0.4222, 0.4244, 
<span class="lineNum">    1138 </span>            :       0.4266, 0.4288, 0.4309, 0.4331, 0.4352, 0.4373, 0.4394, 0.4414, 
<span class="lineNum">    1139 </span>            :       0.4435, 0.4455, 0.4475, 0.4494, 0.4514, 0.4533, 0.4552, 0.4571, 
<span class="lineNum">    1140 </span>            :       0.4590, 0.4608, 0.4626, 0.4645, 0.4662, 0.4680, 0.4698, 0.4715, 
<span class="lineNum">    1141 </span>            :       0.4733, 0.4750, 0.4766, 0.4781, 0.4796, 0.4812, 0.4829, 0.4846, 
<span class="lineNum">    1142 </span>            :       0.4863, 0.4880, 0.4897, 0.4914, 0.4930, 0.4946, 0.4963, 0.4979
<span class="lineNum">    1143 </span>            :     },
<span class="lineNum">    1144 </span>            :     {
<span class="lineNum">    1145 </span>            :       0.0081, 0.0178, 0.0270, 0.0364, 0.0463, 0.0562, 0.0656, 0.0744, 
<span class="lineNum">    1146 </span>            :       0.0831, 0.0921, 0.1013, 0.1102, 0.1183, 0.1261, 0.1339, 0.1419, 
<span class="lineNum">    1147 </span>            :       0.1499, 0.1576, 0.1648, 0.1715, 0.1782, 0.1849, 0.1917, 0.1984, 
<span class="lineNum">    1148 </span>            :       0.2048, 0.2110, 0.2167, 0.2223, 0.2278, 0.2333, 0.2389, 0.2444, 
<span class="lineNum">    1149 </span>            :       0.2497, 0.2548, 0.2598, 0.2645, 0.2691, 0.2735, 0.2780, 0.2824, 
<span class="lineNum">    1150 </span>            :       0.2868, 0.2912, 0.2955, 0.2997, 0.3038, 0.3078, 0.3116, 0.3152, 
<span class="lineNum">    1151 </span>            :       0.3188, 0.3224, 0.3259, 0.3294, 0.3329, 0.3364, 0.3398, 0.3432, 
<span class="lineNum">    1152 </span>            :       0.3465, 0.3497, 0.3529, 0.3561, 0.3591, 0.3620, 0.3649, 0.3677, 
<span class="lineNum">    1153 </span>            :       0.3705, 0.3733, 0.3761, 0.3788, 0.3816, 0.3843, 0.3869, 0.3896, 
<span class="lineNum">    1154 </span>            :       0.3922, 0.3948, 0.3973, 0.3998, 0.4022, 0.4047, 0.4070, 0.4094, 
<span class="lineNum">    1155 </span>            :       0.4117, 0.4139, 0.4162, 0.4184, 0.4206, 0.4227, 0.4249, 0.4270, 
<span class="lineNum">    1156 </span>            :       0.4291, 0.4313, 0.4334, 0.4354, 0.4375, 0.4395, 0.4415, 0.4435, 
<span class="lineNum">    1157 </span>            :       0.4455, 0.4474, 0.4493, 0.4512, 0.4531, 0.4550, 0.4568, 0.4586, 
<span class="lineNum">    1158 </span>            :       0.4604, 0.4622, 0.4639, 0.4657, 0.4674, 0.4691, 0.4708, 0.4725, 
<span class="lineNum">    1159 </span>            :       0.4742, 0.4758, 0.4773, 0.4788, 0.4803, 0.4819, 0.4836, 0.4852, 
<span class="lineNum">    1160 </span>            :       0.4869, 0.4885, 0.4901, 0.4917, 0.4933, 0.4948, 0.4964, 0.4979
<span class="lineNum">    1161 </span>            :     },
<span class="lineNum">    1162 </span>            :     {
<span class="lineNum">    1163 </span>            :       0.0085, 0.0189, 0.0288, 0.0389, 0.0497, 0.0603, 0.0699, 0.0792, 
<span class="lineNum">    1164 </span>            :       0.0887, 0.0985, 0.1082, 0.1170, 0.1253, 0.1336, 0.1421, 0.1505, 
<span class="lineNum">    1165 </span>            :       0.1587, 0.1662, 0.1733, 0.1803, 0.1874, 0.1945, 0.2014, 0.2081, 
<span class="lineNum">    1166 </span>            :       0.2143, 0.2201, 0.2259, 0.2316, 0.2374, 0.2431, 0.2487, 0.2541, 
<span class="lineNum">    1167 </span>            :       0.2593, 0.2642, 0.2689, 0.2735, 0.2781, 0.2826, 0.2872, 0.2917, 
<span class="lineNum">    1168 </span>            :       0.2961, 0.3003, 0.3045, 0.3086, 0.3125, 0.3162, 0.3198, 0.3235, 
<span class="lineNum">    1169 </span>            :       0.3270, 0.3306, 0.3342, 0.3377, 0.3411, 0.3446, 0.3479, 0.3511, 
<span class="lineNum">    1170 </span>            :       0.3543, 0.3575, 0.3605, 0.3634, 0.3663, 0.3691, 0.3720, 0.3748, 
<span class="lineNum">    1171 </span>            :       0.3775, 0.3803, 0.3830, 0.3857, 0.3884, 0.3911, 0.3937, 0.3962, 
<span class="lineNum">    1172 </span>            :       0.3987, 0.4012, 0.4036, 0.4060, 0.4084, 0.4107, 0.4129, 0.4152, 
<span class="lineNum">    1173 </span>            :       0.4174, 0.4196, 0.4218, 0.4239, 0.4261, 0.4282, 0.4303, 0.4324, 
<span class="lineNum">    1174 </span>            :       0.4344, 0.4365, 0.4385, 0.4405, 0.4425, 0.4445, 0.4464, 0.4483, 
<span class="lineNum">    1175 </span>            :       0.4502, 0.4521, 0.4539, 0.4558, 0.4576, 0.4593, 0.4611, 0.4629, 
<span class="lineNum">    1176 </span>            :       0.4646, 0.4663, 0.4680, 0.4697, 0.4714, 0.4730, 0.4747, 0.4759, 
<span class="lineNum">    1177 </span>            :       0.4769, 0.4780, 0.4790, 0.4800, 0.4811, 0.4827, 0.4843, 0.4859, 
<span class="lineNum">    1178 </span>            :       0.4874, 0.4889, 0.4905, 0.4920, 0.4935, 0.4950, 0.4965, 0.4979
<span class="lineNum">    1179 </span>            :     }
<span class="lineNum">    1180 </span>            :   }; 
<span class="lineNum">    1181 </span>            : 
<span class="lineNum">    1182 </span><span class="lineCov">          4 :   if(!fgLUT) fgLUT = new Double_t[AliTRDgeometry::kNlayer*fgkNlut];</span>
<span class="lineNum">    1183 </span>            : 
<span class="lineNum">    1184 </span><span class="lineCov">         28 :   for (Int_t ilayer = 0; ilayer &lt; AliTRDgeometry::kNlayer; ilayer++) {</span>
<span class="lineNum">    1185 </span><span class="lineCov">       3096 :     for (Int_t ilut  = 0; ilut  &lt; fgkNlut; ilut++  ) {</span>
<span class="lineNum">    1186 </span><span class="lineCov">       1536 :       fgLUT[ilayer*fgkNlut+ilut] = lut[ilayer][ilut];</span>
<span class="lineNum">    1187 </span>            :     }
<span class="lineNum">    1188 </span>            :   }
<span class="lineNum">    1189 </span><span class="lineCov">          2 : }</span>
<span class="lineNum">    1190 </span>            : 
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.11</a></td></tr>
  </table>
  <br>

</body>
</html>
