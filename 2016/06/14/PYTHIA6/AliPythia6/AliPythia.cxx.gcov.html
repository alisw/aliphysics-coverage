<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - coverage.info - PYTHIA6/AliPythia6/AliPythia.cxx</title>
  <link rel="stylesheet" type="text/css" href="../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../index.html">top level</a> - <a href="index.html">PYTHIA6/AliPythia6</a> - AliPythia.cxx<span style="font-size: 80%;"> (source / <a href="AliPythia.cxx.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">coverage.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">34</td>
            <td class="headerCovTableEntry">858</td>
            <td class="headerCovTableEntryLo">4.0 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2016-06-14 17:26:59</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">6</td>
            <td class="headerCovTableEntry">43</td>
            <td class="headerCovTableEntryLo">14.0 %</td>
          </tr>
          <tr><td><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            : /**************************************************************************</a>
<span class="lineNum">       2 </span>            :  * Copyright(c) 1998-1999, ALICE Experiment at CERN, All rights reserved. *
<span class="lineNum">       3 </span>            :  *                                                                        *
<span class="lineNum">       4 </span>            :  * Author: The ALICE Off-line Project.                                    *
<span class="lineNum">       5 </span>            :  * Contributors are mentioned in the code where appropriate.              *
<span class="lineNum">       6 </span>            :  *                                                                        *
<span class="lineNum">       7 </span>            :  * Permission to use, copy, modify and distribute this software and its   *
<span class="lineNum">       8 </span>            :  * documentation strictly for non-commercial purposes is hereby granted   *
<span class="lineNum">       9 </span>            :  * without fee, provided that the above copyright notice appears in all   *
<span class="lineNum">      10 </span>            :  * copies and that both the copyright notice and this permission notice   *
<span class="lineNum">      11 </span>            :  * appear in the supporting documentation. The authors make no claims     *
<span class="lineNum">      12 </span>            :  * about the suitability of this software for any purpose. It is          *
<span class="lineNum">      13 </span>            :  * provided &quot;as is&quot; without express or implied warranty.                  *
<span class="lineNum">      14 </span>            :  **************************************************************************/
<span class="lineNum">      15 </span>            : 
<span class="lineNum">      16 </span>            : // Pythia 6 interface used by AliGenPythia
<span class="lineNum">      17 </span>            : // Some settings are done by AliGenPythia, others here :)
<span class="lineNum">      18 </span>            : //
<span class="lineNum">      19 </span>            : /* $Id$ */
<span class="lineNum">      20 </span>            : 
<span class="lineNum">      21 </span>            : #include &quot;AliPythia.h&quot;
<span class="lineNum">      22 </span>            : #include &quot;AliPythiaRndm.h&quot;
<span class="lineNum">      23 </span>            : #include &quot;AliFastGlauber.h&quot;
<span class="lineNum">      24 </span>            : #include &quot;AliQuenchingWeights.h&quot;
<span class="lineNum">      25 </span>            : #include &quot;AliOmegaDalitz.h&quot;
<span class="lineNum">      26 </span>            : #include &quot;AliDecayerExodus.h&quot;
<span class="lineNum">      27 </span>            : #include &quot;AliLog.h&quot;
<span class="lineNum">      28 </span>            : #include &quot;TVector3.h&quot;
<span class="lineNum">      29 </span>            : #include &quot;TLorentzVector.h&quot;
<a name="30"><span class="lineNum">      30 </span>            : #include &quot;PyquenCommon.h&quot;</a>
<span class="lineNum">      31 </span>            : 
<span class="lineNum">      32 </span><span class="lineCov">          2 : ClassImp(AliPythia)</span>
<span class="lineNum">      33 </span>            : 
<span class="lineNum">      34 </span>            : #ifndef WIN32
<span class="lineNum">      35 </span>            : # define pyclus pyclus_
<span class="lineNum">      36 </span>            : # define pycell pycell_
<span class="lineNum">      37 </span>            : # define pyshow pyshow_
<span class="lineNum">      38 </span>            : # define pyrobo pyrobo_
<span class="lineNum">      39 </span>            : # define pyquen pyquen_
<span class="lineNum">      40 </span>            : # define pyevnw pyevnw_
<span class="lineNum">      41 </span>            : # define pyshowq pyshowq_
<span class="lineNum">      42 </span>            : # define qpygin0 qpygin0_
<span class="lineNum">      43 </span>            : # define pytune  pytune_
<span class="lineNum">      44 </span>            : # define py2ent  py2ent_
<span class="lineNum">      45 </span>            : # define setpowwght setpowwght_
<span class="lineNum">      46 </span>            : # define type_of_call
<span class="lineNum">      47 </span>            : #else
<span class="lineNum">      48 </span>            : # define pyclus PYCLUS
<span class="lineNum">      49 </span>            : # define pycell PYCELL
<span class="lineNum">      50 </span>            : # define pyrobo PYROBO
<span class="lineNum">      51 </span>            : # define pyquen PYQUEN
<span class="lineNum">      52 </span>            : # define pyevnw PYEVNW
<span class="lineNum">      53 </span>            : # define pyshowq PYSHOWQ
<span class="lineNum">      54 </span>            : # define qpygin0 QPYGIN0
<span class="lineNum">      55 </span>            : # define pytune  PYTUNE
<span class="lineNum">      56 </span>            : # define py2ent  PY2ENT
<span class="lineNum">      57 </span>            : # define setpowwght SETPOWWGHT
<span class="lineNum">      58 </span>            : # define type_of_call _stdcall
<span class="lineNum">      59 </span>            : #endif
<span class="lineNum">      60 </span>            : 
<span class="lineNum">      61 </span>            : extern &quot;C&quot; void type_of_call pyclus(Int_t &amp; );
<span class="lineNum">      62 </span>            : extern &quot;C&quot; void type_of_call pycell(Int_t &amp; );
<span class="lineNum">      63 </span>            : extern &quot;C&quot; void type_of_call pyshow(Int_t &amp;, Int_t &amp;, Double_t &amp;);
<span class="lineNum">      64 </span>            : extern &quot;C&quot; void type_of_call pyrobo(Int_t &amp;, Int_t &amp;, Double_t &amp;, Double_t &amp;, Double_t &amp;, Double_t &amp;, Double_t &amp;);
<span class="lineNum">      65 </span>            : extern &quot;C&quot; void type_of_call pyquen(Double_t &amp;, Int_t &amp;, Double_t &amp;);
<span class="lineNum">      66 </span>            : extern &quot;C&quot; void type_of_call pyevnw();
<span class="lineNum">      67 </span>            : extern &quot;C&quot; void type_of_call pyshowq(Int_t &amp;, Int_t &amp;, Double_t &amp;);
<span class="lineNum">      68 </span>            : extern &quot;C&quot; void type_of_call pytune(Int_t &amp;);
<span class="lineNum">      69 </span>            : extern &quot;C&quot; void type_of_call py2ent(Int_t &amp;, Int_t&amp;, Int_t&amp;, Double_t&amp;);
<span class="lineNum">      70 </span>            : extern &quot;C&quot; void type_of_call qpygin0();
<span class="lineNum">      71 </span>            : extern &quot;C&quot; void type_of_call setpowwght(Double_t &amp;);
<span class="lineNum">      72 </span>            : //_____________________________________________________________________________
<span class="lineNum">      73 </span>            : 
<a name="74"><span class="lineNum">      74 </span>            : AliPythia* AliPythia::fgAliPythia=NULL;</a>
<span class="lineNum">      75 </span>            : 
<span class="lineNum">      76 </span><span class="lineCov">          2 : AliPythia::AliPythia():</span>
<span class="lineNum">      77 </span><span class="lineCov">          1 :     fProcess(kPyMb),</span>
<span class="lineNum">      78 </span><span class="lineCov">          1 :     fEcms(0.),</span>
<span class="lineNum">      79 </span><span class="lineCov">          1 :     fStrucFunc(kCTEQ5L),</span>
<span class="lineNum">      80 </span><span class="lineCov">          1 :     fProjectile(&quot;p&quot;),</span>
<span class="lineNum">      81 </span><span class="lineCov">          1 :     fTarget(&quot;p&quot;),</span>
<span class="lineNum">      82 </span><span class="lineCov">          1 :     fXJet(0.),</span>
<span class="lineNum">      83 </span><span class="lineCov">          1 :     fYJet(0.),</span>
<span class="lineNum">      84 </span><span class="lineCov">          1 :     fNGmax(30),</span>
<span class="lineNum">      85 </span><span class="lineCov">          1 :     fZmax(0.97),</span>
<span class="lineNum">      86 </span><span class="lineCov">          1 :     fGlauber(0),</span>
<span class="lineNum">      87 </span><span class="lineCov">          1 :     fQuenchingWeights(0),</span>
<span class="lineNum">      88 </span><span class="lineCov">          1 :     fItune(-1),</span>
<span class="lineNum">      89 </span><span class="lineCov">          1 :     fOmegaDalitz(),</span>
<span class="lineNum">      90 </span><span class="lineCov">          1 :     fExodus()</span>
<span class="lineNum">      91 </span><span class="lineCov">          6 : {</span>
<span class="lineNum">      92 </span>            : // Default Constructor
<span class="lineNum">      93 </span>            : //
<span class="lineNum">      94 </span>            : //  Set random number
<span class="lineNum">      95 </span><span class="lineCov">          2 :     if (!AliPythiaRndm::GetPythiaRandom()) </span>
<span class="lineNum">      96 </span><span class="lineNoCov">          0 :       AliPythiaRndm::SetPythiaRandom(GetRandom());</span>
<span class="lineNum">      97 </span><span class="lineCov">          1 :     fGlauber          = 0;</span>
<span class="lineNum">      98 </span><span class="lineCov">          1 :     fQuenchingWeights = 0;</span>
<span class="lineNum">      99 </span>            :     Int_t i = 0;
<span class="lineNum">     100 </span><span class="lineCov">       1004 :     for (i = 0; i &lt;  501; i++) fDefMDCY[i] = 0;</span>
<span class="lineNum">     101 </span><span class="lineCov">       4004 :     for (i = 0; i &lt; 2001; i++) fDefMDME[i] = 0;</span>
<span class="lineNum">     102 </span><span class="lineCov">         10 :     for (i = 0; i &lt;    4; i++) fZQuench[i] = 0;</span>
<a name="103"><span class="lineNum">     103 </span><span class="lineCov">          2 : }</span></a>
<span class="lineNum">     104 </span>            : 
<span class="lineNum">     105 </span>            : AliPythia::AliPythia(const AliPythia&amp; pythia):
<span class="lineNum">     106 </span><span class="lineNoCov">          0 :     TPythia6(pythia), </span>
<span class="lineNum">     107 </span><span class="lineNoCov">          0 :     AliRndm(pythia),</span>
<span class="lineNum">     108 </span><span class="lineNoCov">          0 :     fProcess(kPyMb),</span>
<span class="lineNum">     109 </span><span class="lineNoCov">          0 :     fEcms(0.),</span>
<span class="lineNum">     110 </span><span class="lineNoCov">          0 :     fStrucFunc(kCTEQ5L),</span>
<span class="lineNum">     111 </span><span class="lineNoCov">          0 :     fProjectile(&quot;p&quot;),</span>
<span class="lineNum">     112 </span><span class="lineNoCov">          0 :     fTarget(&quot;p&quot;),</span>
<span class="lineNum">     113 </span><span class="lineNoCov">          0 :     fXJet(0.),</span>
<span class="lineNum">     114 </span><span class="lineNoCov">          0 :     fYJet(0.),</span>
<span class="lineNum">     115 </span><span class="lineNoCov">          0 :     fNGmax(30),</span>
<span class="lineNum">     116 </span><span class="lineNoCov">          0 :     fZmax(0.97),</span>
<span class="lineNum">     117 </span><span class="lineNoCov">          0 :     fGlauber(0),</span>
<span class="lineNum">     118 </span><span class="lineNoCov">          0 :     fQuenchingWeights(0),</span>
<span class="lineNum">     119 </span><span class="lineNoCov">          0 :     fItune(-1),</span>
<span class="lineNum">     120 </span><span class="lineNoCov">          0 :     fOmegaDalitz(),</span>
<span class="lineNum">     121 </span><span class="lineNoCov">          0 :     fExodus()</span>
<span class="lineNum">     122 </span><span class="lineNoCov">          0 : {</span>
<span class="lineNum">     123 </span>            :     // Copy Constructor
<span class="lineNum">     124 </span>            :     Int_t i;
<span class="lineNum">     125 </span><span class="lineNoCov">          0 :     for (i = 0; i &lt;  501; i++) fDefMDCY[i] = 0;</span>
<span class="lineNum">     126 </span><span class="lineNoCov">          0 :     for (i = 0; i &lt; 2001; i++) fDefMDME[i] = 0;</span>
<span class="lineNum">     127 </span><span class="lineNoCov">          0 :     for (i = 0; i &lt;    4; i++) fZQuench[i] = 0;</span>
<span class="lineNum">     128 </span><span class="lineNoCov">          0 :     pythia.Copy(*this);</span>
<a name="129"><span class="lineNum">     129 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     130 </span>            : 
<span class="lineNum">     131 </span>            : void AliPythia::ProcInit(Process_t process, Float_t energy, StrucFunc_t strucfunc, Int_t itune)
<span class="lineNum">     132 </span>            : {
<span class="lineNum">     133 </span>            : // Initialise the process to generate 
<span class="lineNum">     134 </span><span class="lineNoCov">          0 :     if (!AliPythiaRndm::GetPythiaRandom()) </span>
<span class="lineNum">     135 </span><span class="lineNoCov">          0 :       AliPythiaRndm::SetPythiaRandom(GetRandom());</span>
<span class="lineNum">     136 </span>            :     
<span class="lineNum">     137 </span><span class="lineNoCov">          0 :     fItune = itune;</span>
<span class="lineNum">     138 </span>            :     
<span class="lineNum">     139 </span><span class="lineNoCov">          0 :     fProcess = process;</span>
<span class="lineNum">     140 </span><span class="lineNoCov">          0 :     fEcms = energy;</span>
<span class="lineNum">     141 </span><span class="lineNoCov">          0 :     fStrucFunc = strucfunc;</span>
<span class="lineNum">     142 </span>            : //...Switch off decay of pi0, K0S, Lambda, Sigma+-, Xi0-, Omega-.
<span class="lineNum">     143 </span><span class="lineNoCov">          0 :     SetMDCY(Pycomp(111) ,1,0); // pi0</span>
<span class="lineNum">     144 </span><span class="lineNoCov">          0 :     SetMDCY(Pycomp(310) ,1,0); // K0S</span>
<span class="lineNum">     145 </span><span class="lineNoCov">          0 :     SetMDCY(Pycomp(3122),1,0); // kLambda</span>
<span class="lineNum">     146 </span><span class="lineNoCov">          0 :     SetMDCY(Pycomp(3112),1,0); // sigma -</span>
<span class="lineNum">     147 </span><span class="lineNoCov">          0 :     SetMDCY(Pycomp(3222),1,0); // sigma +</span>
<span class="lineNum">     148 </span><span class="lineNoCov">          0 :     SetMDCY(Pycomp(3312),1,0); // xi - </span>
<span class="lineNum">     149 </span><span class="lineNoCov">          0 :     SetMDCY(Pycomp(3322),1,0); // xi 0</span>
<span class="lineNum">     150 </span><span class="lineNoCov">          0 :     SetMDCY(Pycomp(3334),1,0); // omega-</span>
<span class="lineNum">     151 </span>            :     // Select structure function 
<span class="lineNum">     152 </span><span class="lineNoCov">          0 :     SetMSTP(52,2);</span>
<span class="lineNum">     153 </span><span class="lineNoCov">          0 :     SetMSTP(51, AliStructFuncType::PDFsetIndex(strucfunc));</span>
<span class="lineNum">     154 </span>            :     // Particles produced in string fragmentation point directly to either of the two endpoints
<span class="lineNum">     155 </span>            :     // of the string (depending in the side they were generated from).
<span class="lineNum">     156 </span><span class="lineNoCov">          0 :     SetMSTU(16,2);</span>
<span class="lineNum">     157 </span>            : 
<span class="lineNum">     158 </span>            : //
<span class="lineNum">     159 </span>            : // Pythia initialisation for selected processes//
<span class="lineNum">     160 </span>            : //
<span class="lineNum">     161 </span>            : // Make MSEL clean
<span class="lineNum">     162 </span>            : //
<span class="lineNum">     163 </span><span class="lineNoCov">          0 :     for (Int_t i=1; i&lt;= 200; i++) {</span>
<span class="lineNum">     164 </span><span class="lineNoCov">          0 :         SetMSUB(i,0);</span>
<span class="lineNum">     165 </span>            :     }
<span class="lineNum">     166 </span>            : //  select charm production
<span class="lineNum">     167 </span><span class="lineNoCov">          0 :     switch (process) </span>
<span class="lineNum">     168 </span>            :     {
<span class="lineNum">     169 </span>            :     case kPyOldUEQ2ordered:  //Old underlying events with Q2 ordered QCD processes
<span class="lineNum">     170 </span>            : //        Multiple interactions on.
<span class="lineNum">     171 </span><span class="lineNoCov">          0 :         SetMSTP(81,1);</span>
<span class="lineNum">     172 </span>            : // Double Gaussian matter distribution.
<span class="lineNum">     173 </span><span class="lineNoCov">          0 :         SetMSTP(82,4);</span>
<span class="lineNum">     174 </span><span class="lineNoCov">          0 :         SetPARP(83,0.5);</span>
<span class="lineNum">     175 </span><span class="lineNoCov">          0 :         SetPARP(84,0.4);</span>
<span class="lineNum">     176 </span>            : //  pT0.
<span class="lineNum">     177 </span><span class="lineNoCov">          0 :         SetPARP(82,2.0);</span>
<span class="lineNum">     178 </span>            : //  Reference energy for pT0 and energy rescaling pace.
<span class="lineNum">     179 </span><span class="lineNoCov">          0 :         SetPARP(89,1800);</span>
<span class="lineNum">     180 </span><span class="lineNoCov">          0 :         SetPARP(90,0.25);</span>
<span class="lineNum">     181 </span>            : //  String drawing almost completely minimizes string length.
<span class="lineNum">     182 </span><span class="lineNoCov">          0 :         SetPARP(85,0.9);</span>
<span class="lineNum">     183 </span><span class="lineNoCov">          0 :         SetPARP(86,0.95);</span>
<span class="lineNum">     184 </span>            : // ISR and FSR activity.
<span class="lineNum">     185 </span><span class="lineNoCov">          0 :         SetPARP(67,4);</span>
<span class="lineNum">     186 </span><span class="lineNoCov">          0 :         SetPARP(71,4);</span>
<span class="lineNum">     187 </span>            : // Lambda_FSR scale.
<span class="lineNum">     188 </span><span class="lineNoCov">          0 :         SetPARJ(81,0.29);</span>
<span class="lineNum">     189 </span><span class="lineNoCov">          0 :         break;</span>
<span class="lineNum">     190 </span>            :     case kPyOldUEQ2ordered2:   
<span class="lineNum">     191 </span>            : // Old underlying events with Q2 ordered QCD processes
<span class="lineNum">     192 </span>            : // Multiple interactions on.
<span class="lineNum">     193 </span><span class="lineNoCov">          0 :         SetMSTP(81,1);</span>
<span class="lineNum">     194 </span>            : // Double Gaussian matter distribution.
<span class="lineNum">     195 </span><span class="lineNoCov">          0 :         SetMSTP(82,4);</span>
<span class="lineNum">     196 </span><span class="lineNoCov">          0 :         SetPARP(83,0.5);</span>
<span class="lineNum">     197 </span><span class="lineNoCov">          0 :         SetPARP(84,0.4);</span>
<span class="lineNum">     198 </span>            : // pT0.
<span class="lineNum">     199 </span><span class="lineNoCov">          0 :         SetPARP(82,2.0);</span>
<span class="lineNum">     200 </span>            : // Reference energy for pT0 and energy rescaling pace.
<span class="lineNum">     201 </span><span class="lineNoCov">          0 :         SetPARP(89,1800);</span>
<span class="lineNum">     202 </span><span class="lineNoCov">          0 :         SetPARP(90,0.16);  // here is the difference with  kPyOldUEQ2ordered</span>
<span class="lineNum">     203 </span>            : // String drawing almost completely minimizes string length.
<span class="lineNum">     204 </span><span class="lineNoCov">          0 :         SetPARP(85,0.9);</span>
<span class="lineNum">     205 </span><span class="lineNoCov">          0 :         SetPARP(86,0.95);</span>
<span class="lineNum">     206 </span>            : // ISR and FSR activity.
<span class="lineNum">     207 </span><span class="lineNoCov">          0 :         SetPARP(67,4);</span>
<span class="lineNum">     208 </span><span class="lineNoCov">          0 :         SetPARP(71,4);</span>
<span class="lineNum">     209 </span>            : // Lambda_FSR scale.
<span class="lineNum">     210 </span><span class="lineNoCov">          0 :         SetPARJ(81,0.29);       </span>
<span class="lineNum">     211 </span><span class="lineNoCov">          0 :         break;</span>
<span class="lineNum">     212 </span>            :     case kPyOldPopcorn:  
<span class="lineNum">     213 </span>            : // Old production mechanism: Old Popcorn
<span class="lineNum">     214 </span><span class="lineNoCov">          0 :         SetMSEL(1);</span>
<span class="lineNum">     215 </span><span class="lineNoCov">          0 :         SetMSTJ(12,3); </span>
<span class="lineNum">     216 </span>            : // (D=2) Like MSTJ(12)=2 but added prod ofthe 1er rank baryon
<span class="lineNum">     217 </span><span class="lineNoCov">          0 :         SetMSTP(88,2); </span>
<span class="lineNum">     218 </span>            : // (D=1)see can be used to form  baryons (BARYON JUNCTION)
<span class="lineNum">     219 </span><span class="lineNoCov">          0 :         SetMSTJ(1,1);  </span>
<span class="lineNum">     220 </span><span class="lineNoCov">          0 :         AtlasTuning();</span>
<span class="lineNum">     221 </span><span class="lineNoCov">          0 :         break;</span>
<span class="lineNum">     222 </span>            :     case kPyCharm:
<span class="lineNum">     223 </span><span class="lineNoCov">          0 :         SetMSEL(4);</span>
<span class="lineNum">     224 </span>            : //  heavy quark masses
<span class="lineNum">     225 </span>            : 
<span class="lineNum">     226 </span><span class="lineNoCov">          0 :         SetPMAS(4,1,1.2);</span>
<span class="lineNum">     227 </span>            : //
<span class="lineNum">     228 </span>            : //    primordial pT
<span class="lineNum">     229 </span><span class="lineNoCov">          0 :         SetMSTP(91,1);</span>
<span class="lineNum">     230 </span><span class="lineNoCov">          0 :         SetPARP(91,1.);</span>
<span class="lineNum">     231 </span><span class="lineNoCov">          0 :         SetPARP(93,5.);</span>
<span class="lineNum">     232 </span>            : //
<span class="lineNum">     233 </span><span class="lineNoCov">          0 :         break;</span>
<span class="lineNum">     234 </span>            :     case kPyBeauty:
<span class="lineNum">     235 </span><span class="lineNoCov">          0 :         SetMSEL(5);</span>
<span class="lineNum">     236 </span><span class="lineNoCov">          0 :         SetPMAS(5,1,4.75);</span>
<span class="lineNum">     237 </span><span class="lineNoCov">          0 :         break;</span>
<span class="lineNum">     238 </span>            :     case kPyJpsi:
<span class="lineNum">     239 </span><span class="lineNoCov">          0 :         SetMSEL(0);</span>
<span class="lineNum">     240 </span>            : // gg-&gt;J/Psi g
<span class="lineNum">     241 </span><span class="lineNoCov">          0 :         SetMSUB(86,1);</span>
<span class="lineNum">     242 </span><span class="lineNoCov">          0 :         break;</span>
<span class="lineNum">     243 </span>            :     case kPyJpsiChi:
<span class="lineNum">     244 </span><span class="lineNoCov">          0 :         SetMSEL(0);</span>
<span class="lineNum">     245 </span>            : // gg-&gt;J/Psi g
<span class="lineNum">     246 </span><span class="lineNoCov">          0 :         SetMSUB(86,1);</span>
<span class="lineNum">     247 </span>            : // gg-&gt; chi_0c g
<span class="lineNum">     248 </span><span class="lineNoCov">          0 :         SetMSUB(87,1);</span>
<span class="lineNum">     249 </span>            : // gg-&gt; chi_1c g
<span class="lineNum">     250 </span><span class="lineNoCov">          0 :         SetMSUB(88,1);</span>
<span class="lineNum">     251 </span>            : // gg-&gt; chi_2c g
<span class="lineNum">     252 </span><span class="lineNoCov">          0 :         SetMSUB(89,1);  </span>
<span class="lineNum">     253 </span><span class="lineNoCov">          0 :         break;</span>
<span class="lineNum">     254 </span>            :     case kPyCharmUnforced:
<span class="lineNum">     255 </span><span class="lineNoCov">          0 :         SetMSEL(0);</span>
<span class="lineNum">     256 </span>            : // gq-&gt;qg   
<span class="lineNum">     257 </span><span class="lineNoCov">          0 :         SetMSUB(28,1);</span>
<span class="lineNum">     258 </span>            : // gg-&gt;qq
<span class="lineNum">     259 </span><span class="lineNoCov">          0 :         SetMSUB(53,1);</span>
<span class="lineNum">     260 </span>            : // gg-&gt;gg
<span class="lineNum">     261 </span><span class="lineNoCov">          0 :         SetMSUB(68,1);</span>
<span class="lineNum">     262 </span><span class="lineNoCov">          0 :         break;</span>
<span class="lineNum">     263 </span>            :     case kPyBeautyUnforced:
<span class="lineNum">     264 </span><span class="lineNoCov">          0 :         SetMSEL(0);</span>
<span class="lineNum">     265 </span>            : // gq-&gt;qg   
<span class="lineNum">     266 </span><span class="lineNoCov">          0 :         SetMSUB(28,1);</span>
<span class="lineNum">     267 </span>            : // gg-&gt;qq
<span class="lineNum">     268 </span><span class="lineNoCov">          0 :         SetMSUB(53,1);</span>
<span class="lineNum">     269 </span>            : // gg-&gt;gg
<span class="lineNum">     270 </span><span class="lineNoCov">          0 :         SetMSUB(68,1);</span>
<span class="lineNum">     271 </span><span class="lineNoCov">          0 :         break;</span>
<span class="lineNum">     272 </span>            :     case kPyMb:
<span class="lineNum">     273 </span>            : // Minimum Bias pp-Collisions
<span class="lineNum">     274 </span>            : //
<span class="lineNum">     275 </span>            : //   
<span class="lineNum">     276 </span>            : //      select Pythia min. bias model
<span class="lineNum">     277 </span><span class="lineNoCov">          0 :         SetMSEL(0);</span>
<span class="lineNum">     278 </span><span class="lineNoCov">          0 :         SetMSUB(92,1);             // single diffraction AB--&gt;XB</span>
<span class="lineNum">     279 </span><span class="lineNoCov">          0 :         SetMSUB(93,1);             // single diffraction AB--&gt;AX</span>
<span class="lineNum">     280 </span><span class="lineNoCov">          0 :         SetMSUB(94,1);             // double diffraction</span>
<span class="lineNum">     281 </span><span class="lineNoCov">          0 :         SetMSUB(95,1);             // low pt production</span>
<span class="lineNum">     282 </span>            : 
<span class="lineNum">     283 </span><span class="lineNoCov">          0 :         AtlasTuning();</span>
<span class="lineNum">     284 </span><span class="lineNoCov">          0 :         break;</span>
<span class="lineNum">     285 </span>            :         
<span class="lineNum">     286 </span>            :     case kPyMbAtlasTuneMC09:
<span class="lineNum">     287 </span>            : // Minimum Bias pp-Collisions
<span class="lineNum">     288 </span>            : //
<span class="lineNum">     289 </span>            : //   
<span class="lineNum">     290 </span>            : //      select Pythia min. bias model
<span class="lineNum">     291 </span><span class="lineNoCov">          0 :         SetMSEL(0);</span>
<span class="lineNum">     292 </span><span class="lineNoCov">          0 :         SetMSUB(92,1);             // single diffraction AB--&gt;XB</span>
<span class="lineNum">     293 </span><span class="lineNoCov">          0 :         SetMSUB(93,1);             // single diffraction AB--&gt;AX</span>
<span class="lineNum">     294 </span><span class="lineNoCov">          0 :         SetMSUB(94,1);             // double diffraction</span>
<span class="lineNum">     295 </span><span class="lineNoCov">          0 :         SetMSUB(95,1);             // low pt production</span>
<span class="lineNum">     296 </span>            : 
<span class="lineNum">     297 </span><span class="lineNoCov">          0 :         AtlasTuningMC09();</span>
<span class="lineNum">     298 </span><span class="lineNoCov">          0 :         break;</span>
<span class="lineNum">     299 </span>            : 
<span class="lineNum">     300 </span>            :     case kPyMbWithDirectPhoton:
<span class="lineNum">     301 </span>            : // Minimum Bias pp-Collisions with direct photon processes added 
<span class="lineNum">     302 </span>            : //
<span class="lineNum">     303 </span>            : //   
<span class="lineNum">     304 </span>            : //      select Pythia min. bias model
<span class="lineNum">     305 </span><span class="lineNoCov">          0 :         SetMSEL(0);</span>
<span class="lineNum">     306 </span><span class="lineNoCov">          0 :         SetMSUB(92,1);             // single diffraction AB--&gt;XB</span>
<span class="lineNum">     307 </span><span class="lineNoCov">          0 :         SetMSUB(93,1);             // single diffraction AB--&gt;AX</span>
<span class="lineNum">     308 </span><span class="lineNoCov">          0 :         SetMSUB(94,1);             // double diffraction</span>
<span class="lineNum">     309 </span><span class="lineNoCov">          0 :         SetMSUB(95,1);             // low pt production</span>
<span class="lineNum">     310 </span>            : 
<span class="lineNum">     311 </span><span class="lineNoCov">          0 :         SetMSUB(14,1);             //</span>
<span class="lineNum">     312 </span><span class="lineNoCov">          0 :         SetMSUB(18,1);             //</span>
<span class="lineNum">     313 </span><span class="lineNoCov">          0 :         SetMSUB(29,1);             //</span>
<span class="lineNum">     314 </span><span class="lineNoCov">          0 :         SetMSUB(114,1);            //</span>
<span class="lineNum">     315 </span><span class="lineNoCov">          0 :         SetMSUB(115,1);            //</span>
<span class="lineNum">     316 </span>            : 
<span class="lineNum">     317 </span>            : 
<span class="lineNum">     318 </span><span class="lineNoCov">          0 :         AtlasTuning();</span>
<span class="lineNum">     319 </span><span class="lineNoCov">          0 :         break;</span>
<span class="lineNum">     320 </span>            : 
<span class="lineNum">     321 </span>            :     case kPyMbDefault:
<span class="lineNum">     322 </span>            : // Minimum Bias pp-Collisions
<span class="lineNum">     323 </span>            : //
<span class="lineNum">     324 </span>            : //   
<span class="lineNum">     325 </span>            : //      select Pythia min. bias model
<span class="lineNum">     326 </span><span class="lineNoCov">          0 :         SetMSEL(0);</span>
<span class="lineNum">     327 </span><span class="lineNoCov">          0 :         SetMSUB(92,1);             // single diffraction AB--&gt;XB</span>
<span class="lineNum">     328 </span><span class="lineNoCov">          0 :         SetMSUB(93,1);             // single diffraction AB--&gt;AX</span>
<span class="lineNum">     329 </span><span class="lineNoCov">          0 :         SetMSUB(94,1);             // double diffraction</span>
<span class="lineNum">     330 </span><span class="lineNoCov">          0 :         SetMSUB(95,1);             // low pt production</span>
<span class="lineNum">     331 </span><span class="lineNoCov">          0 :         break;</span>
<span class="lineNum">     332 </span>            :     case kPyLhwgMb:
<span class="lineNum">     333 </span>            : // Les Houches Working Group 05 Minimum Bias pp-Collisions: hep-ph/0604120
<span class="lineNum">     334 </span>            : //  -&gt; Pythia 6.3 or above is needed
<span class="lineNum">     335 </span>            : //   
<span class="lineNum">     336 </span><span class="lineNoCov">          0 :         SetMSEL(0);</span>
<span class="lineNum">     337 </span><span class="lineNoCov">          0 :         SetMSUB(92,1);             // single diffraction AB--&gt;XB</span>
<span class="lineNum">     338 </span><span class="lineNoCov">          0 :         SetMSUB(93,1);             // single diffraction AB--&gt;AX</span>
<span class="lineNum">     339 </span><span class="lineNoCov">          0 :         SetMSUB(94,1);             // double diffraction</span>
<span class="lineNum">     340 </span><span class="lineNoCov">          0 :         SetMSUB(95,1);             // low pt production</span>
<span class="lineNum">     341 </span>            : 
<span class="lineNum">     342 </span><span class="lineNoCov">          0 :         SetMSTP(51,AliStructFuncType::PDFsetIndex(kCTEQ6ll));      // CTEQ6ll pdf</span>
<span class="lineNum">     343 </span><span class="lineNoCov">          0 :         SetMSTP(52,2);</span>
<span class="lineNum">     344 </span><span class="lineNoCov">          0 :         SetMSTP(68,1);</span>
<span class="lineNum">     345 </span><span class="lineNoCov">          0 :         SetMSTP(70,2);</span>
<span class="lineNum">     346 </span><span class="lineNoCov">          0 :         SetMSTP(81,1);             // Multiple Interactions ON</span>
<span class="lineNum">     347 </span><span class="lineNoCov">          0 :         SetMSTP(82,4);             // Double Gaussian Model</span>
<span class="lineNum">     348 </span><span class="lineNoCov">          0 :         SetMSTP(88,1);</span>
<span class="lineNum">     349 </span>            : 
<span class="lineNum">     350 </span><span class="lineNoCov">          0 :         SetPARP(82,2.3);           // [GeV]    PT_min at Ref. energy</span>
<span class="lineNum">     351 </span><span class="lineNoCov">          0 :         SetPARP(83,0.5);           // Core density in proton matter distribution (def.value)</span>
<span class="lineNum">     352 </span><span class="lineNoCov">          0 :         SetPARP(84,0.5);           // Core radius</span>
<span class="lineNum">     353 </span><span class="lineNoCov">          0 :         SetPARP(85,0.9);           // Regulates gluon prod. mechanism</span>
<span class="lineNum">     354 </span><span class="lineNoCov">          0 :         SetPARP(90,0.2);           // 2*epsilon (exponent in power law)</span>
<span class="lineNum">     355 </span>            : 
<span class="lineNum">     356 </span><span class="lineNoCov">          0 :         break;</span>
<span class="lineNum">     357 </span>            :     case kPyMbNonDiffr:
<span class="lineNum">     358 </span>            : // Minimum Bias pp-Collisions
<span class="lineNum">     359 </span>            : //
<span class="lineNum">     360 </span>            : //   
<span class="lineNum">     361 </span>            : //      select Pythia min. bias model
<span class="lineNum">     362 </span><span class="lineNoCov">          0 :         SetMSEL(0);</span>
<span class="lineNum">     363 </span><span class="lineNoCov">          0 :         SetMSUB(95,1);             // low pt production</span>
<span class="lineNum">     364 </span>            : 
<span class="lineNum">     365 </span><span class="lineNoCov">          0 :         AtlasTuning();</span>
<span class="lineNum">     366 </span><span class="lineNoCov">          0 :         break;</span>
<span class="lineNum">     367 </span>            :     case kPyMbMSEL1:
<span class="lineNum">     368 </span><span class="lineNoCov">          0 :         ConfigHeavyFlavor();</span>
<span class="lineNum">     369 </span>            : // Intrinsic &lt;kT^2&gt;
<span class="lineNum">     370 </span><span class="lineNoCov">          0 :         SetMSTP(91,1);// Width (1=gaussian) primordial kT dist. inside hadrons</span>
<span class="lineNum">     371 </span><span class="lineNoCov">          0 :         SetPARP(91,1.);     // &lt;kT^2&gt; = PARP(91,1.)^2</span>
<span class="lineNum">     372 </span><span class="lineNoCov">          0 :         SetPARP(93,5.);     // Upper cut-off</span>
<span class="lineNum">     373 </span>            : // Set Q-quark mass
<span class="lineNum">     374 </span><span class="lineNoCov">          0 :         SetPMAS(4,1,1.2);   // Charm quark mass</span>
<span class="lineNum">     375 </span><span class="lineNoCov">          0 :         SetPMAS(5,1,4.78);  // Beauty quark mass</span>
<span class="lineNum">     376 </span><span class="lineNoCov">          0 :         SetPARP(71,4.);     // Defaut value</span>
<span class="lineNum">     377 </span>            : // Atlas Tuning
<span class="lineNum">     378 </span><span class="lineNoCov">          0 :         AtlasTuning();</span>
<span class="lineNum">     379 </span><span class="lineNoCov">          0 :         break;</span>
<span class="lineNum">     380 </span>            :     case kPyJets:
<span class="lineNum">     381 </span>            : //
<span class="lineNum">     382 </span>            : //  QCD Jets
<span class="lineNum">     383 </span>            : //
<span class="lineNum">     384 </span><span class="lineNoCov">          0 :         SetMSEL(1);</span>
<span class="lineNum">     385 </span>            : 
<span class="lineNum">     386 </span>            :  // Pythia Tune A (CDF)
<span class="lineNum">     387 </span>            :  //
<span class="lineNum">     388 </span><span class="lineNoCov">          0 :         if (fItune &lt; 0) {</span>
<span class="lineNum">     389 </span><span class="lineNoCov">          0 :           SetPARP(67,2.5);           // Regulates Initial State Radiation (value from best fit to D0 dijet analysis)</span>
<span class="lineNum">     390 </span><span class="lineNoCov">          0 :           SetMSTP(82,4);             // Double Gaussian Model</span>
<span class="lineNum">     391 </span><span class="lineNoCov">          0 :           SetPARP(82,2.0);           // [GeV]    PT_min at Ref. energy</span>
<span class="lineNum">     392 </span><span class="lineNoCov">          0 :           SetPARP(84,0.4);           // Core radius</span>
<span class="lineNum">     393 </span><span class="lineNoCov">          0 :           SetPARP(85,0.90) ;         // Regulates gluon prod. mechanism</span>
<span class="lineNum">     394 </span><span class="lineNoCov">          0 :           SetPARP(86,0.95);          // Regulates gluon prod. mechanism</span>
<span class="lineNum">     395 </span><span class="lineNoCov">          0 :           SetPARP(89,1800.);         // [GeV]   Ref. energy</span>
<span class="lineNum">     396 </span><span class="lineNoCov">          0 :           SetPARP(90,0.25);          // 2*epsilon (exponent in power law)</span>
<span class="lineNum">     397 </span><span class="lineNoCov">          0 :         }</span>
<span class="lineNum">     398 </span>            :           break;
<span class="lineNum">     399 </span>            :     case kPyDirectGamma:
<span class="lineNum">     400 </span><span class="lineNoCov">          0 :         SetMSEL(10);</span>
<span class="lineNum">     401 </span><span class="lineNoCov">          0 :         break;</span>
<span class="lineNum">     402 </span>            :     case kPyCharmPbPbMNR:
<span class="lineNum">     403 </span>            :     case kPyD0PbPbMNR:
<span class="lineNum">     404 </span>            :     case kPyDPlusPbPbMNR:
<span class="lineNum">     405 </span>            :     case kPyDPlusStrangePbPbMNR:
<span class="lineNum">     406 </span>            :       // Tuning of Pythia parameters aimed to get a resonable agreement
<span class="lineNum">     407 </span>            :       // between with the NLO calculation by Mangano, Nason, Ridolfi for the
<span class="lineNum">     408 </span>            :       // c-cbar single inclusive and double differential distributions.
<span class="lineNum">     409 </span>            :       // This parameter settings are meant to work with Pb-Pb collisions
<span class="lineNum">     410 </span>            :       // (AliGenPythia::SetNuclei) and with kCTEQ4L PDFs.
<span class="lineNum">     411 </span>            :       // To get a good agreement the minimum ptHard (AliGenPythia::SetPtHard)
<span class="lineNum">     412 </span>            :       // has to be set to 2.1GeV. Example in ConfigCharmPPR.C.
<span class="lineNum">     413 </span><span class="lineNoCov">          0 :         ConfigHeavyFlavor();</span>
<span class="lineNum">     414 </span>            :       // Intrinsic &lt;kT&gt;
<span class="lineNum">     415 </span><span class="lineNoCov">          0 :       SetMSTP(91,1);</span>
<span class="lineNum">     416 </span><span class="lineNoCov">          0 :       SetPARP(91,1.304);</span>
<span class="lineNum">     417 </span><span class="lineNoCov">          0 :       SetPARP(93,6.52);</span>
<span class="lineNum">     418 </span>            :       // Set c-quark mass
<span class="lineNum">     419 </span><span class="lineNoCov">          0 :       SetPMAS(4,1,1.2);</span>
<span class="lineNum">     420 </span><span class="lineNoCov">          0 :       break;</span>
<span class="lineNum">     421 </span>            :     case kPyCharmpPbMNR:
<span class="lineNum">     422 </span>            :     case kPyD0pPbMNR:
<span class="lineNum">     423 </span>            :     case kPyDPluspPbMNR:
<span class="lineNum">     424 </span>            :     case kPyDPlusStrangepPbMNR:
<span class="lineNum">     425 </span>            :       // Tuning of Pythia parameters aimed to get a resonable agreement
<span class="lineNum">     426 </span>            :       // between with the NLO calculation by Mangano, Nason, Ridolfi for the
<span class="lineNum">     427 </span>            :       // c-cbar single inclusive and double differential distributions.
<span class="lineNum">     428 </span>            :       // This parameter settings are meant to work with p-Pb collisions
<span class="lineNum">     429 </span>            :       // (AliGenPythia::SetNuclei) and with kCTEQ4L PDFs.
<span class="lineNum">     430 </span>            :       // To get a good agreement the minimum ptHard (AliGenPythia::SetPtHard)
<span class="lineNum">     431 </span>            :       // has to be set to 2.1GeV. Example in ConfigCharmPPR.C.
<span class="lineNum">     432 </span><span class="lineNoCov">          0 :         ConfigHeavyFlavor();</span>
<span class="lineNum">     433 </span>            :       // Intrinsic &lt;kT&gt;
<span class="lineNum">     434 </span><span class="lineNoCov">          0 :         SetMSTP(91,1);</span>
<span class="lineNum">     435 </span><span class="lineNoCov">          0 :         SetPARP(91,1.16);</span>
<span class="lineNum">     436 </span><span class="lineNoCov">          0 :         SetPARP(93,5.8);</span>
<span class="lineNum">     437 </span>            :         
<span class="lineNum">     438 </span>            :       // Set c-quark mass
<span class="lineNum">     439 </span><span class="lineNoCov">          0 :         SetPMAS(4,1,1.2);</span>
<span class="lineNum">     440 </span><span class="lineNoCov">          0 :       break;</span>
<span class="lineNum">     441 </span>            :     case kPyCharmppMNR:
<span class="lineNum">     442 </span>            :     case kPyD0ppMNR:
<span class="lineNum">     443 </span>            :     case kPyDPlusppMNR:
<span class="lineNum">     444 </span>            :     case kPyDPlusStrangeppMNR:
<span class="lineNum">     445 </span>            :     case kPyLambdacppMNR:
<span class="lineNum">     446 </span>            :       // Tuning of Pythia parameters aimed to get a resonable agreement
<span class="lineNum">     447 </span>            :       // between with the NLO calculation by Mangano, Nason, Ridolfi for the
<span class="lineNum">     448 </span>            :       // c-cbar single inclusive and double differential distributions.
<span class="lineNum">     449 </span>            :       // This parameter settings are meant to work with pp collisions
<span class="lineNum">     450 </span>            :       // (AliGenPythia::SetNuclei) and with kCTEQ4L PDFs.
<span class="lineNum">     451 </span>            :       // To get a good agreement the minimum ptHard (AliGenPythia::SetPtHard)
<span class="lineNum">     452 </span>            :       // has to be set to 2.1GeV. Example in ConfigCharmPPR.C.
<span class="lineNum">     453 </span><span class="lineNoCov">          0 :         ConfigHeavyFlavor();</span>
<span class="lineNum">     454 </span>            :       // Intrinsic &lt;kT^2&gt;
<span class="lineNum">     455 </span><span class="lineNoCov">          0 :         SetMSTP(91,1);</span>
<span class="lineNum">     456 </span><span class="lineNoCov">          0 :         SetPARP(91,1.);</span>
<span class="lineNum">     457 </span><span class="lineNoCov">          0 :         SetPARP(93,5.);</span>
<span class="lineNum">     458 </span>            :         
<span class="lineNum">     459 </span>            :       // Set c-quark mass
<span class="lineNum">     460 </span><span class="lineNoCov">          0 :         SetPMAS(4,1,1.2);</span>
<span class="lineNum">     461 </span><span class="lineNoCov">          0 :       break;</span>
<span class="lineNum">     462 </span>            :     case kPyCharmppMNRwmi:
<span class="lineNum">     463 </span>            :       // Tuning of Pythia parameters aimed to get a resonable agreement
<span class="lineNum">     464 </span>            :       // between with the NLO calculation by Mangano, Nason, Ridolfi for the
<span class="lineNum">     465 </span>            :       // c-cbar single inclusive and double differential distributions.
<span class="lineNum">     466 </span>            :       // This parameter settings are meant to work with pp collisions
<span class="lineNum">     467 </span>            :       // and with kCTEQ5L PDFs.
<span class="lineNum">     468 </span>            :       // Added multiple interactions according to ATLAS tune settings.
<span class="lineNum">     469 </span>            :       // To get a &quot;reasonable&quot; agreement with MNR results, events have to be 
<span class="lineNum">     470 </span>            :       // generated with the minimum ptHard (AliGenPythia::SetPtHard)
<span class="lineNum">     471 </span>            :       // set to 2.76 GeV.
<span class="lineNum">     472 </span>            :       // To get a &quot;perfect&quot; agreement with MNR results, events have to be 
<span class="lineNum">     473 </span>            :       // generated in four ptHard bins with the following relative 
<span class="lineNum">     474 </span>            :       // normalizations:
<span class="lineNum">     475 </span>            :       // 2.76-3 GeV: 25%
<span class="lineNum">     476 </span>            :       //    3-4 GeV: 40%
<span class="lineNum">     477 </span>            :       //    4-8 GeV: 29%
<span class="lineNum">     478 </span>            :       //     &gt;8 GeV:  6%
<span class="lineNum">     479 </span><span class="lineNoCov">          0 :         ConfigHeavyFlavor();</span>
<span class="lineNum">     480 </span>            :       // Intrinsic &lt;kT^2&gt;
<span class="lineNum">     481 </span><span class="lineNoCov">          0 :         SetMSTP(91,1);</span>
<span class="lineNum">     482 </span><span class="lineNoCov">          0 :         SetPARP(91,1.);</span>
<span class="lineNum">     483 </span><span class="lineNoCov">          0 :         SetPARP(93,5.);</span>
<span class="lineNum">     484 </span>            : 
<span class="lineNum">     485 </span>            :       // Set c-quark mass
<span class="lineNum">     486 </span><span class="lineNoCov">          0 :         SetPMAS(4,1,1.2);</span>
<span class="lineNum">     487 </span><span class="lineNoCov">          0 :         AtlasTuning();</span>
<span class="lineNum">     488 </span><span class="lineNoCov">          0 :         break;</span>
<span class="lineNum">     489 </span>            :     case kPyBeautyPbPbMNR:
<span class="lineNum">     490 </span>            :       // Tuning of Pythia parameters aimed to get a resonable agreement
<span class="lineNum">     491 </span>            :       // between with the NLO calculation by Mangano, Nason, Ridolfi for the
<span class="lineNum">     492 </span>            :       // b-bbar single inclusive and double differential distributions.
<span class="lineNum">     493 </span>            :       // This parameter settings are meant to work with Pb-Pb collisions
<span class="lineNum">     494 </span>            :       // (AliGenPythia::SetNuclei) and with kCTEQ4L PDFs.
<span class="lineNum">     495 </span>            :       // To get a good agreement the minimum ptHard (AliGenPythia::SetPtHard)
<span class="lineNum">     496 </span>            :       // has to be set to 2.75GeV. Example in ConfigBeautyPPR.C.
<span class="lineNum">     497 </span><span class="lineNoCov">          0 :         ConfigHeavyFlavor();</span>
<span class="lineNum">     498 </span>            :       // QCD scales
<span class="lineNum">     499 </span><span class="lineNoCov">          0 :         SetPARP(67,1.0);</span>
<span class="lineNum">     500 </span><span class="lineNoCov">          0 :         SetPARP(71,1.0);</span>
<span class="lineNum">     501 </span>            :       // Intrinsic &lt;kT&gt;
<span class="lineNum">     502 </span><span class="lineNoCov">          0 :         SetMSTP(91,1);</span>
<span class="lineNum">     503 </span><span class="lineNoCov">          0 :         SetPARP(91,2.035);</span>
<span class="lineNum">     504 </span><span class="lineNoCov">          0 :         SetPARP(93,10.17);</span>
<span class="lineNum">     505 </span>            :       // Set b-quark mass
<span class="lineNum">     506 </span><span class="lineNoCov">          0 :         SetPMAS(5,1,4.75);</span>
<span class="lineNum">     507 </span><span class="lineNoCov">          0 :       break;</span>
<span class="lineNum">     508 </span>            :     case kPyBeautypPbMNR:
<span class="lineNum">     509 </span>            :       // Tuning of Pythia parameters aimed to get a resonable agreement
<span class="lineNum">     510 </span>            :       // between with the NLO calculation by Mangano, Nason, Ridolfi for the
<span class="lineNum">     511 </span>            :       // b-bbar single inclusive and double differential distributions.
<span class="lineNum">     512 </span>            :       // This parameter settings are meant to work with p-Pb collisions
<span class="lineNum">     513 </span>            :       // (AliGenPythia::SetNuclei) and with kCTEQ4L PDFs.
<span class="lineNum">     514 </span>            :       // To get a good agreement the minimum ptHard (AliGenPythia::SetPtHard)
<span class="lineNum">     515 </span>            :       // has to be set to 2.75GeV. Example in ConfigBeautyPPR.C.
<span class="lineNum">     516 </span><span class="lineNoCov">          0 :         ConfigHeavyFlavor();</span>
<span class="lineNum">     517 </span>            :       // QCD scales
<span class="lineNum">     518 </span><span class="lineNoCov">          0 :         SetPARP(67,1.0);</span>
<span class="lineNum">     519 </span><span class="lineNoCov">          0 :         SetPARP(71,1.0);</span>
<span class="lineNum">     520 </span>            :       // Intrinsic &lt;kT&gt;
<span class="lineNum">     521 </span><span class="lineNoCov">          0 :         SetMSTP(91,1);</span>
<span class="lineNum">     522 </span><span class="lineNoCov">          0 :         SetPARP(91,1.60);</span>
<span class="lineNum">     523 </span><span class="lineNoCov">          0 :         SetPARP(93,8.00);</span>
<span class="lineNum">     524 </span>            :       // Set b-quark mass
<span class="lineNum">     525 </span><span class="lineNoCov">          0 :         SetPMAS(5,1,4.75);</span>
<span class="lineNum">     526 </span><span class="lineNoCov">          0 :       break;</span>
<span class="lineNum">     527 </span>            :     case kPyBeautyppMNR:
<span class="lineNum">     528 </span>            :       // Tuning of Pythia parameters aimed to get a resonable agreement
<span class="lineNum">     529 </span>            :       // between with the NLO calculation by Mangano, Nason, Ridolfi for the
<span class="lineNum">     530 </span>            :       // b-bbar single inclusive and double differential distributions.
<span class="lineNum">     531 </span>            :       // This parameter settings are meant to work with pp collisions
<span class="lineNum">     532 </span>            :       // (AliGenPythia::SetNuclei) and with kCTEQ4L PDFs.
<span class="lineNum">     533 </span>            :       // To get a good agreement the minimum ptHard (AliGenPythia::SetPtHard)
<span class="lineNum">     534 </span>            :       // has to be set to 2.75GeV. Example in ConfigBeautyPPR.C.
<span class="lineNum">     535 </span><span class="lineNoCov">          0 :         ConfigHeavyFlavor();</span>
<span class="lineNum">     536 </span>            :       // QCD scales
<span class="lineNum">     537 </span><span class="lineNoCov">          0 :         SetPARP(67,1.0);</span>
<span class="lineNum">     538 </span><span class="lineNoCov">          0 :         SetPARP(71,1.0);</span>
<span class="lineNum">     539 </span>            :         
<span class="lineNum">     540 </span>            :         // Intrinsic &lt;kT&gt;
<span class="lineNum">     541 </span><span class="lineNoCov">          0 :         SetMSTP(91,1);</span>
<span class="lineNum">     542 </span><span class="lineNoCov">          0 :         SetPARP(91,1.);</span>
<span class="lineNum">     543 </span><span class="lineNoCov">          0 :         SetPARP(93,5.);</span>
<span class="lineNum">     544 </span>            :         
<span class="lineNum">     545 </span>            :         // Set b-quark mass
<span class="lineNum">     546 </span><span class="lineNoCov">          0 :         SetPMAS(5,1,4.75);</span>
<span class="lineNum">     547 </span><span class="lineNoCov">          0 :       break;</span>
<span class="lineNum">     548 </span>            :      case kPyBeautyJets:
<span class="lineNum">     549 </span>            :      case kPyBeautyppMNRwmi:
<span class="lineNum">     550 </span>            :       // Tuning of Pythia parameters aimed to get a resonable agreement
<span class="lineNum">     551 </span>            :       // between with the NLO calculation by Mangano, Nason, Ridolfi for the
<span class="lineNum">     552 </span>            :       // b-bbar single inclusive and double differential distributions.
<span class="lineNum">     553 </span>            :       // This parameter settings are meant to work with pp collisions
<span class="lineNum">     554 </span>            :       // and with kCTEQ5L PDFs.
<span class="lineNum">     555 </span>            :       // Added multiple interactions according to ATLAS tune settings.
<span class="lineNum">     556 </span>            :       // To get a &quot;reasonable&quot; agreement with MNR results, events have to be 
<span class="lineNum">     557 </span>            :       // generated with the minimum ptHard (AliGenPythia::SetPtHard)
<span class="lineNum">     558 </span>            :       // set to 2.76 GeV.
<span class="lineNum">     559 </span>            :       // To get a &quot;perfect&quot; agreement with MNR results, events have to be 
<span class="lineNum">     560 </span>            :       // generated in four ptHard bins with the following relative 
<span class="lineNum">     561 </span>            :       // normalizations:
<span class="lineNum">     562 </span>            :       // 2.76-4 GeV:  5% 
<span class="lineNum">     563 </span>            :       //    4-6 GeV: 31%
<span class="lineNum">     564 </span>            :       //    6-8 GeV: 28%
<span class="lineNum">     565 </span>            :       //     &gt;8 GeV: 36%
<span class="lineNum">     566 </span><span class="lineNoCov">          0 :          ConfigHeavyFlavor();</span>
<span class="lineNum">     567 </span>            :       // QCD scales
<span class="lineNum">     568 </span><span class="lineNoCov">          0 :          SetPARP(67,1.0);</span>
<span class="lineNum">     569 </span><span class="lineNoCov">          0 :          SetPARP(71,1.0);</span>
<span class="lineNum">     570 </span>            :          
<span class="lineNum">     571 </span>            :          // Intrinsic &lt;kT&gt;
<span class="lineNum">     572 </span><span class="lineNoCov">          0 :          SetMSTP(91,1);</span>
<span class="lineNum">     573 </span><span class="lineNoCov">          0 :          SetPARP(91,1.);</span>
<span class="lineNum">     574 </span><span class="lineNoCov">          0 :          SetPARP(93,5.);</span>
<span class="lineNum">     575 </span>            : 
<span class="lineNum">     576 </span>            :       // Set b-quark mass
<span class="lineNum">     577 </span><span class="lineNoCov">          0 :          SetPMAS(5,1,4.75);</span>
<span class="lineNum">     578 </span>            : 
<span class="lineNum">     579 </span><span class="lineNoCov">          0 :          AtlasTuning();</span>
<span class="lineNum">     580 </span><span class="lineNoCov">          0 :          break; </span>
<span class="lineNum">     581 </span>            :     case kPyW:
<span class="lineNum">     582 </span>            : 
<span class="lineNum">     583 </span>            :       //Inclusive production of W+/-
<span class="lineNum">     584 </span><span class="lineNoCov">          0 :       SetMSEL(0);</span>
<span class="lineNum">     585 </span>            :       //f fbar -&gt; W+ 
<span class="lineNum">     586 </span><span class="lineNoCov">          0 :       SetMSUB(2,1);</span>
<span class="lineNum">     587 </span>            :       //        //f fbar -&gt; g W+
<span class="lineNum">     588 </span>            :       //        SetMSUB(16,1);
<span class="lineNum">     589 </span>            :       //        //f fbar -&gt; gamma W+
<span class="lineNum">     590 </span>            :       //        SetMSUB(20,1);
<span class="lineNum">     591 </span>            :       //        //f g -&gt; f W+  
<span class="lineNum">     592 </span>            :       //        SetMSUB(31,1);
<span class="lineNum">     593 </span>            :       //        //f gamma -&gt; f W+
<span class="lineNum">     594 </span>            :       //        SetMSUB(36,1);
<span class="lineNum">     595 </span>            :       
<span class="lineNum">     596 </span>            :       // Initial/final parton shower on (Pythia default)
<span class="lineNum">     597 </span>            :       // With parton showers on we are generating &quot;W inclusive process&quot;
<span class="lineNum">     598 </span><span class="lineNoCov">          0 :       SetMSTP(61,1); //Initial QCD &amp; QED showers on</span>
<span class="lineNum">     599 </span><span class="lineNoCov">          0 :       SetMSTP(71,1); //Final QCD &amp; QED showers on</span>
<span class="lineNum">     600 </span>            :       
<span class="lineNum">     601 </span><span class="lineNoCov">          0 :       break;  </span>
<span class="lineNum">     602 </span>            : 
<span class="lineNum">     603 </span>            :     case kPyZ:
<span class="lineNum">     604 </span>            : 
<span class="lineNum">     605 </span>            :       //Inclusive production of Z
<span class="lineNum">     606 </span><span class="lineNoCov">          0 :       SetMSEL(0);</span>
<span class="lineNum">     607 </span>            :       //f fbar -&gt; Z/gamma
<span class="lineNum">     608 </span><span class="lineNoCov">          0 :       SetMSUB(1,1);</span>
<span class="lineNum">     609 </span>            :       
<span class="lineNum">     610 </span>            :       //       // f fbar -&gt; g Z/gamma
<span class="lineNum">     611 </span>            :       //       SetMSUB(15,1);
<span class="lineNum">     612 </span>            :       //       // f fbar -&gt; gamma Z/gamma
<span class="lineNum">     613 </span>            :       //       SetMSUB(19,1);
<span class="lineNum">     614 </span>            :       //       // f g -&gt; f Z/gamma
<span class="lineNum">     615 </span>            :       //       SetMSUB(30,1);
<span class="lineNum">     616 </span>            :       //       // f gamma -&gt; f Z/gamma
<span class="lineNum">     617 </span>            :       //       SetMSUB(35,1);
<span class="lineNum">     618 </span>            :       
<span class="lineNum">     619 </span>            :       //only Z included, not gamma
<span class="lineNum">     620 </span><span class="lineNoCov">          0 :       SetMSTP(43,2);</span>
<span class="lineNum">     621 </span>            :       
<span class="lineNum">     622 </span>            :       // Initial/final parton shower on (Pythia default)
<span class="lineNum">     623 </span>            :       // With parton showers on we are generating &quot;Z inclusive process&quot;
<span class="lineNum">     624 </span><span class="lineNoCov">          0 :       SetMSTP(61,1); //Initial QCD &amp; QED showers on</span>
<span class="lineNum">     625 </span><span class="lineNoCov">          0 :       SetMSTP(71,1); //Final QCD &amp; QED showers on</span>
<span class="lineNum">     626 </span>            :       
<span class="lineNum">     627 </span><span class="lineNoCov">          0 :       break;  </span>
<span class="lineNum">     628 </span>            :     case kPyZgamma:
<span class="lineNum">     629 </span>            :         //Inclusive production of Z
<span class="lineNum">     630 </span><span class="lineNoCov">          0 :         SetMSEL(0);</span>
<span class="lineNum">     631 </span>            :         //f fbar -&gt; Z/gamma
<span class="lineNum">     632 </span><span class="lineNoCov">          0 :         SetMSUB(1,1);</span>
<span class="lineNum">     633 </span>            :         // Initial/final parton shower on (Pythia default)
<span class="lineNum">     634 </span>            :         // With parton showers on we are generating &quot;Z inclusive process&quot;
<span class="lineNum">     635 </span><span class="lineNoCov">          0 :         SetMSTP(61,1); //Initial QCD &amp; QED showers on</span>
<span class="lineNum">     636 </span><span class="lineNoCov">          0 :         SetMSTP(71,1); //Final QCD &amp; QED showers on</span>
<span class="lineNum">     637 </span><span class="lineNoCov">          0 :       break;  </span>
<span class="lineNum">     638 </span>            :       case kPyMBRSingleDiffraction:
<span class="lineNum">     639 </span>            :       case kPyMBRDoubleDiffraction:
<span class="lineNum">     640 </span>            :       case kPyMBRCentralDiffraction:
<span class="lineNum">     641 </span>            :       break;
<span class="lineNum">     642 </span>            :       case kPyJetsPWHG:
<span class="lineNum">     643 </span>            :       //    N.B.
<span class="lineNum">     644 </span>            :       //    ====
<span class="lineNum">     645 </span>            :       //    For the case of jet production the following parameter setting
<span class="lineNum">     646 </span>            :       //    limits the transverse momentum of secondary scatterings, due
<span class="lineNum">     647 </span>            :       //    to multiple parton interactions, to be less than that of the
<span class="lineNum">     648 </span>            :       //    primary interaction (see POWHEG Dijet paper arXiv:1012.3380
<span class="lineNum">     649 </span>            :       //    [hep-ph] sec. 4.1 and also the PYTHIA Manual).
<span class="lineNum">     650 </span><span class="lineNoCov">          0 :       SetMSTP(86,1);</span>
<span class="lineNum">     651 </span>            :       
<span class="lineNum">     652 </span>            :       //    maximum number of errors before pythia aborts (def=10)
<span class="lineNum">     653 </span><span class="lineNoCov">          0 :       SetMSTU(22,10);</span>
<span class="lineNum">     654 </span>            :       //    number of warnings printed on the shell
<span class="lineNum">     655 </span><span class="lineNoCov">          0 :       SetMSTU(26,20);</span>
<span class="lineNum">     656 </span><span class="lineNoCov">          0 :       break;</span>
<span class="lineNum">     657 </span>            :     
<span class="lineNum">     658 </span>            :       case kPyCharmPWHG:
<span class="lineNum">     659 </span>            :       case kPyBeautyPWHG:
<span class="lineNum">     660 </span>            :       case kPyWPWHG:
<span class="lineNum">     661 </span>            :       //    number of warnings printed on the shell
<span class="lineNum">     662 </span><span class="lineNoCov">          0 :       SetMSTU(26,20);</span>
<span class="lineNum">     663 </span>            :             
<span class="lineNum">     664 </span><span class="lineNoCov">          0 :       break;</span>
<span class="lineNum">     665 </span>            :     }
<span class="lineNum">     666 </span>            : //
<span class="lineNum">     667 </span>            : //  Initialize PYTHIA
<span class="lineNum">     668 </span>            : //
<span class="lineNum">     669 </span>            : //  Select the tune
<span class="lineNum">     670 </span><span class="lineNoCov">          0 :     if (itune &gt; -1) {</span>
<span class="lineNum">     671 </span><span class="lineNoCov">          0 :       Pytune(itune);</span>
<span class="lineNum">     672 </span><span class="lineNoCov">          0 :       if (GetMSTP(192) &gt; 1 || GetMSTP(193) &gt; 1) {</span>
<span class="lineNum">     673 </span><span class="lineNoCov">          0 :         AliWarning(Form(&quot;Structure function for tune %5d set to %5s\n&quot;, </span>
<span class="lineNum">     674 </span>            :                         itune,  AliStructFuncType::PDFsetName(strucfunc).Data()));
<span class="lineNum">     675 </span><span class="lineNoCov">          0 :         SetMSTP(52,2);</span>
<span class="lineNum">     676 </span><span class="lineNoCov">          0 :         SetMSTP(51, AliStructFuncType::PDFsetIndex(strucfunc));</span>
<span class="lineNum">     677 </span><span class="lineNoCov">          0 :       }</span>
<span class="lineNum">     678 </span>            :     }
<span class="lineNum">     679 </span>            : //  
<span class="lineNum">     680 </span><span class="lineNoCov">          0 :     SetMSTP(41,1);   // all resonance decays switched on</span>
<span class="lineNum">     681 </span><span class="lineNoCov">          0 :     if (process == kPyJetsPWHG || process == kPyCharmPWHG || process == kPyBeautyPWHG || process == kPyWPWHG) {</span>
<span class="lineNum">     682 </span><span class="lineNoCov">          0 :       Initialize(&quot;USER&quot;,&quot;&quot;,&quot;&quot;,0.);</span>
<span class="lineNum">     683 </span><span class="lineNoCov">          0 :     } else {    </span>
<span class="lineNum">     684 </span><span class="lineNoCov">          0 :       Initialize(&quot;CMS&quot;,fProjectile,fTarget,fEcms);</span>
<span class="lineNum">     685 </span>            :     }
<span class="lineNum">     686 </span><span class="lineNoCov">          0 :     fOmegaDalitz.Init();</span>
<span class="lineNum">     687 </span><span class="lineNoCov">          0 :     fExodus.Init();</span>
<a name="688"><span class="lineNum">     688 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     689 </span>            : 
<span class="lineNum">     690 </span>            : Int_t AliPythia::CheckedLuComp(Int_t kf)
<span class="lineNum">     691 </span>            : {
<span class="lineNum">     692 </span>            : // Check Lund particle code (for debugging)
<span class="lineNum">     693 </span><span class="lineNoCov">          0 :     Int_t kc=Pycomp(kf);</span>
<span class="lineNum">     694 </span><span class="lineNoCov">          0 :     printf(&quot;\n Lucomp kf,kc %d %d&quot;,kf,kc);</span>
<span class="lineNum">     695 </span><span class="lineNoCov">          0 :     return kc;</span>
<a name="696"><span class="lineNum">     696 </span>            : }</a>
<span class="lineNum">     697 </span>            : 
<span class="lineNum">     698 </span>            : void AliPythia::SetNuclei(Int_t a1, Int_t a2, Int_t pdf)
<span class="lineNum">     699 </span>            : {
<span class="lineNum">     700 </span>            : // Treat protons as inside nuclei with mass numbers a1 and a2  
<span class="lineNum">     701 </span>            : //    The MSTP array in the PYPARS common block is used to enable and 
<span class="lineNum">     702 </span>            : //    select the nuclear structure functions. 
<span class="lineNum">     703 </span>            : //    MSTP(52)  : (D=1) choice of proton and nuclear structure-function library
<span class="lineNum">     704 </span>            : //            =1: internal PYTHIA acording to MSTP(51) 
<span class="lineNum">     705 </span>            : //            =2: PDFLIB proton  s.f., with MSTP(51)  = 1000xNGROUP+NSET
<span class="lineNum">     706 </span>            : //    If the following mass number both not equal zero, nuclear corrections of the stf are used.
<span class="lineNum">     707 </span>            : //    MSTP(192) : Mass number of nucleus side 1
<span class="lineNum">     708 </span>            : //    MSTP(193) : Mass number of nucleus side 2
<span class="lineNum">     709 </span>            : //    MSTP(194) : Nuclear structure function: 0: EKS98 8:EPS08 9:EPS09LO 19:EPS09NLO
<span class="lineNum">     710 </span><span class="lineNoCov">          0 :     SetMSTP(52,2);</span>
<span class="lineNum">     711 </span><span class="lineNoCov">          0 :     SetMSTP(192, a1);</span>
<span class="lineNum">     712 </span><span class="lineNoCov">          0 :     SetMSTP(193, a2); </span>
<span class="lineNum">     713 </span><span class="lineNoCov">          0 :     SetMSTP(194, pdf);</span>
<span class="lineNum">     714 </span><span class="lineNoCov">          0 : }</span>
<a name="715"><span class="lineNum">     715 </span>            :         </a>
<span class="lineNum">     716 </span>            : 
<span class="lineNum">     717 </span>            : AliPythia* AliPythia::Instance()
<span class="lineNum">     718 </span>            : { 
<span class="lineNum">     719 </span>            : // Set random number generator 
<span class="lineNum">     720 </span><span class="lineCov">          2 :     if (fgAliPythia) {</span>
<span class="lineNum">     721 </span><span class="lineNoCov">          0 :         return fgAliPythia;</span>
<span class="lineNum">     722 </span>            :     } else {
<span class="lineNum">     723 </span><span class="lineCov">          2 :         fgAliPythia = new AliPythia();</span>
<span class="lineNum">     724 </span><span class="lineCov">          1 :         return fgAliPythia;</span>
<span class="lineNum">     725 </span>            :     }
<a name="726"><span class="lineNum">     726 </span><span class="lineCov">          1 : }</span></a>
<span class="lineNum">     727 </span>            : 
<span class="lineNum">     728 </span>            : void AliPythia::PrintParticles()
<span class="lineNum">     729 </span>            : { 
<span class="lineNum">     730 </span>            : // Print list of particl properties
<span class="lineNum">     731 </span>            :     Int_t np = 0;
<span class="lineNum">     732 </span><span class="lineNoCov">          0 :     char*   name = new char[16];    </span>
<span class="lineNum">     733 </span><span class="lineNoCov">          0 :     for (Int_t kf=0; kf&lt;1000000; kf++) {</span>
<span class="lineNum">     734 </span><span class="lineNoCov">          0 :         for (Int_t c = 1;  c &gt; -2; c-=2) {</span>
<span class="lineNum">     735 </span><span class="lineNoCov">          0 :             Int_t kc = Pycomp(c*kf);</span>
<span class="lineNum">     736 </span><span class="lineNoCov">          0 :             if (kc) {</span>
<span class="lineNum">     737 </span><span class="lineNoCov">          0 :                 Float_t mass  = GetPMAS(kc,1);</span>
<span class="lineNum">     738 </span><span class="lineNoCov">          0 :                 Float_t width = GetPMAS(kc,2);  </span>
<span class="lineNum">     739 </span><span class="lineNoCov">          0 :                 Float_t tau   = GetPMAS(kc,4);</span>
<span class="lineNum">     740 </span>            : 
<span class="lineNum">     741 </span><span class="lineNoCov">          0 :                 Pyname(kf,name);</span>
<span class="lineNum">     742 </span>            :         
<span class="lineNum">     743 </span><span class="lineNoCov">          0 :                 np++;</span>
<span class="lineNum">     744 </span>            :                 
<span class="lineNum">     745 </span><span class="lineNoCov">          0 :                 printf(&quot;\n mass, width, tau: %6d %s %10.3f %10.3e %10.3e&quot;, </span>
<span class="lineNum">     746 </span><span class="lineNoCov">          0 :                        c*kf, name, mass, width, tau);</span>
<span class="lineNum">     747 </span><span class="lineNoCov">          0 :             }</span>
<span class="lineNum">     748 </span>            :         }
<span class="lineNum">     749 </span>            :     }
<span class="lineNum">     750 </span><span class="lineNoCov">          0 :     printf(&quot;\n Number of particles %d \n \n&quot;, np);</span>
<a name="751"><span class="lineNum">     751 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     752 </span>            : 
<span class="lineNum">     753 </span>            : void  AliPythia::ResetDecayTable()
<span class="lineNum">     754 </span>            : {
<span class="lineNum">     755 </span>            : //  Set default values for pythia decay switches
<span class="lineNum">     756 </span>            :     Int_t i;
<span class="lineNum">     757 </span><span class="lineCov">       1003 :     for (i = 1; i &lt;  501; i++) SetMDCY(i,1,fDefMDCY[i]);</span>
<span class="lineNum">     758 </span><span class="lineCov">       4002 :     for (i = 1; i &lt; 2001; i++) SetMDME(i,1,fDefMDME[i]);</span>
<a name="759"><span class="lineNum">     759 </span><span class="lineCov">          1 : }</span></a>
<span class="lineNum">     760 </span>            : 
<span class="lineNum">     761 </span>            : void  AliPythia::SetDecayTable()
<span class="lineNum">     762 </span>            : {
<span class="lineNum">     763 </span>            : //  Set default values for pythia decay switches
<span class="lineNum">     764 </span>            : //
<span class="lineNum">     765 </span>            :     Int_t i;
<span class="lineNum">     766 </span><span class="lineCov">       1003 :     for (i = 1; i &lt;  501; i++) fDefMDCY[i] = GetMDCY(i,1);</span>
<span class="lineNum">     767 </span><span class="lineCov">       4002 :     for (i = 1; i &lt; 2001; i++) fDefMDME[i] = GetMDME(i,1);</span>
<a name="768"><span class="lineNum">     768 </span><span class="lineCov">          1 : }</span></a>
<span class="lineNum">     769 </span>            : 
<span class="lineNum">     770 </span>            : void  AliPythia::Pyclus(Int_t&amp; njet)
<span class="lineNum">     771 </span>            : {
<span class="lineNum">     772 </span>            : //  Call Pythia clustering algorithm
<span class="lineNum">     773 </span>            : //
<span class="lineNum">     774 </span><span class="lineNoCov">          0 :     pyclus(njet);</span>
<a name="775"><span class="lineNum">     775 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     776 </span>            : 
<span class="lineNum">     777 </span>            : void  AliPythia::Pycell(Int_t&amp; njet)
<span class="lineNum">     778 </span>            : {
<span class="lineNum">     779 </span>            : //  Call Pythia jet reconstruction algorithm
<span class="lineNum">     780 </span>            : //
<span class="lineNum">     781 </span><span class="lineNoCov">          0 :     pycell(njet);</span>
<a name="782"><span class="lineNum">     782 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     783 </span>            : 
<span class="lineNum">     784 </span>            : void  AliPythia::Pyshow(Int_t ip1, Int_t ip2, Double_t qmax)
<span class="lineNum">     785 </span>            : {
<span class="lineNum">     786 </span>            : //  Call Pythia jet reconstruction algorithm
<span class="lineNum">     787 </span>            : //
<span class="lineNum">     788 </span><span class="lineNoCov">          0 :     pyshow(ip1, ip2, qmax);</span>
<a name="789"><span class="lineNum">     789 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     790 </span>            : 
<span class="lineNum">     791 </span>            : void AliPythia::Pyrobo(Int_t imi, Int_t ima, Double_t the, Double_t phi, Double_t bex, Double_t bey, Double_t bez)
<span class="lineNum">     792 </span>            : {
<span class="lineNum">     793 </span><span class="lineNoCov">          0 :     pyrobo(imi, ima, the, phi, bex, bey, bez);</span>
<a name="794"><span class="lineNum">     794 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     795 </span>            : 
<span class="lineNum">     796 </span>            : void AliPythia::Pytune(Int_t itune)
<span class="lineNum">     797 </span>            : {
<span class="lineNum">     798 </span>            : /*
<span class="lineNum">     799 </span>            : C
<span class="lineNum">     800 </span>            : C ITUNE    NAME (detailed descriptions below)
<span class="lineNum">     801 </span>            : C     0 Default : No settings changed =&gt; linked Pythia version's defaults.
<span class="lineNum">     802 </span>            : C ====== Old UE, Q2-ordered showers ==========================================
<span class="lineNum">     803 </span>            : C   100       A : Rick Field's CDF Tune A 
<span class="lineNum">     804 </span>            : C   101      AW : Rick Field's CDF Tune AW
<span class="lineNum">     805 </span>            : C   102      BW : Rick Field's CDF Tune BW
<span class="lineNum">     806 </span>            : C   103      DW : Rick Field's CDF Tune DW
<span class="lineNum">     807 </span>            : C   104     DWT : Rick Field's CDF Tune DW with slower UE energy scaling
<span class="lineNum">     808 </span>            : C   105      QW : Rick Field's CDF Tune QW (NB: needs CTEQ6.1M pdfs externally)
<span class="lineNum">     809 </span>            : C   106 ATLAS-DC2: Arthur Moraes' (old) ATLAS tune (ATLAS DC2 / Rome)
<span class="lineNum">     810 </span>            : C   107     ACR : Tune A modified with annealing CR
<span class="lineNum">     811 </span>            : C   108      D6 : Rick Field's CDF Tune D6 (NB: needs CTEQ6L pdfs externally)
<span class="lineNum">     812 </span>            : C   109     D6T : Rick Field's CDF Tune D6T (NB: needs CTEQ6L pdfs externally)
<span class="lineNum">     813 </span>            : C ====== Intermediate Models =================================================
<span class="lineNum">     814 </span>            : C   200    IM 1 : Intermediate model: new UE, Q2-ordered showers, annealing CR
<span class="lineNum">     815 </span>            : C   201     APT : Tune A modified to use pT-ordered final-state showers
<span class="lineNum">     816 </span>            : C ====== New UE, interleaved pT-ordered showers, annealing CR ================
<span class="lineNum">     817 </span>            : C   300      S0 : Sandhoff-Skands Tune 0 
<span class="lineNum">     818 </span>            : C   301      S1 : Sandhoff-Skands Tune 1
<span class="lineNum">     819 </span>            : C   302      S2 : Sandhoff-Skands Tune 2
<span class="lineNum">     820 </span>            : C   303     S0A : S0 with &quot;Tune A&quot; UE energy scaling
<span class="lineNum">     821 </span>            : C   304    NOCR : New UE &quot;best try&quot; without colour reconnections
<span class="lineNum">     822 </span>            : C   305     Old : New UE, original (primitive) colour reconnections
<span class="lineNum">     823 </span>            : C   306 ATLAS-CSC: Arthur Moraes' (new) ATLAS tune (needs CTEQ6L externally)
<span class="lineNum">     824 </span>            : C ======= The Uppsala models =================================================
<span class="lineNum">     825 </span>            : C   ( NB! must be run with special modified Pythia 6.215 version )
<span class="lineNum">     826 </span>            : C   ( available from http://www.isv.uu.se/thep/MC/scigal/        )
<span class="lineNum">     827 </span>            : C   400   GAL 0 : Generalized area-law model. Old parameters
<span class="lineNum">     828 </span>            : C   401   SCI 0 : Soft-Colour-Interaction model. Old parameters
<span class="lineNum">     829 </span>            : C   402   GAL 1 : Generalized area-law model. Tevatron MB retuned (Skands)
<span class="lineNum">     830 </span>            : */
<span class="lineNum">     831 </span><span class="lineNoCov">          0 :     pytune(itune);</span>
<a name="832"><span class="lineNum">     832 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     833 </span>            : 
<span class="lineNum">     834 </span>            : void AliPythia::Py2ent(Int_t idx, Int_t pdg1, Int_t pdg2, Double_t p){
<span class="lineNum">     835 </span>            :   // Inset 2-parton system at line idx
<span class="lineNum">     836 </span><span class="lineNoCov">          0 :   py2ent(idx, pdg1, pdg2, p);</span>
<a name="837"><span class="lineNum">     837 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     838 </span>            : 
<span class="lineNum">     839 </span>            : void AliPythia::SetWeightPower(Double_t pow)
<span class="lineNum">     840 </span>            : {
<span class="lineNum">     841 </span><span class="lineNoCov">          0 :     setpowwght(pow);</span>
<span class="lineNum">     842 </span><span class="lineNoCov">          0 :     SetMSTP(142, 1); // Tell Pythia to use pyevwt to calculate event wghts</span>
<span class="lineNum">     843 </span><span class="lineNoCov">          0 :     if (GetCKIN(3) &lt;= 0) </span>
<span class="lineNum">     844 </span><span class="lineNoCov">          0 :       AliWarning(&quot;Need to set minimum p_T,hard to nonzero value for weighted event generation&quot;);</span>
<a name="845"><span class="lineNum">     845 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     846 </span>            : 
<span class="lineNum">     847 </span>            : void AliPythia::InitQuenching(Float_t cMin, Float_t cMax, Float_t k, Int_t iECMethod, Float_t zmax, Int_t ngmax)
<span class="lineNum">     848 </span>            : {
<span class="lineNum">     849 </span>            : // Initializes 
<span class="lineNum">     850 </span>            : // (1) The quenching model using quenching weights according to C. Salgado and U. Wiedemann
<span class="lineNum">     851 </span>            : // (2) The nuclear geometry using the Glauber Model
<span class="lineNum">     852 </span>            : //     
<span class="lineNum">     853 </span>            :     
<span class="lineNum">     854 </span><span class="lineNoCov">          0 :     fGlauber = AliFastGlauber::Instance();</span>
<span class="lineNum">     855 </span><span class="lineNoCov">          0 :     fGlauber-&gt;Init(2);</span>
<span class="lineNum">     856 </span><span class="lineNoCov">          0 :     fGlauber-&gt;SetCentralityClass(cMin, cMax); </span>
<span class="lineNum">     857 </span>            : 
<span class="lineNum">     858 </span><span class="lineNoCov">          0 :     fQuenchingWeights = new AliQuenchingWeights();</span>
<span class="lineNum">     859 </span><span class="lineNoCov">          0 :     fQuenchingWeights-&gt;InitMult();</span>
<span class="lineNum">     860 </span><span class="lineNoCov">          0 :     fQuenchingWeights-&gt;SetK(k);</span>
<span class="lineNum">     861 </span><span class="lineNoCov">          0 :     fQuenchingWeights-&gt;SetECMethod(AliQuenchingWeights::kECMethod(iECMethod));</span>
<span class="lineNum">     862 </span><span class="lineNoCov">          0 :     fNGmax = ngmax;</span>
<span class="lineNum">     863 </span><span class="lineNoCov">          0 :     fZmax  = zmax;</span>
<span class="lineNum">     864 </span>            :     
<span class="lineNum">     865 </span><span class="lineNoCov">          0 : }</span>
<a name="866"><span class="lineNum">     866 </span>            : </a>
<span class="lineNum">     867 </span>            : 
<span class="lineNum">     868 </span>            : void  AliPythia::Quench()
<span class="lineNum">     869 </span>            : {
<span class="lineNum">     870 </span>            : //
<span class="lineNum">     871 </span>            : //
<span class="lineNum">     872 </span>            : //  Simple Jet Quenching routine:
<span class="lineNum">     873 </span>            : //  =============================
<span class="lineNum">     874 </span>            : //  The jet formed by all final state partons radiated by the parton created 
<span class="lineNum">     875 </span>            : //  in the hard collisions is quenched by a factor (1-z) using light cone variables in 
<span class="lineNum">     876 </span>            : //  the initial parton reference frame:
<span class="lineNum">     877 </span>            : //  (E + p_z)new = (1-z) (E + p_z)old
<span class="lineNum">     878 </span>            : //
<span class="lineNum">     879 </span>            : //
<span class="lineNum">     880 </span>            : //
<span class="lineNum">     881 </span>            : //
<span class="lineNum">     882 </span>            : //   The lost momentum is first balanced by one gluon with virtuality &gt; 0.   
<span class="lineNum">     883 </span>            : //   Subsequently the gluon splits to yield two gluons with E = p.
<span class="lineNum">     884 </span>            : //
<span class="lineNum">     885 </span>            : //
<span class="lineNum">     886 </span>            : // 
<span class="lineNum">     887 </span>            :     static Float_t eMean = 0.;
<span class="lineNum">     888 </span>            :     static Int_t   icall = 0;
<span class="lineNum">     889 </span>            :     
<span class="lineNum">     890 </span><span class="lineNoCov">          0 :     Double_t p0[4][5];</span>
<span class="lineNum">     891 </span><span class="lineNoCov">          0 :     Double_t p1[4][5];</span>
<span class="lineNum">     892 </span><span class="lineNoCov">          0 :     Double_t p2[4][5];</span>
<span class="lineNum">     893 </span><span class="lineNoCov">          0 :     Int_t   klast[4] = {-1, -1, -1, -1};</span>
<span class="lineNum">     894 </span>            : 
<span class="lineNum">     895 </span><span class="lineNoCov">          0 :     Int_t numpart   = fPyjets-&gt;N;</span>
<span class="lineNum">     896 </span>            :     Double_t px = 0., py = 0., pz = 0., e = 0., m = 0., p = 0., pt = 0., theta = 0., phi = 0.;
<span class="lineNum">     897 </span><span class="lineNoCov">          0 :     Double_t pxq[4], pyq[4], pzq[4], eq[4], yq[4], mq[4], pq[4], phiq[4], thetaq[4], ptq[4];</span>
<span class="lineNum">     898 </span><span class="lineNoCov">          0 :     Bool_t  quenched[4];</span>
<span class="lineNum">     899 </span><span class="lineNoCov">          0 :     Double_t wjtKick[4] = {0., 0., 0., 0.};</span>
<span class="lineNum">     900 </span><span class="lineNoCov">          0 :     Int_t nGluon[4];</span>
<span class="lineNum">     901 </span><span class="lineNoCov">          0 :     Int_t qPdg[4];</span>
<span class="lineNum">     902 </span>            :     Int_t   imo, kst, pdg;
<span class="lineNum">     903 </span>            :     
<span class="lineNum">     904 </span>            : //
<span class="lineNum">     905 </span>            : //  Sore information about Primary partons
<span class="lineNum">     906 </span>            : //
<span class="lineNum">     907 </span>            : //  j =
<span class="lineNum">     908 </span>            : //  0, 1 partons from hard scattering
<span class="lineNum">     909 </span>            : //  2, 3 partons from initial state radiation
<span class="lineNum">     910 </span>            : // 
<span class="lineNum">     911 </span><span class="lineNoCov">          0 :     for (Int_t i = 2; i &lt;= 7; i++) {</span>
<span class="lineNum">     912 </span>            :         Int_t j = 0;
<span class="lineNum">     913 </span>            :         // Skip gluons that participate in hard scattering
<span class="lineNum">     914 </span><span class="lineNoCov">          0 :         if (i == 4 || i == 5) continue;</span>
<span class="lineNum">     915 </span>            :         // Gluons from hard Scattering
<span class="lineNum">     916 </span><span class="lineNoCov">          0 :         if (i == 6 || i == 7) {</span>
<span class="lineNum">     917 </span><span class="lineNoCov">          0 :             j = i - 6;</span>
<span class="lineNum">     918 </span><span class="lineNoCov">          0 :             pxq[j]    = fPyjets-&gt;P[0][i];</span>
<span class="lineNum">     919 </span><span class="lineNoCov">          0 :             pyq[j]    = fPyjets-&gt;P[1][i];</span>
<span class="lineNum">     920 </span><span class="lineNoCov">          0 :             pzq[j]    = fPyjets-&gt;P[2][i];</span>
<span class="lineNum">     921 </span><span class="lineNoCov">          0 :             eq[j]     = fPyjets-&gt;P[3][i];</span>
<span class="lineNum">     922 </span><span class="lineNoCov">          0 :             mq[j]     = fPyjets-&gt;P[4][i];</span>
<span class="lineNum">     923 </span><span class="lineNoCov">          0 :         } else {</span>
<span class="lineNum">     924 </span>            :             // Gluons from initial state radiation
<span class="lineNum">     925 </span>            :             //
<span class="lineNum">     926 </span>            :             // Obtain 4-momentum vector from difference between original parton and parton after gluon 
<span class="lineNum">     927 </span>            :             // radiation. Energy is calculated independently because initial state radition does not 
<span class="lineNum">     928 </span>            :             // conserve strictly momentum and energy for each partonic system independently.
<span class="lineNum">     929 </span>            :             //
<span class="lineNum">     930 </span>            :             // Not very clean. Should be improved !
<span class="lineNum">     931 </span>            :             //
<span class="lineNum">     932 </span>            :             //
<span class="lineNum">     933 </span>            :             j = i;
<span class="lineNum">     934 </span><span class="lineNoCov">          0 :             pxq[j]    = fPyjets-&gt;P[0][i] - fPyjets-&gt;P[0][i+2];</span>
<span class="lineNum">     935 </span><span class="lineNoCov">          0 :             pyq[j]    = fPyjets-&gt;P[1][i] - fPyjets-&gt;P[1][i+2];</span>
<span class="lineNum">     936 </span><span class="lineNoCov">          0 :             pzq[j]    = fPyjets-&gt;P[2][i] - fPyjets-&gt;P[2][i+2];</span>
<span class="lineNum">     937 </span><span class="lineNoCov">          0 :             mq[j]     = fPyjets-&gt;P[4][i];</span>
<span class="lineNum">     938 </span><span class="lineNoCov">          0 :             eq[j]     = TMath::Sqrt(pxq[j] * pxq[j] + pyq[j] * pyq[j] + pzq[j] * pzq[j] + mq[j] * mq[j]);</span>
<span class="lineNum">     939 </span>            :         }
<span class="lineNum">     940 </span>            : //
<span class="lineNum">     941 </span>            : //  Calculate some kinematic variables
<span class="lineNum">     942 </span>            : //
<span class="lineNum">     943 </span><span class="lineNoCov">          0 :         yq[j]     = 0.5 * TMath::Log((eq[j] + pzq[j] + 1.e-14) / (eq[j] - pzq[j] + 1.e-14));</span>
<span class="lineNum">     944 </span><span class="lineNoCov">          0 :         pq[j]     = TMath::Sqrt(pxq[j] * pxq[j] + pyq[j] * pyq[j] + pzq[j] * pzq[j]);</span>
<span class="lineNum">     945 </span><span class="lineNoCov">          0 :         phiq[j]   = TMath::Pi()+TMath::ATan2(-pyq[j], -pxq[j]);</span>
<span class="lineNum">     946 </span><span class="lineNoCov">          0 :         ptq[j]    = TMath::Sqrt(pxq[j] * pxq[j] + pyq[j] * pyq[j]);</span>
<span class="lineNum">     947 </span><span class="lineNoCov">          0 :         thetaq[j] = TMath::ATan2(ptq[j], pzq[j]);</span>
<span class="lineNum">     948 </span><span class="lineNoCov">          0 :         qPdg[j]   =  fPyjets-&gt;K[1][i];</span>
<span class="lineNum">     949 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">     950 </span>            :   
<span class="lineNum">     951 </span><span class="lineNoCov">          0 :     Double_t int0[4];</span>
<span class="lineNum">     952 </span><span class="lineNoCov">          0 :     Double_t int1[4];</span>
<span class="lineNum">     953 </span>            :     
<span class="lineNum">     954 </span><span class="lineNoCov">          0 :     fGlauber-&gt;GetI0I1ForPythiaAndXY(4, phiq, int0, int1, fXJet, fYJet, 15.);</span>
<span class="lineNum">     955 </span>            : 
<span class="lineNum">     956 </span><span class="lineNoCov">          0 :     for (Int_t j = 0; j &lt; 4; j++) {</span>
<span class="lineNum">     957 </span>            :         //
<span class="lineNum">     958 </span>            :         // Quench only central jets and with E &gt; 10.
<span class="lineNum">     959 </span>            :         //
<span class="lineNum">     960 </span>            : 
<span class="lineNum">     961 </span>            : 
<span class="lineNum">     962 </span><span class="lineNoCov">          0 :         Int_t itype = (qPdg[j] == 21) ? 2 : 1;</span>
<span class="lineNum">     963 </span><span class="lineNoCov">          0 :         Double_t eloss = fQuenchingWeights-&gt;GetELossRandomKFast(itype, int0[j], int1[j], eq[j]);</span>
<span class="lineNum">     964 </span>            : 
<span class="lineNum">     965 </span><span class="lineNoCov">          0 :         if (TMath::Abs(yq[j]) &gt; 2.5 || eq[j] &lt; 10.) {</span>
<span class="lineNum">     966 </span><span class="lineNoCov">          0 :             fZQuench[j] = 0.;</span>
<span class="lineNum">     967 </span><span class="lineNoCov">          0 :         } else {</span>
<span class="lineNum">     968 </span><span class="lineNoCov">          0 :             if (eq[j] &gt; 40. &amp;&amp; TMath::Abs(yq[j]) &lt; 0.5) {</span>
<span class="lineNum">     969 </span><span class="lineNoCov">          0 :                 icall ++;</span>
<span class="lineNum">     970 </span><span class="lineNoCov">          0 :                 eMean += eloss;</span>
<span class="lineNum">     971 </span><span class="lineNoCov">          0 :             }</span>
<span class="lineNum">     972 </span>            :             //
<span class="lineNum">     973 </span>            :             // Extra pt
<span class="lineNum">     974 </span><span class="lineNoCov">          0 :             Double_t l =   fQuenchingWeights-&gt;CalcLk(int0[j], int1[j]);          </span>
<span class="lineNum">     975 </span><span class="lineNoCov">          0 :             wjtKick[j] = TMath::Sqrt(l *  fQuenchingWeights-&gt;CalcQk(int0[j], int1[j]));</span>
<span class="lineNum">     976 </span>            :             //
<span class="lineNum">     977 </span>            :             // Fractional energy loss
<span class="lineNum">     978 </span><span class="lineNoCov">          0 :             fZQuench[j] = eloss / eq[j];</span>
<span class="lineNum">     979 </span>            :             //
<span class="lineNum">     980 </span>            :             // Avoid complete loss
<span class="lineNum">     981 </span>            :             //
<span class="lineNum">     982 </span><span class="lineNoCov">          0 :             if (fZQuench[j] &gt; fZmax) fZQuench[j] = fZmax;</span>
<span class="lineNum">     983 </span>            :             //
<span class="lineNum">     984 </span>            :             // Some debug printing
<span class="lineNum">     985 </span>            : 
<span class="lineNum">     986 </span>            :             
<span class="lineNum">     987 </span>            : //          printf(&quot;Initial parton # %3d, Type %3d Energy %10.3f Phi %10.3f Length %10.3f Loss %10.3f Kick %10.3f Mean: %10.3f %10.3f\n&quot;, 
<span class="lineNum">     988 </span>            : //                 j, itype, eq[j], phiq[j], l, eloss, wjtKick[j], eMean / Float_t(icall+1), yq[j]);
<span class="lineNum">     989 </span>            :             
<span class="lineNum">     990 </span>            : //          fZQuench[j] = 0.8;
<span class="lineNum">     991 </span>            : //          while (fZQuench[j] &gt;= 0.95)  fZQuench[j] = gRandom-&gt;Exp(0.2);
<span class="lineNum">     992 </span>            :         }
<span class="lineNum">     993 </span>            :         
<span class="lineNum">     994 </span><span class="lineNoCov">          0 :         quenched[j] = (fZQuench[j] &gt; 0.01);</span>
<span class="lineNum">     995 </span>            :     } // primary partons
<span class="lineNum">     996 </span>            :     
<span class="lineNum">     997 </span>            :     
<span class="lineNum">     998 </span>            : 
<span class="lineNum">     999 </span><span class="lineNoCov">          0 :     Double_t pNew[1000][4];</span>
<span class="lineNum">    1000 </span><span class="lineNoCov">          0 :     Int_t    kNew[1000];</span>
<span class="lineNum">    1001 </span>            :     Int_t icount = 0;
<span class="lineNum">    1002 </span><span class="lineNoCov">          0 :     Double_t zquench[4];</span>
<span class="lineNum">    1003 </span>            :     
<span class="lineNum">    1004 </span>            : //
<span class="lineNum">    1005 </span>            : //  System Loop    
<span class="lineNum">    1006 </span><span class="lineNoCov">          0 :     for (Int_t isys = 0; isys &lt; 4; isys++) {</span>
<span class="lineNum">    1007 </span>            : //      Skip to next system if not quenched.
<span class="lineNum">    1008 </span><span class="lineNoCov">          0 :         if (!quenched[isys]) continue;</span>
<span class="lineNum">    1009 </span>            :         
<span class="lineNum">    1010 </span><span class="lineNoCov">          0 :         nGluon[isys]   = 1 + Int_t(fZQuench[isys] / (1. - fZQuench[isys]));</span>
<span class="lineNum">    1011 </span><span class="lineNoCov">          0 :         if (nGluon[isys] &gt; fNGmax) nGluon[isys] = fNGmax;</span>
<span class="lineNum">    1012 </span><span class="lineNoCov">          0 :         zquench[isys] = 1. - TMath::Power(1. - fZQuench[isys], 1./Double_t(nGluon[isys]));</span>
<span class="lineNum">    1013 </span><span class="lineNoCov">          0 :         wjtKick[isys]  = wjtKick[isys] / TMath::Sqrt(Double_t(nGluon[isys]));</span>
<span class="lineNum">    1014 </span>            : 
<span class="lineNum">    1015 </span>            : 
<span class="lineNum">    1016 </span>            :         
<span class="lineNum">    1017 </span>            :         Int_t igMin = -1;
<span class="lineNum">    1018 </span>            :         Int_t igMax = -1;
<span class="lineNum">    1019 </span>            :         Double_t pg[4] = {0., 0., 0., 0.};
<span class="lineNum">    1020 </span>            :         
<span class="lineNum">    1021 </span>            : //
<span class="lineNum">    1022 </span>            : // Loop on radiation events
<span class="lineNum">    1023 </span>            : 
<span class="lineNum">    1024 </span><span class="lineNoCov">          0 :         for (Int_t iglu = 0; iglu &lt; nGluon[isys]; iglu++) {</span>
<span class="lineNum">    1025 </span>            :             while (1) {
<span class="lineNum">    1026 </span>            :                 icount = 0;
<span class="lineNum">    1027 </span><span class="lineNoCov">          0 :                 for (Int_t k = 0; k &lt; 4; k++)</span>
<span class="lineNum">    1028 </span>            :                 {
<span class="lineNum">    1029 </span><span class="lineNoCov">          0 :                     p0[isys][k] = 0.;</span>
<span class="lineNum">    1030 </span><span class="lineNoCov">          0 :                     p1[isys][k] = 0.;</span>
<span class="lineNum">    1031 </span><span class="lineNoCov">          0 :                     p2[isys][k] = 0.;</span>
<span class="lineNum">    1032 </span>            :                 }
<span class="lineNum">    1033 </span>            : //      Loop over partons
<span class="lineNum">    1034 </span><span class="lineNoCov">          0 :                 for (Int_t i = 0; i &lt; numpart; i++)</span>
<span class="lineNum">    1035 </span>            :                 {
<span class="lineNum">    1036 </span><span class="lineNoCov">          0 :                     imo =  fPyjets-&gt;K[2][i];</span>
<span class="lineNum">    1037 </span><span class="lineNoCov">          0 :                     kst =  fPyjets-&gt;K[0][i];</span>
<span class="lineNum">    1038 </span><span class="lineNoCov">          0 :                     pdg =  fPyjets-&gt;K[1][i];</span>
<span class="lineNum">    1039 </span>            :                     
<span class="lineNum">    1040 </span>            :                 
<span class="lineNum">    1041 </span>            :                 
<span class="lineNum">    1042 </span>            : //      Quarks and gluons only
<span class="lineNum">    1043 </span><span class="lineNoCov">          0 :                     if (pdg != 21 &amp;&amp; TMath::Abs(pdg) &gt; 6) continue;</span>
<span class="lineNum">    1044 </span>            : //      Particles from hard scattering only
<span class="lineNum">    1045 </span>            :                     
<span class="lineNum">    1046 </span><span class="lineNoCov">          0 :                     if (imo &gt; 8 &amp;&amp; imo &lt; 1000) imo = fPyjets-&gt;K[2][imo - 1];</span>
<span class="lineNum">    1047 </span><span class="lineNoCov">          0 :                     Int_t imom = imo % 1000;</span>
<span class="lineNum">    1048 </span><span class="lineNoCov">          0 :                     if ((isys == 0 || isys == 1) &amp;&amp; ((imom != (isys + 7)))) continue;</span>
<span class="lineNum">    1049 </span><span class="lineNoCov">          0 :                     if ((isys == 2 || isys == 3) &amp;&amp; ((imom != (isys + 1)))) continue;               </span>
<span class="lineNum">    1050 </span>            :                     
<span class="lineNum">    1051 </span>            :                     
<span class="lineNum">    1052 </span>            : //      Skip comment lines
<span class="lineNum">    1053 </span><span class="lineNoCov">          0 :                     if (kst != 1 &amp;&amp; kst != 2) continue;</span>
<span class="lineNum">    1054 </span>            : //
<span class="lineNum">    1055 </span>            : //      Parton kinematic
<span class="lineNum">    1056 </span><span class="lineNoCov">          0 :                     px    = fPyjets-&gt;P[0][i];</span>
<span class="lineNum">    1057 </span><span class="lineNoCov">          0 :                     py    = fPyjets-&gt;P[1][i];</span>
<span class="lineNum">    1058 </span><span class="lineNoCov">          0 :                     pz    = fPyjets-&gt;P[2][i];</span>
<span class="lineNum">    1059 </span><span class="lineNoCov">          0 :                     e     = fPyjets-&gt;P[3][i];</span>
<span class="lineNum">    1060 </span><span class="lineNoCov">          0 :                     m     = fPyjets-&gt;P[4][i];</span>
<span class="lineNum">    1061 </span><span class="lineNoCov">          0 :                     pt    = TMath::Sqrt(px * px + py * py);</span>
<span class="lineNum">    1062 </span><span class="lineNoCov">          0 :                     p     = TMath::Sqrt(px * px + py * py + pz * pz); </span>
<span class="lineNum">    1063 </span><span class="lineNoCov">          0 :                     phi   = TMath::Pi() + TMath::ATan2(-py, -px);</span>
<span class="lineNum">    1064 </span><span class="lineNoCov">          0 :                     theta = TMath::ATan2(pt, pz);</span>
<span class="lineNum">    1065 </span>            :                 
<span class="lineNum">    1066 </span>            : //
<span class="lineNum">    1067 </span>            : //      Save 4-momentum sum for balancing
<span class="lineNum">    1068 </span>            :                     Int_t index = isys;
<span class="lineNum">    1069 </span>            :                     
<span class="lineNum">    1070 </span><span class="lineNoCov">          0 :                     p0[index][0] += px;</span>
<span class="lineNum">    1071 </span><span class="lineNoCov">          0 :                     p0[index][1] += py;</span>
<span class="lineNum">    1072 </span><span class="lineNoCov">          0 :                     p0[index][2] += pz;</span>
<span class="lineNum">    1073 </span><span class="lineNoCov">          0 :                     p0[index][3] += e;</span>
<span class="lineNum">    1074 </span>            :                 
<span class="lineNum">    1075 </span><span class="lineNoCov">          0 :                     klast[index] = i;</span>
<span class="lineNum">    1076 </span>            :                     
<span class="lineNum">    1077 </span>            : //
<span class="lineNum">    1078 </span>            : //      Fractional energy loss
<span class="lineNum">    1079 </span><span class="lineNoCov">          0 :                     Double_t z = zquench[index];</span>
<span class="lineNum">    1080 </span>            :                     
<span class="lineNum">    1081 </span>            :                     
<span class="lineNum">    1082 </span>            : //      Don't fully quench radiated gluons
<span class="lineNum">    1083 </span>            : //
<span class="lineNum">    1084 </span><span class="lineNoCov">          0 :                     if (imo &gt; 1000) {</span>
<span class="lineNum">    1085 </span>            : //      This small factor makes sure that the gluons are not too close in phase space to avoid recombination
<span class="lineNum">    1086 </span>            : //
<span class="lineNum">    1087 </span>            : 
<span class="lineNum">    1088 </span>            :                         z = 0.02;
<span class="lineNum">    1089 </span>            :                     }
<span class="lineNum">    1090 </span>            : //                  printf(&quot;z: %d %f\n&quot;, imo, z);
<span class="lineNum">    1091 </span>            :                     
<span class="lineNum">    1092 </span>            : 
<span class="lineNum">    1093 </span>            : //
<span class="lineNum">    1094 </span>            :                     
<span class="lineNum">    1095 </span>            :                     //
<span class="lineNum">    1096 </span>            :                     //
<span class="lineNum">    1097 </span>            :                     //      Transform into frame in which initial parton is along z-axis
<span class="lineNum">    1098 </span>            :                     //
<span class="lineNum">    1099 </span><span class="lineNoCov">          0 :                     TVector3 v(px, py, pz);</span>
<span class="lineNum">    1100 </span><span class="lineNoCov">          0 :                     v.RotateZ(-phiq[index]);  v.RotateY(-thetaq[index]);</span>
<span class="lineNum">    1101 </span><span class="lineNoCov">          0 :                     Double_t pxs = v.X(); Double_t pys = v.Y(); Double_t pl  = v.Z();</span>
<span class="lineNum">    1102 </span>            : 
<span class="lineNum">    1103 </span><span class="lineNoCov">          0 :                     Double_t jt  = TMath::Sqrt(pxs * pxs + pys * pys);</span>
<span class="lineNum">    1104 </span><span class="lineNoCov">          0 :                     Double_t mt2 = jt * jt + m * m;</span>
<span class="lineNum">    1105 </span>            :                     Double_t zmax = 1.;     
<span class="lineNum">    1106 </span>            :                     //
<span class="lineNum">    1107 </span>            :                     // Kinematic limit on z
<span class="lineNum">    1108 </span>            :                     //
<span class="lineNum">    1109 </span><span class="lineNoCov">          0 :                     if (m &gt; 0.) zmax = 1. - m / TMath::Sqrt(m * m + jt * jt);</span>
<span class="lineNum">    1110 </span>            :                     //
<span class="lineNum">    1111 </span>            :                     // Change light-cone kinematics rel. to initial parton
<span class="lineNum">    1112 </span>            :                     //  
<span class="lineNum">    1113 </span><span class="lineNoCov">          0 :                     Double_t eppzOld = e + pl;</span>
<span class="lineNum">    1114 </span><span class="lineNoCov">          0 :                     Double_t empzOld = e - pl;</span>
<span class="lineNum">    1115 </span>            :                     
<span class="lineNum">    1116 </span><span class="lineNoCov">          0 :                     Double_t eppzNew = (1. - z) * eppzOld;</span>
<span class="lineNum">    1117 </span><span class="lineNoCov">          0 :                     Double_t empzNew = empzOld - mt2 * z / eppzOld;</span>
<span class="lineNum">    1118 </span><span class="lineNoCov">          0 :                     Double_t eNew    = 0.5 * (eppzNew + empzNew);</span>
<span class="lineNum">    1119 </span><span class="lineNoCov">          0 :                     Double_t plNew   = 0.5 * (eppzNew - empzNew);</span>
<span class="lineNum">    1120 </span>            :                     
<span class="lineNum">    1121 </span>            :                     Double_t jtNew;
<span class="lineNum">    1122 </span>            :                     //
<span class="lineNum">    1123 </span>            :                     // if mt very small (or sometimes even &lt; 0 for numerical reasons) set it to 0
<span class="lineNum">    1124 </span><span class="lineNoCov">          0 :                     Double_t mt2New = eppzNew * empzNew;</span>
<span class="lineNum">    1125 </span><span class="lineNoCov">          0 :                     if (mt2New &lt; 1.e-8) mt2New = 0.;</span>
<span class="lineNum">    1126 </span><span class="lineNoCov">          0 :                     if (z &lt; zmax) {</span>
<span class="lineNum">    1127 </span><span class="lineNoCov">          0 :                         if (m * m &gt; mt2New) {</span>
<span class="lineNum">    1128 </span>            :                             //
<span class="lineNum">    1129 </span>            :                             // This should not happen 
<span class="lineNum">    1130 </span>            :                             //
<span class="lineNum">    1131 </span><span class="lineNoCov">          0 :                             Fatal(&quot;Quench()&quot;, &quot;This should never happen %e %e %e!&quot;, m, eppzNew, empzNew);</span>
<span class="lineNum">    1132 </span>            :                             jtNew = 0;
<span class="lineNum">    1133 </span><span class="lineNoCov">          0 :                         } else {</span>
<span class="lineNum">    1134 </span><span class="lineNoCov">          0 :                             jtNew    = TMath::Sqrt(mt2New - m * m);</span>
<span class="lineNum">    1135 </span>            :                         }
<span class="lineNum">    1136 </span>            :                     } else {
<span class="lineNum">    1137 </span>            :                         // If pT is to small (probably a leading massive particle) we scale only the energy
<span class="lineNum">    1138 </span>            :                         // This can cause negative masses of the radiated gluon
<span class="lineNum">    1139 </span>            :                         // Let's hope for the best ...
<span class="lineNum">    1140 </span>            :                         jtNew = jt;
<span class="lineNum">    1141 </span><span class="lineNoCov">          0 :                         eNew  = TMath::Sqrt(plNew * plNew + mt2);</span>
<span class="lineNum">    1142 </span>            :                         
<span class="lineNum">    1143 </span>            :                     }
<span class="lineNum">    1144 </span>            :                     //
<span class="lineNum">    1145 </span>            :                     //     Calculate new px, py
<span class="lineNum">    1146 </span>            :                     //
<span class="lineNum">    1147 </span>            :                     Double_t pxNew   = 0;
<span class="lineNum">    1148 </span>            :                     Double_t pyNew   = 0;
<span class="lineNum">    1149 </span>            :                     
<span class="lineNum">    1150 </span><span class="lineNoCov">          0 :                     if (jt&gt;0) {</span>
<span class="lineNum">    1151 </span><span class="lineNoCov">          0 :                       pxNew = jtNew / jt * pxs;</span>
<span class="lineNum">    1152 </span><span class="lineNoCov">          0 :                       pyNew = jtNew / jt * pys;</span>
<span class="lineNum">    1153 </span><span class="lineNoCov">          0 :                     }   </span>
<span class="lineNum">    1154 </span>            : //                  Double_t dpx = pxs - pxNew;
<span class="lineNum">    1155 </span>            : //                  Double_t dpy = pys - pyNew;
<span class="lineNum">    1156 </span>            : //                  Double_t dpz = pl  - plNew;
<span class="lineNum">    1157 </span>            : //                  Double_t de  = e   - eNew;
<span class="lineNum">    1158 </span>            : //                  Double_t dmass2 = de * de  - dpx * dpx - dpy * dpy - dpz * dpz;
<span class="lineNum">    1159 </span>            : //                  printf(&quot;New mass (1) %e %e %e %e %e %e %e \n&quot;, dmass2, jt, jtNew, pl, plNew, e, eNew);
<span class="lineNum">    1160 </span>            : //                  printf(&quot;New mass (2) %e %e \n&quot;, pxNew, pyNew);
<span class="lineNum">    1161 </span>            :                     //
<span class="lineNum">    1162 </span>            :                     //      Rotate back
<span class="lineNum">    1163 </span>            :                     //  
<span class="lineNum">    1164 </span><span class="lineNoCov">          0 :                     TVector3 w(pxNew, pyNew, plNew);</span>
<span class="lineNum">    1165 </span><span class="lineNoCov">          0 :                     w.RotateY(thetaq[index]); w.RotateZ(phiq[index]);</span>
<span class="lineNum">    1166 </span><span class="lineNoCov">          0 :                     pxNew = w.X(); pyNew = w.Y(); plNew = w.Z();</span>
<span class="lineNum">    1167 </span>            :                 
<span class="lineNum">    1168 </span><span class="lineNoCov">          0 :                     p1[index][0] += pxNew;</span>
<span class="lineNum">    1169 </span><span class="lineNoCov">          0 :                     p1[index][1] += pyNew;</span>
<span class="lineNum">    1170 </span><span class="lineNoCov">          0 :                     p1[index][2] += plNew;</span>
<span class="lineNum">    1171 </span><span class="lineNoCov">          0 :                     p1[index][3] += eNew;       </span>
<span class="lineNum">    1172 </span>            :                     //
<span class="lineNum">    1173 </span>            :                     // Updated 4-momentum vectors
<span class="lineNum">    1174 </span>            :                     //
<span class="lineNum">    1175 </span><span class="lineNoCov">          0 :                     pNew[icount][0]  = pxNew;</span>
<span class="lineNum">    1176 </span><span class="lineNoCov">          0 :                     pNew[icount][1]  = pyNew;</span>
<span class="lineNum">    1177 </span><span class="lineNoCov">          0 :                     pNew[icount][2]  = plNew;</span>
<span class="lineNum">    1178 </span><span class="lineNoCov">          0 :                     pNew[icount][3]  = eNew;</span>
<span class="lineNum">    1179 </span><span class="lineNoCov">          0 :                     kNew[icount]     = i;</span>
<span class="lineNum">    1180 </span><span class="lineNoCov">          0 :                     icount++;</span>
<span class="lineNum">    1181 </span><span class="lineNoCov">          0 :                 } // parton loop</span>
<span class="lineNum">    1182 </span>            :                 //
<span class="lineNum">    1183 </span>            :                 // Check if there was phase-space for quenching
<span class="lineNum">    1184 </span>            :                 //
<span class="lineNum">    1185 </span>            : 
<span class="lineNum">    1186 </span><span class="lineNoCov">          0 :                 if (icount == 0) quenched[isys] = kFALSE;</span>
<span class="lineNum">    1187 </span><span class="lineNoCov">          0 :                 if (!quenched[isys]) break;</span>
<span class="lineNum">    1188 </span>            :                 
<span class="lineNum">    1189 </span><span class="lineNoCov">          0 :                 for (Int_t j = 0; j &lt; 4; j++) </span>
<span class="lineNum">    1190 </span>            :                 {
<span class="lineNum">    1191 </span><span class="lineNoCov">          0 :                     p2[isys][j] = p0[isys][j] - p1[isys][j];</span>
<span class="lineNum">    1192 </span>            :                 }
<span class="lineNum">    1193 </span><span class="lineNoCov">          0 :                 p2[isys][4] = p2[isys][3] * p2[isys][3] - p2[isys][0] * p2[isys][0] - p2[isys][1] * p2[isys][1] - p2[isys][2] * p2[isys][2];</span>
<span class="lineNum">    1194 </span><span class="lineNoCov">          0 :                 if (p2[isys][4] &gt; 0.) {</span>
<span class="lineNum">    1195 </span><span class="lineNoCov">          0 :                     p2[isys][4] = TMath::Sqrt(p2[isys][4]);</span>
<span class="lineNum">    1196 </span><span class="lineNoCov">          0 :                     break;</span>
<span class="lineNum">    1197 </span>            :                 } else {
<span class="lineNum">    1198 </span><span class="lineNoCov">          0 :                     printf(&quot;Warning negative mass squared in system %d %f ! \n&quot;, isys, zquench[isys]);</span>
<span class="lineNum">    1199 </span><span class="lineNoCov">          0 :                     printf(&quot;4-Momentum: %10.3e %10.3e %10.3e %10.3e %10.3e \n&quot;, p2[isys][0], p2[isys][1], p2[isys][2], p2[isys][3], p2[isys][4]);</span>
<span class="lineNum">    1200 </span><span class="lineNoCov">          0 :                     if (p2[isys][4] &lt; -0.01) {</span>
<span class="lineNum">    1201 </span><span class="lineNoCov">          0 :                         printf(&quot;Negative mass squared !\n&quot;);</span>
<span class="lineNum">    1202 </span>            :                         // Here we have to put the gluon back to mass shell
<span class="lineNum">    1203 </span>            :                         // This will lead to a small energy imbalance
<span class="lineNum">    1204 </span><span class="lineNoCov">          0 :                         p2[isys][4]  = 0.;</span>
<span class="lineNum">    1205 </span><span class="lineNoCov">          0 :                         p2[isys][3]  = TMath::Sqrt(p2[isys][0] * p2[isys][0] + p2[isys][1] * p2[isys][1] + p2[isys][2] * p2[isys][2]);</span>
<span class="lineNum">    1206 </span><span class="lineNoCov">          0 :                         break;</span>
<span class="lineNum">    1207 </span>            :                     } else {
<span class="lineNum">    1208 </span><span class="lineNoCov">          0 :                         p2[isys][4] = 0.;</span>
<span class="lineNum">    1209 </span><span class="lineNoCov">          0 :                         break;</span>
<span class="lineNum">    1210 </span>            :                     }
<span class="lineNum">    1211 </span>            :                 }
<span class="lineNum">    1212 </span>            :                 /*
<span class="lineNum">    1213 </span>            :                 zHeavy *= 0.98;
<span class="lineNum">    1214 </span>            :                 printf(&quot;zHeavy lowered to %f\n&quot;, zHeavy);
<span class="lineNum">    1215 </span>            :                 if (zHeavy &lt; 0.01) {
<span class="lineNum">    1216 </span>            :                     printf(&quot;No success ! \n&quot;);
<span class="lineNum">    1217 </span>            :                     icount = 0;
<span class="lineNum">    1218 </span>            :                     quenched[isys] = kFALSE;
<span class="lineNum">    1219 </span>            :                     break;
<span class="lineNum">    1220 </span>            :                 }
<span class="lineNum">    1221 </span>            :                 */
<span class="lineNum">    1222 </span>            :             } // iteration on z (while)
<span class="lineNum">    1223 </span>            :             
<span class="lineNum">    1224 </span>            : //          Update  event record
<span class="lineNum">    1225 </span><span class="lineNoCov">          0 :             for (Int_t k = 0; k &lt; icount; k++) {</span>
<span class="lineNum">    1226 </span>            : //              printf(&quot;%6d %6d %10.3e %10.3e %10.3e %10.3e\n&quot;, k, kNew[k], pNew[k][0],pNew[k][1], pNew[k][2], pNew[k][3] );
<span class="lineNum">    1227 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;P[0][kNew[k]] = pNew[k][0];</span>
<span class="lineNum">    1228 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;P[1][kNew[k]] = pNew[k][1];</span>
<span class="lineNum">    1229 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;P[2][kNew[k]] = pNew[k][2];</span>
<span class="lineNum">    1230 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;P[3][kNew[k]] = pNew[k][3];</span>
<span class="lineNum">    1231 </span>            :             }
<span class="lineNum">    1232 </span>            :             //
<span class="lineNum">    1233 </span>            :             // Add the gluons
<span class="lineNum">    1234 </span>            :             //
<span class="lineNum">    1235 </span>            :             Int_t ish = 0;    
<span class="lineNum">    1236 </span>            :             Int_t iGlu;
<span class="lineNum">    1237 </span><span class="lineNoCov">          0 :             if (!quenched[isys]) continue;</span>
<span class="lineNum">    1238 </span>            : //
<span class="lineNum">    1239 </span>            : //      Last parton from shower i
<span class="lineNum">    1240 </span><span class="lineNoCov">          0 :             Int_t in = klast[isys];</span>
<span class="lineNum">    1241 </span>            : //
<span class="lineNum">    1242 </span>            : //      Continue if no parton in shower i selected
<span class="lineNum">    1243 </span><span class="lineNoCov">          0 :             if (in == -1) continue;</span>
<span class="lineNum">    1244 </span>            : //  
<span class="lineNum">    1245 </span>            : //      If this is the second initial parton and it is behind the first move pointer by previous ish
<span class="lineNum">    1246 </span><span class="lineNoCov">          0 :             if (isys == 1 &amp;&amp; klast[1] &gt; klast[0]) in += ish;</span>
<span class="lineNum">    1247 </span>            : //
<span class="lineNum">    1248 </span>            : //      Starting index
<span class="lineNum">    1249 </span>            :             
<span class="lineNum">    1250 </span>            : //          jmin = in - 1;
<span class="lineNum">    1251 </span>            : // How many additional gluons will be generated
<span class="lineNum">    1252 </span>            :             ish  = 1;
<span class="lineNum">    1253 </span><span class="lineNoCov">          0 :             if (p2[isys][4] &gt; 0.05) ish = 2;</span>
<span class="lineNum">    1254 </span>            : //
<span class="lineNum">    1255 </span>            : //      Position of gluons
<span class="lineNum">    1256 </span>            :             iGlu = numpart;
<span class="lineNum">    1257 </span><span class="lineNoCov">          0 :             if (iglu == 0) igMin = iGlu;</span>
<span class="lineNum">    1258 </span>            :             igMax = iGlu;
<span class="lineNum">    1259 </span><span class="lineNoCov">          0 :             numpart += ish;</span>
<span class="lineNum">    1260 </span><span class="lineNoCov">          0 :             (fPyjets-&gt;N) += ish;</span>
<span class="lineNum">    1261 </span>            :             
<span class="lineNum">    1262 </span><span class="lineNoCov">          0 :             if (ish == 1) {</span>
<span class="lineNum">    1263 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;P[0][iGlu] = p2[isys][0];</span>
<span class="lineNum">    1264 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;P[1][iGlu] = p2[isys][1];</span>
<span class="lineNum">    1265 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;P[2][iGlu] = p2[isys][2];</span>
<span class="lineNum">    1266 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;P[3][iGlu] = p2[isys][3];</span>
<span class="lineNum">    1267 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;P[4][iGlu] = p2[isys][4];</span>
<span class="lineNum">    1268 </span>            :                 
<span class="lineNum">    1269 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;K[0][iGlu] = 1;</span>
<span class="lineNum">    1270 </span><span class="lineNoCov">          0 :                 if (iglu == nGluon[isys] - 1) fPyjets-&gt;K[0][iGlu] = 1;</span>
<span class="lineNum">    1271 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;K[1][iGlu] = 21;    </span>
<span class="lineNum">    1272 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;K[2][iGlu] = fPyjets-&gt;K[2][in] + 1000;</span>
<span class="lineNum">    1273 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;K[3][iGlu] = -1;    </span>
<span class="lineNum">    1274 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;K[4][iGlu] = -1;</span>
<span class="lineNum">    1275 </span>            :                 
<span class="lineNum">    1276 </span><span class="lineNoCov">          0 :                 pg[0] += p2[isys][0];</span>
<span class="lineNum">    1277 </span><span class="lineNoCov">          0 :                 pg[1] += p2[isys][1];</span>
<span class="lineNum">    1278 </span><span class="lineNoCov">          0 :                 pg[2] += p2[isys][2];</span>
<span class="lineNum">    1279 </span><span class="lineNoCov">          0 :                 pg[3] += p2[isys][3];</span>
<span class="lineNum">    1280 </span><span class="lineNoCov">          0 :             } else {</span>
<span class="lineNum">    1281 </span>            :                 //
<span class="lineNum">    1282 </span>            :                 // Split gluon in rest frame.
<span class="lineNum">    1283 </span>            :                 //
<span class="lineNum">    1284 </span><span class="lineNoCov">          0 :                 Double_t bx   =  p2[isys][0] / p2[isys][3];</span>
<span class="lineNum">    1285 </span><span class="lineNoCov">          0 :                 Double_t by   =  p2[isys][1] / p2[isys][3];</span>
<span class="lineNum">    1286 </span><span class="lineNoCov">          0 :                 Double_t bz   =  p2[isys][2] / p2[isys][3];</span>
<span class="lineNum">    1287 </span><span class="lineNoCov">          0 :                 Double_t pst  =  p2[isys][4] / 2.;</span>
<span class="lineNum">    1288 </span>            :                 //
<span class="lineNum">    1289 </span>            :                 // Isotropic decay ????
<span class="lineNum">    1290 </span><span class="lineNoCov">          0 :                 Double_t cost = 2. * gRandom-&gt;Rndm() - 1.;</span>
<span class="lineNum">    1291 </span><span class="lineNoCov">          0 :                 Double_t sint = TMath::Sqrt((1.-cost)*(1.+cost));</span>
<span class="lineNum">    1292 </span><span class="lineNoCov">          0 :                 Double_t phis =  2. * TMath::Pi() * gRandom-&gt;Rndm();</span>
<span class="lineNum">    1293 </span>            :                 
<span class="lineNum">    1294 </span><span class="lineNoCov">          0 :                 Double_t pz1 =   pst * cost;</span>
<span class="lineNum">    1295 </span><span class="lineNoCov">          0 :                 Double_t pz2 =  -pst * cost;</span>
<span class="lineNum">    1296 </span><span class="lineNoCov">          0 :                 Double_t pt1 =   pst * sint;</span>
<span class="lineNum">    1297 </span><span class="lineNoCov">          0 :                 Double_t pt2 =  -pst * sint;</span>
<span class="lineNum">    1298 </span><span class="lineNoCov">          0 :                 Double_t px1 =   pt1 * TMath::Cos(phis);</span>
<span class="lineNum">    1299 </span><span class="lineNoCov">          0 :                 Double_t py1 =   pt1 * TMath::Sin(phis);            </span>
<span class="lineNum">    1300 </span><span class="lineNoCov">          0 :                 Double_t px2 =   pt2 * TMath::Cos(phis);</span>
<span class="lineNum">    1301 </span><span class="lineNoCov">          0 :                 Double_t py2 =   pt2 * TMath::Sin(phis);            </span>
<span class="lineNum">    1302 </span>            :                 
<span class="lineNum">    1303 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;P[0][iGlu] = px1;</span>
<span class="lineNum">    1304 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;P[1][iGlu] = py1;</span>
<span class="lineNum">    1305 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;P[2][iGlu] = pz1;</span>
<span class="lineNum">    1306 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;P[3][iGlu] = pst;</span>
<span class="lineNum">    1307 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;P[4][iGlu] = 0.;</span>
<span class="lineNum">    1308 </span>            :                 
<span class="lineNum">    1309 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;K[0][iGlu] = 1 ;</span>
<span class="lineNum">    1310 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;K[1][iGlu] = 21;    </span>
<span class="lineNum">    1311 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;K[2][iGlu] = fPyjets-&gt;K[2][in] + 1000;</span>
<span class="lineNum">    1312 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;K[3][iGlu] = -1;    </span>
<span class="lineNum">    1313 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;K[4][iGlu] = -1;</span>
<span class="lineNum">    1314 </span>            :                 
<span class="lineNum">    1315 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;P[0][iGlu+1] = px2;</span>
<span class="lineNum">    1316 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;P[1][iGlu+1] = py2;</span>
<span class="lineNum">    1317 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;P[2][iGlu+1] = pz2;</span>
<span class="lineNum">    1318 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;P[3][iGlu+1] = pst;</span>
<span class="lineNum">    1319 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;P[4][iGlu+1] = 0.;</span>
<span class="lineNum">    1320 </span>            :                 
<span class="lineNum">    1321 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;K[0][iGlu+1] = 1;</span>
<span class="lineNum">    1322 </span><span class="lineNoCov">          0 :                 if (iglu == nGluon[isys] - 1) fPyjets-&gt;K[0][iGlu+1] = 1;</span>
<span class="lineNum">    1323 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;K[1][iGlu+1] = 21;  </span>
<span class="lineNum">    1324 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;K[2][iGlu+1] = fPyjets-&gt;K[2][in] + 1000;</span>
<span class="lineNum">    1325 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;K[3][iGlu+1] = -1;  </span>
<span class="lineNum">    1326 </span><span class="lineNoCov">          0 :                 fPyjets-&gt;K[4][iGlu+1] = -1;</span>
<span class="lineNum">    1327 </span><span class="lineNoCov">          0 :                 SetMSTU(1,0);</span>
<span class="lineNum">    1328 </span><span class="lineNoCov">          0 :                 SetMSTU(2,0);</span>
<span class="lineNum">    1329 </span>            :                 //
<span class="lineNum">    1330 </span>            :                 // Boost back
<span class="lineNum">    1331 </span>            :                 //
<span class="lineNum">    1332 </span><span class="lineNoCov">          0 :                 Pyrobo(iGlu + 1, iGlu + 2, 0., 0., bx, by, bz);</span>
<span class="lineNum">    1333 </span>            :             }
<span class="lineNum">    1334 </span>            : /*    
<span class="lineNum">    1335 </span>            :             for (Int_t ig = iGlu; ig &lt; iGlu+ish; ig++) {
<span class="lineNum">    1336 </span>            :                 Double_t px, py, pz;
<span class="lineNum">    1337 </span>            :                 px = fPyjets-&gt;P[0][ig]; 
<span class="lineNum">    1338 </span>            :                 py = fPyjets-&gt;P[1][ig]; 
<span class="lineNum">    1339 </span>            :                 pz = fPyjets-&gt;P[2][ig]; 
<span class="lineNum">    1340 </span>            :                 TVector3 v(px, py, pz);
<span class="lineNum">    1341 </span>            :                 v.RotateZ(-phiq[isys]);
<span class="lineNum">    1342 </span>            :                 v.RotateY(-thetaq[isys]);
<span class="lineNum">    1343 </span>            :                 Double_t pxs     = v.X(); Double_t pys = v.Y(); Double_t pzs  = v.Z();     
<span class="lineNum">    1344 </span>            :                 Double_t r       = AliPythiaRndm::GetPythiaRandom()-&gt;Rndm();
<span class="lineNum">    1345 </span>            :                 Double_t jtKick  = 0.3 * TMath::Sqrt(-TMath::Log(r));
<span class="lineNum">    1346 </span>            :                 if (ish == 2)   jtKick  = wjtKick[i] * TMath::Sqrt(-TMath::Log(r)) / TMath::Sqrt(2.);
<span class="lineNum">    1347 </span>            :                 Double_t phiKick = 2. * TMath::Pi() * AliPythiaRndm::GetPythiaRandom()-&gt;Rndm();
<span class="lineNum">    1348 </span>            :                 pxs += jtKick * TMath::Cos(phiKick);
<span class="lineNum">    1349 </span>            :                 pys += jtKick * TMath::Sin(phiKick);
<span class="lineNum">    1350 </span>            :                 TVector3 w(pxs, pys, pzs);
<span class="lineNum">    1351 </span>            :                 w.RotateY(thetaq[isys]);
<span class="lineNum">    1352 </span>            :                 w.RotateZ(phiq[isys]);
<span class="lineNum">    1353 </span>            :                 fPyjets-&gt;P[0][ig] = w.X(); 
<span class="lineNum">    1354 </span>            :                 fPyjets-&gt;P[1][ig] = w.Y(); 
<span class="lineNum">    1355 </span>            :                 fPyjets-&gt;P[2][ig] = w.Z(); 
<span class="lineNum">    1356 </span>            :                 fPyjets-&gt;P[2][ig] = w.Mag();
<span class="lineNum">    1357 </span>            :             }
<span class="lineNum">    1358 </span>            : */
<span class="lineNum">    1359 </span><span class="lineNoCov">          0 :         } // kGluon         </span>
<span class="lineNum">    1360 </span>            :         
<span class="lineNum">    1361 </span>            :         
<span class="lineNum">    1362 </span>            :     // Check energy conservation
<span class="lineNum">    1363 </span>            :         Double_t pxs = 0.;
<span class="lineNum">    1364 </span>            :         Double_t pys = 0.;
<span class="lineNum">    1365 </span>            :         Double_t pzs = 0.;      
<span class="lineNum">    1366 </span>            :         Double_t es  = 14000.;
<span class="lineNum">    1367 </span>            :         
<span class="lineNum">    1368 </span><span class="lineNoCov">          0 :         for (Int_t i = 0; i &lt; numpart; i++)</span>
<span class="lineNum">    1369 </span>            :         {
<span class="lineNum">    1370 </span><span class="lineNoCov">          0 :             kst =  fPyjets-&gt;K[0][i];</span>
<span class="lineNum">    1371 </span><span class="lineNoCov">          0 :             if (kst != 1 &amp;&amp; kst != 2) continue;</span>
<span class="lineNum">    1372 </span><span class="lineNoCov">          0 :             pxs += fPyjets-&gt;P[0][i];</span>
<span class="lineNum">    1373 </span><span class="lineNoCov">          0 :             pys += fPyjets-&gt;P[1][i];</span>
<span class="lineNum">    1374 </span><span class="lineNoCov">          0 :             pzs += fPyjets-&gt;P[2][i];     </span>
<span class="lineNum">    1375 </span><span class="lineNoCov">          0 :             es  -= fPyjets-&gt;P[3][i];     </span>
<span class="lineNum">    1376 </span><span class="lineNoCov">          0 :         }</span>
<span class="lineNum">    1377 </span><span class="lineNoCov">          0 :         if (TMath::Abs(pxs) &gt; 1.e-2 ||</span>
<span class="lineNum">    1378 </span><span class="lineNoCov">          0 :             TMath::Abs(pys) &gt; 1.e-2 ||</span>
<span class="lineNum">    1379 </span><span class="lineNoCov">          0 :             TMath::Abs(pzs) &gt; 1.e-1) {</span>
<span class="lineNum">    1380 </span><span class="lineNoCov">          0 :             printf(&quot;%e %e %e %e\n&quot;, pxs, pys, pzs, es);</span>
<span class="lineNum">    1381 </span>            : //              Fatal(&quot;Quench()&quot;, &quot;4-Momentum non-conservation&quot;);
<span class="lineNum">    1382 </span><span class="lineNoCov">          0 :         }</span>
<span class="lineNum">    1383 </span>            :         
<span class="lineNum">    1384 </span><span class="lineNoCov">          0 :     } // end quenching loop (systems)</span>
<span class="lineNum">    1385 </span>            : // Clean-up
<span class="lineNum">    1386 </span><span class="lineNoCov">          0 :     for (Int_t i = 0; i &lt; numpart; i++)</span>
<span class="lineNum">    1387 </span>            :     {
<span class="lineNum">    1388 </span><span class="lineNoCov">          0 :         imo =  fPyjets-&gt;K[2][i];</span>
<span class="lineNum">    1389 </span><span class="lineNoCov">          0 :         if (imo &gt; 1000) {</span>
<span class="lineNum">    1390 </span><span class="lineNoCov">          0 :             fPyjets-&gt;K[2][i] = fPyjets-&gt;K[2][i] % 1000;</span>
<span class="lineNum">    1391 </span><span class="lineNoCov">          0 :         }</span>
<span class="lineNum">    1392 </span>            :     }
<span class="lineNum">    1393 </span>            : //      this-&gt;Pylist(1);
<span class="lineNum">    1394 </span><span class="lineNoCov">          0 : } // end quench</span>
<a name="1395"><span class="lineNum">    1395 </span>            : </a>
<span class="lineNum">    1396 </span>            : 
<span class="lineNum">    1397 </span>            : void AliPythia::Pyquen(Double_t a, Int_t ibf, Double_t b)
<span class="lineNum">    1398 </span>            : {
<span class="lineNum">    1399 </span>            :     // Igor Lokthine's quenching routine
<span class="lineNum">    1400 </span>            :     // http://lokhtin.web.cern.ch/lokhtin/pyquen/pyquen.txt
<span class="lineNum">    1401 </span>            : 
<span class="lineNum">    1402 </span><span class="lineNoCov">          0 :     pyquen(a, ibf, b);</span>
<a name="1403"><span class="lineNum">    1403 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1404 </span>            : 
<span class="lineNum">    1405 </span>            : void AliPythia::SetPyquenParameters(Double_t t0, Double_t tau0, Int_t nf, Int_t iengl, Int_t iangl)
<span class="lineNum">    1406 </span>            : {
<span class="lineNum">    1407 </span>            :     // Set the parameters for the PYQUEN package.
<span class="lineNum">    1408 </span>            :     // See comments in PyquenCommon.h
<span class="lineNum">    1409 </span>            :     
<span class="lineNum">    1410 </span>            :     
<span class="lineNum">    1411 </span><span class="lineNoCov">          0 :     PYQPAR.t0    = t0;</span>
<span class="lineNum">    1412 </span><span class="lineNoCov">          0 :     PYQPAR.tau0  = tau0;</span>
<span class="lineNum">    1413 </span><span class="lineNoCov">          0 :     PYQPAR.nf    = nf;</span>
<span class="lineNum">    1414 </span><span class="lineNoCov">          0 :     PYQPAR.iengl = iengl;</span>
<span class="lineNum">    1415 </span><span class="lineNoCov">          0 :     PYQPAR.iangl = iangl;</span>
<span class="lineNum">    1416 </span><span class="lineNoCov">          0 : }</span>
<a name="1417"><span class="lineNum">    1417 </span>            : </a>
<span class="lineNum">    1418 </span>            : 
<span class="lineNum">    1419 </span>            : void AliPythia::Pyevnw()
<span class="lineNum">    1420 </span>            : {
<span class="lineNum">    1421 </span>            :     // New multiple interaction scenario
<span class="lineNum">    1422 </span><span class="lineNoCov">          0 :     pyevnw();</span>
<a name="1423"><span class="lineNum">    1423 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1424 </span>            : 
<span class="lineNum">    1425 </span>            : void  AliPythia::Pyshowq(Int_t ip1, Int_t ip2, Double_t qmax)
<span class="lineNum">    1426 </span>            : {
<span class="lineNum">    1427 </span>            :     //  Call medium-modified Pythia jet reconstruction algorithm
<span class="lineNum">    1428 </span>            :     //
<a name="1429"><span class="lineNum">    1429 </span><span class="lineNoCov">          0 :     pyshowq(ip1, ip2, qmax);</span></a>
<span class="lineNum">    1430 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">    1431 </span>            :  void AliPythia::Qpygin0()                                                                      
<span class="lineNum">    1432 </span>            :  {                                                                                              
<span class="lineNum">    1433 </span>            :      // New multiple interaction scenario                                                       
<span class="lineNum">    1434 </span><span class="lineNoCov">          0 :      qpygin0();                                                                                 </span>
<a name="1435"><span class="lineNum">    1435 </span><span class="lineNoCov">          0 :  }</span></a>
<span class="lineNum">    1436 </span>            : 
<span class="lineNum">    1437 </span>            : void AliPythia::GetQuenchingParameters(Double_t&amp; xp, Double_t&amp; yp, Double_t z[4])
<span class="lineNum">    1438 </span>            : {
<span class="lineNum">    1439 </span>            :     // Return event specific quenching parameters
<span class="lineNum">    1440 </span><span class="lineNoCov">          0 :     xp = fXJet;</span>
<span class="lineNum">    1441 </span><span class="lineNoCov">          0 :     yp = fYJet;</span>
<span class="lineNum">    1442 </span><span class="lineNoCov">          0 :     for (Int_t i = 0; i &lt; 4; i++) z[i] = fZQuench[i];</span>
<span class="lineNum">    1443 </span>            : 
<a name="1444"><span class="lineNum">    1444 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1445 </span>            : 
<span class="lineNum">    1446 </span>            : void AliPythia::ConfigHeavyFlavor()
<span class="lineNum">    1447 </span>            : {
<span class="lineNum">    1448 </span>            :     //
<span class="lineNum">    1449 </span>            :     // Default configuration for Heavy Flavor production
<span class="lineNum">    1450 </span>            :     //
<span class="lineNum">    1451 </span>            :     // All QCD processes
<span class="lineNum">    1452 </span>            :     //
<span class="lineNum">    1453 </span><span class="lineNoCov">          0 :     SetMSEL(1);</span>
<span class="lineNum">    1454 </span>            :     
<span class="lineNum">    1455 </span>            : 
<span class="lineNum">    1456 </span><span class="lineNoCov">          0 :     if (fItune &lt; 0) {</span>
<span class="lineNum">    1457 </span>            :       // No multiple interactions
<span class="lineNum">    1458 </span><span class="lineNoCov">          0 :       SetMSTP(81,0);</span>
<span class="lineNum">    1459 </span><span class="lineNoCov">          0 :       SetPARP(81, 0.);</span>
<span class="lineNum">    1460 </span><span class="lineNoCov">          0 :       SetPARP(82, 0.);    </span>
<span class="lineNum">    1461 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">    1462 </span>            :     // Initial/final parton shower on (Pythia default)
<span class="lineNum">    1463 </span><span class="lineNoCov">          0 :     SetMSTP(61,1);</span>
<span class="lineNum">    1464 </span><span class="lineNoCov">          0 :     SetMSTP(71,1);</span>
<span class="lineNum">    1465 </span>            :     
<span class="lineNum">    1466 </span>            :     // 2nd order alpha_s
<span class="lineNum">    1467 </span><span class="lineNoCov">          0 :     SetMSTP(2,2);</span>
<span class="lineNum">    1468 </span>            :     
<span class="lineNum">    1469 </span>            :     // QCD scales
<span class="lineNum">    1470 </span><span class="lineNoCov">          0 :     SetMSTP(32,2);</span>
<span class="lineNum">    1471 </span><span class="lineNoCov">          0 :     SetPARP(34,1.0);</span>
<a name="1472"><span class="lineNum">    1472 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1473 </span>            : 
<span class="lineNum">    1474 </span>            : void AliPythia::AtlasTuning()
<span class="lineNum">    1475 </span>            : {
<span class="lineNum">    1476 </span>            :     //
<span class="lineNum">    1477 </span>            :     // Configuration for the ATLAS tuning
<span class="lineNum">    1478 </span><span class="lineNoCov">          0 :     if (fItune &gt; -1) return;</span>
<span class="lineNum">    1479 </span><span class="lineNoCov">          0 :     printf(&quot;ATLAS TUNE \n&quot;);</span>
<span class="lineNum">    1480 </span>            :     
<span class="lineNum">    1481 </span><span class="lineNoCov">          0 :     SetMSTP(51, AliStructFuncType::PDFsetIndex(kCTEQ5L));      // CTEQ5L pdf</span>
<span class="lineNum">    1482 </span><span class="lineNoCov">          0 :     SetMSTP(81,1);             // Multiple Interactions ON</span>
<span class="lineNum">    1483 </span><span class="lineNoCov">          0 :     SetMSTP(82,4);             // Double Gaussian Model</span>
<span class="lineNum">    1484 </span><span class="lineNoCov">          0 :     SetPARP(81,1.9);           // Min. pt for multiple interactions (default in 6.2-14) </span>
<span class="lineNum">    1485 </span><span class="lineNoCov">          0 :     SetPARP(82,1.8);           // [GeV]    PT_min at Ref. energy</span>
<span class="lineNum">    1486 </span><span class="lineNoCov">          0 :     SetPARP(89,1000.);         // [GeV]   Ref. energy</span>
<span class="lineNum">    1487 </span><span class="lineNoCov">          0 :     SetPARP(90,0.16);          // 2*epsilon (exponent in power law)</span>
<span class="lineNum">    1488 </span><span class="lineNoCov">          0 :     SetPARP(83,0.5);           // Core density in proton matter distribution (def.value)</span>
<span class="lineNum">    1489 </span><span class="lineNoCov">          0 :     SetPARP(84,0.5);           // Core radius</span>
<span class="lineNum">    1490 </span><span class="lineNoCov">          0 :     SetPARP(85,0.33);          // Regulates gluon prod. mechanism</span>
<span class="lineNum">    1491 </span><span class="lineNoCov">          0 :     SetPARP(86,0.66);          // Regulates gluon prod. mechanism</span>
<span class="lineNum">    1492 </span><span class="lineNoCov">          0 :     SetPARP(67,1);             // Regulates Initial State Radiation</span>
<a name="1493"><span class="lineNum">    1493 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1494 </span>            : 
<span class="lineNum">    1495 </span>            : void AliPythia::AtlasTuningMC09()
<span class="lineNum">    1496 </span>            : {
<span class="lineNum">    1497 </span>            :     //
<span class="lineNum">    1498 </span>            :     // Configuration for the ATLAS tuning
<span class="lineNum">    1499 </span><span class="lineNoCov">          0 :     if (fItune &gt; -1) return;</span>
<span class="lineNum">    1500 </span><span class="lineNoCov">          0 :     printf(&quot;ATLAS New TUNE MC09\n&quot;);</span>
<span class="lineNum">    1501 </span><span class="lineNoCov">          0 :     SetMSTP(81,21);             // treatment for MI, ISR, FSR and beam remnants: MI on, new model</span>
<span class="lineNum">    1502 </span><span class="lineNoCov">          0 :     SetMSTP(82, 4);             // Double Gaussian Model</span>
<span class="lineNum">    1503 </span><span class="lineNoCov">          0 :     SetMSTP(52, 2);             // External PDF</span>
<span class="lineNum">    1504 </span><span class="lineNoCov">          0 :     SetMSTP(51, 20650);         // MRST LO*</span>
<span class="lineNum">    1505 </span>            :   
<span class="lineNum">    1506 </span>            :     
<span class="lineNum">    1507 </span><span class="lineNoCov">          0 :     SetMSTP(70, 0);             // (was 2: def manual 1, def code 0) virtuality scale for ISR </span>
<span class="lineNum">    1508 </span><span class="lineNoCov">          0 :     SetMSTP(72, 1);             // (was 0: def 1) maximum scale for FSR</span>
<span class="lineNum">    1509 </span><span class="lineNoCov">          0 :     SetMSTP(88, 1);             // (was 0: def 1) strategy for qq junction to di-quark or baryon in beam remnant</span>
<span class="lineNum">    1510 </span><span class="lineNoCov">          0 :     SetMSTP(90, 0);             // (was 1: def 0) strategy of compensate the primordial kT</span>
<span class="lineNum">    1511 </span>            : 
<span class="lineNum">    1512 </span><span class="lineNoCov">          0 :     SetPARP(78, 0.3);           // the amount of color reconnection in the final state</span>
<span class="lineNum">    1513 </span><span class="lineNoCov">          0 :     SetPARP(80, 0.1);           // probability of color partons kicked out from beam remnant</span>
<span class="lineNum">    1514 </span><span class="lineNoCov">          0 :     SetPARP(82, 2.3);           // [GeV]    PT_min at Ref. energy    </span>
<span class="lineNum">    1515 </span><span class="lineNoCov">          0 :     SetPARP(83, 0.8);           // Core density in proton matter distribution (def.value)    </span>
<span class="lineNum">    1516 </span><span class="lineNoCov">          0 :     SetPARP(84, 0.7);           // Core radius</span>
<span class="lineNum">    1517 </span><span class="lineNoCov">          0 :     SetPARP(90, 0.25);          //  2*epsilon (exponent in power law)</span>
<span class="lineNum">    1518 </span><span class="lineNoCov">          0 :     SetPARJ(81, 0.29);          // (was 0.14: def 0.29) Labmda value in running alpha_s for parton showers</span>
<span class="lineNum">    1519 </span>            : 
<span class="lineNum">    1520 </span><span class="lineNoCov">          0 :     SetMSTP(95, 6);</span>
<span class="lineNum">    1521 </span><span class="lineNoCov">          0 :     SetPARJ(41, 0.3);           // a and b parameters of the symmm. Lund FF</span>
<span class="lineNum">    1522 </span><span class="lineNoCov">          0 :     SetPARJ(42, 0.58);</span>
<span class="lineNum">    1523 </span><span class="lineNoCov">          0 :     SetPARJ(46, 0.75);          // mod. of the Lund FF for heavy end-point quarks</span>
<span class="lineNum">    1524 </span><span class="lineNoCov">          0 :     SetPARP(89,1800.);         // [GeV]   Ref. energy</span>
<a name="1525"><span class="lineNum">    1525 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1526 </span>            : 
<span class="lineNum">    1527 </span>            : AliPythia&amp; AliPythia::operator=(const  AliPythia&amp; rhs)
<span class="lineNum">    1528 </span>            : {
<span class="lineNum">    1529 </span>            : // Assignment operator
<span class="lineNum">    1530 </span><span class="lineNoCov">          0 :     rhs.Copy(*this);</span>
<span class="lineNum">    1531 </span><span class="lineNoCov">          0 :     return *this;</span>
<a name="1532"><span class="lineNum">    1532 </span>            : }</a>
<span class="lineNum">    1533 </span>            : 
<span class="lineNum">    1534 </span>            :  void AliPythia::Copy(TObject&amp;) const
<span class="lineNum">    1535 </span>            : {
<span class="lineNum">    1536 </span>            :     //
<span class="lineNum">    1537 </span>            :     // Copy 
<span class="lineNum">    1538 </span>            :     //
<span class="lineNum">    1539 </span><span class="lineNoCov">          0 :     Fatal(&quot;Copy&quot;,&quot;Not implemented!\n&quot;);</span>
<a name="1540"><span class="lineNum">    1540 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1541 </span>            : 
<span class="lineNum">    1542 </span>            : void AliPythia::DalitzDecays()
<span class="lineNum">    1543 </span>            : {
<span class="lineNum">    1544 </span>            : 
<span class="lineNum">    1545 </span>            :   //
<span class="lineNum">    1546 </span>            :   // Replace all omega dalitz decays with the correct matrix element decays
<span class="lineNum">    1547 </span>            :   //
<span class="lineNum">    1548 </span><span class="lineNoCov">          0 :   Int_t nt = fPyjets-&gt;N;</span>
<span class="lineNum">    1549 </span><span class="lineNoCov">          0 :   for (Int_t i = 0; i &lt; nt; i++) {</span>
<span class="lineNum">    1550 </span><span class="lineNoCov">          0 :     if (fPyjets-&gt;K[1][i] != 223)                       continue;     </span>
<span class="lineNum">    1551 </span><span class="lineNoCov">          0 :     Int_t fd = fPyjets-&gt;K[3][i] - 1;</span>
<span class="lineNum">    1552 </span><span class="lineNoCov">          0 :     Int_t ld = fPyjets-&gt;K[4][i] - 1;</span>
<span class="lineNum">    1553 </span><span class="lineNoCov">          0 :     if (fd &lt; 0)                                        continue;</span>
<span class="lineNum">    1554 </span><span class="lineNoCov">          0 :     if ((ld - fd) != 2)                                continue;</span>
<span class="lineNum">    1555 </span><span class="lineNoCov">          0 :     if ((fPyjets-&gt;K[1][fd] != 111) ||</span>
<span class="lineNum">    1556 </span><span class="lineNoCov">          0 :         ((TMath::Abs(fPyjets-&gt;K[1][fd+1]) != 11) &amp;&amp; (TMath::Abs(fPyjets-&gt;K[1][fd+1]) != 13)))</span>
<span class="lineNum">    1557 </span><span class="lineNoCov">          0 :         continue;</span>
<span class="lineNum">    1558 </span><span class="lineNoCov">          0 :     TLorentzVector omega(fPyjets-&gt;P[0][i], fPyjets-&gt;P[1][i], fPyjets-&gt;P[2][i], fPyjets-&gt;P[3][i]);</span>
<span class="lineNum">    1559 </span><span class="lineNoCov">          0 :     Int_t pdg = TMath::Abs(fPyjets-&gt;K[1][fd+1]);</span>
<span class="lineNum">    1560 </span><span class="lineNoCov">          0 :     fOmegaDalitz.Decay(pdg, &amp;omega);</span>
<span class="lineNum">    1561 </span><span class="lineNoCov">          0 :     for (Int_t j = 0; j &lt; 3; j++) {</span>
<span class="lineNum">    1562 </span><span class="lineNoCov">          0 :       for (Int_t k = 0; k &lt; 4; k++) {</span>
<span class="lineNum">    1563 </span><span class="lineNoCov">          0 :         TLorentzVector vec = (fOmegaDalitz.Products())[2-j];</span>
<span class="lineNum">    1564 </span><span class="lineNoCov">          0 :         fPyjets-&gt;P[k][fd+j] = vec[k];</span>
<span class="lineNum">    1565 </span><span class="lineNoCov">          0 :       }</span>
<span class="lineNum">    1566 </span>            :     }
<span class="lineNum">    1567 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">    1568 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">    1569 </span>            : 
<span class="lineNum">    1570 </span>            : 
<span class="lineNum">    1571 </span>            : //
<span class="lineNum">    1572 </span>            : // Replace all dalitz(pi0,eta,omega,eta',phi) and resonance(rho,omega,phi,jpsi) decays with the correct matrix element decays
<span class="lineNum">    1573 </span>            : // for di-electron cocktail calculations
<span class="lineNum">    1574 </span>            : //
<a name="1575"><span class="lineNum">    1575 </span>            : </a>
<span class="lineNum">    1576 </span>            : 
<span class="lineNum">    1577 </span>            : void AliPythia::PizeroDalitz()
<span class="lineNum">    1578 </span>            : {
<span class="lineNum">    1579 </span>            : 
<span class="lineNum">    1580 </span><span class="lineNoCov">          0 :   Int_t nt = fPyjets-&gt;N;</span>
<span class="lineNum">    1581 </span><span class="lineNoCov">          0 :   for (Int_t i = 0; i &lt; nt; i++) {</span>
<span class="lineNum">    1582 </span><span class="lineNoCov">          0 :   if (fPyjets-&gt;K[1][i] != 111)                       continue;</span>
<span class="lineNum">    1583 </span><span class="lineNoCov">          0 :   Int_t fd = fPyjets-&gt;K[3][i] - 1;</span>
<span class="lineNum">    1584 </span><span class="lineNoCov">          0 :   Int_t ld = fPyjets-&gt;K[4][i] - 1;</span>
<span class="lineNum">    1585 </span><span class="lineNoCov">          0 :   if (fd &lt; 0)                                        continue;</span>
<span class="lineNum">    1586 </span><span class="lineNoCov">          0 :   if ((ld - fd) != 2)                                continue;</span>
<span class="lineNum">    1587 </span><span class="lineNoCov">          0 :   if ((fPyjets-&gt;K[1][fd] != 22) || (TMath::Abs(fPyjets-&gt;K[1][fd+1]) != 11) )</span>
<span class="lineNum">    1588 </span><span class="lineNoCov">          0 :   continue;</span>
<span class="lineNum">    1589 </span><span class="lineNoCov">          0 :   TLorentzVector pizero(fPyjets-&gt;P[0][i], fPyjets-&gt;P[1][i], fPyjets-&gt;P[2][i], fPyjets-&gt;P[3][i]);</span>
<span class="lineNum">    1590 </span><span class="lineNoCov">          0 :   Int_t pdg = TMath::Abs(fPyjets-&gt;K[1][i]);</span>
<span class="lineNum">    1591 </span><span class="lineNoCov">          0 :   fExodus.Decay(pdg, &amp;pizero);</span>
<span class="lineNum">    1592 </span><span class="lineNoCov">          0 :   for (Int_t j = 0; j &lt; 3; j++) {</span>
<span class="lineNum">    1593 </span><span class="lineNoCov">          0 :   for (Int_t k = 0; k &lt; 4; k++) {</span>
<span class="lineNum">    1594 </span><span class="lineNoCov">          0 :   TLorentzVector vec = (fExodus.Products_pion())[2-j];</span>
<span class="lineNum">    1595 </span><span class="lineNoCov">          0 :   fPyjets-&gt;P[k][fd+j] = vec[k];</span>
<span class="lineNum">    1596 </span><span class="lineNoCov">          0 :         }</span>
<span class="lineNum">    1597 </span>            :       }
<span class="lineNum">    1598 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">    1599 </span><span class="lineNoCov">          0 : }</span>
<a name="1600"><span class="lineNum">    1600 </span>            : </a>
<span class="lineNum">    1601 </span>            : 
<span class="lineNum">    1602 </span>            : void AliPythia::EtaDalitz()
<span class="lineNum">    1603 </span>            : {
<span class="lineNum">    1604 </span>            : 
<span class="lineNum">    1605 </span><span class="lineNoCov">          0 :   Int_t nt = fPyjets-&gt;N;</span>
<span class="lineNum">    1606 </span><span class="lineNoCov">          0 :   for (Int_t i = 0; i &lt; nt; i++) {</span>
<span class="lineNum">    1607 </span><span class="lineNoCov">          0 :   if (fPyjets-&gt;K[1][i] != 221)                       continue;</span>
<span class="lineNum">    1608 </span><span class="lineNoCov">          0 :   Int_t fd = fPyjets-&gt;K[3][i] - 1;</span>
<span class="lineNum">    1609 </span><span class="lineNoCov">          0 :   Int_t ld = fPyjets-&gt;K[4][i] - 1;</span>
<span class="lineNum">    1610 </span><span class="lineNoCov">          0 :   if (fd &lt; 0)                                        continue;</span>
<span class="lineNum">    1611 </span><span class="lineNoCov">          0 :   if ((ld - fd) != 2)                                continue;</span>
<span class="lineNum">    1612 </span><span class="lineNoCov">          0 :   if ((fPyjets-&gt;K[1][fd] != 22) || (TMath::Abs(fPyjets-&gt;K[1][fd+1]) != 11))</span>
<span class="lineNum">    1613 </span><span class="lineNoCov">          0 :   continue;</span>
<span class="lineNum">    1614 </span><span class="lineNoCov">          0 :   TLorentzVector eta(fPyjets-&gt;P[0][i], fPyjets-&gt;P[1][i], fPyjets-&gt;P[2][i], fPyjets-&gt;P[3][i]);</span>
<span class="lineNum">    1615 </span><span class="lineNoCov">          0 :   Int_t pdg = TMath::Abs(fPyjets-&gt;K[1][i]);</span>
<span class="lineNum">    1616 </span><span class="lineNoCov">          0 :   fExodus.Decay(pdg, &amp;eta);</span>
<span class="lineNum">    1617 </span><span class="lineNoCov">          0 :   for (Int_t j = 0; j &lt; 3; j++) {</span>
<span class="lineNum">    1618 </span><span class="lineNoCov">          0 :   for (Int_t k = 0; k &lt; 4; k++) {</span>
<span class="lineNum">    1619 </span><span class="lineNoCov">          0 :   TLorentzVector vec = (fExodus.Products_eta())[2-j];</span>
<span class="lineNum">    1620 </span><span class="lineNoCov">          0 :   fPyjets-&gt;P[k][fd+j] = vec[k];</span>
<span class="lineNum">    1621 </span><span class="lineNoCov">          0 :         }</span>
<span class="lineNum">    1622 </span>            :      }
<span class="lineNum">    1623 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">    1624 </span><span class="lineNoCov">          0 : }</span>
<a name="1625"><span class="lineNum">    1625 </span>            : </a>
<span class="lineNum">    1626 </span>            : 
<span class="lineNum">    1627 </span>            : void AliPythia::RhoDirect()
<span class="lineNum">    1628 </span>            : {
<span class="lineNum">    1629 </span>            : 
<span class="lineNum">    1630 </span><span class="lineNoCov">          0 :   Int_t nt = fPyjets-&gt;N;</span>
<span class="lineNum">    1631 </span><span class="lineNoCov">          0 :   for (Int_t i = 0; i &lt; nt; i++) {</span>
<span class="lineNum">    1632 </span><span class="lineNoCov">          0 :   if (fPyjets-&gt;K[1][i] != 113)                       continue;</span>
<span class="lineNum">    1633 </span><span class="lineNoCov">          0 :   Int_t fd = fPyjets-&gt;K[3][i] - 1;</span>
<span class="lineNum">    1634 </span><span class="lineNoCov">          0 :   Int_t ld = fPyjets-&gt;K[4][i] - 1;</span>
<span class="lineNum">    1635 </span><span class="lineNoCov">          0 :   if (fd &lt; 0)                                        continue;</span>
<span class="lineNum">    1636 </span><span class="lineNoCov">          0 :   if ((ld - fd) != 1)                                continue;</span>
<span class="lineNum">    1637 </span><span class="lineNoCov">          0 :   if ((TMath::Abs(fPyjets-&gt;K[1][fd]) != 11))</span>
<span class="lineNum">    1638 </span><span class="lineNoCov">          0 :   continue;</span>
<span class="lineNum">    1639 </span><span class="lineNoCov">          0 :   TLorentzVector rho(fPyjets-&gt;P[0][i], fPyjets-&gt;P[1][i], fPyjets-&gt;P[2][i], fPyjets-&gt;P[3][i]);</span>
<span class="lineNum">    1640 </span><span class="lineNoCov">          0 :   Int_t pdg = TMath::Abs(fPyjets-&gt;K[1][i]);</span>
<span class="lineNum">    1641 </span><span class="lineNoCov">          0 :   fExodus.Decay(pdg, &amp;rho);</span>
<span class="lineNum">    1642 </span><span class="lineNoCov">          0 :   for (Int_t j = 0; j &lt; 2; j++) {</span>
<span class="lineNum">    1643 </span><span class="lineNoCov">          0 :   for (Int_t k = 0; k &lt; 4; k++) {</span>
<span class="lineNum">    1644 </span><span class="lineNoCov">          0 :   TLorentzVector vec = (fExodus.Products_rho())[1-j];</span>
<span class="lineNum">    1645 </span><span class="lineNoCov">          0 :   fPyjets-&gt;P[k][fd+j] = vec[k];</span>
<span class="lineNum">    1646 </span><span class="lineNoCov">          0 :         }</span>
<span class="lineNum">    1647 </span>            :      }
<span class="lineNum">    1648 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">    1649 </span><span class="lineNoCov">          0 : }</span>
<a name="1650"><span class="lineNum">    1650 </span>            : </a>
<span class="lineNum">    1651 </span>            : 
<span class="lineNum">    1652 </span>            : void AliPythia::OmegaDalitz()
<span class="lineNum">    1653 </span>            : {
<span class="lineNum">    1654 </span>            : 
<span class="lineNum">    1655 </span><span class="lineNoCov">          0 :   Int_t nt = fPyjets-&gt;N;</span>
<span class="lineNum">    1656 </span><span class="lineNoCov">          0 :   for (Int_t i = 0; i &lt; nt; i++) {</span>
<span class="lineNum">    1657 </span><span class="lineNoCov">          0 :   if (fPyjets-&gt;K[1][i] != 223)                       continue;</span>
<span class="lineNum">    1658 </span><span class="lineNoCov">          0 :   Int_t fd = fPyjets-&gt;K[3][i] - 1;</span>
<span class="lineNum">    1659 </span><span class="lineNoCov">          0 :   Int_t ld = fPyjets-&gt;K[4][i] - 1;</span>
<span class="lineNum">    1660 </span><span class="lineNoCov">          0 :   if (fd &lt; 0)                                        continue;</span>
<span class="lineNum">    1661 </span><span class="lineNoCov">          0 :   if ((ld - fd) != 2)                                continue;</span>
<span class="lineNum">    1662 </span><span class="lineNoCov">          0 :   if ((fPyjets-&gt;K[1][fd] != 111) || (TMath::Abs(fPyjets-&gt;K[1][fd+1]) != 11))</span>
<span class="lineNum">    1663 </span><span class="lineNoCov">          0 :   continue;</span>
<span class="lineNum">    1664 </span><span class="lineNoCov">          0 :   TLorentzVector omegadalitz(fPyjets-&gt;P[0][i], fPyjets-&gt;P[1][i], fPyjets-&gt;P[2][i], fPyjets-&gt;P[3][i]);</span>
<span class="lineNum">    1665 </span><span class="lineNoCov">          0 :   Int_t pdg = TMath::Abs(fPyjets-&gt;K[1][i]);</span>
<span class="lineNum">    1666 </span><span class="lineNoCov">          0 :   fExodus.Decay(pdg, &amp;omegadalitz);</span>
<span class="lineNum">    1667 </span><span class="lineNoCov">          0 :   for (Int_t j = 0; j &lt; 3; j++) {</span>
<span class="lineNum">    1668 </span><span class="lineNoCov">          0 :   for (Int_t k = 0; k &lt; 4; k++) {</span>
<span class="lineNum">    1669 </span><span class="lineNoCov">          0 :   TLorentzVector vec = (fExodus.Products_omega_dalitz())[2-j];</span>
<span class="lineNum">    1670 </span><span class="lineNoCov">          0 :   fPyjets-&gt;P[k][fd+j] = vec[k];</span>
<span class="lineNum">    1671 </span><span class="lineNoCov">          0 :         }</span>
<span class="lineNum">    1672 </span>            :      }
<span class="lineNum">    1673 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">    1674 </span><span class="lineNoCov">          0 : }</span>
<a name="1675"><span class="lineNum">    1675 </span>            : </a>
<span class="lineNum">    1676 </span>            : 
<span class="lineNum">    1677 </span>            : void AliPythia::OmegaDirect()
<span class="lineNum">    1678 </span>            : {
<span class="lineNum">    1679 </span>            : 
<span class="lineNum">    1680 </span><span class="lineNoCov">          0 :   Int_t nt = fPyjets-&gt;N;</span>
<span class="lineNum">    1681 </span><span class="lineNoCov">          0 :   for (Int_t i = 0; i &lt; nt; i++) {</span>
<span class="lineNum">    1682 </span><span class="lineNoCov">          0 :   if (fPyjets-&gt;K[1][i] != 223)                       continue;</span>
<span class="lineNum">    1683 </span><span class="lineNoCov">          0 :   Int_t fd = fPyjets-&gt;K[3][i] - 1;</span>
<span class="lineNum">    1684 </span><span class="lineNoCov">          0 :   Int_t ld = fPyjets-&gt;K[4][i] - 1;</span>
<span class="lineNum">    1685 </span><span class="lineNoCov">          0 :   if (fd &lt; 0)                                        continue;</span>
<span class="lineNum">    1686 </span><span class="lineNoCov">          0 :   if ((ld - fd) != 1)                                continue;</span>
<span class="lineNum">    1687 </span><span class="lineNoCov">          0 :   if ((TMath::Abs(fPyjets-&gt;K[1][fd]) != 11))</span>
<span class="lineNum">    1688 </span><span class="lineNoCov">          0 :   continue;</span>
<span class="lineNum">    1689 </span><span class="lineNoCov">          0 :   TLorentzVector omegadirect(fPyjets-&gt;P[0][i], fPyjets-&gt;P[1][i], fPyjets-&gt;P[2][i], fPyjets-&gt;P[3][i]);</span>
<span class="lineNum">    1690 </span><span class="lineNoCov">          0 :   Int_t pdg = TMath::Abs(fPyjets-&gt;K[1][i]);</span>
<span class="lineNum">    1691 </span><span class="lineNoCov">          0 :   fExodus.Decay(pdg, &amp;omegadirect);</span>
<span class="lineNum">    1692 </span><span class="lineNoCov">          0 :   for (Int_t j = 0; j &lt; 2; j++) {</span>
<span class="lineNum">    1693 </span><span class="lineNoCov">          0 :   for (Int_t k = 0; k &lt; 4; k++) {</span>
<span class="lineNum">    1694 </span><span class="lineNoCov">          0 :   TLorentzVector vec = (fExodus.Products_omega())[1-j];</span>
<span class="lineNum">    1695 </span><span class="lineNoCov">          0 :   fPyjets-&gt;P[k][fd+j] = vec[k];</span>
<span class="lineNum">    1696 </span><span class="lineNoCov">          0 :         }</span>
<span class="lineNum">    1697 </span>            :      }
<span class="lineNum">    1698 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">    1699 </span><span class="lineNoCov">          0 : }</span>
<a name="1700"><span class="lineNum">    1700 </span>            : </a>
<span class="lineNum">    1701 </span>            : 
<span class="lineNum">    1702 </span>            : void AliPythia::EtaprimeDalitz()
<span class="lineNum">    1703 </span>            : {
<span class="lineNum">    1704 </span>            : 
<span class="lineNum">    1705 </span><span class="lineNoCov">          0 :   Int_t nt = fPyjets-&gt;N;</span>
<span class="lineNum">    1706 </span><span class="lineNoCov">          0 :   for (Int_t i = 0; i &lt; nt; i++) {</span>
<span class="lineNum">    1707 </span><span class="lineNoCov">          0 :   if (fPyjets-&gt;K[1][i] != 331)                       continue;</span>
<span class="lineNum">    1708 </span><span class="lineNoCov">          0 :   Int_t fd = fPyjets-&gt;K[3][i] - 1;</span>
<span class="lineNum">    1709 </span><span class="lineNoCov">          0 :   Int_t ld = fPyjets-&gt;K[4][i] - 1;</span>
<span class="lineNum">    1710 </span><span class="lineNoCov">          0 :   if (fd &lt; 0)                                        continue;</span>
<span class="lineNum">    1711 </span><span class="lineNoCov">          0 :   if ((ld - fd) != 2)                                continue;</span>
<span class="lineNum">    1712 </span><span class="lineNoCov">          0 :   if ((fPyjets-&gt;K[1][fd] != 22) || (TMath::Abs(fPyjets-&gt;K[1][fd+1]) != 11))</span>
<span class="lineNum">    1713 </span><span class="lineNoCov">          0 :   continue;</span>
<span class="lineNum">    1714 </span><span class="lineNoCov">          0 :   TLorentzVector etaprime(fPyjets-&gt;P[0][i], fPyjets-&gt;P[1][i], fPyjets-&gt;P[2][i], fPyjets-&gt;P[3][i]);</span>
<span class="lineNum">    1715 </span><span class="lineNoCov">          0 :   Int_t pdg = TMath::Abs(fPyjets-&gt;K[1][i]);</span>
<span class="lineNum">    1716 </span><span class="lineNoCov">          0 :   fExodus.Decay(pdg, &amp;etaprime);</span>
<span class="lineNum">    1717 </span><span class="lineNoCov">          0 :   for (Int_t j = 0; j &lt; 3; j++) {</span>
<span class="lineNum">    1718 </span><span class="lineNoCov">          0 :   for (Int_t k = 0; k &lt; 4; k++) {</span>
<span class="lineNum">    1719 </span><span class="lineNoCov">          0 :   TLorentzVector vec = (fExodus.Products_etaprime())[2-j];</span>
<span class="lineNum">    1720 </span><span class="lineNoCov">          0 :   fPyjets-&gt;P[k][fd+j] = vec[k];</span>
<span class="lineNum">    1721 </span><span class="lineNoCov">          0 :         }</span>
<span class="lineNum">    1722 </span>            :      }
<span class="lineNum">    1723 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">    1724 </span><span class="lineNoCov">          0 : }</span>
<a name="1725"><span class="lineNum">    1725 </span>            : </a>
<span class="lineNum">    1726 </span>            : 
<span class="lineNum">    1727 </span>            : void AliPythia::PhiDalitz()
<span class="lineNum">    1728 </span>            : {
<span class="lineNum">    1729 </span>            : 
<span class="lineNum">    1730 </span><span class="lineNoCov">          0 :   Int_t nt = fPyjets-&gt;N;</span>
<span class="lineNum">    1731 </span><span class="lineNoCov">          0 :   for (Int_t i = 0; i &lt; nt; i++) {</span>
<span class="lineNum">    1732 </span><span class="lineNoCov">          0 :   if (fPyjets-&gt;K[1][i] != 333)                       continue;</span>
<span class="lineNum">    1733 </span><span class="lineNoCov">          0 :   Int_t fd = fPyjets-&gt;K[3][i] - 1;</span>
<span class="lineNum">    1734 </span><span class="lineNoCov">          0 :   Int_t ld = fPyjets-&gt;K[4][i] - 1;</span>
<span class="lineNum">    1735 </span><span class="lineNoCov">          0 :   if (fd &lt; 0)                                        continue;</span>
<span class="lineNum">    1736 </span><span class="lineNoCov">          0 :   if ((ld - fd) != 2)                                continue;</span>
<span class="lineNum">    1737 </span><span class="lineNoCov">          0 :   if ((fPyjets-&gt;K[1][fd] != 221) || (TMath::Abs(fPyjets-&gt;K[1][fd+1]) != 11))</span>
<span class="lineNum">    1738 </span><span class="lineNoCov">          0 :   continue;</span>
<span class="lineNum">    1739 </span><span class="lineNoCov">          0 :   TLorentzVector phidalitz(fPyjets-&gt;P[0][i], fPyjets-&gt;P[1][i], fPyjets-&gt;P[2][i], fPyjets-&gt;P[3][i]);</span>
<span class="lineNum">    1740 </span><span class="lineNoCov">          0 :   Int_t pdg = TMath::Abs(fPyjets-&gt;K[1][i]);</span>
<span class="lineNum">    1741 </span><span class="lineNoCov">          0 :   fExodus.Decay(pdg, &amp;phidalitz);</span>
<span class="lineNum">    1742 </span><span class="lineNoCov">          0 :   for (Int_t j = 0; j &lt; 3; j++) {</span>
<span class="lineNum">    1743 </span><span class="lineNoCov">          0 :   for (Int_t k = 0; k &lt; 4; k++) {</span>
<span class="lineNum">    1744 </span><span class="lineNoCov">          0 :   TLorentzVector vec = (fExodus.Products_phi_dalitz())[2-j];</span>
<span class="lineNum">    1745 </span><span class="lineNoCov">          0 :   fPyjets-&gt;P[k][fd+j] = vec[k];</span>
<span class="lineNum">    1746 </span><span class="lineNoCov">          0 :         }</span>
<span class="lineNum">    1747 </span>            :      }
<span class="lineNum">    1748 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">    1749 </span><span class="lineNoCov">          0 : }</span>
<a name="1750"><span class="lineNum">    1750 </span>            : </a>
<span class="lineNum">    1751 </span>            : 
<span class="lineNum">    1752 </span>            : void AliPythia::PhiDirect()
<span class="lineNum">    1753 </span>            : {
<span class="lineNum">    1754 </span>            : 
<span class="lineNum">    1755 </span><span class="lineNoCov">          0 :   Int_t nt = fPyjets-&gt;N;</span>
<span class="lineNum">    1756 </span><span class="lineNoCov">          0 :   for (Int_t i = 0; i &lt; nt; i++) {</span>
<span class="lineNum">    1757 </span><span class="lineNoCov">          0 :   if (fPyjets-&gt;K[1][i] != 333)                       continue;</span>
<span class="lineNum">    1758 </span><span class="lineNoCov">          0 :   Int_t fd = fPyjets-&gt;K[3][i] - 1;</span>
<span class="lineNum">    1759 </span><span class="lineNoCov">          0 :   Int_t ld = fPyjets-&gt;K[4][i] - 1;</span>
<span class="lineNum">    1760 </span><span class="lineNoCov">          0 :   if (fd &lt; 0)                                        continue;</span>
<span class="lineNum">    1761 </span><span class="lineNoCov">          0 :   if ((ld - fd) != 1)                                continue;</span>
<span class="lineNum">    1762 </span><span class="lineNoCov">          0 :   if ((TMath::Abs(fPyjets-&gt;K[1][fd]) != 11))</span>
<span class="lineNum">    1763 </span><span class="lineNoCov">          0 :   continue;</span>
<span class="lineNum">    1764 </span><span class="lineNoCov">          0 :   TLorentzVector phi(fPyjets-&gt;P[0][i], fPyjets-&gt;P[1][i], fPyjets-&gt;P[2][i], fPyjets-&gt;P[3][i]);</span>
<span class="lineNum">    1765 </span><span class="lineNoCov">          0 :   Int_t pdg = TMath::Abs(fPyjets-&gt;K[1][i]);</span>
<span class="lineNum">    1766 </span><span class="lineNoCov">          0 :   fExodus.Decay(pdg, &amp;phi);</span>
<span class="lineNum">    1767 </span><span class="lineNoCov">          0 :   for (Int_t j = 0; j &lt; 2; j++) {</span>
<span class="lineNum">    1768 </span><span class="lineNoCov">          0 :   for (Int_t k = 0; k &lt; 4; k++) {</span>
<span class="lineNum">    1769 </span><span class="lineNoCov">          0 :   TLorentzVector vec = (fExodus.Products_phi())[1-j];</span>
<span class="lineNum">    1770 </span><span class="lineNoCov">          0 :   fPyjets-&gt;P[k][fd+j] = vec[k];</span>
<span class="lineNum">    1771 </span><span class="lineNoCov">          0 :         }</span>
<span class="lineNum">    1772 </span>            :      }
<span class="lineNum">    1773 </span><span class="lineNoCov">          0 :   }</span>
<a name="1774"><span class="lineNum">    1774 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1775 </span>            : 
<span class="lineNum">    1776 </span>            : void AliPythia::JPsiDirect()
<span class="lineNum">    1777 </span>            : {
<span class="lineNum">    1778 </span>            : 
<span class="lineNum">    1779 </span><span class="lineNoCov">          0 :   Int_t nt = fPyjets-&gt;N;</span>
<span class="lineNum">    1780 </span><span class="lineNoCov">          0 :   for (Int_t i = 0; i &lt; nt; i++) {</span>
<span class="lineNum">    1781 </span><span class="lineNoCov">          0 :   if (fPyjets-&gt;K[1][i] != 443)                       continue;</span>
<span class="lineNum">    1782 </span><span class="lineNoCov">          0 :   Int_t fd = fPyjets-&gt;K[3][i] - 1;</span>
<span class="lineNum">    1783 </span><span class="lineNoCov">          0 :   Int_t ld = fPyjets-&gt;K[4][i] - 1;</span>
<span class="lineNum">    1784 </span><span class="lineNoCov">          0 :   if (fd &lt; 0)                                        continue;</span>
<span class="lineNum">    1785 </span><span class="lineNoCov">          0 :   if ((ld - fd) != 1)                                continue;</span>
<span class="lineNum">    1786 </span><span class="lineNoCov">          0 :   if ((TMath::Abs(fPyjets-&gt;K[1][fd]) != 11))</span>
<span class="lineNum">    1787 </span><span class="lineNoCov">          0 :   continue;</span>
<span class="lineNum">    1788 </span><span class="lineNoCov">          0 :   TLorentzVector jpsi(fPyjets-&gt;P[0][i], fPyjets-&gt;P[1][i], fPyjets-&gt;P[2][i], fPyjets-&gt;P[3][i]);</span>
<span class="lineNum">    1789 </span><span class="lineNoCov">          0 :   Int_t pdg = TMath::Abs(fPyjets-&gt;K[1][i]);</span>
<span class="lineNum">    1790 </span><span class="lineNoCov">          0 :   fExodus.Decay(pdg, &amp;jpsi);</span>
<span class="lineNum">    1791 </span><span class="lineNoCov">          0 :   for (Int_t j = 0; j &lt; 2; j++) {</span>
<span class="lineNum">    1792 </span><span class="lineNoCov">          0 :   for (Int_t k = 0; k &lt; 4; k++) {</span>
<span class="lineNum">    1793 </span><span class="lineNoCov">          0 :   TLorentzVector vec = (fExodus.Products_jpsi())[1-j];</span>
<span class="lineNum">    1794 </span><span class="lineNoCov">          0 :   fPyjets-&gt;P[k][fd+j] = vec[k];</span>
<span class="lineNum">    1795 </span><span class="lineNoCov">          0 :         }</span>
<span class="lineNum">    1796 </span>            :      }
<span class="lineNum">    1797 </span><span class="lineNoCov">          0 :   }</span>
<a name="1798"><span class="lineNum">    1798 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1799 </span>            : 
<span class="lineNum">    1800 </span>            : Int_t AliPythia::GetNMPI()
<span class="lineNum">    1801 </span>            : {
<span class="lineNum">    1802 </span>            :   // returns the number of parton-parton interactions
<span class="lineNum">    1803 </span><span class="lineNoCov">          0 :   return (GetMSTI(31));</span>
<span class="lineNum">    1804 </span>            : }
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.11</a></td></tr>
  </table>
  <br>

</body>
</html>
