<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - coverage.info - PYTHIA6/AliPythia6/AliGenPythia.cxx</title>
  <link rel="stylesheet" type="text/css" href="../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../index.html">top level</a> - <a href="index.html">PYTHIA6/AliPythia6</a> - AliGenPythia.cxx<span style="font-size: 80%;"> (source / <a href="AliGenPythia.cxx.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">coverage.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">1</td>
            <td class="headerCovTableEntry">1288</td>
            <td class="headerCovTableEntryLo">0.1 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2016-06-14 17:26:59</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">1</td>
            <td class="headerCovTableEntry">38</td>
            <td class="headerCovTableEntryLo">2.6 %</td>
          </tr>
          <tr><td><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            : /**************************************************************************</a>
<span class="lineNum">       2 </span>            :  * Copyright(c) 1998-1999, ALICE Experiment at CERN, All rights reserved. *
<span class="lineNum">       3 </span>            :  *                                                                        *
<span class="lineNum">       4 </span>            :  * Author: The ALICE Off-line Project.                                    *
<span class="lineNum">       5 </span>            :  * Contributors are mentioned in the code where appropriate.              *
<span class="lineNum">       6 </span>            :  *                                                                        *
<span class="lineNum">       7 </span>            :  * Permission to use, copy, modify and distribute this software and its   *
<span class="lineNum">       8 </span>            :  * documentation strictly for non-commercial purposes is hereby granted   *
<span class="lineNum">       9 </span>            :  * without fee, provided that the above copyright notice appears in all   *
<span class="lineNum">      10 </span>            :  * copies and that both the copyright notice and this permission notice   *
<span class="lineNum">      11 </span>            :  * appear in the supporting documentation. The authors make no claims     *
<span class="lineNum">      12 </span>            :  * about the suitability of this software for any purpose. It is          *
<span class="lineNum">      13 </span>            :  * provided &quot;as is&quot; without express or implied warranty.                  *
<span class="lineNum">      14 </span>            :  **************************************************************************/
<span class="lineNum">      15 </span>            : 
<span class="lineNum">      16 </span>            : /* $Id$ */
<span class="lineNum">      17 </span>            : 
<span class="lineNum">      18 </span>            : //
<span class="lineNum">      19 </span>            : // Generator using the TPythia interface (via AliPythia)
<span class="lineNum">      20 </span>            : // to generate pp collisions.
<span class="lineNum">      21 </span>            : // Using SetNuclei() also nuclear modifications to the structure functions
<span class="lineNum">      22 </span>            : // can be taken into account. This makes, of course, only sense for the
<span class="lineNum">      23 </span>            : // generation of the products of hard processes (heavy flavor, jets ...)
<span class="lineNum">      24 </span>            : //
<span class="lineNum">      25 </span>            : // andreas.morsch@cern.ch
<span class="lineNum">      26 </span>            : //
<span class="lineNum">      27 </span>            : 
<span class="lineNum">      28 </span>            : #include &lt;TMath.h&gt;
<span class="lineNum">      29 </span>            : #include &lt;TClonesArray.h&gt;
<span class="lineNum">      30 </span>            : #include &lt;TDatabasePDG.h&gt;
<span class="lineNum">      31 </span>            : #include &lt;TParticle.h&gt;
<span class="lineNum">      32 </span>            : #include &lt;TPDGCode.h&gt;
<span class="lineNum">      33 </span>            : #include &lt;TObjArray.h&gt;
<span class="lineNum">      34 </span>            : #include &lt;TSystem.h&gt;
<span class="lineNum">      35 </span>            : #include &lt;TTree.h&gt;
<span class="lineNum">      36 </span>            : #include &quot;AliConst.h&quot;
<span class="lineNum">      37 </span>            : #include &quot;AliDecayerPythia.h&quot;
<span class="lineNum">      38 </span>            : #include &quot;AliGenPythia.h&quot;
<span class="lineNum">      39 </span>            : #include &quot;AliFastGlauber.h&quot;
<span class="lineNum">      40 </span>            : #include &quot;AliHeader.h&quot;
<span class="lineNum">      41 </span>            : #include &quot;AliGenPythiaEventHeader.h&quot;
<span class="lineNum">      42 </span>            : #include &quot;AliPythia.h&quot;
<span class="lineNum">      43 </span>            : #include &quot;AliPythiaRndm.h&quot;
<span class="lineNum">      44 </span>            : #include &quot;AliRun.h&quot;
<span class="lineNum">      45 </span>            : #include &quot;AliStack.h&quot;
<span class="lineNum">      46 </span>            : #include &quot;AliRunLoader.h&quot;
<span class="lineNum">      47 </span>            : #include &quot;AliMC.h&quot;
<span class="lineNum">      48 </span>            : #include &quot;AliLog.h&quot;
<a name="49"><span class="lineNum">      49 </span>            : #include &quot;PyquenCommon.h&quot;</a>
<span class="lineNum">      50 </span>            : 
<span class="lineNum">      51 </span><span class="lineCov">          2 : ClassImp(AliGenPythia)</span>
<a name="52"><span class="lineNum">      52 </span>            : </a>
<span class="lineNum">      53 </span>            : 
<span class="lineNum">      54 </span>            : AliGenPythia::AliGenPythia():
<span class="lineNum">      55 </span><span class="lineNoCov">          0 :     AliGenMC(),</span>
<span class="lineNum">      56 </span><span class="lineNoCov">          0 :     fProcess(kPyCharm),          </span>
<span class="lineNum">      57 </span><span class="lineNoCov">          0 :     fItune(-1),</span>
<span class="lineNum">      58 </span><span class="lineNoCov">          0 :     fStrucFunc(kCTEQ5L), </span>
<span class="lineNum">      59 </span><span class="lineNoCov">          0 :     fKineBias(0.),</span>
<span class="lineNum">      60 </span><span class="lineNoCov">          0 :     fTrials(0),</span>
<span class="lineNum">      61 </span><span class="lineNoCov">          0 :     fTrialsRun(0),</span>
<span class="lineNum">      62 </span><span class="lineNoCov">          0 :     fQ(0.),</span>
<span class="lineNum">      63 </span><span class="lineNoCov">          0 :     fX1(0.),</span>
<span class="lineNum">      64 </span><span class="lineNoCov">          0 :     fX2(0.),</span>
<span class="lineNum">      65 </span><span class="lineNoCov">          0 :     fEventTime(0.),</span>
<span class="lineNum">      66 </span><span class="lineNoCov">          0 :     fInteractionRate(0.),</span>
<span class="lineNum">      67 </span><span class="lineNoCov">          0 :     fTimeWindow(0.),</span>
<span class="lineNum">      68 </span><span class="lineNoCov">          0 :     fCurSubEvent(0),</span>
<span class="lineNum">      69 </span><span class="lineNoCov">          0 :     fEventsTime(0),</span>
<span class="lineNum">      70 </span><span class="lineNoCov">          0 :     fNev(0),</span>
<span class="lineNum">      71 </span><span class="lineNoCov">          0 :     fFlavorSelect(0),</span>
<span class="lineNum">      72 </span><span class="lineNoCov">          0 :     fXsection(0.),</span>
<span class="lineNum">      73 </span><span class="lineNoCov">          0 :     fPythia(0),</span>
<span class="lineNum">      74 </span><span class="lineNoCov">          0 :     fWeightPower(0.),</span>
<span class="lineNum">      75 </span><span class="lineNoCov">          0 :     fPtHardMin(0.),</span>
<span class="lineNum">      76 </span><span class="lineNoCov">          0 :     fPtHardMax(1.e4),</span>
<span class="lineNum">      77 </span><span class="lineNoCov">          0 :     fYHardMin(-1.e10),</span>
<span class="lineNum">      78 </span><span class="lineNoCov">          0 :     fYHardMax(1.e10),</span>
<span class="lineNum">      79 </span><span class="lineNoCov">          0 :     fGinit(1),</span>
<span class="lineNum">      80 </span><span class="lineNoCov">          0 :     fGfinal(1),</span>
<span class="lineNum">      81 </span><span class="lineNoCov">          0 :     fCRoff(0),</span>
<span class="lineNum">      82 </span><span class="lineNoCov">          0 :     fHadronisation(1),</span>
<span class="lineNum">      83 </span><span class="lineNoCov">          0 :     fPatchOmegaDalitz(0), </span>
<span class="lineNum">      84 </span><span class="lineNoCov">          0 :     fDecayerExodus(0),</span>
<span class="lineNum">      85 </span><span class="lineNoCov">          0 :     fNpartons(0),</span>
<span class="lineNum">      86 </span><span class="lineNoCov">          0 :     fReadFromFile(0),</span>
<span class="lineNum">      87 </span><span class="lineNoCov">          0 :     fReadLHEF(0),</span>
<span class="lineNum">      88 </span><span class="lineNoCov">          0 :     fQuench(0),</span>
<span class="lineNum">      89 </span><span class="lineNoCov">          0 :     fQhat(0.),</span>
<span class="lineNum">      90 </span><span class="lineNoCov">          0 :     fLength(0.),</span>
<span class="lineNum">      91 </span><span class="lineNoCov">          0 :     fpyquenT(1.),</span>
<span class="lineNum">      92 </span><span class="lineNoCov">          0 :     fpyquenTau(0.1),</span>
<span class="lineNum">      93 </span><span class="lineNoCov">          0 :     fpyquenNf(0),</span>
<span class="lineNum">      94 </span><span class="lineNoCov">          0 :     fpyquenEloss(0),</span>
<span class="lineNum">      95 </span><span class="lineNoCov">          0 :     fpyquenAngle(0), </span>
<span class="lineNum">      96 </span><span class="lineNoCov">          0 :     fImpact(0.),</span>
<span class="lineNum">      97 </span><span class="lineNoCov">          0 :     fPtKick(1.),</span>
<span class="lineNum">      98 </span><span class="lineNoCov">          0 :     fFullEvent(kTRUE),</span>
<span class="lineNum">      99 </span><span class="lineNoCov">          0 :     fDecayer(new AliDecayerPythia()),</span>
<span class="lineNum">     100 </span><span class="lineNoCov">          0 :     fDebugEventFirst(-1),</span>
<span class="lineNum">     101 </span><span class="lineNoCov">          0 :     fDebugEventLast(-1),</span>
<span class="lineNum">     102 </span><span class="lineNoCov">          0 :     fEtMinJet(0.),      </span>
<span class="lineNum">     103 </span><span class="lineNoCov">          0 :     fEtMaxJet(1.e4),      </span>
<span class="lineNum">     104 </span><span class="lineNoCov">          0 :     fEtaMinJet(-20.),     </span>
<span class="lineNum">     105 </span><span class="lineNoCov">          0 :     fEtaMaxJet(20.),     </span>
<span class="lineNum">     106 </span><span class="lineNoCov">          0 :     fPhiMinJet(0.),     </span>
<span class="lineNum">     107 </span><span class="lineNoCov">          0 :     fPhiMaxJet(2.* TMath::Pi()),     </span>
<span class="lineNum">     108 </span><span class="lineNoCov">          0 :     fJetReconstruction(kCell),</span>
<span class="lineNum">     109 </span><span class="lineNoCov">          0 :     fEtaMinGamma(-20.),      </span>
<span class="lineNum">     110 </span><span class="lineNoCov">          0 :     fEtaMaxGamma(20.),      </span>
<span class="lineNum">     111 </span><span class="lineNoCov">          0 :     fPhiMinGamma(0.),      </span>
<span class="lineNum">     112 </span><span class="lineNoCov">          0 :     fPhiMaxGamma(2. * TMath::Pi()),      </span>
<span class="lineNum">     113 </span><span class="lineNoCov">          0 :     fUseYCutHQ(kFALSE),</span>
<span class="lineNum">     114 </span><span class="lineNoCov">          0 :     fYMinHQ(-20.),</span>
<span class="lineNum">     115 </span><span class="lineNoCov">          0 :     fYMaxHQ(20.),</span>
<span class="lineNum">     116 </span><span class="lineNoCov">          0 :     fPycellEtaMax(2.),     </span>
<span class="lineNum">     117 </span><span class="lineNoCov">          0 :     fPycellNEta(274),       </span>
<span class="lineNum">     118 </span><span class="lineNoCov">          0 :     fPycellNPhi(432),       </span>
<span class="lineNum">     119 </span><span class="lineNoCov">          0 :     fPycellThreshold(0.),  </span>
<span class="lineNum">     120 </span><span class="lineNoCov">          0 :     fPycellEtSeed(4.),     </span>
<span class="lineNum">     121 </span><span class="lineNoCov">          0 :     fPycellMinEtJet(10.),  </span>
<span class="lineNum">     122 </span><span class="lineNoCov">          0 :     fPycellMaxRadius(1.), </span>
<span class="lineNum">     123 </span><span class="lineNoCov">          0 :     fStackFillOpt(kFlavorSelection),   </span>
<span class="lineNum">     124 </span><span class="lineNoCov">          0 :     fFeedDownOpt(kTRUE),    </span>
<span class="lineNum">     125 </span><span class="lineNoCov">          0 :     fFragmentation(kTRUE),</span>
<span class="lineNum">     126 </span><span class="lineNoCov">          0 :     fSetNuclei(kFALSE),</span>
<span class="lineNum">     127 </span><span class="lineNoCov">          0 :     fUseNuclearPDF(kFALSE),</span>
<span class="lineNum">     128 </span><span class="lineNoCov">          0 :     fUseLorentzBoost(kTRUE),</span>
<span class="lineNum">     129 </span><span class="lineNoCov">          0 :     fNewMIS(kFALSE),   </span>
<span class="lineNum">     130 </span><span class="lineNoCov">          0 :     fHFoff(kFALSE),    </span>
<span class="lineNum">     131 </span><span class="lineNoCov">          0 :     fNucPdf(0),</span>
<span class="lineNum">     132 </span><span class="lineNoCov">          0 :     fTriggerParticle(0),</span>
<span class="lineNum">     133 </span><span class="lineNoCov">          0 :     fTriggerEta(0.9),     </span>
<span class="lineNum">     134 </span><span class="lineNoCov">          0 :     fTriggerY(999.),     </span>
<span class="lineNum">     135 </span><span class="lineNoCov">          0 :     fTriggerEtaMin(0.9),     </span>
<span class="lineNum">     136 </span><span class="lineNoCov">          0 :     fTriggerMinPt(-1),  </span>
<span class="lineNum">     137 </span><span class="lineNoCov">          0 :     fTriggerMaxPt(1000),  </span>
<span class="lineNum">     138 </span><span class="lineNoCov">          0 :     fTriggerMultiplicity(0),</span>
<span class="lineNum">     139 </span><span class="lineNoCov">          0 :     fTriggerMultiplicityEta(0),</span>
<span class="lineNum">     140 </span><span class="lineNoCov">          0 :     fTriggerMultiplicityEtaMin(0),</span>
<span class="lineNum">     141 </span><span class="lineNoCov">          0 :     fTriggerMultiplicityEtaMax(0),</span>
<span class="lineNum">     142 </span><span class="lineNoCov">          0 :     fTriggerMultiplicityPtMin(0),</span>
<span class="lineNum">     143 </span><span class="lineNoCov">          0 :     fCountMode(kCountAll),      </span>
<span class="lineNum">     144 </span><span class="lineNoCov">          0 :     fHeader(0),  </span>
<span class="lineNum">     145 </span><span class="lineNoCov">          0 :     fRL(0),      </span>
<span class="lineNum">     146 </span><span class="lineNoCov">          0 :     fkFileName(0),</span>
<span class="lineNum">     147 </span><span class="lineNoCov">          0 :     fkNameLHEF(0),</span>
<span class="lineNum">     148 </span><span class="lineNoCov">          0 :     fFragPhotonInCalo(kFALSE),</span>
<span class="lineNum">     149 </span><span class="lineNoCov">          0 :     fHadronInCalo(kFALSE) ,</span>
<span class="lineNum">     150 </span><span class="lineNoCov">          0 :     fPi0InCalo(kFALSE) ,</span>
<span class="lineNum">     151 </span><span class="lineNoCov">          0 :     fEtaInCalo(kFALSE) ,</span>
<span class="lineNum">     152 </span><span class="lineNoCov">          0 :     fPhotonInCalo(kFALSE), // not in use</span>
<span class="lineNum">     153 </span><span class="lineNoCov">          0 :     fDecayPhotonInCalo(kFALSE),</span>
<span class="lineNum">     154 </span><span class="lineNoCov">          0 :     fForceNeutralMeson2PhotonDecay(kFALSE),</span>
<span class="lineNum">     155 </span><span class="lineNoCov">          0 :     fEleInCalo(kFALSE),</span>
<span class="lineNum">     156 </span><span class="lineNoCov">          0 :     fEleInEMCAL(kFALSE), // not in use</span>
<span class="lineNum">     157 </span><span class="lineNoCov">          0 :     fCheckBarrel(kFALSE),</span>
<span class="lineNum">     158 </span><span class="lineNoCov">          0 :     fCheckEMCAL(kFALSE),</span>
<span class="lineNum">     159 </span><span class="lineNoCov">          0 :     fCheckPHOS(kFALSE),</span>
<span class="lineNum">     160 </span><span class="lineNoCov">          0 :     fCheckPHOSeta(kFALSE),</span>
<span class="lineNum">     161 </span><span class="lineNoCov">          0 :     fPHOSRotateCandidate(-1),</span>
<span class="lineNum">     162 </span><span class="lineNoCov">          0 :     fTriggerParticleMinPt(0), </span>
<span class="lineNum">     163 </span><span class="lineNoCov">          0 :     fPhotonMinPt(0), // not in use</span>
<span class="lineNum">     164 </span><span class="lineNoCov">          0 :     fElectronMinPt(0), // not in use</span>
<span class="lineNum">     165 </span><span class="lineNoCov">          0 :     fPHOSMinPhi(219.),</span>
<span class="lineNum">     166 </span><span class="lineNoCov">          0 :     fPHOSMaxPhi(321.),</span>
<span class="lineNum">     167 </span><span class="lineNoCov">          0 :     fPHOSEta(0.13),</span>
<span class="lineNum">     168 </span><span class="lineNoCov">          0 :     fEMCALMinPhi(79.),</span>
<span class="lineNum">     169 </span><span class="lineNoCov">          0 :     fEMCALMaxPhi(191.),</span>
<span class="lineNum">     170 </span><span class="lineNoCov">          0 :     fEMCALEta(0.71),</span>
<span class="lineNum">     171 </span><span class="lineNoCov">          0 :     fkTuneForDiff(0),</span>
<span class="lineNum">     172 </span><span class="lineNoCov">          0 :     fProcDiff(0)</span>
<span class="lineNum">     173 </span><span class="lineNoCov">          0 : {</span>
<span class="lineNum">     174 </span>            : // Default Constructor
<span class="lineNum">     175 </span><span class="lineNoCov">          0 :   fEnergyCMS = 5500.;</span>
<span class="lineNum">     176 </span><span class="lineNoCov">          0 :   if (!AliPythiaRndm::GetPythiaRandom()) </span>
<span class="lineNum">     177 </span><span class="lineNoCov">          0 :       AliPythiaRndm::SetPythiaRandom(GetRandom());</span>
<a name="178"><span class="lineNum">     178 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     179 </span>            : 
<span class="lineNum">     180 </span>            : AliGenPythia::AliGenPythia(Int_t npart)
<span class="lineNum">     181 </span><span class="lineNoCov">          0 :     :AliGenMC(npart),</span>
<span class="lineNum">     182 </span><span class="lineNoCov">          0 :      fProcess(kPyCharm),          </span>
<span class="lineNum">     183 </span><span class="lineNoCov">          0 :      fItune(-1),</span>
<span class="lineNum">     184 </span><span class="lineNoCov">          0 :      fStrucFunc(kCTEQ5L), </span>
<span class="lineNum">     185 </span><span class="lineNoCov">          0 :      fKineBias(0.),</span>
<span class="lineNum">     186 </span><span class="lineNoCov">          0 :      fTrials(0),</span>
<span class="lineNum">     187 </span><span class="lineNoCov">          0 :      fTrialsRun(0),</span>
<span class="lineNum">     188 </span><span class="lineNoCov">          0 :      fQ(0.),</span>
<span class="lineNum">     189 </span><span class="lineNoCov">          0 :      fX1(0.),</span>
<span class="lineNum">     190 </span><span class="lineNoCov">          0 :      fX2(0.),</span>
<span class="lineNum">     191 </span><span class="lineNoCov">          0 :      fEventTime(0.),</span>
<span class="lineNum">     192 </span><span class="lineNoCov">          0 :      fInteractionRate(0.),</span>
<span class="lineNum">     193 </span><span class="lineNoCov">          0 :      fTimeWindow(0.),</span>
<span class="lineNum">     194 </span><span class="lineNoCov">          0 :      fCurSubEvent(0),</span>
<span class="lineNum">     195 </span><span class="lineNoCov">          0 :      fEventsTime(0),</span>
<span class="lineNum">     196 </span><span class="lineNoCov">          0 :      fNev(0),</span>
<span class="lineNum">     197 </span><span class="lineNoCov">          0 :      fFlavorSelect(0),</span>
<span class="lineNum">     198 </span><span class="lineNoCov">          0 :      fXsection(0.),</span>
<span class="lineNum">     199 </span><span class="lineNoCov">          0 :      fPythia(0),</span>
<span class="lineNum">     200 </span><span class="lineNoCov">          0 :      fWeightPower(0.),</span>
<span class="lineNum">     201 </span><span class="lineNoCov">          0 :      fPtHardMin(0.),</span>
<span class="lineNum">     202 </span><span class="lineNoCov">          0 :      fPtHardMax(1.e4),</span>
<span class="lineNum">     203 </span><span class="lineNoCov">          0 :      fYHardMin(-1.e10),</span>
<span class="lineNum">     204 </span><span class="lineNoCov">          0 :      fYHardMax(1.e10),</span>
<span class="lineNum">     205 </span><span class="lineNoCov">          0 :      fGinit(kTRUE),</span>
<span class="lineNum">     206 </span><span class="lineNoCov">          0 :      fGfinal(kTRUE),</span>
<span class="lineNum">     207 </span><span class="lineNoCov">          0 :      fCRoff(kFALSE),</span>
<span class="lineNum">     208 </span><span class="lineNoCov">          0 :      fHadronisation(kTRUE),</span>
<span class="lineNum">     209 </span><span class="lineNoCov">          0 :      fPatchOmegaDalitz(0),</span>
<span class="lineNum">     210 </span><span class="lineNoCov">          0 :      fDecayerExodus(0), </span>
<span class="lineNum">     211 </span><span class="lineNoCov">          0 :      fNpartons(0),</span>
<span class="lineNum">     212 </span><span class="lineNoCov">          0 :      fReadFromFile(kFALSE),</span>
<span class="lineNum">     213 </span><span class="lineNoCov">          0 :      fReadLHEF(0),</span>
<span class="lineNum">     214 </span><span class="lineNoCov">          0 :      fQuench(kFALSE),</span>
<span class="lineNum">     215 </span><span class="lineNoCov">          0 :      fQhat(0.),</span>
<span class="lineNum">     216 </span><span class="lineNoCov">          0 :      fLength(0.),</span>
<span class="lineNum">     217 </span><span class="lineNoCov">          0 :      fpyquenT(1.),</span>
<span class="lineNum">     218 </span><span class="lineNoCov">          0 :      fpyquenTau(0.1),</span>
<span class="lineNum">     219 </span><span class="lineNoCov">          0 :      fpyquenNf(0),</span>
<span class="lineNum">     220 </span><span class="lineNoCov">          0 :      fpyquenEloss(0),</span>
<span class="lineNum">     221 </span><span class="lineNoCov">          0 :      fpyquenAngle(0), </span>
<span class="lineNum">     222 </span><span class="lineNoCov">          0 :      fImpact(0.),</span>
<span class="lineNum">     223 </span><span class="lineNoCov">          0 :      fPtKick(1.),</span>
<span class="lineNum">     224 </span><span class="lineNoCov">          0 :      fFullEvent(kTRUE),</span>
<span class="lineNum">     225 </span><span class="lineNoCov">          0 :      fDecayer(new AliDecayerPythia()),</span>
<span class="lineNum">     226 </span><span class="lineNoCov">          0 :      fDebugEventFirst(-1),</span>
<span class="lineNum">     227 </span><span class="lineNoCov">          0 :      fDebugEventLast(-1),</span>
<span class="lineNum">     228 </span><span class="lineNoCov">          0 :      fEtMinJet(0.),      </span>
<span class="lineNum">     229 </span><span class="lineNoCov">          0 :      fEtMaxJet(1.e4),      </span>
<span class="lineNum">     230 </span><span class="lineNoCov">          0 :      fEtaMinJet(-20.),     </span>
<span class="lineNum">     231 </span><span class="lineNoCov">          0 :      fEtaMaxJet(20.),     </span>
<span class="lineNum">     232 </span><span class="lineNoCov">          0 :      fPhiMinJet(0.),     </span>
<span class="lineNum">     233 </span><span class="lineNoCov">          0 :      fPhiMaxJet(2.* TMath::Pi()),     </span>
<span class="lineNum">     234 </span><span class="lineNoCov">          0 :      fJetReconstruction(kCell),</span>
<span class="lineNum">     235 </span><span class="lineNoCov">          0 :      fEtaMinGamma(-20.),      </span>
<span class="lineNum">     236 </span><span class="lineNoCov">          0 :      fEtaMaxGamma(20.),      </span>
<span class="lineNum">     237 </span><span class="lineNoCov">          0 :      fPhiMinGamma(0.),      </span>
<span class="lineNum">     238 </span><span class="lineNoCov">          0 :      fPhiMaxGamma(2. * TMath::Pi()),      </span>
<span class="lineNum">     239 </span><span class="lineNoCov">          0 :      fUseYCutHQ(kFALSE),</span>
<span class="lineNum">     240 </span><span class="lineNoCov">          0 :      fYMinHQ(-20.),</span>
<span class="lineNum">     241 </span><span class="lineNoCov">          0 :      fYMaxHQ(20.),</span>
<span class="lineNum">     242 </span><span class="lineNoCov">          0 :      fPycellEtaMax(2.),     </span>
<span class="lineNum">     243 </span><span class="lineNoCov">          0 :      fPycellNEta(274),       </span>
<span class="lineNum">     244 </span><span class="lineNoCov">          0 :      fPycellNPhi(432),       </span>
<span class="lineNum">     245 </span><span class="lineNoCov">          0 :      fPycellThreshold(0.),  </span>
<span class="lineNum">     246 </span><span class="lineNoCov">          0 :      fPycellEtSeed(4.),     </span>
<span class="lineNum">     247 </span><span class="lineNoCov">          0 :      fPycellMinEtJet(10.),  </span>
<span class="lineNum">     248 </span><span class="lineNoCov">          0 :      fPycellMaxRadius(1.), </span>
<span class="lineNum">     249 </span><span class="lineNoCov">          0 :      fStackFillOpt(kFlavorSelection),   </span>
<span class="lineNum">     250 </span><span class="lineNoCov">          0 :      fFeedDownOpt(kTRUE),    </span>
<span class="lineNum">     251 </span><span class="lineNoCov">          0 :      fFragmentation(kTRUE),</span>
<span class="lineNum">     252 </span><span class="lineNoCov">          0 :      fSetNuclei(kFALSE),</span>
<span class="lineNum">     253 </span><span class="lineNoCov">          0 :      fUseNuclearPDF(kFALSE),</span>
<span class="lineNum">     254 </span><span class="lineNoCov">          0 :      fUseLorentzBoost(kTRUE),</span>
<span class="lineNum">     255 </span><span class="lineNoCov">          0 :      fNewMIS(kFALSE),   </span>
<span class="lineNum">     256 </span><span class="lineNoCov">          0 :      fHFoff(kFALSE),    </span>
<span class="lineNum">     257 </span><span class="lineNoCov">          0 :      fNucPdf(0),</span>
<span class="lineNum">     258 </span><span class="lineNoCov">          0 :      fTriggerParticle(0),</span>
<span class="lineNum">     259 </span><span class="lineNoCov">          0 :      fTriggerEta(0.9), </span>
<span class="lineNum">     260 </span><span class="lineNoCov">          0 :      fTriggerY(999.), </span>
<span class="lineNum">     261 </span><span class="lineNoCov">          0 :      fTriggerEtaMin(0.9),     </span>
<span class="lineNum">     262 </span><span class="lineNoCov">          0 :      fTriggerMinPt(-1),  </span>
<span class="lineNum">     263 </span><span class="lineNoCov">          0 :      fTriggerMaxPt(1000),      </span>
<span class="lineNum">     264 </span><span class="lineNoCov">          0 :      fTriggerMultiplicity(0),</span>
<span class="lineNum">     265 </span><span class="lineNoCov">          0 :      fTriggerMultiplicityEta(0),</span>
<span class="lineNum">     266 </span><span class="lineNoCov">          0 :      fTriggerMultiplicityEtaMin(0),</span>
<span class="lineNum">     267 </span><span class="lineNoCov">          0 :      fTriggerMultiplicityEtaMax(0),</span>
<span class="lineNum">     268 </span><span class="lineNoCov">          0 :      fTriggerMultiplicityPtMin(0),</span>
<span class="lineNum">     269 </span><span class="lineNoCov">          0 :      fCountMode(kCountAll),      </span>
<span class="lineNum">     270 </span><span class="lineNoCov">          0 :      fHeader(0),  </span>
<span class="lineNum">     271 </span><span class="lineNoCov">          0 :      fRL(0),      </span>
<span class="lineNum">     272 </span><span class="lineNoCov">          0 :      fkFileName(0),</span>
<span class="lineNum">     273 </span><span class="lineNoCov">          0 :      fkNameLHEF(0),</span>
<span class="lineNum">     274 </span><span class="lineNoCov">          0 :      fFragPhotonInCalo(kFALSE),</span>
<span class="lineNum">     275 </span><span class="lineNoCov">          0 :      fHadronInCalo(kFALSE) ,</span>
<span class="lineNum">     276 </span><span class="lineNoCov">          0 :      fPi0InCalo(kFALSE) ,</span>
<span class="lineNum">     277 </span><span class="lineNoCov">          0 :      fEtaInCalo(kFALSE) ,</span>
<span class="lineNum">     278 </span><span class="lineNoCov">          0 :      fPhotonInCalo(kFALSE), // not in use</span>
<span class="lineNum">     279 </span><span class="lineNoCov">          0 :      fDecayPhotonInCalo(kFALSE),</span>
<span class="lineNum">     280 </span><span class="lineNoCov">          0 :      fForceNeutralMeson2PhotonDecay(kFALSE),</span>
<span class="lineNum">     281 </span><span class="lineNoCov">          0 :      fEleInCalo(kFALSE),</span>
<span class="lineNum">     282 </span><span class="lineNoCov">          0 :      fEleInEMCAL(kFALSE), // not in use</span>
<span class="lineNum">     283 </span><span class="lineNoCov">          0 :      fCheckBarrel(kFALSE),</span>
<span class="lineNum">     284 </span><span class="lineNoCov">          0 :      fCheckEMCAL(kFALSE),</span>
<span class="lineNum">     285 </span><span class="lineNoCov">          0 :      fCheckPHOS(kFALSE),</span>
<span class="lineNum">     286 </span><span class="lineNoCov">          0 :      fCheckPHOSeta(kFALSE),</span>
<span class="lineNum">     287 </span><span class="lineNoCov">          0 :      fPHOSRotateCandidate(-1),</span>
<span class="lineNum">     288 </span><span class="lineNoCov">          0 :      fTriggerParticleMinPt(0),</span>
<span class="lineNum">     289 </span><span class="lineNoCov">          0 :      fPhotonMinPt(0), // not in use</span>
<span class="lineNum">     290 </span><span class="lineNoCov">          0 :      fElectronMinPt(0), // not in use</span>
<span class="lineNum">     291 </span><span class="lineNoCov">          0 :      fPHOSMinPhi(219.),</span>
<span class="lineNum">     292 </span><span class="lineNoCov">          0 :      fPHOSMaxPhi(321.),</span>
<span class="lineNum">     293 </span><span class="lineNoCov">          0 :      fPHOSEta(0.13),</span>
<span class="lineNum">     294 </span><span class="lineNoCov">          0 :      fEMCALMinPhi(79.),</span>
<span class="lineNum">     295 </span><span class="lineNoCov">          0 :      fEMCALMaxPhi(191.),</span>
<span class="lineNum">     296 </span><span class="lineNoCov">          0 :      fEMCALEta(0.71),</span>
<span class="lineNum">     297 </span><span class="lineNoCov">          0 :      fkTuneForDiff(0),</span>
<span class="lineNum">     298 </span><span class="lineNoCov">          0 :      fProcDiff(0)</span>
<span class="lineNum">     299 </span><span class="lineNoCov">          0 : {</span>
<span class="lineNum">     300 </span>            : // default charm production at 5. 5 TeV
<span class="lineNum">     301 </span>            : // semimuonic decay
<span class="lineNum">     302 </span>            : // structure function GRVHO
<span class="lineNum">     303 </span>            : //
<span class="lineNum">     304 </span><span class="lineNoCov">          0 :     fEnergyCMS = 5500.;</span>
<span class="lineNum">     305 </span><span class="lineNoCov">          0 :     fName = &quot;Pythia&quot;;</span>
<span class="lineNum">     306 </span><span class="lineNoCov">          0 :     fTitle= &quot;Particle Generator using PYTHIA&quot;;</span>
<span class="lineNum">     307 </span><span class="lineNoCov">          0 :     SetForceDecay();</span>
<span class="lineNum">     308 </span>            :     // Set random number generator 
<span class="lineNum">     309 </span><span class="lineNoCov">          0 :     if (!AliPythiaRndm::GetPythiaRandom()) </span>
<span class="lineNum">     310 </span><span class="lineNoCov">          0 :       AliPythiaRndm::SetPythiaRandom(GetRandom());</span>
<a name="311"><span class="lineNum">     311 </span><span class="lineNoCov">          0 :  }</span></a>
<span class="lineNum">     312 </span>            : 
<span class="lineNum">     313 </span><span class="lineNoCov">          0 : AliGenPythia::~AliGenPythia()</span>
<span class="lineNum">     314 </span><span class="lineNoCov">          0 : {</span>
<span class="lineNum">     315 </span>            : // Destructor
<span class="lineNum">     316 </span><span class="lineNoCov">          0 :   if(fEventsTime) delete fEventsTime;</span>
<a name="317"><span class="lineNum">     317 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     318 </span>            : 
<span class="lineNum">     319 </span>            : void AliGenPythia::SetInteractionRate(Float_t rate,Float_t timewindow)
<span class="lineNum">     320 </span>            : {
<span class="lineNum">     321 </span>            : // Generate pileup using user specified rate
<span class="lineNum">     322 </span><span class="lineNoCov">          0 :     fInteractionRate = rate;</span>
<span class="lineNum">     323 </span><span class="lineNoCov">          0 :     fTimeWindow = timewindow;</span>
<span class="lineNum">     324 </span><span class="lineNoCov">          0 :     GeneratePileup();</span>
<a name="325"><span class="lineNum">     325 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     326 </span>            : 
<span class="lineNum">     327 </span>            : void AliGenPythia::GeneratePileup()
<span class="lineNum">     328 </span>            : {
<span class="lineNum">     329 </span>            : // Generate sub events time for pileup
<span class="lineNum">     330 </span><span class="lineNoCov">          0 :     fEventsTime = 0;</span>
<span class="lineNum">     331 </span><span class="lineNoCov">          0 :     if(fInteractionRate == 0.) {</span>
<span class="lineNum">     332 </span><span class="lineNoCov">          0 :       Warning(&quot;GeneratePileup&quot;,&quot;Zero interaction specified. Skipping pileup generation.\n&quot;);</span>
<span class="lineNum">     333 </span><span class="lineNoCov">          0 :       return;</span>
<span class="lineNum">     334 </span>            :     }
<span class="lineNum">     335 </span>            : 
<span class="lineNum">     336 </span><span class="lineNoCov">          0 :     Int_t npart = NumberParticles();</span>
<span class="lineNum">     337 </span><span class="lineNoCov">          0 :     if(npart &lt; 0) {</span>
<span class="lineNum">     338 </span><span class="lineNoCov">          0 :       Warning(&quot;GeneratePileup&quot;,&quot;Negative number of particles. Skipping pileup generation.\n&quot;);</span>
<span class="lineNum">     339 </span><span class="lineNoCov">          0 :       return;</span>
<span class="lineNum">     340 </span>            :     }
<span class="lineNum">     341 </span>            : 
<span class="lineNum">     342 </span><span class="lineNoCov">          0 :     if(fEventsTime) delete fEventsTime;</span>
<span class="lineNum">     343 </span><span class="lineNoCov">          0 :     fEventsTime = new TArrayF(npart);</span>
<span class="lineNum">     344 </span>            :     TArrayF &amp;array = *fEventsTime;
<span class="lineNum">     345 </span><span class="lineNoCov">          0 :     for(Int_t ipart = 0; ipart &lt; npart; ipart++)</span>
<span class="lineNum">     346 </span><span class="lineNoCov">          0 :       array[ipart] = 0.;</span>
<span class="lineNum">     347 </span>            : 
<span class="lineNum">     348 </span>            :     Float_t eventtime = 0.;
<span class="lineNum">     349 </span><span class="lineNoCov">          0 :     while(1)</span>
<span class="lineNum">     350 </span>            :       {
<span class="lineNum">     351 </span><span class="lineNoCov">          0 :         eventtime += (AliPythiaRndm::GetPythiaRandom())-&gt;Exp(1./fInteractionRate);</span>
<span class="lineNum">     352 </span><span class="lineNoCov">          0 :         if(eventtime &gt; fTimeWindow) break;</span>
<span class="lineNum">     353 </span><span class="lineNoCov">          0 :         array.Set(array.GetSize()+1);</span>
<span class="lineNum">     354 </span><span class="lineNoCov">          0 :         array[array.GetSize()-1] = eventtime;</span>
<span class="lineNum">     355 </span>            :       }
<span class="lineNum">     356 </span>            : 
<span class="lineNum">     357 </span>            :     eventtime = 0.;
<span class="lineNum">     358 </span><span class="lineNoCov">          0 :     while(1)</span>
<span class="lineNum">     359 </span>            :       {
<span class="lineNum">     360 </span><span class="lineNoCov">          0 :         eventtime -= (AliPythiaRndm::GetPythiaRandom())-&gt;Exp(1./fInteractionRate);</span>
<span class="lineNum">     361 </span><span class="lineNoCov">          0 :         if(TMath::Abs(eventtime) &gt; fTimeWindow) break;</span>
<span class="lineNum">     362 </span><span class="lineNoCov">          0 :         array.Set(array.GetSize()+1);</span>
<span class="lineNum">     363 </span><span class="lineNoCov">          0 :         array[array.GetSize()-1] = eventtime;</span>
<span class="lineNum">     364 </span>            :       }
<span class="lineNum">     365 </span>            : 
<span class="lineNum">     366 </span><span class="lineNoCov">          0 :     SetNumberParticles(fEventsTime-&gt;GetSize());</span>
<a name="367"><span class="lineNum">     367 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     368 </span>            : 
<span class="lineNum">     369 </span>            : void AliGenPythia::SetPycellParameters(Float_t etamax, Int_t neta, Int_t nphi,
<span class="lineNum">     370 </span>            :                                        Float_t thresh, Float_t etseed, Float_t minet, Float_t r)
<span class="lineNum">     371 </span>            : {
<span class="lineNum">     372 </span>            : // Set pycell parameters
<span class="lineNum">     373 </span><span class="lineNoCov">          0 :     fPycellEtaMax    =  etamax;</span>
<span class="lineNum">     374 </span><span class="lineNoCov">          0 :     fPycellNEta      =  neta;</span>
<span class="lineNum">     375 </span><span class="lineNoCov">          0 :     fPycellNPhi      =  nphi;</span>
<span class="lineNum">     376 </span><span class="lineNoCov">          0 :     fPycellThreshold =  thresh;</span>
<span class="lineNum">     377 </span><span class="lineNoCov">          0 :     fPycellEtSeed    =  etseed;</span>
<span class="lineNum">     378 </span><span class="lineNoCov">          0 :     fPycellMinEtJet  =  minet;</span>
<span class="lineNum">     379 </span><span class="lineNoCov">          0 :     fPycellMaxRadius =  r;</span>
<span class="lineNum">     380 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">     381 </span>            : 
<a name="382"><span class="lineNum">     382 </span>            : </a>
<span class="lineNum">     383 </span>            : 
<span class="lineNum">     384 </span>            : void AliGenPythia::SetEventListRange(Int_t eventFirst, Int_t eventLast)
<span class="lineNum">     385 </span>            : {
<span class="lineNum">     386 </span>            :   // Set a range of event numbers, for which a table
<span class="lineNum">     387 </span>            :   // of generated particle will be printed
<span class="lineNum">     388 </span><span class="lineNoCov">          0 :   fDebugEventFirst = eventFirst;</span>
<span class="lineNum">     389 </span><span class="lineNoCov">          0 :   fDebugEventLast  = eventLast;</span>
<span class="lineNum">     390 </span><span class="lineNoCov">          0 :   if (fDebugEventLast==-1) fDebugEventLast=fDebugEventFirst;</span>
<a name="391"><span class="lineNum">     391 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     392 </span>            : 
<span class="lineNum">     393 </span>            : void AliGenPythia::Init()
<span class="lineNum">     394 </span>            : {
<span class="lineNum">     395 </span>            : // Initialisation
<span class="lineNum">     396 </span>            :     
<span class="lineNum">     397 </span><span class="lineNoCov">          0 :     SetMC(AliPythia::Instance());</span>
<span class="lineNum">     398 </span><span class="lineNoCov">          0 :     fPythia=(AliPythia*) fMCEvGen;</span>
<span class="lineNum">     399 </span>            :     
<span class="lineNum">     400 </span>            : //
<span class="lineNum">     401 </span><span class="lineNoCov">          0 :     fParentWeight=1./Float_t(fNpart);</span>
<span class="lineNum">     402 </span>            : //
<span class="lineNum">     403 </span><span class="lineNoCov">          0 :     if (fWeightPower != 0)</span>
<span class="lineNum">     404 </span><span class="lineNoCov">          0 :       fPythia-&gt;SetWeightPower(fWeightPower);</span>
<span class="lineNum">     405 </span><span class="lineNoCov">          0 :     fPythia-&gt;SetCKIN(3,fPtHardMin);</span>
<span class="lineNum">     406 </span><span class="lineNoCov">          0 :     fPythia-&gt;SetCKIN(4,fPtHardMax);</span>
<span class="lineNum">     407 </span><span class="lineNoCov">          0 :     fPythia-&gt;SetCKIN(7,fYHardMin);</span>
<span class="lineNum">     408 </span><span class="lineNoCov">          0 :     fPythia-&gt;SetCKIN(8,fYHardMax);</span>
<span class="lineNum">     409 </span>            :     
<span class="lineNum">     410 </span><span class="lineNoCov">          0 :     if (fProjectile != &quot;p&quot; || fTarget != &quot;p&quot;) fPythia-&gt;SetCollisionSystem(fProjectile,fTarget);</span>
<span class="lineNum">     411 </span>            :   
<span class="lineNum">     412 </span><span class="lineNoCov">          0 :     if(fUseNuclearPDF)</span>
<span class="lineNum">     413 </span><span class="lineNoCov">          0 :       fPythia-&gt;SetNuclei(fAProjectile, fATarget, fNucPdf);</span>
<span class="lineNum">     414 </span>            :     // Fragmentation?
<span class="lineNum">     415 </span><span class="lineNoCov">          0 :     if (fFragmentation) {</span>
<span class="lineNum">     416 </span><span class="lineNoCov">          0 :       fPythia-&gt;SetMSTP(111,1);</span>
<span class="lineNum">     417 </span><span class="lineNoCov">          0 :     } else {</span>
<span class="lineNum">     418 </span><span class="lineNoCov">          0 :       fPythia-&gt;SetMSTP(111,0);</span>
<span class="lineNum">     419 </span>            :     }
<span class="lineNum">     420 </span>            : 
<span class="lineNum">     421 </span>            : 
<span class="lineNum">     422 </span>            : //  initial state radiation   
<span class="lineNum">     423 </span><span class="lineNoCov">          0 :     fPythia-&gt;SetMSTP(61,fGinit);</span>
<span class="lineNum">     424 </span>            : //  final state radiation
<span class="lineNum">     425 </span><span class="lineNoCov">          0 :     fPythia-&gt;SetMSTP(71,fGfinal);</span>
<span class="lineNum">     426 </span>            :     //color reconnection strength
<span class="lineNum">     427 </span><span class="lineNoCov">          0 :     if(fCRoff==1)fPythia-&gt;SetMSTP(95,0);</span>
<span class="lineNum">     428 </span>            : //  pt - kick
<span class="lineNum">     429 </span><span class="lineNoCov">          0 :     if (fPtKick &gt; 0.) {</span>
<span class="lineNum">     430 </span><span class="lineNoCov">          0 :         fPythia-&gt;SetMSTP(91,1);</span>
<span class="lineNum">     431 </span><span class="lineNoCov">          0 :         fPythia-&gt;SetPARP(91,fPtKick);        </span>
<span class="lineNum">     432 </span><span class="lineNoCov">          0 :         fPythia-&gt;SetPARP(93, 4. * fPtKick);</span>
<span class="lineNum">     433 </span><span class="lineNoCov">          0 :     } else {</span>
<span class="lineNum">     434 </span><span class="lineNoCov">          0 :         fPythia-&gt;SetMSTP(91,0);</span>
<span class="lineNum">     435 </span>            :     }
<span class="lineNum">     436 </span>            : 
<span class="lineNum">     437 </span><span class="lineNoCov">          0 :            if (fReadLHEF) fPythia-&gt;OpenFortranFile(97, const_cast&lt;char*&gt;(fkNameLHEF));</span>
<span class="lineNum">     438 </span>            :         
<span class="lineNum">     439 </span><span class="lineNoCov">          0 :     if (fReadFromFile) {</span>
<span class="lineNum">     440 </span><span class="lineNoCov">          0 :         fRL  =  AliRunLoader::Open(fkFileName, &quot;Partons&quot;);</span>
<span class="lineNum">     441 </span><span class="lineNoCov">          0 :         fRL-&gt;LoadKinematics();</span>
<span class="lineNum">     442 </span><span class="lineNoCov">          0 :         fRL-&gt;LoadHeader();</span>
<span class="lineNum">     443 </span><span class="lineNoCov">          0 :     } else {</span>
<span class="lineNum">     444 </span><span class="lineNoCov">          0 :         fRL = 0x0;</span>
<span class="lineNum">     445 </span>            :     }
<span class="lineNum">     446 </span>            :  //
<span class="lineNum">     447 </span><span class="lineNoCov">          0 :     fPythia-&gt;ProcInit(fProcess,fEnergyCMS,fStrucFunc, fItune);</span>
<span class="lineNum">     448 </span>            :     //  Forward Paramters to the AliPythia object
<span class="lineNum">     449 </span><span class="lineNoCov">          0 :     fDecayer-&gt;SetForceDecay(fForceDecay);    </span>
<span class="lineNum">     450 </span>            : // Switch off Heavy Flavors on request  
<span class="lineNum">     451 </span><span class="lineNoCov">          0 :     if (fHFoff) {</span>
<span class="lineNum">     452 </span>            :         // Maximum number of quark flavours used in pdf 
<span class="lineNum">     453 </span><span class="lineNoCov">          0 :         fPythia-&gt;SetMSTP(58, 3);</span>
<span class="lineNum">     454 </span>            :         // Maximum number of flavors that can be used in showers
<span class="lineNum">     455 </span><span class="lineNoCov">          0 :         fPythia-&gt;SetMSTJ(45, 3);     </span>
<span class="lineNum">     456 </span>            :         // Switch off g-&gt;QQbar splitting in decay table
<span class="lineNum">     457 </span><span class="lineNoCov">          0 :         ((AliDecayerPythia*) fDecayer)-&gt;HeavyFlavourOff();</span>
<span class="lineNum">     458 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">     459 </span>            : 
<span class="lineNum">     460 </span><span class="lineNoCov">          0 :     fDecayer-&gt;Init();</span>
<span class="lineNum">     461 </span>            : 
<span class="lineNum">     462 </span>            : 
<span class="lineNum">     463 </span>            : //  Parent and Children Selection
<span class="lineNum">     464 </span><span class="lineNoCov">          0 :     switch (fProcess) </span>
<span class="lineNum">     465 </span>            :     {
<span class="lineNum">     466 </span>            :     case kPyOldUEQ2ordered:
<span class="lineNum">     467 </span>            :     case kPyOldUEQ2ordered2:
<span class="lineNum">     468 </span>            :     case kPyOldPopcorn:
<span class="lineNum">     469 </span>            :       break;
<span class="lineNum">     470 </span>            :     case kPyCharm:
<span class="lineNum">     471 </span>            :     case kPyCharmUnforced:
<span class="lineNum">     472 </span>            :     case kPyCharmPbPbMNR:
<span class="lineNum">     473 </span>            :     case kPyCharmpPbMNR:
<span class="lineNum">     474 </span>            :     case kPyCharmppMNR:
<span class="lineNum">     475 </span>            :     case kPyCharmppMNRwmi:
<span class="lineNum">     476 </span>            :     case kPyCharmPWHG:
<span class="lineNum">     477 </span><span class="lineNoCov">          0 :         fParentSelect[0] =   411;</span>
<span class="lineNum">     478 </span><span class="lineNoCov">          0 :         fParentSelect[1] =   421;</span>
<span class="lineNum">     479 </span><span class="lineNoCov">          0 :         fParentSelect[2] =   431;</span>
<span class="lineNum">     480 </span><span class="lineNoCov">          0 :         fParentSelect[3] =  4122;</span>
<span class="lineNum">     481 </span><span class="lineNoCov">          0 :         fParentSelect[4] =  4232;</span>
<span class="lineNum">     482 </span><span class="lineNoCov">          0 :         fParentSelect[5] =  4132;</span>
<span class="lineNum">     483 </span><span class="lineNoCov">          0 :         fParentSelect[6] =  4332;</span>
<span class="lineNum">     484 </span><span class="lineNoCov">          0 :         fFlavorSelect    =  4;  </span>
<span class="lineNum">     485 </span><span class="lineNoCov">          0 :         break;</span>
<span class="lineNum">     486 </span>            :     case kPyD0PbPbMNR:
<span class="lineNum">     487 </span>            :     case kPyD0pPbMNR:
<span class="lineNum">     488 </span>            :     case kPyD0ppMNR:
<span class="lineNum">     489 </span><span class="lineNoCov">          0 :         fParentSelect[0] =   421;</span>
<span class="lineNum">     490 </span><span class="lineNoCov">          0 :         fFlavorSelect    =   4; </span>
<span class="lineNum">     491 </span><span class="lineNoCov">          0 :         break;</span>
<span class="lineNum">     492 </span>            :     case kPyDPlusPbPbMNR:
<span class="lineNum">     493 </span>            :     case kPyDPluspPbMNR:
<span class="lineNum">     494 </span>            :     case kPyDPlusppMNR:
<span class="lineNum">     495 </span><span class="lineNoCov">          0 :         fParentSelect[0] =   411;</span>
<span class="lineNum">     496 </span><span class="lineNoCov">          0 :         fFlavorSelect    =   4; </span>
<span class="lineNum">     497 </span><span class="lineNoCov">          0 :         break;</span>
<span class="lineNum">     498 </span>            :     case kPyDPlusStrangePbPbMNR:
<span class="lineNum">     499 </span>            :     case kPyDPlusStrangepPbMNR:
<span class="lineNum">     500 </span>            :     case kPyDPlusStrangeppMNR:
<span class="lineNum">     501 </span><span class="lineNoCov">          0 :         fParentSelect[0] =   431;</span>
<span class="lineNum">     502 </span><span class="lineNoCov">          0 :         fFlavorSelect    =   4; </span>
<span class="lineNum">     503 </span><span class="lineNoCov">          0 :         break;</span>
<span class="lineNum">     504 </span>            :     case kPyLambdacppMNR:
<span class="lineNum">     505 </span><span class="lineNoCov">          0 :         fParentSelect[0] =  4122;</span>
<span class="lineNum">     506 </span><span class="lineNoCov">          0 :         fFlavorSelect    =   4; </span>
<span class="lineNum">     507 </span><span class="lineNoCov">          0 :         break;      </span>
<span class="lineNum">     508 </span>            :     case kPyBeauty:
<span class="lineNum">     509 </span>            :     case kPyBeautyJets:
<span class="lineNum">     510 </span>            :     case kPyBeautyPbPbMNR:
<span class="lineNum">     511 </span>            :     case kPyBeautypPbMNR:
<span class="lineNum">     512 </span>            :     case kPyBeautyppMNR:
<span class="lineNum">     513 </span>            :     case kPyBeautyppMNRwmi:
<span class="lineNum">     514 </span>            :     case kPyBeautyPWHG:
<span class="lineNum">     515 </span><span class="lineNoCov">          0 :         fParentSelect[0]=  511;</span>
<span class="lineNum">     516 </span><span class="lineNoCov">          0 :         fParentSelect[1]=  521;</span>
<span class="lineNum">     517 </span><span class="lineNoCov">          0 :         fParentSelect[2]=  531;</span>
<span class="lineNum">     518 </span><span class="lineNoCov">          0 :         fParentSelect[3]= 5122;</span>
<span class="lineNum">     519 </span><span class="lineNoCov">          0 :         fParentSelect[4]= 5132;</span>
<span class="lineNum">     520 </span><span class="lineNoCov">          0 :         fParentSelect[5]= 5232;</span>
<span class="lineNum">     521 </span><span class="lineNoCov">          0 :         fParentSelect[6]= 5332;</span>
<span class="lineNum">     522 </span><span class="lineNoCov">          0 :         fFlavorSelect   = 5;    </span>
<span class="lineNum">     523 </span><span class="lineNoCov">          0 :         break;</span>
<span class="lineNum">     524 </span>            :     case kPyBeautyUnforced:
<span class="lineNum">     525 </span><span class="lineNoCov">          0 :         fParentSelect[0] =  511;</span>
<span class="lineNum">     526 </span><span class="lineNoCov">          0 :         fParentSelect[1] =  521;</span>
<span class="lineNum">     527 </span><span class="lineNoCov">          0 :         fParentSelect[2] =  531;</span>
<span class="lineNum">     528 </span><span class="lineNoCov">          0 :         fParentSelect[3] = 5122;</span>
<span class="lineNum">     529 </span><span class="lineNoCov">          0 :         fParentSelect[4] = 5132;</span>
<span class="lineNum">     530 </span><span class="lineNoCov">          0 :         fParentSelect[5] = 5232;</span>
<span class="lineNum">     531 </span><span class="lineNoCov">          0 :         fParentSelect[6] = 5332;</span>
<span class="lineNum">     532 </span><span class="lineNoCov">          0 :         fFlavorSelect    = 5;   </span>
<span class="lineNum">     533 </span><span class="lineNoCov">          0 :         break;</span>
<span class="lineNum">     534 </span>            :     case kPyJpsiChi:
<span class="lineNum">     535 </span>            :     case kPyJpsi:
<span class="lineNum">     536 </span><span class="lineNoCov">          0 :         fParentSelect[0] = 443;</span>
<span class="lineNum">     537 </span><span class="lineNoCov">          0 :         break;</span>
<span class="lineNum">     538 </span>            :     case kPyMbDefault:
<span class="lineNum">     539 </span>            :     case kPyMbAtlasTuneMC09:
<span class="lineNum">     540 </span>            :     case kPyMb:
<span class="lineNum">     541 </span>            :     case kPyMbWithDirectPhoton:
<span class="lineNum">     542 </span>            :     case kPyMbNonDiffr:
<span class="lineNum">     543 </span>            :     case kPyMbMSEL1:
<span class="lineNum">     544 </span>            :     case kPyJets:
<span class="lineNum">     545 </span>            :     case kPyJetsPWHG:
<span class="lineNum">     546 </span>            :     case kPyDirectGamma:
<span class="lineNum">     547 </span>            :     case kPyLhwgMb:     
<span class="lineNum">     548 </span>            :         break;
<span class="lineNum">     549 </span>            :     case kPyWPWHG:
<span class="lineNum">     550 </span>            :     case kPyW:
<span class="lineNum">     551 </span>            :     case kPyZ:
<span class="lineNum">     552 </span>            :     case kPyZgamma:
<span class="lineNum">     553 </span>            :     case kPyMBRSingleDiffraction:
<span class="lineNum">     554 </span>            :     case kPyMBRDoubleDiffraction:
<span class="lineNum">     555 </span>            :     case kPyMBRCentralDiffraction:
<span class="lineNum">     556 </span>            :         break;
<span class="lineNum">     557 </span>            :     }
<span class="lineNum">     558 </span>            : //
<span class="lineNum">     559 </span>            : //
<span class="lineNum">     560 </span>            : //  JetFinder for Trigger
<span class="lineNum">     561 </span>            : //
<span class="lineNum">     562 </span>            : //  Configure detector (EMCAL like)
<span class="lineNum">     563 </span>            : //
<span class="lineNum">     564 </span><span class="lineNoCov">          0 :     fPythia-&gt;SetPARU(51, fPycellEtaMax);</span>
<span class="lineNum">     565 </span><span class="lineNoCov">          0 :     fPythia-&gt;SetMSTU(51, fPycellNEta);</span>
<span class="lineNum">     566 </span><span class="lineNoCov">          0 :     fPythia-&gt;SetMSTU(52, fPycellNPhi);</span>
<span class="lineNum">     567 </span>            : //
<span class="lineNum">     568 </span>            : //  Configure Jet Finder
<span class="lineNum">     569 </span>            : //  
<span class="lineNum">     570 </span><span class="lineNoCov">          0 :     fPythia-&gt;SetPARU(58,  fPycellThreshold);</span>
<span class="lineNum">     571 </span><span class="lineNoCov">          0 :     fPythia-&gt;SetPARU(52,  fPycellEtSeed);</span>
<span class="lineNum">     572 </span><span class="lineNoCov">          0 :     fPythia-&gt;SetPARU(53,  fPycellMinEtJet);</span>
<span class="lineNum">     573 </span><span class="lineNoCov">          0 :     fPythia-&gt;SetPARU(54,  fPycellMaxRadius);</span>
<span class="lineNum">     574 </span><span class="lineNoCov">          0 :     fPythia-&gt;SetMSTU(54,  2);</span>
<span class="lineNum">     575 </span>            : //
<span class="lineNum">     576 </span>            : //  This counts the total number of calls to Pyevnt() per run.
<span class="lineNum">     577 </span><span class="lineNoCov">          0 :     fTrialsRun = 0;</span>
<span class="lineNum">     578 </span><span class="lineNoCov">          0 :     fQ         = 0.;</span>
<span class="lineNum">     579 </span><span class="lineNoCov">          0 :     fX1        = 0.;</span>
<span class="lineNum">     580 </span><span class="lineNoCov">          0 :     fX2        = 0.;    </span>
<span class="lineNum">     581 </span><span class="lineNoCov">          0 :     fNev       = 0 ;</span>
<span class="lineNum">     582 </span>            : //    
<span class="lineNum">     583 </span>            : //
<span class="lineNum">     584 </span>            : //
<span class="lineNum">     585 </span><span class="lineNoCov">          0 :     AliGenMC::Init();</span>
<span class="lineNum">     586 </span>            : 
<span class="lineNum">     587 </span>            :     // Reset Lorentz boost if demanded
<span class="lineNum">     588 </span><span class="lineNoCov">          0 :     if(!fUseLorentzBoost) {</span>
<span class="lineNum">     589 </span><span class="lineNoCov">          0 :       fDyBoost = 0;</span>
<span class="lineNum">     590 </span><span class="lineNoCov">          0 :       Warning(&quot;Init&quot;,&quot;Demand to discard Lorentz boost.\n&quot;);</span>
<span class="lineNum">     591 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">     592 </span>            : //
<span class="lineNum">     593 </span>            : //
<span class="lineNum">     594 </span>            : //  
<span class="lineNum">     595 </span><span class="lineNoCov">          0 :     if (fSetNuclei) {</span>
<span class="lineNum">     596 </span><span class="lineNoCov">          0 :       fDyBoost = 0;</span>
<span class="lineNum">     597 </span><span class="lineNoCov">          0 :       Warning(&quot;Init&quot;,&quot;Deprecated function SetNuclei() used (nPDFs + no boost). Use SetProjectile + SetTarget + SetUseNuclearPDF + SetUseLorentzBoost instead.\n&quot;);</span>
<span class="lineNum">     598 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">     599 </span><span class="lineNoCov">          0 :     fPythia-&gt;SetPARJ(200, 0.0);</span>
<span class="lineNum">     600 </span><span class="lineNoCov">          0 :     fPythia-&gt;SetPARJ(199, 0.0);</span>
<span class="lineNum">     601 </span><span class="lineNoCov">          0 :     fPythia-&gt;SetPARJ(198, 0.0);</span>
<span class="lineNum">     602 </span><span class="lineNoCov">          0 :     fPythia-&gt;SetPARJ(197, 0.0);</span>
<span class="lineNum">     603 </span>            : 
<span class="lineNum">     604 </span><span class="lineNoCov">          0 :     if (fQuench == 1) {</span>
<span class="lineNum">     605 </span><span class="lineNoCov">          0 :         fPythia-&gt;InitQuenching(0., 0.1, 0.6e6, 0);</span>
<span class="lineNum">     606 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">     607 </span>            : 
<span class="lineNum">     608 </span><span class="lineNoCov">          0 :     if(fQuench ==2){fPythia-&gt;SetPyquenParameters(fpyquenT,fpyquenTau,fpyquenNf,fpyquenEloss,fpyquenAngle);}</span>
<span class="lineNum">     609 </span>            :   
<span class="lineNum">     610 </span><span class="lineNoCov">          0 :     if (fQuench == 3) {</span>
<span class="lineNum">     611 </span>            :         // Nestor's change of the splittings
<span class="lineNum">     612 </span><span class="lineNoCov">          0 :         fPythia-&gt;SetPARJ(200, 0.8);</span>
<span class="lineNum">     613 </span><span class="lineNoCov">          0 :         fPythia-&gt;SetMSTJ(41, 1);  // QCD radiation only</span>
<span class="lineNum">     614 </span><span class="lineNoCov">          0 :         fPythia-&gt;SetMSTJ(42, 2);  // angular ordering</span>
<span class="lineNum">     615 </span><span class="lineNoCov">          0 :         fPythia-&gt;SetMSTJ(44, 2);  // option to run alpha_s</span>
<span class="lineNum">     616 </span><span class="lineNoCov">          0 :         fPythia-&gt;SetMSTJ(47, 0);  // No correction back to hard scattering element</span>
<span class="lineNum">     617 </span><span class="lineNoCov">          0 :         fPythia-&gt;SetMSTJ(50, 0);  // No coherence in first branching</span>
<span class="lineNum">     618 </span><span class="lineNoCov">          0 :         fPythia-&gt;SetPARJ(82, 1.); // Cut off for parton showers</span>
<span class="lineNum">     619 </span><span class="lineNoCov">          0 :     } else if (fQuench == 4) {</span>
<span class="lineNum">     620 </span>            :         // Armesto-Cunqueiro-Salgado change of the splittings.
<span class="lineNum">     621 </span><span class="lineNoCov">          0 :         AliFastGlauber* glauber = AliFastGlauber::Instance();</span>
<span class="lineNum">     622 </span><span class="lineNoCov">          0 :         glauber-&gt;Init(2);</span>
<span class="lineNum">     623 </span>            :         //read and store transverse almonds corresponding to differnt
<span class="lineNum">     624 </span>            :         //impact parameters.
<span class="lineNum">     625 </span><span class="lineNoCov">          0 :         glauber-&gt;SetCentralityClass(0.,0.1);</span>
<span class="lineNum">     626 </span><span class="lineNoCov">          0 :         fPythia-&gt;SetPARJ(200, 1.);</span>
<span class="lineNum">     627 </span><span class="lineNoCov">          0 :         fPythia-&gt;SetPARJ(198, fQhat);</span>
<span class="lineNum">     628 </span><span class="lineNoCov">          0 :         fPythia-&gt;SetPARJ(199, fLength);</span>
<span class="lineNum">     629 </span><span class="lineNoCov">          0 :         fPythia-&gt;SetMSTJ(42, 2);  // angular ordering</span>
<span class="lineNum">     630 </span><span class="lineNoCov">          0 :         fPythia-&gt;SetMSTJ(44, 2);  // option to run alpha_s</span>
<span class="lineNum">     631 </span><span class="lineNoCov">          0 :         fPythia-&gt;SetPARJ(82, 1.); // Cut off for parton showers</span>
<span class="lineNum">     632 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">     633 </span>            :   
<span class="lineNum">     634 </span><span class="lineNoCov">          0 :   if ( AliLog::GetDebugLevel(&quot;&quot;,&quot;AliGenPythia&quot;) &gt;= 1 ) {</span>
<span class="lineNum">     635 </span><span class="lineNoCov">          0 :     fPythia-&gt;Pystat(4);</span>
<span class="lineNum">     636 </span><span class="lineNoCov">          0 :     fPythia-&gt;Pystat(5);</span>
<span class="lineNum">     637 </span><span class="lineNoCov">          0 :   }</span>
<a name="638"><span class="lineNum">     638 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     639 </span>            : 
<span class="lineNum">     640 </span>            : void AliGenPythia::Generate()
<span class="lineNum">     641 </span>            : {
<span class="lineNum">     642 </span>            : // Generate one event
<span class="lineNum">     643 </span><span class="lineNoCov">          0 :     if (!fPythia) fPythia=(AliPythia*) fMCEvGen;</span>
<span class="lineNum">     644 </span><span class="lineNoCov">          0 :     fDecayer-&gt;ForceDecay();</span>
<span class="lineNum">     645 </span>            : 
<span class="lineNum">     646 </span>            :     Double_t polar[3]   =   {0,0,0};
<span class="lineNum">     647 </span>            :     Double_t origin[3]  =   {0,0,0};
<span class="lineNum">     648 </span>            :     Double_t p[4];
<span class="lineNum">     649 </span>            : //  converts from mm/c to s
<span class="lineNum">     650 </span><span class="lineNoCov">          0 :     const Float_t kconv=0.001/TMath::C();</span>
<span class="lineNum">     651 </span>            : //
<span class="lineNum">     652 </span><span class="lineNoCov">          0 :     Int_t nt=0;</span>
<span class="lineNum">     653 </span>            :     Int_t jev=0;
<span class="lineNum">     654 </span>            :     Int_t j, kf;
<span class="lineNum">     655 </span><span class="lineNoCov">          0 :     fTrials=0;</span>
<span class="lineNum">     656 </span><span class="lineNoCov">          0 :     fEventTime = 0.;</span>
<span class="lineNum">     657 </span>            :     
<span class="lineNum">     658 </span>            :     
<span class="lineNum">     659 </span>            : 
<span class="lineNum">     660 </span>            :     //  Set collision vertex position 
<span class="lineNum">     661 </span><span class="lineNoCov">          0 :     if (fVertexSmear == kPerEvent) Vertex();</span>
<span class="lineNum">     662 </span>            :     
<span class="lineNum">     663 </span>            : //  event loop    
<span class="lineNum">     664 </span>            :     while(1)
<span class="lineNum">     665 </span>            :     {
<span class="lineNum">     666 </span>            : //
<span class="lineNum">     667 </span>            : // Produce event
<span class="lineNum">     668 </span>            : //
<span class="lineNum">     669 </span>            : //
<span class="lineNum">     670 </span>            : // Switch hadronisation off
<span class="lineNum">     671 </span>            : //
<span class="lineNum">     672 </span><span class="lineNoCov">          0 :         fPythia-&gt;SetMSTJ(1, 0);</span>
<span class="lineNum">     673 </span>            : 
<span class="lineNum">     674 </span><span class="lineNoCov">          0 :         if (fQuench ==4){</span>
<span class="lineNum">     675 </span><span class="lineNoCov">          0 :             Double_t bimp;</span>
<span class="lineNum">     676 </span>            :             // Quenching comes through medium-modified splitting functions.
<span class="lineNum">     677 </span><span class="lineNoCov">          0 :             AliFastGlauber::Instance()-&gt;GetRandomBHard(bimp);</span>
<span class="lineNum">     678 </span><span class="lineNoCov">          0 :             fPythia-&gt;SetPARJ(197, bimp);</span>
<span class="lineNum">     679 </span><span class="lineNoCov">          0 :             fImpact = bimp;</span>
<span class="lineNum">     680 </span><span class="lineNoCov">          0 :             fPythia-&gt;Qpygin0();</span>
<span class="lineNum">     681 </span><span class="lineNoCov">          0 :         } </span>
<span class="lineNum">     682 </span>            : //
<span class="lineNum">     683 </span>            : // Either produce new event or read partons from file
<span class="lineNum">     684 </span>            : //      
<span class="lineNum">     685 </span><span class="lineNoCov">          0 :         if (!fReadFromFile) {</span>
<span class="lineNum">     686 </span><span class="lineNoCov">          0 :             if (!fNewMIS) {</span>
<span class="lineNum">     687 </span><span class="lineNoCov">          0 :                 fPythia-&gt;Pyevnt();</span>
<span class="lineNum">     688 </span><span class="lineNoCov">          0 :             } else {</span>
<span class="lineNum">     689 </span><span class="lineNoCov">          0 :                 fPythia-&gt;Pyevnw();</span>
<span class="lineNum">     690 </span>            :             }
<span class="lineNum">     691 </span><span class="lineNoCov">          0 :             fNpartons = fPythia-&gt;GetN();</span>
<span class="lineNum">     692 </span><span class="lineNoCov">          0 :         } else {</span>
<span class="lineNum">     693 </span><span class="lineNoCov">          0 :             printf(&quot;Loading Event %d\n&quot;,AliRunLoader::Instance()-&gt;GetEventNumber());</span>
<span class="lineNum">     694 </span><span class="lineNoCov">          0 :             fRL-&gt;GetEvent(AliRunLoader::Instance()-&gt;GetEventNumber());</span>
<span class="lineNum">     695 </span><span class="lineNoCov">          0 :             fPythia-&gt;SetN(0);</span>
<span class="lineNum">     696 </span><span class="lineNoCov">          0 :             LoadEvent(fRL-&gt;Stack(), 0 , 1);</span>
<span class="lineNum">     697 </span><span class="lineNoCov">          0 :             fPythia-&gt;Pyedit(21);</span>
<span class="lineNum">     698 </span>            :         }
<span class="lineNum">     699 </span>            :         
<span class="lineNum">     700 </span>            : //
<span class="lineNum">     701 </span>            : //  Run quenching routine 
<span class="lineNum">     702 </span>            : //
<span class="lineNum">     703 </span><span class="lineNoCov">          0 :         if (fQuench == 1) {</span>
<span class="lineNum">     704 </span><span class="lineNoCov">          0 :             fPythia-&gt;Quench();</span>
<span class="lineNum">     705 </span><span class="lineNoCov">          0 :         } else if (fQuench == 2){</span>
<span class="lineNum">     706 </span><span class="lineNoCov">          0 :             fPythia-&gt;Pyquen(208., 0, 0.);</span>
<span class="lineNum">     707 </span><span class="lineNoCov">          0 :         } else if (fQuench == 3) {</span>
<span class="lineNum">     708 </span>            :             // Quenching is via multiplicative correction of the splittings
<span class="lineNum">     709 </span>            :         }
<span class="lineNum">     710 </span>            :         
<span class="lineNum">     711 </span>            : //
<span class="lineNum">     712 </span>            : // Switch hadronisation on
<span class="lineNum">     713 </span>            : //
<span class="lineNum">     714 </span><span class="lineNoCov">          0 :         if (fHadronisation) {</span>
<span class="lineNum">     715 </span><span class="lineNoCov">          0 :             fPythia-&gt;SetMSTJ(1, 1);</span>
<span class="lineNum">     716 </span>            : //
<span class="lineNum">     717 </span>            : // .. and perform hadronisation
<span class="lineNum">     718 </span>            : //      printf(&quot;Calling hadronisation %d\n&quot;, fPythia-&gt;GetN());
<span class="lineNum">     719 </span>            : 
<span class="lineNum">     720 </span><span class="lineNoCov">          0 :             if (fPatchOmegaDalitz) {</span>
<span class="lineNum">     721 </span><span class="lineNoCov">          0 :               fPythia-&gt;SetMDCY(fPythia-&gt;Pycomp(111) ,1, 0);</span>
<span class="lineNum">     722 </span><span class="lineNoCov">          0 :               fPythia-&gt;Pyexec();</span>
<span class="lineNum">     723 </span><span class="lineNoCov">          0 :               fPythia-&gt;DalitzDecays();</span>
<span class="lineNum">     724 </span><span class="lineNoCov">          0 :               fPythia-&gt;SetMDCY(fPythia-&gt;Pycomp(111) ,1, 1);</span>
<span class="lineNum">     725 </span><span class="lineNoCov">          0 :             } </span>
<span class="lineNum">     726 </span>            :           
<span class="lineNum">     727 </span><span class="lineNoCov">          0 :       else  if (fDecayerExodus) {</span>
<span class="lineNum">     728 </span>            : 
<span class="lineNum">     729 </span><span class="lineNoCov">          0 :         fPythia-&gt;SetMDCY(fPythia-&gt;Pycomp(22) ,1, 0);</span>
<span class="lineNum">     730 </span><span class="lineNoCov">          0 :         fPythia-&gt;SetMDCY(fPythia-&gt;Pycomp(111) ,1, 0);</span>
<span class="lineNum">     731 </span><span class="lineNoCov">          0 :         fPythia-&gt;SetMDCY(fPythia-&gt;Pycomp(221) ,1, 0);</span>
<span class="lineNum">     732 </span><span class="lineNoCov">          0 :         fPythia-&gt;Pyexec();</span>
<span class="lineNum">     733 </span><span class="lineNoCov">          0 :         fPythia-&gt;OmegaDalitz();</span>
<span class="lineNum">     734 </span><span class="lineNoCov">          0 :         fPythia-&gt;SetMDCY(fPythia-&gt;Pycomp(111) ,1, 1);</span>
<span class="lineNum">     735 </span><span class="lineNoCov">          0 :         fPythia-&gt;PizeroDalitz();</span>
<span class="lineNum">     736 </span><span class="lineNoCov">          0 :         fPythia-&gt;PhiDalitz();</span>
<span class="lineNum">     737 </span><span class="lineNoCov">          0 :         fPythia-&gt;SetMDCY(fPythia-&gt;Pycomp(221) ,1, 1);</span>
<span class="lineNum">     738 </span><span class="lineNoCov">          0 :         fPythia-&gt;EtaDalitz();</span>
<span class="lineNum">     739 </span><span class="lineNoCov">          0 :         fPythia-&gt;EtaprimeDalitz();</span>
<span class="lineNum">     740 </span><span class="lineNoCov">          0 :         fPythia-&gt;SetMDCY(fPythia-&gt;Pycomp(22) ,1, 1);</span>
<span class="lineNum">     741 </span><span class="lineNoCov">          0 :         fPythia-&gt;RhoDirect();</span>
<span class="lineNum">     742 </span><span class="lineNoCov">          0 :         fPythia-&gt;OmegaDirect();</span>
<span class="lineNum">     743 </span><span class="lineNoCov">          0 :         fPythia-&gt;PhiDirect();</span>
<span class="lineNum">     744 </span><span class="lineNoCov">          0 :         fPythia-&gt;JPsiDirect();</span>
<span class="lineNum">     745 </span><span class="lineNoCov">          0 :       }</span>
<span class="lineNum">     746 </span>            :     
<span class="lineNum">     747 </span><span class="lineNoCov">          0 :       fPythia-&gt;Pyexec();</span>
<span class="lineNum">     748 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">     749 </span><span class="lineNoCov">          0 :         fTrials++;</span>
<span class="lineNum">     750 </span><span class="lineNoCov">          0 :         fPythia-&gt;ImportParticles(&amp;fParticles,&quot;All&quot;);</span>
<span class="lineNum">     751 </span>            :         
<span class="lineNum">     752 </span><span class="lineNoCov">          0 :         if (TMath::Abs(fDyBoost) &gt; 1.e-4) Boost();</span>
<span class="lineNum">     753 </span><span class="lineNoCov">          0 :         if(TMath::Abs(fXingAngleY) &gt; 1.e-10) BeamCrossAngle();</span>
<span class="lineNum">     754 </span>            :         
<span class="lineNum">     755 </span>            : //
<span class="lineNum">     756 </span>            : //
<span class="lineNum">     757 </span>            : //
<span class="lineNum">     758 </span>            :         Int_t i;
<span class="lineNum">     759 </span>            :         
<span class="lineNum">     760 </span><span class="lineNoCov">          0 :         fNprimaries = 0;</span>
<span class="lineNum">     761 </span><span class="lineNoCov">          0 :         Int_t np = fParticles.GetEntriesFast();</span>
<span class="lineNum">     762 </span>            :         
<span class="lineNum">     763 </span><span class="lineNoCov">          0 :         if (np == 0) continue;</span>
<span class="lineNum">     764 </span>            : //
<span class="lineNum">     765 </span>            :         
<span class="lineNum">     766 </span>            : //
<span class="lineNum">     767 </span><span class="lineNoCov">          0 :         Int_t* pParent   = new Int_t[np];</span>
<span class="lineNum">     768 </span><span class="lineNoCov">          0 :         Int_t* pSelected = new Int_t[np];</span>
<span class="lineNum">     769 </span><span class="lineNoCov">          0 :         Int_t* trackIt   = new Int_t[np];</span>
<span class="lineNum">     770 </span><span class="lineNoCov">          0 :         for (i = 0; i &lt; np; i++) {</span>
<span class="lineNum">     771 </span><span class="lineNoCov">          0 :             pParent[i]   = -1;</span>
<span class="lineNum">     772 </span><span class="lineNoCov">          0 :             pSelected[i] =  0;</span>
<span class="lineNum">     773 </span><span class="lineNoCov">          0 :             trackIt[i]   =  0;</span>
<span class="lineNum">     774 </span>            :         }
<span class="lineNum">     775 </span>            : 
<span class="lineNum">     776 </span>            :         Int_t nc = 0;        // Total n. of selected particles
<span class="lineNum">     777 </span>            :         Int_t nParents = 0;  // Selected parents
<span class="lineNum">     778 </span>            :         Int_t nTkbles = 0;   // Trackable particles
<span class="lineNum">     779 </span><span class="lineNoCov">          0 :         if (fProcess != kPyMbDefault &amp;&amp; </span>
<span class="lineNum">     780 </span><span class="lineNoCov">          0 :             fProcess != kPyMb &amp;&amp; </span>
<span class="lineNum">     781 </span><span class="lineNoCov">          0 :             fProcess != kPyMbAtlasTuneMC09 &amp;&amp; </span>
<span class="lineNum">     782 </span><span class="lineNoCov">          0 :             fProcess != kPyMbWithDirectPhoton &amp;&amp; </span>
<span class="lineNum">     783 </span><span class="lineNoCov">          0 :             fProcess != kPyJets &amp;&amp; </span>
<span class="lineNum">     784 </span><span class="lineNoCov">          0 :             fProcess != kPyDirectGamma &amp;&amp;</span>
<span class="lineNum">     785 </span><span class="lineNoCov">          0 :             fProcess != kPyMbNonDiffr  &amp;&amp;</span>
<span class="lineNum">     786 </span><span class="lineNoCov">          0 :             fProcess != kPyMbMSEL1     &amp;&amp;</span>
<span class="lineNum">     787 </span><span class="lineNoCov">          0 :             fProcess != kPyW &amp;&amp; </span>
<span class="lineNum">     788 </span><span class="lineNoCov">          0 :             fProcess != kPyZ &amp;&amp;</span>
<span class="lineNum">     789 </span><span class="lineNoCov">          0 :             fProcess != kPyJpsi &amp;&amp;</span>
<span class="lineNum">     790 </span><span class="lineNoCov">          0 :             fProcess != kPyZgamma &amp;&amp;</span>
<span class="lineNum">     791 </span><span class="lineNoCov">          0 :             fProcess != kPyCharmppMNRwmi &amp;&amp; </span>
<span class="lineNum">     792 </span><span class="lineNoCov">          0 :             fProcess != kPyBeautyppMNRwmi &amp;&amp;</span>
<span class="lineNum">     793 </span><span class="lineNoCov">          0 :             fProcess != kPyBeautyJets &amp;&amp;</span>
<span class="lineNum">     794 </span><span class="lineNoCov">          0 :             fProcess != kPyWPWHG &amp;&amp;</span>
<span class="lineNum">     795 </span><span class="lineNoCov">          0 :             fProcess != kPyJetsPWHG &amp;&amp;</span>
<span class="lineNum">     796 </span><span class="lineNoCov">          0 :             fProcess != kPyCharmPWHG &amp;&amp;</span>
<span class="lineNum">     797 </span><span class="lineNoCov">          0 :             fProcess != kPyBeautyPWHG) {</span>
<span class="lineNum">     798 </span>            :             
<span class="lineNum">     799 </span><span class="lineNoCov">          0 :             for (i = 0; i &lt; np; i++) {</span>
<span class="lineNum">     800 </span><span class="lineNoCov">          0 :                 TParticle* iparticle = (TParticle *) fParticles.At(i);</span>
<span class="lineNum">     801 </span><span class="lineNoCov">          0 :                 Int_t ks = iparticle-&gt;GetStatusCode();</span>
<span class="lineNum">     802 </span><span class="lineNoCov">          0 :                 kf = CheckPDGCode(iparticle-&gt;GetPdgCode());</span>
<span class="lineNum">     803 </span>            : // No initial state partons
<span class="lineNum">     804 </span><span class="lineNoCov">          0 :                 if (ks==21) continue;</span>
<span class="lineNum">     805 </span>            : //
<span class="lineNum">     806 </span>            : // Heavy Flavor Selection
<span class="lineNum">     807 </span>            : //
<span class="lineNum">     808 </span>            :                 // quark ?
<span class="lineNum">     809 </span><span class="lineNoCov">          0 :                 kf = TMath::Abs(kf);</span>
<span class="lineNum">     810 </span>            :                 Int_t kfl = kf;
<span class="lineNum">     811 </span>            :                 // Resonance
<span class="lineNum">     812 </span>            : 
<span class="lineNum">     813 </span><span class="lineNoCov">          0 :                 if (kfl &gt; 100000) kfl %= 100000;</span>
<span class="lineNum">     814 </span><span class="lineNoCov">          0 :                 if (kfl &gt; 10000)  kfl %= 10000;</span>
<span class="lineNum">     815 </span>            :                 // meson ?
<span class="lineNum">     816 </span><span class="lineNoCov">          0 :                 if  (kfl &gt; 10) kfl/=100;</span>
<span class="lineNum">     817 </span>            :                 // baryon
<span class="lineNum">     818 </span><span class="lineNoCov">          0 :                 if (kfl &gt; 10) kfl/=10;</span>
<span class="lineNum">     819 </span><span class="lineNoCov">          0 :                 Int_t ipa = iparticle-&gt;GetFirstMother()-1;</span>
<span class="lineNum">     820 </span>            :                 Int_t kfMo = 0;
<span class="lineNum">     821 </span>            : //
<span class="lineNum">     822 </span>            : // Establish mother daughter relation between heavy quarks and mesons
<span class="lineNum">     823 </span>            : //
<span class="lineNum">     824 </span><span class="lineNoCov">          0 :                 if (kf &gt;= fFlavorSelect &amp;&amp; kf &lt;= 6) {</span>
<span class="lineNum">     825 </span><span class="lineNoCov">          0 :                     Int_t idau = iparticle-&gt;GetFirstDaughter() - 1;</span>
<span class="lineNum">     826 </span><span class="lineNoCov">          0 :                     if (idau &gt; -1) {</span>
<span class="lineNum">     827 </span><span class="lineNoCov">          0 :                         TParticle* daughter = (TParticle *) fParticles.At(idau);</span>
<span class="lineNum">     828 </span><span class="lineNoCov">          0 :                         Int_t pdgD = daughter-&gt;GetPdgCode();</span>
<span class="lineNum">     829 </span><span class="lineNoCov">          0 :                         if (pdgD == 91 || pdgD == 92) {</span>
<span class="lineNum">     830 </span><span class="lineNoCov">          0 :                             Int_t jmin = daughter-&gt;GetFirstDaughter() - 1;</span>
<span class="lineNum">     831 </span><span class="lineNoCov">          0 :                             Int_t jmax = daughter-&gt;GetLastDaughter()  - 1;                       </span>
<span class="lineNum">     832 </span><span class="lineNoCov">          0 :                             for (Int_t jp = jmin; jp &lt;= jmax; jp++)</span>
<span class="lineNum">     833 </span><span class="lineNoCov">          0 :                                 ((TParticle *) fParticles.At(jp))-&gt;SetFirstMother(i+1);</span>
<span class="lineNum">     834 </span><span class="lineNoCov">          0 :                         } // is string or cluster</span>
<span class="lineNum">     835 </span><span class="lineNoCov">          0 :                     } // has daughter</span>
<span class="lineNum">     836 </span><span class="lineNoCov">          0 :                 } // heavy quark</span>
<span class="lineNum">     837 </span>            :                 
<span class="lineNum">     838 </span>            : 
<span class="lineNum">     839 </span><span class="lineNoCov">          0 :                 if (ipa &gt; -1) {</span>
<span class="lineNum">     840 </span><span class="lineNoCov">          0 :                     TParticle *  mother = (TParticle *) fParticles.At(ipa);</span>
<span class="lineNum">     841 </span><span class="lineNoCov">          0 :                     kfMo = TMath::Abs(mother-&gt;GetPdgCode());</span>
<span class="lineNum">     842 </span><span class="lineNoCov">          0 :                 }</span>
<span class="lineNum">     843 </span>            :                 
<span class="lineNum">     844 </span>            :                 // What to keep in Stack?
<span class="lineNum">     845 </span>            :                 Bool_t flavorOK = kFALSE;
<span class="lineNum">     846 </span>            :                 Bool_t selectOK = kFALSE;
<span class="lineNum">     847 </span><span class="lineNoCov">          0 :                 if (fFeedDownOpt) {</span>
<span class="lineNum">     848 </span><span class="lineNoCov">          0 :                     if (kfl &gt;= fFlavorSelect) flavorOK = kTRUE;</span>
<span class="lineNum">     849 </span>            :                 } else {
<span class="lineNum">     850 </span><span class="lineNoCov">          0 :                     if (kfl &gt; fFlavorSelect) {</span>
<span class="lineNum">     851 </span>            :                         nc = -1;
<span class="lineNum">     852 </span><span class="lineNoCov">          0 :                         break;</span>
<span class="lineNum">     853 </span>            :                     }
<span class="lineNum">     854 </span><span class="lineNoCov">          0 :                     if (kfl == fFlavorSelect) flavorOK = kTRUE;</span>
<span class="lineNum">     855 </span>            :                 }
<span class="lineNum">     856 </span><span class="lineNoCov">          0 :                 switch (fStackFillOpt) {</span>
<span class="lineNum">     857 </span>            :                 case kHeavyFlavor:
<span class="lineNum">     858 </span>            :                 case kFlavorSelection:
<span class="lineNum">     859 </span>            :                     selectOK = kTRUE;
<span class="lineNum">     860 </span><span class="lineNoCov">          0 :                     break;</span>
<span class="lineNum">     861 </span>            :                 case kParentSelection:
<span class="lineNum">     862 </span><span class="lineNoCov">          0 :                     if (ParentSelected(kf) || kf &lt;= 10) selectOK = kTRUE;</span>
<span class="lineNum">     863 </span>            :                     break;
<span class="lineNum">     864 </span>            :                 }
<span class="lineNum">     865 </span><span class="lineNoCov">          0 :                 if (flavorOK &amp;&amp; selectOK) { </span>
<span class="lineNum">     866 </span>            : //
<span class="lineNum">     867 </span>            : // Heavy flavor hadron or quark
<span class="lineNum">     868 </span>            : //
<span class="lineNum">     869 </span>            : // Kinematic seletion on final state heavy flavor mesons
<span class="lineNum">     870 </span><span class="lineNoCov">          0 :                     if (ParentSelected(kf) &amp;&amp; !KinematicSelection(iparticle, 0)) </span>
<span class="lineNum">     871 </span>            :                     {
<span class="lineNum">     872 </span><span class="lineNoCov">          0 :                         continue;</span>
<span class="lineNum">     873 </span>            :                     }
<span class="lineNum">     874 </span><span class="lineNoCov">          0 :                     pSelected[i] = 1;</span>
<span class="lineNum">     875 </span><span class="lineNoCov">          0 :                     if (ParentSelected(kf)) ++nParents; // Update parent count</span>
<span class="lineNum">     876 </span>            : //                  printf(&quot;\n particle (HF)  %d %d %d&quot;, i, pSelected[i], kf);
<span class="lineNum">     877 </span>            :                 } else {
<span class="lineNum">     878 </span>            : // Kinematic seletion on decay products
<span class="lineNum">     879 </span><span class="lineNoCov">          0 :                     if (fCutOnChild &amp;&amp; ParentSelected(kfMo) &amp;&amp; ChildSelected(kf) </span>
<span class="lineNum">     880 </span><span class="lineNoCov">          0 :                         &amp;&amp; !KinematicSelection(iparticle, 1)) </span>
<span class="lineNum">     881 </span>            :                     {
<span class="lineNum">     882 </span><span class="lineNoCov">          0 :                         continue;</span>
<span class="lineNum">     883 </span>            :                     }
<span class="lineNum">     884 </span>            : //
<span class="lineNum">     885 </span>            : // Decay products 
<span class="lineNum">     886 </span>            : // Select if mother was selected and is not tracked
<span class="lineNum">     887 </span>            : 
<span class="lineNum">     888 </span><span class="lineNoCov">          0 :                     if (pSelected[ipa] &amp;&amp; </span>
<span class="lineNum">     889 </span><span class="lineNoCov">          0 :                         !trackIt[ipa]  &amp;&amp;     // mother will be  tracked ?</span>
<span class="lineNum">     890 </span><span class="lineNoCov">          0 :                         kfMo !=  5 &amp;&amp;         // mother is b-quark, don't store fragments          </span>
<span class="lineNum">     891 </span><span class="lineNoCov">          0 :                         kfMo !=  4 &amp;&amp;         // mother is c-quark, don't store fragments </span>
<span class="lineNum">     892 </span><span class="lineNoCov">          0 :                         kf   != 92)           // don't store string</span>
<span class="lineNum">     893 </span>            :                     {
<span class="lineNum">     894 </span>            : //
<span class="lineNum">     895 </span>            : // Semi-stable or de-selected: diselect decay products:
<span class="lineNum">     896 </span>            : // 
<span class="lineNum">     897 </span>            : //
<span class="lineNum">     898 </span><span class="lineNoCov">          0 :                         if (pSelected[i] == -1 ||  fDecayer-&gt;GetLifetime(kf) &gt; fMaxLifeTime)</span>
<span class="lineNum">     899 </span>            :                         {
<span class="lineNum">     900 </span><span class="lineNoCov">          0 :                             Int_t ipF = iparticle-&gt;GetFirstDaughter();</span>
<span class="lineNum">     901 </span><span class="lineNoCov">          0 :                             Int_t ipL = iparticle-&gt;GetLastDaughter();        </span>
<span class="lineNum">     902 </span><span class="lineNoCov">          0 :                             if (ipF &gt; 0) for (j = ipF-1; j &lt; ipL; j++) pSelected[j] = -1;</span>
<span class="lineNum">     903 </span><span class="lineNoCov">          0 :                         }</span>
<span class="lineNum">     904 </span>            : //                      printf(&quot;\n particle (decay)  %d %d %d&quot;, i, pSelected[i], kf);
<span class="lineNum">     905 </span><span class="lineNoCov">          0 :                         pSelected[i] = (pSelected[i] == -1) ? 0 : 1;</span>
<span class="lineNum">     906 </span><span class="lineNoCov">          0 :                     }</span>
<span class="lineNum">     907 </span>            :                 }
<span class="lineNum">     908 </span><span class="lineNoCov">          0 :                 if (pSelected[i] == -1) pSelected[i] = 0;</span>
<span class="lineNum">     909 </span><span class="lineNoCov">          0 :                 if (!pSelected[i]) continue;</span>
<span class="lineNum">     910 </span>            :                 // Count quarks only if you did not include fragmentation
<span class="lineNum">     911 </span><span class="lineNoCov">          0 :                 if (fFragmentation &amp;&amp; kf &lt;= 10) continue;</span>
<span class="lineNum">     912 </span>            : 
<span class="lineNum">     913 </span><span class="lineNoCov">          0 :                 nc++;</span>
<span class="lineNum">     914 </span>            : // Decision on tracking
<span class="lineNum">     915 </span><span class="lineNoCov">          0 :                 trackIt[i] = 0;</span>
<span class="lineNum">     916 </span>            : //
<span class="lineNum">     917 </span>            : // Track final state particle
<span class="lineNum">     918 </span><span class="lineNoCov">          0 :                 if (ks == 1) trackIt[i] = 1;</span>
<span class="lineNum">     919 </span>            : // Track semi-stable particles
<span class="lineNum">     920 </span>            : //              if ((ks == 1) || (fDecayer-&gt;GetLifetime(kf) &gt; fMaxLifeTime))  trackIt[i] = 1;
<span class="lineNum">     921 </span>            : // Track particles selected by process if undecayed. 
<span class="lineNum">     922 </span><span class="lineNoCov">          0 :                 if (fForceDecay == kNoDecay) {</span>
<span class="lineNum">     923 </span><span class="lineNoCov">          0 :                     if (ParentSelected(kf)) trackIt[i] = 1;</span>
<span class="lineNum">     924 </span>            :                 } else {
<span class="lineNum">     925 </span><span class="lineNoCov">          0 :                     if (ParentSelected(kf)) trackIt[i] = 0;</span>
<span class="lineNum">     926 </span>            :                 }
<span class="lineNum">     927 </span><span class="lineNoCov">          0 :                 if (trackIt[i] == 1) ++nTkbles; // Update trackable counter</span>
<span class="lineNum">     928 </span>            : //
<span class="lineNum">     929 </span>            : //
<span class="lineNum">     930 </span>            : 
<span class="lineNum">     931 </span><span class="lineNoCov">          0 :             } // particle selection loop</span>
<span class="lineNum">     932 </span><span class="lineNoCov">          0 :             if (nc &gt; 0) {</span>
<span class="lineNum">     933 </span><span class="lineNoCov">          0 :                 for (i = 0; i&lt;np; i++) {</span>
<span class="lineNum">     934 </span><span class="lineNoCov">          0 :                     if (!pSelected[i]) continue;</span>
<span class="lineNum">     935 </span><span class="lineNoCov">          0 :                     TParticle *  iparticle = (TParticle *) fParticles.At(i);</span>
<span class="lineNum">     936 </span><span class="lineNoCov">          0 :                     kf = CheckPDGCode(iparticle-&gt;GetPdgCode());</span>
<span class="lineNum">     937 </span><span class="lineNoCov">          0 :                     Int_t ks = iparticle-&gt;GetStatusCode();  </span>
<span class="lineNum">     938 </span><span class="lineNoCov">          0 :                     p[0] = iparticle-&gt;Px();</span>
<span class="lineNum">     939 </span><span class="lineNoCov">          0 :                     p[1] = iparticle-&gt;Py();</span>
<span class="lineNum">     940 </span><span class="lineNoCov">          0 :                     p[2] = iparticle-&gt;Pz();</span>
<span class="lineNum">     941 </span><span class="lineNoCov">          0 :                     p[3] = iparticle-&gt;Energy();</span>
<span class="lineNum">     942 </span>            :                     
<span class="lineNum">     943 </span><span class="lineNoCov">          0 :                     origin[0] = fVertex[0]+iparticle-&gt;Vx()/10; // [cm]</span>
<span class="lineNum">     944 </span><span class="lineNoCov">          0 :                     origin[1] = fVertex[1]+iparticle-&gt;Vy()/10; // [cm]</span>
<span class="lineNum">     945 </span><span class="lineNoCov">          0 :                     origin[2] = fVertex[2]+iparticle-&gt;Vz()/10; // [cm]</span>
<span class="lineNum">     946 </span>            :                     
<span class="lineNum">     947 </span><span class="lineNoCov">          0 :                     Float_t tof   = fTime + kconv*iparticle-&gt;T();</span>
<span class="lineNum">     948 </span><span class="lineNoCov">          0 :                     Int_t ipa     = iparticle-&gt;GetFirstMother()-1;</span>
<span class="lineNum">     949 </span><span class="lineNoCov">          0 :                     Int_t iparent = (ipa &gt; -1) ? pParent[ipa] : -1;</span>
<span class="lineNum">     950 </span>            :  
<span class="lineNum">     951 </span><span class="lineNoCov">          0 :                     PushTrack(fTrackIt*trackIt[i], iparent, kf, </span>
<span class="lineNum">     952 </span>            :                               p[0], p[1], p[2], p[3], 
<span class="lineNum">     953 </span><span class="lineNoCov">          0 :                               origin[0], origin[1], origin[2], tof, </span>
<span class="lineNum">     954 </span>            :                               polar[0], polar[1], polar[2],
<span class="lineNum">     955 </span>            :                               kPPrimary, nt, 1., ks);
<span class="lineNum">     956 </span><span class="lineNoCov">          0 :                     pParent[i] = nt;</span>
<span class="lineNum">     957 </span><span class="lineNoCov">          0 :                     KeepTrack(nt);</span>
<span class="lineNum">     958 </span><span class="lineNoCov">          0 :                     fNprimaries++;</span>
<span class="lineNum">     959 </span><span class="lineNoCov">          0 :                 } //  PushTrack loop</span>
<span class="lineNum">     960 </span>            :             }
<span class="lineNum">     961 </span>            :         } else {
<span class="lineNum">     962 </span><span class="lineNoCov">          0 :             nc = GenerateMB();</span>
<span class="lineNum">     963 </span>            :         } // mb ?
<span class="lineNum">     964 </span>            :         
<span class="lineNum">     965 </span><span class="lineNoCov">          0 :         GetSubEventTime();</span>
<span class="lineNum">     966 </span>            : 
<span class="lineNum">     967 </span><span class="lineNoCov">          0 :         delete[] pParent;</span>
<span class="lineNum">     968 </span><span class="lineNoCov">          0 :         delete[] pSelected;</span>
<span class="lineNum">     969 </span><span class="lineNoCov">          0 :         delete[] trackIt;</span>
<span class="lineNum">     970 </span>            : 
<span class="lineNum">     971 </span><span class="lineNoCov">          0 :         if (nc &gt; 0) {</span>
<span class="lineNum">     972 </span><span class="lineNoCov">          0 :           switch (fCountMode) {</span>
<span class="lineNum">     973 </span>            :           case kCountAll:
<span class="lineNum">     974 </span>            :             // printf(&quot; Count all \n&quot;);
<span class="lineNum">     975 </span><span class="lineNoCov">          0 :             jev += nc;</span>
<span class="lineNum">     976 </span><span class="lineNoCov">          0 :             break;</span>
<span class="lineNum">     977 </span>            :           case kCountParents:
<span class="lineNum">     978 </span>            :             // printf(&quot; Count parents \n&quot;);
<span class="lineNum">     979 </span><span class="lineNoCov">          0 :             jev += nParents;</span>
<span class="lineNum">     980 </span><span class="lineNoCov">          0 :             break;</span>
<span class="lineNum">     981 </span>            :           case kCountTrackables:
<span class="lineNum">     982 </span>            :             // printf(&quot; Count trackable \n&quot;);
<span class="lineNum">     983 </span><span class="lineNoCov">          0 :             jev += nTkbles;</span>
<span class="lineNum">     984 </span><span class="lineNoCov">          0 :             break;</span>
<span class="lineNum">     985 </span>            :           }
<span class="lineNum">     986 </span><span class="lineNoCov">          0 :             if (jev &gt;= fNpart || fNpart == -1) {</span>
<span class="lineNum">     987 </span><span class="lineNoCov">          0 :                 fKineBias=Float_t(fNpart)/Float_t(fTrials);</span>
<span class="lineNum">     988 </span>            :                 
<span class="lineNum">     989 </span><span class="lineNoCov">          0 :                 fQ  += fPythia-&gt;GetVINT(51);</span>
<span class="lineNum">     990 </span><span class="lineNoCov">          0 :                 fX1 += fPythia-&gt;GetVINT(41);</span>
<span class="lineNum">     991 </span><span class="lineNoCov">          0 :                 fX2 += fPythia-&gt;GetVINT(42);</span>
<span class="lineNum">     992 </span><span class="lineNoCov">          0 :                 fTrialsRun += fTrials;</span>
<span class="lineNum">     993 </span><span class="lineNoCov">          0 :                 fNev++;</span>
<span class="lineNum">     994 </span><span class="lineNoCov">          0 :                 MakeHeader();</span>
<span class="lineNum">     995 </span><span class="lineNoCov">          0 :                 break;</span>
<span class="lineNum">     996 </span>            :             }
<span class="lineNum">     997 </span>            :         }
<span class="lineNum">     998 </span><span class="lineNoCov">          0 :     } // event loop</span>
<span class="lineNum">     999 </span><span class="lineNoCov">          0 :     SetHighWaterMark(nt);</span>
<span class="lineNum">    1000 </span>            : //  adjust weight due to kinematic selection
<span class="lineNum">    1001 </span>            : //    AdjustWeights();
<span class="lineNum">    1002 </span>            : //  get cross-section
<span class="lineNum">    1003 </span><span class="lineNoCov">          0 :     fXsection=fPythia-&gt;GetPARI(1);</span>
<a name="1004"><span class="lineNum">    1004 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1005 </span>            : 
<span class="lineNum">    1006 </span>            : Int_t  AliGenPythia::GenerateMB()
<span class="lineNum">    1007 </span>            : {
<span class="lineNum">    1008 </span>            : //
<span class="lineNum">    1009 </span>            : // Min Bias selection and other global selections
<span class="lineNum">    1010 </span>            : //
<span class="lineNum">    1011 </span><span class="lineNoCov">          0 :     Int_t i, kf, nt, iparent;</span>
<span class="lineNum">    1012 </span>            :     Int_t nc = 0;
<span class="lineNum">    1013 </span>            :     Double_t p[4];
<span class="lineNum">    1014 </span>            :     Double_t polar[3]   =   {0,0,0};
<span class="lineNum">    1015 </span>            :     Double_t origin[3]  =   {0,0,0};
<span class="lineNum">    1016 </span>            : //  converts from mm/c to s
<span class="lineNum">    1017 </span>            :     const Float_t kconv=0.001/2.999792458e8;
<span class="lineNum">    1018 </span>            :     
<span class="lineNum">    1019 </span>            :     
<span class="lineNum">    1020 </span><span class="lineNoCov">          0 :     Int_t np = (fHadronisation) ? fParticles.GetEntriesFast() : fNpartons;</span>
<span class="lineNum">    1021 </span>            : 
<span class="lineNum">    1022 </span>            : 
<span class="lineNum">    1023 </span>            : 
<span class="lineNum">    1024 </span><span class="lineNoCov">          0 :     Int_t* pParent = new Int_t[np];</span>
<span class="lineNum">    1025 </span><span class="lineNoCov">          0 :     for (i=0; i&lt; np; i++) pParent[i] = -1;</span>
<span class="lineNum">    1026 </span><span class="lineNoCov">          0 :     if ((fProcess == kPyJets || fProcess == kPyDirectGamma || fProcess == kPyBeautyJets || fProcess == kPyBeautyppMNRwmi || fProcess == kPyJetsPWHG || fProcess == kPyCharmPWHG || fProcess == kPyBeautyPWHG)</span>
<span class="lineNum">    1027 </span><span class="lineNoCov">          0 :         &amp;&amp; fEtMinJet &gt; 0.) {</span>
<span class="lineNum">    1028 </span><span class="lineNoCov">          0 :         TParticle* jet1 = (TParticle *) fParticles.At(6);</span>
<span class="lineNum">    1029 </span><span class="lineNoCov">          0 :         TParticle* jet2 = (TParticle *) fParticles.At(7);</span>
<span class="lineNum">    1030 </span>            :         
<span class="lineNum">    1031 </span><span class="lineNoCov">          0 :         if (!jet1 || ! jet2 || !CheckTrigger(jet1, jet2)) {</span>
<span class="lineNum">    1032 </span><span class="lineNoCov">          0 :           delete [] pParent;</span>
<span class="lineNum">    1033 </span><span class="lineNoCov">          0 :           return 0;</span>
<span class="lineNum">    1034 </span>            :         }
<span class="lineNum">    1035 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">    1036 </span>            : 
<span class="lineNum">    1037 </span>            :   
<span class="lineNum">    1038 </span>            :   // Select events with fragmentation photon, decay photon, pi0, eta or other hadrons going to PHOS or EMCAL or central barrel,
<span class="lineNum">    1039 </span>            :   // implemented primaryly for kPyJets, but extended to any kind of process.
<span class="lineNum">    1040 </span><span class="lineNoCov">          0 :   if ((fFragPhotonInCalo || fPi0InCalo || fEtaInCalo || fEleInCalo || fHadronInCalo || fDecayPhotonInCalo) &amp;&amp; </span>
<span class="lineNum">    1041 </span><span class="lineNoCov">          0 :       (fCheckPHOS || fCheckEMCAL || fCheckBarrel) ) {</span>
<span class="lineNum">    1042 </span><span class="lineNoCov">          0 :     Bool_t ok = TriggerOnSelectedParticles(np);</span>
<span class="lineNum">    1043 </span>            :     
<span class="lineNum">    1044 </span><span class="lineNoCov">          0 :     if(!ok) {</span>
<span class="lineNum">    1045 </span><span class="lineNoCov">          0 :       delete[] pParent;</span>
<span class="lineNum">    1046 </span><span class="lineNoCov">          0 :       return 0;</span>
<span class="lineNum">    1047 </span>            :     }
<span class="lineNum">    1048 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">    1049 </span>            : 
<span class="lineNum">    1050 </span>            :     // Check for diffraction
<span class="lineNum">    1051 </span><span class="lineNoCov">          0 :     if(fkTuneForDiff) {</span>
<span class="lineNum">    1052 </span><span class="lineNoCov">          0 :       if(fItune==320 &amp;&amp; ( (TMath::Abs(fEnergyCMS - 900) &lt; 1) || (TMath::Abs(fEnergyCMS - 2760) &lt; 1) || (TMath::Abs(fEnergyCMS - 7000) &lt; 1)) ) {</span>
<span class="lineNum">    1053 </span><span class="lineNoCov">          0 :         if(!CheckDiffraction()) {</span>
<span class="lineNum">    1054 </span><span class="lineNoCov">          0 :           delete [] pParent;</span>
<span class="lineNum">    1055 </span><span class="lineNoCov">          0 :           return 0;</span>
<span class="lineNum">    1056 </span>            :         }
<span class="lineNum">    1057 </span>            :       }
<span class="lineNum">    1058 </span>            :     }
<span class="lineNum">    1059 </span>            : 
<span class="lineNum">    1060 </span>            :     // Check for minimum multiplicity
<span class="lineNum">    1061 </span><span class="lineNoCov">          0 :     if (fTriggerMultiplicity &gt; 0) {</span>
<span class="lineNum">    1062 </span>            :       Int_t multiplicity = 0;
<span class="lineNum">    1063 </span><span class="lineNoCov">          0 :       for (i = 0; i &lt; np; i++) {</span>
<span class="lineNum">    1064 </span><span class="lineNoCov">          0 :         TParticle *  iparticle = (TParticle *) fParticles.At(i);</span>
<span class="lineNum">    1065 </span>            :         
<span class="lineNum">    1066 </span><span class="lineNoCov">          0 :         Int_t statusCode = iparticle-&gt;GetStatusCode();</span>
<span class="lineNum">    1067 </span>            :         
<span class="lineNum">    1068 </span>            :         // Initial state particle
<span class="lineNum">    1069 </span><span class="lineNoCov">          0 :         if (statusCode != 1)</span>
<span class="lineNum">    1070 </span><span class="lineNoCov">          0 :           continue;</span>
<span class="lineNum">    1071 </span>            :         // eta cut
<span class="lineNum">    1072 </span><span class="lineNoCov">          0 :         if (fTriggerMultiplicityEta &gt; 0 &amp;&amp; TMath::Abs(iparticle-&gt;Eta()) &gt; fTriggerMultiplicityEta)</span>
<span class="lineNum">    1073 </span><span class="lineNoCov">          0 :           continue;</span>
<span class="lineNum">    1074 </span>            :         //multiplicity check for a given eta range
<span class="lineNum">    1075 </span><span class="lineNoCov">          0 :         if ((fTriggerMultiplicityEtaMin != fTriggerMultiplicityEtaMax) &amp;&amp; </span>
<span class="lineNum">    1076 </span><span class="lineNoCov">          0 :             (iparticle-&gt;Eta() &lt; fTriggerMultiplicityEtaMin || iparticle-&gt;Eta() &gt; fTriggerMultiplicityEtaMax))</span>
<span class="lineNum">    1077 </span><span class="lineNoCov">          0 :           continue;</span>
<span class="lineNum">    1078 </span>            :         // pt cut
<span class="lineNum">    1079 </span><span class="lineNoCov">          0 :         if (iparticle-&gt;Pt() &lt; fTriggerMultiplicityPtMin) </span>
<span class="lineNum">    1080 </span><span class="lineNoCov">          0 :             continue;</span>
<span class="lineNum">    1081 </span>            : 
<span class="lineNum">    1082 </span><span class="lineNoCov">          0 :         TParticlePDG* pdgPart = iparticle-&gt;GetPDG();</span>
<span class="lineNum">    1083 </span><span class="lineNoCov">          0 :         if (pdgPart &amp;&amp; pdgPart-&gt;Charge() == 0)</span>
<span class="lineNum">    1084 </span><span class="lineNoCov">          0 :           continue;</span>
<span class="lineNum">    1085 </span>            :         
<span class="lineNum">    1086 </span><span class="lineNoCov">          0 :         ++multiplicity;</span>
<span class="lineNum">    1087 </span><span class="lineNoCov">          0 :       }</span>
<span class="lineNum">    1088 </span>            : 
<span class="lineNum">    1089 </span><span class="lineNoCov">          0 :       if (multiplicity &lt; fTriggerMultiplicity) {</span>
<span class="lineNum">    1090 </span><span class="lineNoCov">          0 :         delete [] pParent;</span>
<span class="lineNum">    1091 </span><span class="lineNoCov">          0 :         return 0;</span>
<span class="lineNum">    1092 </span>            :       }
<span class="lineNum">    1093 </span><span class="lineNoCov">          0 :       Printf(&quot;Triggered on event with multiplicity of %d &gt;= %d&quot;, multiplicity, fTriggerMultiplicity);</span>
<span class="lineNum">    1094 </span><span class="lineNoCov">          0 :     }    </span>
<span class="lineNum">    1095 </span>            :     
<span class="lineNum">    1096 </span>            :     
<span class="lineNum">    1097 </span><span class="lineNoCov">          0 :     if (fTriggerParticle) {</span>
<span class="lineNum">    1098 </span>            :         Bool_t triggered = kFALSE;
<span class="lineNum">    1099 </span><span class="lineNoCov">          0 :         for (i = 0; i &lt; np; i++) {</span>
<span class="lineNum">    1100 </span><span class="lineNoCov">          0 :             TParticle *  iparticle = (TParticle *) fParticles.At(i);</span>
<span class="lineNum">    1101 </span><span class="lineNoCov">          0 :             kf = CheckPDGCode(iparticle-&gt;GetPdgCode());</span>
<span class="lineNum">    1102 </span><span class="lineNoCov">          0 :             if (kf != fTriggerParticle) continue;</span>
<span class="lineNum">    1103 </span><span class="lineNoCov">          0 :             if (iparticle-&gt;Pt() == 0.) continue;</span>
<span class="lineNum">    1104 </span><span class="lineNoCov">          0 :             if (TMath::Abs(iparticle-&gt;Y()) &gt; fTriggerY) continue;</span>
<span class="lineNum">    1105 </span><span class="lineNoCov">          0 :             if (fTriggerEtaMin == fTriggerEta) {</span>
<span class="lineNum">    1106 </span><span class="lineNoCov">          0 :               if (TMath::Abs(iparticle-&gt;Eta()) &gt; fTriggerEta) continue;</span>
<span class="lineNum">    1107 </span>            :             } else {
<span class="lineNum">    1108 </span><span class="lineNoCov">          0 :               if (iparticle-&gt;Eta() &gt; fTriggerEta || iparticle-&gt;Eta() &lt; fTriggerEtaMin) continue;</span>
<span class="lineNum">    1109 </span>            :             }
<span class="lineNum">    1110 </span><span class="lineNoCov">          0 :             if ( iparticle-&gt;Pt() &gt; fTriggerMaxPt || iparticle-&gt;Pt() &lt; fTriggerMinPt ) continue;</span>
<span class="lineNum">    1111 </span>            :             triggered = kTRUE;
<span class="lineNum">    1112 </span><span class="lineNoCov">          0 :             break;</span>
<span class="lineNum">    1113 </span>            :         }
<span class="lineNum">    1114 </span><span class="lineNoCov">          0 :         if (!triggered) {</span>
<span class="lineNum">    1115 </span><span class="lineNoCov">          0 :           delete [] pParent;</span>
<span class="lineNum">    1116 </span><span class="lineNoCov">          0 :           return 0;</span>
<span class="lineNum">    1117 </span>            :         }
<span class="lineNum">    1118 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">    1119 </span>            :         
<span class="lineNum">    1120 </span>            : 
<span class="lineNum">    1121 </span>            :     // Check if there is a ccbar or bbbar pair with at least one of the two
<span class="lineNum">    1122 </span>            :     // in fYMin &lt; y &lt; fYMax
<span class="lineNum">    1123 </span>            : 
<span class="lineNum">    1124 </span><span class="lineNoCov">          0 :     if (fProcess == kPyCharmppMNRwmi || fProcess == kPyBeautyppMNRwmi || fProcess == kPyBeautyJets) {</span>
<span class="lineNum">    1125 </span>            :       TParticle *partCheck;
<span class="lineNum">    1126 </span>            :       TParticle *mother;
<span class="lineNum">    1127 </span>            :       Bool_t  theQ=kFALSE,theQbar=kFALSE,inYcut=kFALSE;
<span class="lineNum">    1128 </span>            :       Bool_t  theChild=kFALSE;
<span class="lineNum">    1129 </span>            :       Bool_t  triggered=kFALSE;
<span class="lineNum">    1130 </span>            :       Float_t y;  
<span class="lineNum">    1131 </span>            :       Int_t   pdg, mpdg, mpdgUpperFamily;
<span class="lineNum">    1132 </span><span class="lineNoCov">          0 :       for(i = 0; i &lt; np; i++) {</span>
<span class="lineNum">    1133 </span><span class="lineNoCov">          0 :         partCheck = (TParticle*)fParticles.At(i);</span>
<span class="lineNum">    1134 </span><span class="lineNoCov">          0 :         pdg = partCheck-&gt;GetPdgCode();  </span>
<span class="lineNum">    1135 </span><span class="lineNoCov">          0 :         if(TMath::Abs(pdg) == fFlavorSelect) { // quark  </span>
<span class="lineNum">    1136 </span><span class="lineNoCov">          0 :           if(pdg&gt;0) { theQ=kTRUE; } else { theQbar=kTRUE; }</span>
<span class="lineNum">    1137 </span><span class="lineNoCov">          0 :           y = 0.5*TMath::Log((partCheck-&gt;Energy()+partCheck-&gt;Pz()+1.e-13)/</span>
<span class="lineNum">    1138 </span><span class="lineNoCov">          0 :                              (partCheck-&gt;Energy()-partCheck-&gt;Pz()+1.e-13));</span>
<span class="lineNum">    1139 </span><span class="lineNoCov">          0 :           if(fUseYCutHQ &amp;&amp; y&gt;fYMinHQ &amp;&amp; y&lt;fYMaxHQ) inYcut=kTRUE;</span>
<span class="lineNum">    1140 </span><span class="lineNoCov">          0 :           if(!fUseYCutHQ &amp;&amp; y&gt;fYMin &amp;&amp; y&lt;fYMax) inYcut=kTRUE;</span>
<span class="lineNum">    1141 </span>            :         }
<span class="lineNum">    1142 </span><span class="lineNoCov">          0 :         if(fTriggerParticle) {</span>
<span class="lineNum">    1143 </span><span class="lineNoCov">          0 :           if(TMath::Abs(pdg)==fTriggerParticle) triggered=kTRUE;</span>
<span class="lineNum">    1144 </span>            :         }
<span class="lineNum">    1145 </span><span class="lineNoCov">          0 :         if(fCutOnChild &amp;&amp; TMath::Abs(pdg) == fPdgCodeParticleforAcceptanceCut) {</span>
<span class="lineNum">    1146 </span><span class="lineNoCov">          0 :           Int_t mi = partCheck-&gt;GetFirstMother() - 1;</span>
<span class="lineNum">    1147 </span><span class="lineNoCov">          0 :           if(mi&lt;0) continue;</span>
<span class="lineNum">    1148 </span><span class="lineNoCov">          0 :           mother = (TParticle*)fParticles.At(mi);</span>
<span class="lineNum">    1149 </span><span class="lineNoCov">          0 :           mpdg=TMath::Abs(mother-&gt;GetPdgCode());</span>
<span class="lineNum">    1150 </span><span class="lineNoCov">          0 :           mpdgUpperFamily=(mpdg&gt;1000 ? mpdg+1000 : mpdg+100); // keep e from c from b</span>
<span class="lineNum">    1151 </span><span class="lineNoCov">          0 :           if ( ParentSelected(mpdg) || </span>
<span class="lineNum">    1152 </span><span class="lineNoCov">          0 :               (fFlavorSelect==5 &amp;&amp; ParentSelected(mpdgUpperFamily))) {</span>
<span class="lineNum">    1153 </span><span class="lineNoCov">          0 :             if (KinematicSelection(partCheck,1)) {</span>
<span class="lineNum">    1154 </span>            :               theChild=kTRUE;
<span class="lineNum">    1155 </span><span class="lineNoCov">          0 :             }</span>
<span class="lineNum">    1156 </span>            :           }
<span class="lineNum">    1157 </span><span class="lineNoCov">          0 :         }</span>
<span class="lineNum">    1158 </span>            :       }
<span class="lineNum">    1159 </span><span class="lineNoCov">          0 :       if (!theQ || !theQbar || !inYcut) { // one of the c/b conditions not satisfied</span>
<span class="lineNum">    1160 </span><span class="lineNoCov">          0 :         delete[] pParent;</span>
<span class="lineNum">    1161 </span><span class="lineNoCov">          0 :         return 0;</span>
<span class="lineNum">    1162 </span>            :       }
<span class="lineNum">    1163 </span><span class="lineNoCov">          0 :       if (fCutOnChild &amp;&amp; !theChild) { // one of the child conditions not satisfied</span>
<span class="lineNum">    1164 </span><span class="lineNoCov">          0 :         delete[] pParent;</span>
<span class="lineNum">    1165 </span><span class="lineNoCov">          0 :         return 0;       </span>
<span class="lineNum">    1166 </span>            :       }
<span class="lineNum">    1167 </span><span class="lineNoCov">          0 :       if(fTriggerParticle &amp;&amp; !triggered) { // particle requested is not produced</span>
<span class="lineNum">    1168 </span><span class="lineNoCov">          0 :         delete[] pParent;</span>
<span class="lineNum">    1169 </span><span class="lineNoCov">          0 :         return 0;       </span>
<span class="lineNum">    1170 </span>            :       }
<span class="lineNum">    1171 </span>            : 
<span class="lineNum">    1172 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">    1173 </span>            : 
<span class="lineNum">    1174 </span>            :     //Introducing child cuts in case kPyW, kPyZ, kPyMb, and kPyMbNonDiff
<span class="lineNum">    1175 </span><span class="lineNoCov">          0 :     if ( (</span>
<span class="lineNum">    1176 </span><span class="lineNoCov">          0 :           fProcess == kPyWPWHG ||</span>
<span class="lineNum">    1177 </span><span class="lineNoCov">          0 :           fProcess == kPyW ||</span>
<span class="lineNum">    1178 </span><span class="lineNoCov">          0 :           fProcess == kPyZ ||</span>
<span class="lineNum">    1179 </span><span class="lineNoCov">          0 :           fProcess == kPyZgamma ||</span>
<span class="lineNum">    1180 </span><span class="lineNoCov">          0 :           fProcess == kPyMbDefault ||</span>
<span class="lineNum">    1181 </span><span class="lineNoCov">          0 :           fProcess == kPyMb ||</span>
<span class="lineNum">    1182 </span><span class="lineNoCov">          0 :           fProcess == kPyMbAtlasTuneMC09 ||</span>
<span class="lineNum">    1183 </span><span class="lineNoCov">          0 :           fProcess == kPyMbWithDirectPhoton ||</span>
<span class="lineNum">    1184 </span><span class="lineNoCov">          0 :           fProcess == kPyMbNonDiffr)  </span>
<span class="lineNum">    1185 </span><span class="lineNoCov">          0 :          &amp;&amp; (fCutOnChild == 1) ) {</span>
<span class="lineNum">    1186 </span><span class="lineNoCov">          0 :       if ( !CheckKinematicsOnChild() ) {</span>
<span class="lineNum">    1187 </span><span class="lineNoCov">          0 :         delete[] pParent;</span>
<span class="lineNum">    1188 </span><span class="lineNoCov">          0 :         return 0;</span>
<span class="lineNum">    1189 </span>            :       }
<span class="lineNum">    1190 </span>            :     }
<span class="lineNum">    1191 </span>            :     
<span class="lineNum">    1192 </span>            : 
<span class="lineNum">    1193 </span><span class="lineNoCov">          0 :     for (i = 0; i &lt; np; i++) {</span>
<span class="lineNum">    1194 </span>            :         Int_t trackIt = 0;
<span class="lineNum">    1195 </span><span class="lineNoCov">          0 :         TParticle *  iparticle = (TParticle *) fParticles.At(i);</span>
<span class="lineNum">    1196 </span><span class="lineNoCov">          0 :         kf = CheckPDGCode(iparticle-&gt;GetPdgCode());</span>
<span class="lineNum">    1197 </span><span class="lineNoCov">          0 :         Int_t ks = iparticle-&gt;GetStatusCode();</span>
<span class="lineNum">    1198 </span><span class="lineNoCov">          0 :         Int_t km = iparticle-&gt;GetFirstMother();</span>
<span class="lineNum">    1199 </span>            :         if (
<span class="lineNum">    1200 </span><span class="lineNoCov">          0 :             (((ks == 1  &amp;&amp; kf!=0 &amp;&amp; KinematicSelection(iparticle, 0)) || (ks !=1)) &amp;&amp; ((fStackFillOpt != kHeavyFlavor) || IsFromHeavyFlavor(i))) ||</span>
<span class="lineNum">    1201 </span><span class="lineNoCov">          0 :             ((fProcess == kPyJets || fProcess == kPyBeautyJets || fProcess == kPyJetsPWHG || fProcess == kPyCharmPWHG || fProcess == kPyBeautyPWHG) &amp;&amp; ks == 21 &amp;&amp; km == 0 &amp;&amp; i&gt;1)</span>
<span class="lineNum">    1202 </span>            :             ) 
<span class="lineNum">    1203 </span>            :           {
<span class="lineNum">    1204 </span><span class="lineNoCov">          0 :             nc++;</span>
<span class="lineNum">    1205 </span><span class="lineNoCov">          0 :             if (ks == 1) trackIt = 1;</span>
<span class="lineNum">    1206 </span><span class="lineNoCov">          0 :             Int_t ipa = iparticle-&gt;GetFirstMother()-1;</span>
<span class="lineNum">    1207 </span>            :             
<span class="lineNum">    1208 </span><span class="lineNoCov">          0 :             iparent = (ipa &gt; -1) ? pParent[ipa] : -1;</span>
<span class="lineNum">    1209 </span>            :             
<span class="lineNum">    1210 </span>            : //
<span class="lineNum">    1211 </span>            : // store track information
<span class="lineNum">    1212 </span><span class="lineNoCov">          0 :             p[0] = iparticle-&gt;Px();</span>
<span class="lineNum">    1213 </span><span class="lineNoCov">          0 :             p[1] = iparticle-&gt;Py();</span>
<span class="lineNum">    1214 </span><span class="lineNoCov">          0 :             p[2] = iparticle-&gt;Pz();</span>
<span class="lineNum">    1215 </span><span class="lineNoCov">          0 :             p[3] = iparticle-&gt;Energy();</span>
<span class="lineNum">    1216 </span>            : 
<span class="lineNum">    1217 </span>            :             
<span class="lineNum">    1218 </span><span class="lineNoCov">          0 :             origin[0] = fVertex[0]+iparticle-&gt;Vx()/10; // [cm]</span>
<span class="lineNum">    1219 </span><span class="lineNoCov">          0 :             origin[1] = fVertex[1]+iparticle-&gt;Vy()/10; // [cm]</span>
<span class="lineNum">    1220 </span><span class="lineNoCov">          0 :             origin[2] = fVertex[2]+iparticle-&gt;Vz()/10; // [cm]</span>
<span class="lineNum">    1221 </span>            :             
<span class="lineNum">    1222 </span><span class="lineNoCov">          0 :             Float_t tof = fTime + fEventTime + kconv * iparticle-&gt;T();</span>
<span class="lineNum">    1223 </span>            : 
<span class="lineNum">    1224 </span><span class="lineNoCov">          0 :             PushTrack(fTrackIt*trackIt, iparent, kf, </span>
<span class="lineNum">    1225 </span>            :                       p[0], p[1], p[2], p[3], 
<span class="lineNum">    1226 </span><span class="lineNoCov">          0 :                       origin[0], origin[1], origin[2], tof, </span>
<span class="lineNum">    1227 </span>            :                       polar[0], polar[1], polar[2],
<span class="lineNum">    1228 </span>            :                       kPPrimary, nt, 1., ks);
<span class="lineNum">    1229 </span><span class="lineNoCov">          0 :             fNprimaries++;</span>
<span class="lineNum">    1230 </span><span class="lineNoCov">          0 :             KeepTrack(nt);</span>
<span class="lineNum">    1231 </span><span class="lineNoCov">          0 :             pParent[i] = nt;</span>
<span class="lineNum">    1232 </span><span class="lineNoCov">          0 :             SetHighWaterMark(nt);</span>
<span class="lineNum">    1233 </span>            :             
<span class="lineNum">    1234 </span><span class="lineNoCov">          0 :         } // select particle</span>
<span class="lineNum">    1235 </span>            :     } // particle loop 
<span class="lineNum">    1236 </span>            : 
<span class="lineNum">    1237 </span><span class="lineNoCov">          0 :     delete[] pParent;</span>
<span class="lineNum">    1238 </span>            :     
<span class="lineNum">    1239 </span><span class="lineNoCov">          0 :     return 1;</span>
<span class="lineNum">    1240 </span><span class="lineNoCov">          0 : }</span>
<a name="1241"><span class="lineNum">    1241 </span>            : </a>
<span class="lineNum">    1242 </span>            : 
<span class="lineNum">    1243 </span>            : void AliGenPythia::FinishRun()
<span class="lineNum">    1244 </span>            : {
<span class="lineNum">    1245 </span>            : // Print x-section summary
<span class="lineNum">    1246 </span><span class="lineNoCov">          0 :     fPythia-&gt;Pystat(1);</span>
<span class="lineNum">    1247 </span>            : 
<span class="lineNum">    1248 </span><span class="lineNoCov">          0 :     if (fNev &gt; 0.) {</span>
<span class="lineNum">    1249 </span><span class="lineNoCov">          0 :         fQ  /= fNev;</span>
<span class="lineNum">    1250 </span><span class="lineNoCov">          0 :         fX1 /= fNev;</span>
<span class="lineNum">    1251 </span><span class="lineNoCov">          0 :         fX2 /= fNev;    </span>
<span class="lineNum">    1252 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">    1253 </span>            :     
<span class="lineNum">    1254 </span><span class="lineNoCov">          0 :     printf(&quot;\nTotal number of Pyevnt() calls %d\n&quot;, fTrialsRun);</span>
<span class="lineNum">    1255 </span><span class="lineNoCov">          0 :     printf(&quot;\nMean Q, x1, x2: %f %f %f\n&quot;, fQ, fX1, fX2);</span>
<a name="1256"><span class="lineNum">    1256 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1257 </span>            : 
<span class="lineNum">    1258 </span>            : void AliGenPythia::AdjustWeights() const
<span class="lineNum">    1259 </span>            : {
<span class="lineNum">    1260 </span>            : // Adjust the weights after generation of all events
<span class="lineNum">    1261 </span>            : //
<span class="lineNum">    1262 </span><span class="lineNoCov">          0 :     if (gAlice) {</span>
<span class="lineNum">    1263 </span>            :         TParticle *part;
<span class="lineNum">    1264 </span><span class="lineNoCov">          0 :         Int_t ntrack=gAlice-&gt;GetMCApp()-&gt;GetNtrack();</span>
<span class="lineNum">    1265 </span><span class="lineNoCov">          0 :         for (Int_t i=0; i&lt;ntrack; i++) {</span>
<span class="lineNum">    1266 </span><span class="lineNoCov">          0 :             part= gAlice-&gt;GetMCApp()-&gt;Particle(i);</span>
<span class="lineNum">    1267 </span><span class="lineNoCov">          0 :             part-&gt;SetWeight(part-&gt;GetWeight()*fKineBias);</span>
<span class="lineNum">    1268 </span>            :         }
<span class="lineNum">    1269 </span><span class="lineNoCov">          0 :     }</span>
<a name="1270"><span class="lineNum">    1270 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1271 </span>            :     
<span class="lineNum">    1272 </span>            : void AliGenPythia::SetNuclei(Int_t a1, Int_t a2, Int_t pdfset)
<span class="lineNum">    1273 </span>            : {
<span class="lineNum">    1274 </span>            : // Treat protons as inside nuclei with mass numbers a1 and a2  
<span class="lineNum">    1275 </span>            : 
<span class="lineNum">    1276 </span><span class="lineNoCov">          0 :     fAProjectile   = a1;</span>
<span class="lineNum">    1277 </span><span class="lineNoCov">          0 :     fATarget       = a2;</span>
<span class="lineNum">    1278 </span><span class="lineNoCov">          0 :     fNucPdf        = pdfset;  // 0 EKS98 9 EPS09LO 19 EPS09NLO</span>
<span class="lineNum">    1279 </span><span class="lineNoCov">          0 :     fUseNuclearPDF = kTRUE;</span>
<span class="lineNum">    1280 </span><span class="lineNoCov">          0 :     fSetNuclei     = kTRUE;</span>
<span class="lineNum">    1281 </span><span class="lineNoCov">          0 : }</span>
<a name="1282"><span class="lineNum">    1282 </span>            : </a>
<span class="lineNum">    1283 </span>            : 
<span class="lineNum">    1284 </span>            : void AliGenPythia::MakeHeader()
<span class="lineNum">    1285 </span>            : {
<span class="lineNum">    1286 </span>            : //
<span class="lineNum">    1287 </span>            : // Make header for the simulated event
<span class="lineNum">    1288 </span>            : // 
<span class="lineNum">    1289 </span><span class="lineNoCov">          0 :   if (gAlice) {</span>
<span class="lineNum">    1290 </span><span class="lineNoCov">          0 :     if (gAlice-&gt;GetEvNumber()&gt;=fDebugEventFirst &amp;&amp;</span>
<span class="lineNum">    1291 </span><span class="lineNoCov">          0 :         gAlice-&gt;GetEvNumber()&lt;=fDebugEventLast) fPythia-&gt;Pylist(2);</span>
<span class="lineNum">    1292 </span>            :   }
<span class="lineNum">    1293 </span>            : 
<span class="lineNum">    1294 </span>            : // Builds the event header, to be called after each event
<span class="lineNum">    1295 </span><span class="lineNoCov">          0 :     if (fHeader) delete fHeader;</span>
<span class="lineNum">    1296 </span><span class="lineNoCov">          0 :     fHeader = new AliGenPythiaEventHeader(&quot;Pythia&quot;);</span>
<span class="lineNum">    1297 </span><span class="lineNoCov">          0 :     fHeader-&gt;SetTitle(GetTitle());</span>
<span class="lineNum">    1298 </span>            : //
<span class="lineNum">    1299 </span>            : // Event type  
<span class="lineNum">    1300 </span><span class="lineNoCov">          0 :     if(fProcDiff&gt;0){</span>
<span class="lineNum">    1301 </span>            :       //      if(fProcDiff == 92 || fProcDiff == 93) printf(&quot;\n\n\n\n\n&quot;);
<span class="lineNum">    1302 </span>            :       //      printf(&quot;fPythia-&gt;GetMSTI(1) = %d   fProcDiff = %d\n&quot;,fPythia-&gt;GetMSTI(1), fProcDiff);
<span class="lineNum">    1303 </span><span class="lineNoCov">          0 :     ((AliGenPythiaEventHeader*) fHeader)-&gt;SetProcessType(fProcDiff);</span>
<span class="lineNum">    1304 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">    1305 </span>            :     else 
<span class="lineNum">    1306 </span><span class="lineNoCov">          0 :     ((AliGenPythiaEventHeader*) fHeader)-&gt;SetProcessType(fPythia-&gt;GetMSTI(1));</span>
<span class="lineNum">    1307 </span>            : //
<span class="lineNum">    1308 </span>            : // Number of trials
<span class="lineNum">    1309 </span><span class="lineNoCov">          0 :     ((AliGenPythiaEventHeader*) fHeader)-&gt;SetTrials(fTrials);</span>
<span class="lineNum">    1310 </span>            : //
<span class="lineNum">    1311 </span>            : // Event Vertex 
<span class="lineNum">    1312 </span><span class="lineNoCov">          0 :     fHeader-&gt;SetPrimaryVertex(fVertex);</span>
<span class="lineNum">    1313 </span><span class="lineNoCov">          0 :     fHeader-&gt;SetInteractionTime(fTime+fEventTime);</span>
<span class="lineNum">    1314 </span>            : //
<span class="lineNum">    1315 </span>            : // Number of primaries
<span class="lineNum">    1316 </span><span class="lineNoCov">          0 :     fHeader-&gt;SetNProduced(fNprimaries);</span>
<span class="lineNum">    1317 </span>            : //
<span class="lineNum">    1318 </span>            : // Event weight
<span class="lineNum">    1319 </span><span class="lineNoCov">          0 :     fHeader-&gt;SetEventWeight(fPythia-&gt;GetVINT(97));</span>
<span class="lineNum">    1320 </span>            : //
<span class="lineNum">    1321 </span>            : // Number of MPI
<span class="lineNum">    1322 </span><span class="lineNoCov">          0 :     fHeader-&gt;SetNMPI(fPythia-&gt;GetNMPI());</span>
<span class="lineNum">    1323 </span>            : //
<span class="lineNum">    1324 </span>            : // Jets that have triggered
<span class="lineNum">    1325 </span>            : 
<span class="lineNum">    1326 </span>            :     //Need to store jets for b-jet studies too!
<span class="lineNum">    1327 </span><span class="lineNoCov">          0 :     if (fProcess == kPyJets || fProcess == kPyDirectGamma || fProcess == kPyBeautyJets || fProcess == kPyBeautyppMNRwmi || fProcess == kPyJetsPWHG || fProcess == kPyCharmPWHG || fProcess == kPyBeautyPWHG)</span>
<span class="lineNum">    1328 </span>            :     {
<span class="lineNum">    1329 </span><span class="lineNoCov">          0 :         Int_t ntrig, njet;</span>
<span class="lineNum">    1330 </span><span class="lineNoCov">          0 :         Float_t jets[4][10];</span>
<span class="lineNum">    1331 </span><span class="lineNoCov">          0 :         GetJets(njet, ntrig, jets);</span>
<span class="lineNum">    1332 </span>            : 
<span class="lineNum">    1333 </span>            :         
<span class="lineNum">    1334 </span><span class="lineNoCov">          0 :         for (Int_t i = 0; i &lt; ntrig; i++) {</span>
<span class="lineNum">    1335 </span><span class="lineNoCov">          0 :             ((AliGenPythiaEventHeader*) fHeader)-&gt;AddJet(jets[0][i], jets[1][i], jets[2][i], </span>
<span class="lineNum">    1336 </span><span class="lineNoCov">          0 :                                                         jets[3][i]);</span>
<span class="lineNum">    1337 </span>            :         }
<span class="lineNum">    1338 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">    1339 </span>            : //
<span class="lineNum">    1340 </span>            : // Copy relevant information from external header, if present.
<span class="lineNum">    1341 </span>            : //
<span class="lineNum">    1342 </span><span class="lineNoCov">          0 :     Float_t uqJet[4];</span>
<span class="lineNum">    1343 </span>            :     
<span class="lineNum">    1344 </span><span class="lineNoCov">          0 :     if (fRL) {</span>
<span class="lineNum">    1345 </span><span class="lineNoCov">          0 :         AliGenPythiaEventHeader* exHeader = (AliGenPythiaEventHeader*) (fRL-&gt;GetHeader()-&gt;GenEventHeader());</span>
<span class="lineNum">    1346 </span><span class="lineNoCov">          0 :         for (Int_t i = 0; i &lt; exHeader-&gt;NTriggerJets(); i++)</span>
<span class="lineNum">    1347 </span>            :         {
<span class="lineNum">    1348 </span><span class="lineNoCov">          0 :             printf(&quot;Adding Jet %d %d \n&quot;, i,  exHeader-&gt;NTriggerJets());</span>
<span class="lineNum">    1349 </span>            :             
<span class="lineNum">    1350 </span>            :             
<span class="lineNum">    1351 </span><span class="lineNoCov">          0 :             exHeader-&gt;TriggerJet(i, uqJet);</span>
<span class="lineNum">    1352 </span><span class="lineNoCov">          0 :             ((AliGenPythiaEventHeader*) fHeader)-&gt;AddUQJet(uqJet[0], uqJet[1], uqJet[2], uqJet[3]);</span>
<span class="lineNum">    1353 </span>            :         }
<span class="lineNum">    1354 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">    1355 </span>            : //
<span class="lineNum">    1356 </span>            : // Store quenching parameters
<span class="lineNum">    1357 </span>            : //
<span class="lineNum">    1358 </span><span class="lineNoCov">          0 :     if (fQuench){</span>
<span class="lineNum">    1359 </span><span class="lineNoCov">          0 :         Double_t z[4] = {0.};</span>
<span class="lineNum">    1360 </span><span class="lineNoCov">          0 :         Double_t xp = 0.;</span>
<span class="lineNum">    1361 </span><span class="lineNoCov">          0 :         Double_t yp = 0.;</span>
<span class="lineNum">    1362 </span>            :         
<span class="lineNum">    1363 </span><span class="lineNoCov">          0 :         if (fQuench == 1) {</span>
<span class="lineNum">    1364 </span>            :             // Pythia::Quench()
<span class="lineNum">    1365 </span><span class="lineNoCov">          0 :             fPythia-&gt;GetQuenchingParameters(xp, yp, z);</span>
<span class="lineNum">    1366 </span><span class="lineNoCov">          0 :         } else if (fQuench == 2){</span>
<span class="lineNum">    1367 </span>            :             // Pyquen
<span class="lineNum">    1368 </span><span class="lineNoCov">          0 :             Double_t r1 = PARIMP.rb1;</span>
<span class="lineNum">    1369 </span><span class="lineNoCov">          0 :             Double_t r2 = PARIMP.rb2;</span>
<span class="lineNum">    1370 </span><span class="lineNoCov">          0 :             Double_t b  = PARIMP.b1;</span>
<span class="lineNum">    1371 </span><span class="lineNoCov">          0 :             Double_t r   = 0.5 * TMath::Sqrt(2. * (r1 * r1 + r2 * r2) - b * b);</span>
<span class="lineNum">    1372 </span><span class="lineNoCov">          0 :             Double_t phi = PARIMP.psib1;</span>
<span class="lineNum">    1373 </span><span class="lineNoCov">          0 :             xp = r * TMath::Cos(phi);</span>
<span class="lineNum">    1374 </span><span class="lineNoCov">          0 :             yp = r * TMath::Sin(phi);</span>
<span class="lineNum">    1375 </span>            :             
<span class="lineNum">    1376 </span><span class="lineNoCov">          0 :         } else if (fQuench == 4) {</span>
<span class="lineNum">    1377 </span>            :             // QPythia
<span class="lineNum">    1378 </span><span class="lineNoCov">          0 :             Double_t xy[2];</span>
<span class="lineNum">    1379 </span><span class="lineNoCov">          0 :             Double_t i0i1[2];</span>
<span class="lineNum">    1380 </span><span class="lineNoCov">          0 :             AliFastGlauber::Instance()-&gt;GetSavedXY(xy);</span>
<span class="lineNum">    1381 </span><span class="lineNoCov">          0 :             AliFastGlauber::Instance()-&gt;GetSavedI0I1(i0i1);</span>
<span class="lineNum">    1382 </span><span class="lineNoCov">          0 :             xp = xy[0];</span>
<span class="lineNum">    1383 </span><span class="lineNoCov">          0 :             yp = xy[1];</span>
<span class="lineNum">    1384 </span><span class="lineNoCov">          0 :             ((AliGenPythiaEventHeader*) fHeader)-&gt;SetImpactParameter(fImpact);</span>
<span class="lineNum">    1385 </span><span class="lineNoCov">          0 :         }</span>
<span class="lineNum">    1386 </span>            :         
<span class="lineNum">    1387 </span><span class="lineNoCov">          0 :             ((AliGenPythiaEventHeader*) fHeader)-&gt;SetXYJet(xp, yp);</span>
<span class="lineNum">    1388 </span><span class="lineNoCov">          0 :             ((AliGenPythiaEventHeader*) fHeader)-&gt;SetZQuench(z);</span>
<span class="lineNum">    1389 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">    1390 </span>            : //
<span class="lineNum">    1391 </span>            : // Store pt^hard and cross-section
<span class="lineNum">    1392 </span><span class="lineNoCov">          0 :     ((AliGenPythiaEventHeader*) fHeader)-&gt;SetPtHard(fPythia-&gt;GetVINT(47));</span>
<span class="lineNum">    1393 </span><span class="lineNoCov">          0 :     ((AliGenPythiaEventHeader*) fHeader)-&gt;SetXsection(fPythia-&gt;GetPARI(1)); </span>
<span class="lineNum">    1394 </span>            :                 
<span class="lineNum">    1395 </span>            : //
<span class="lineNum">    1396 </span>            : // Store Event Weight
<span class="lineNum">    1397 </span><span class="lineNoCov">          0 :     ((AliGenPythiaEventHeader*) fHeader)-&gt;SetEventWeight(fPythia-&gt;GetPARI(7)*fPythia-&gt;GetPARI(10));</span>
<span class="lineNum">    1398 </span>            :     // PARI(7) is 1 or -1, for weighted generation with accept/reject, e.g. POWHEG
<span class="lineNum">    1399 </span>            :     // PARI(10) is a weight associated with reweighted generation, using Pyevwt
<span class="lineNum">    1400 </span>            : //
<span class="lineNum">    1401 </span>            : //  Pass header
<span class="lineNum">    1402 </span>            : //
<span class="lineNum">    1403 </span><span class="lineNoCov">          0 :     AddHeader(fHeader);</span>
<span class="lineNum">    1404 </span><span class="lineNoCov">          0 :     fHeader = 0x0;</span>
<a name="1405"><span class="lineNum">    1405 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1406 </span>            : 
<span class="lineNum">    1407 </span>            : Bool_t AliGenPythia::CheckTrigger(const TParticle* jet1, const TParticle* jet2)
<span class="lineNum">    1408 </span>            : {
<span class="lineNum">    1409 </span>            : // Check the kinematic trigger condition
<span class="lineNum">    1410 </span>            : //
<span class="lineNum">    1411 </span><span class="lineNoCov">          0 :     Double_t eta[2];</span>
<span class="lineNum">    1412 </span><span class="lineNoCov">          0 :     eta[0] = jet1-&gt;Eta();</span>
<span class="lineNum">    1413 </span><span class="lineNoCov">          0 :     eta[1] = jet2-&gt;Eta();</span>
<span class="lineNum">    1414 </span><span class="lineNoCov">          0 :     Double_t phi[2];</span>
<span class="lineNum">    1415 </span><span class="lineNoCov">          0 :     phi[0] = jet1-&gt;Phi();</span>
<span class="lineNum">    1416 </span><span class="lineNoCov">          0 :     phi[1] = jet2-&gt;Phi();</span>
<span class="lineNum">    1417 </span>            :     Int_t    pdg[2]; 
<span class="lineNum">    1418 </span><span class="lineNoCov">          0 :     pdg[0] = jet1-&gt;GetPdgCode();</span>
<span class="lineNum">    1419 </span><span class="lineNoCov">          0 :     pdg[1] = jet2-&gt;GetPdgCode();    </span>
<span class="lineNum">    1420 </span>            :     Bool_t   triggered = kFALSE;
<span class="lineNum">    1421 </span>            : 
<span class="lineNum">    1422 </span><span class="lineNoCov">          0 :     if (fProcess == kPyJets || fProcess == kPyBeautyJets || fProcess ==  kPyBeautyppMNRwmi || fProcess == kPyJetsPWHG || fProcess == kPyCharmPWHG || fProcess == kPyBeautyPWHG) {</span>
<span class="lineNum">    1423 </span><span class="lineNoCov">          0 :         Int_t njets = 0;</span>
<span class="lineNum">    1424 </span><span class="lineNoCov">          0 :         Int_t ntrig = 0;</span>
<span class="lineNum">    1425 </span><span class="lineNoCov">          0 :         Float_t jets[4][10];</span>
<span class="lineNum">    1426 </span>            : //
<span class="lineNum">    1427 </span>            : // Use Pythia clustering on parton level to determine jet axis
<span class="lineNum">    1428 </span>            : //
<span class="lineNum">    1429 </span><span class="lineNoCov">          0 :         GetJets(njets, ntrig, jets);</span>
<span class="lineNum">    1430 </span>            :         
<span class="lineNum">    1431 </span><span class="lineNoCov">          0 :         if (ntrig || fEtMinJet == 0.) triggered = kTRUE;</span>
<span class="lineNum">    1432 </span>            : //
<span class="lineNum">    1433 </span><span class="lineNoCov">          0 :     } else {</span>
<span class="lineNum">    1434 </span>            :         Int_t ij = 0;
<span class="lineNum">    1435 </span>            :         Int_t ig = 1;
<span class="lineNum">    1436 </span><span class="lineNoCov">          0 :         if (pdg[0] == kGamma) {</span>
<span class="lineNum">    1437 </span>            :             ij = 1;
<span class="lineNum">    1438 </span>            :             ig = 0;
<span class="lineNum">    1439 </span><span class="lineNoCov">          0 :         }</span>
<span class="lineNum">    1440 </span>            :         //Check eta range first...
<span class="lineNum">    1441 </span><span class="lineNoCov">          0 :         if ((eta[ij] &lt; fEtaMaxJet   &amp;&amp; eta[ij] &gt; fEtaMinJet) &amp;&amp;</span>
<span class="lineNum">    1442 </span><span class="lineNoCov">          0 :             (eta[ig] &lt; fEtaMaxGamma &amp;&amp; eta[ig] &gt; fEtaMinGamma))</span>
<span class="lineNum">    1443 </span>            :         {
<span class="lineNum">    1444 </span>            :             //Eta is okay, now check phi range
<span class="lineNum">    1445 </span><span class="lineNoCov">          0 :             if ((phi[ij] &lt; fPhiMaxJet   &amp;&amp; phi[ij] &gt; fPhiMinJet) &amp;&amp;</span>
<span class="lineNum">    1446 </span><span class="lineNoCov">          0 :                 (phi[ig] &lt; fPhiMaxGamma &amp;&amp; phi[ig] &gt; fPhiMinGamma))</span>
<span class="lineNum">    1447 </span>            :             {
<span class="lineNum">    1448 </span>            :                 triggered = kTRUE;
<span class="lineNum">    1449 </span><span class="lineNoCov">          0 :             }</span>
<span class="lineNum">    1450 </span>            :         }
<span class="lineNum">    1451 </span>            :     }
<span class="lineNum">    1452 </span><span class="lineNoCov">          0 :     return triggered;</span>
<span class="lineNum">    1453 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">    1454 </span>            : 
<a name="1455"><span class="lineNum">    1455 </span>            : </a>
<span class="lineNum">    1456 </span>            : 
<span class="lineNum">    1457 </span>            : Bool_t AliGenPythia::CheckKinematicsOnChild(){
<span class="lineNum">    1458 </span>            : //
<span class="lineNum">    1459 </span>            : //Checking Kinematics on Child (status code 1, particle code ?, kin cuts
<span class="lineNum">    1460 </span>            : //
<span class="lineNum">    1461 </span>            :     Bool_t checking = kFALSE;
<span class="lineNum">    1462 </span>            :     Int_t j, kcode, ks, km;
<span class="lineNum">    1463 </span>            :     Int_t nPartAcc = 0; //number of particles in the acceptance range
<span class="lineNum">    1464 </span>            :     Int_t numberOfAcceptedParticles = 1;
<span class="lineNum">    1465 </span><span class="lineNoCov">          0 :     if (fNumberOfAcceptedParticles != 0) { numberOfAcceptedParticles = fNumberOfAcceptedParticles; }</span>
<span class="lineNum">    1466 </span><span class="lineNoCov">          0 :     Int_t npart = fParticles.GetEntriesFast();</span>
<span class="lineNum">    1467 </span>            :     
<span class="lineNum">    1468 </span><span class="lineNoCov">          0 :     for (j = 0; j&lt;npart; j++) {</span>
<span class="lineNum">    1469 </span><span class="lineNoCov">          0 :         TParticle *  jparticle = (TParticle *) fParticles.At(j);</span>
<span class="lineNum">    1470 </span><span class="lineNoCov">          0 :         kcode = TMath::Abs( CheckPDGCode(jparticle-&gt;GetPdgCode()) );</span>
<span class="lineNum">    1471 </span><span class="lineNoCov">          0 :         ks = jparticle-&gt;GetStatusCode();</span>
<span class="lineNum">    1472 </span><span class="lineNoCov">          0 :         km = jparticle-&gt;GetFirstMother(); </span>
<span class="lineNum">    1473 </span>            :         
<span class="lineNum">    1474 </span><span class="lineNoCov">          0 :         if( (ks == 1)  &amp;&amp;  (kcode == fPdgCodeParticleforAcceptanceCut)  &amp;&amp;  (KinematicSelection(jparticle,1)) ){</span>
<span class="lineNum">    1475 </span><span class="lineNoCov">          0 :             nPartAcc++;</span>
<span class="lineNum">    1476 </span><span class="lineNoCov">          0 :         }</span>
<span class="lineNum">    1477 </span><span class="lineNoCov">          0 :         if( numberOfAcceptedParticles &lt;= nPartAcc){</span>
<span class="lineNum">    1478 </span>            :           checking = kTRUE;
<span class="lineNum">    1479 </span><span class="lineNoCov">          0 :           break;</span>
<span class="lineNum">    1480 </span>            :         }
<span class="lineNum">    1481 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">    1482 </span>            : 
<span class="lineNum">    1483 </span><span class="lineNoCov">          0 :     return checking;</span>
<a name="1484"><span class="lineNum">    1484 </span>            : }</a>
<span class="lineNum">    1485 </span>            : 
<span class="lineNum">    1486 </span>            : void  AliGenPythia::LoadEvent(AliStack* stack, Int_t flag, Int_t reHadr)
<span class="lineNum">    1487 </span>            : {
<span class="lineNum">    1488 </span>            :   //
<span class="lineNum">    1489 </span>            :   // Load event into Pythia Common Block
<span class="lineNum">    1490 </span>            :   //
<span class="lineNum">    1491 </span>            :   
<span class="lineNum">    1492 </span><span class="lineNoCov">          0 :   Int_t npart = stack -&gt; GetNprimary();</span>
<span class="lineNum">    1493 </span>            :   Int_t n0 = 0;
<span class="lineNum">    1494 </span>            :   
<span class="lineNum">    1495 </span><span class="lineNoCov">          0 :   if (!flag) {</span>
<span class="lineNum">    1496 </span><span class="lineNoCov">          0 :     (fPythia-&gt;GetPyjets())-&gt;N = npart;</span>
<span class="lineNum">    1497 </span><span class="lineNoCov">          0 :   } else {</span>
<span class="lineNum">    1498 </span><span class="lineNoCov">          0 :     n0 = (fPythia-&gt;GetPyjets())-&gt;N;</span>
<span class="lineNum">    1499 </span><span class="lineNoCov">          0 :     (fPythia-&gt;GetPyjets())-&gt;N = n0 + npart;</span>
<span class="lineNum">    1500 </span>            :   }
<span class="lineNum">    1501 </span>            :   
<span class="lineNum">    1502 </span>            :   
<span class="lineNum">    1503 </span><span class="lineNoCov">          0 :   for (Int_t part = 0; part &lt; npart; part++) {</span>
<span class="lineNum">    1504 </span><span class="lineNoCov">          0 :     TParticle *mPart = stack-&gt;Particle(part);</span>
<span class="lineNum">    1505 </span>            :     
<span class="lineNum">    1506 </span><span class="lineNoCov">          0 :     Int_t kf     =  mPart-&gt;GetPdgCode();</span>
<span class="lineNum">    1507 </span><span class="lineNoCov">          0 :     Int_t ks     =  mPart-&gt;GetStatusCode();</span>
<span class="lineNum">    1508 </span><span class="lineNoCov">          0 :     Int_t idf    =  mPart-&gt;GetFirstDaughter();</span>
<span class="lineNum">    1509 </span><span class="lineNoCov">          0 :     Int_t idl    =  mPart-&gt;GetLastDaughter();</span>
<span class="lineNum">    1510 </span>            :     
<span class="lineNum">    1511 </span><span class="lineNoCov">          0 :     if (reHadr) {</span>
<span class="lineNum">    1512 </span><span class="lineNoCov">          0 :             if (ks == 11 || ks == 12) {</span>
<span class="lineNum">    1513 </span><span class="lineNoCov">          0 :         ks  -= 10;</span>
<span class="lineNum">    1514 </span>            :         idf  = -1;
<span class="lineNum">    1515 </span>            :         idl  = -1;
<span class="lineNum">    1516 </span><span class="lineNoCov">          0 :             }</span>
<span class="lineNum">    1517 </span>            :     }
<span class="lineNum">    1518 </span>            :     
<span class="lineNum">    1519 </span><span class="lineNoCov">          0 :     Float_t px = mPart-&gt;Px();</span>
<span class="lineNum">    1520 </span><span class="lineNoCov">          0 :     Float_t py = mPart-&gt;Py();</span>
<span class="lineNum">    1521 </span><span class="lineNoCov">          0 :     Float_t pz = mPart-&gt;Pz();</span>
<span class="lineNum">    1522 </span><span class="lineNoCov">          0 :     Float_t e  = mPart-&gt;Energy();</span>
<span class="lineNum">    1523 </span><span class="lineNoCov">          0 :     Float_t m  = mPart-&gt;GetCalcMass();</span>
<span class="lineNum">    1524 </span>            :     
<span class="lineNum">    1525 </span>            :     
<span class="lineNum">    1526 </span><span class="lineNoCov">          0 :     (fPythia-&gt;GetPyjets())-&gt;P[0][part+n0] = px;</span>
<span class="lineNum">    1527 </span><span class="lineNoCov">          0 :     (fPythia-&gt;GetPyjets())-&gt;P[1][part+n0] = py;</span>
<span class="lineNum">    1528 </span><span class="lineNoCov">          0 :     (fPythia-&gt;GetPyjets())-&gt;P[2][part+n0] = pz;</span>
<span class="lineNum">    1529 </span><span class="lineNoCov">          0 :     (fPythia-&gt;GetPyjets())-&gt;P[3][part+n0] = e;</span>
<span class="lineNum">    1530 </span><span class="lineNoCov">          0 :     (fPythia-&gt;GetPyjets())-&gt;P[4][part+n0] = m;</span>
<span class="lineNum">    1531 </span>            :     
<span class="lineNum">    1532 </span><span class="lineNoCov">          0 :     (fPythia-&gt;GetPyjets())-&gt;K[1][part+n0] = kf;</span>
<span class="lineNum">    1533 </span><span class="lineNoCov">          0 :     (fPythia-&gt;GetPyjets())-&gt;K[0][part+n0] = ks;</span>
<span class="lineNum">    1534 </span><span class="lineNoCov">          0 :     (fPythia-&gt;GetPyjets())-&gt;K[3][part+n0] = idf + 1;</span>
<span class="lineNum">    1535 </span><span class="lineNoCov">          0 :     (fPythia-&gt;GetPyjets())-&gt;K[4][part+n0] = idl + 1;</span>
<span class="lineNum">    1536 </span><span class="lineNoCov">          0 :     (fPythia-&gt;GetPyjets())-&gt;K[2][part+n0] = mPart-&gt;GetFirstMother() + 1;</span>
<span class="lineNum">    1537 </span>            :   }
<a name="1538"><span class="lineNum">    1538 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1539 </span>            : 
<span class="lineNum">    1540 </span>            : void  AliGenPythia::LoadEvent(const TObjArray* stack, Int_t flag, Int_t reHadr)
<span class="lineNum">    1541 </span>            : {
<span class="lineNum">    1542 </span>            :   //
<span class="lineNum">    1543 </span>            :   // Load event into Pythia Common Block
<span class="lineNum">    1544 </span>            :   //
<span class="lineNum">    1545 </span>            :   
<span class="lineNum">    1546 </span><span class="lineNoCov">          0 :   Int_t npart = stack -&gt; GetEntries();</span>
<span class="lineNum">    1547 </span>            :   Int_t n0 = 0;
<span class="lineNum">    1548 </span>            :   
<span class="lineNum">    1549 </span><span class="lineNoCov">          0 :   if (!flag) {</span>
<span class="lineNum">    1550 </span><span class="lineNoCov">          0 :     (fPythia-&gt;GetPyjets())-&gt;N = npart;</span>
<span class="lineNum">    1551 </span><span class="lineNoCov">          0 :   } else {</span>
<span class="lineNum">    1552 </span><span class="lineNoCov">          0 :     n0 = (fPythia-&gt;GetPyjets())-&gt;N;</span>
<span class="lineNum">    1553 </span><span class="lineNoCov">          0 :     (fPythia-&gt;GetPyjets())-&gt;N = n0 + npart;</span>
<span class="lineNum">    1554 </span>            :   }
<span class="lineNum">    1555 </span>            :   
<span class="lineNum">    1556 </span>            :   
<span class="lineNum">    1557 </span><span class="lineNoCov">          0 :   for (Int_t part = 0; part &lt; npart; part++) {</span>
<span class="lineNum">    1558 </span><span class="lineNoCov">          0 :     TParticle *mPart = dynamic_cast&lt;TParticle *&gt;(stack-&gt;At(part));</span>
<span class="lineNum">    1559 </span><span class="lineNoCov">          0 :     if (!mPart) continue;</span>
<span class="lineNum">    1560 </span>            :     
<span class="lineNum">    1561 </span><span class="lineNoCov">          0 :     Int_t kf     =  mPart-&gt;GetPdgCode();</span>
<span class="lineNum">    1562 </span><span class="lineNoCov">          0 :     Int_t ks     =  mPart-&gt;GetStatusCode();</span>
<span class="lineNum">    1563 </span><span class="lineNoCov">          0 :     Int_t idf    =  mPart-&gt;GetFirstDaughter();</span>
<span class="lineNum">    1564 </span><span class="lineNoCov">          0 :     Int_t idl    =  mPart-&gt;GetLastDaughter();</span>
<span class="lineNum">    1565 </span>            :     
<span class="lineNum">    1566 </span><span class="lineNoCov">          0 :     if (reHadr) {</span>
<span class="lineNum">    1567 </span><span class="lineNoCov">          0 :         if (ks == 11 || ks == 12) {</span>
<span class="lineNum">    1568 </span><span class="lineNoCov">          0 :             ks  -= 10;</span>
<span class="lineNum">    1569 </span>            :             idf  = -1;
<span class="lineNum">    1570 </span>            :             idl  = -1;
<span class="lineNum">    1571 </span><span class="lineNoCov">          0 :         }</span>
<span class="lineNum">    1572 </span>            :     }
<span class="lineNum">    1573 </span>            :     
<span class="lineNum">    1574 </span><span class="lineNoCov">          0 :     Float_t px = mPart-&gt;Px();</span>
<span class="lineNum">    1575 </span><span class="lineNoCov">          0 :     Float_t py = mPart-&gt;Py();</span>
<span class="lineNum">    1576 </span><span class="lineNoCov">          0 :     Float_t pz = mPart-&gt;Pz();</span>
<span class="lineNum">    1577 </span><span class="lineNoCov">          0 :     Float_t e  = mPart-&gt;Energy();</span>
<span class="lineNum">    1578 </span><span class="lineNoCov">          0 :     Float_t m  = mPart-&gt;GetCalcMass();</span>
<span class="lineNum">    1579 </span>            :     
<span class="lineNum">    1580 </span>            :     
<span class="lineNum">    1581 </span><span class="lineNoCov">          0 :     (fPythia-&gt;GetPyjets())-&gt;P[0][part+n0] = px;</span>
<span class="lineNum">    1582 </span><span class="lineNoCov">          0 :     (fPythia-&gt;GetPyjets())-&gt;P[1][part+n0] = py;</span>
<span class="lineNum">    1583 </span><span class="lineNoCov">          0 :     (fPythia-&gt;GetPyjets())-&gt;P[2][part+n0] = pz;</span>
<span class="lineNum">    1584 </span><span class="lineNoCov">          0 :     (fPythia-&gt;GetPyjets())-&gt;P[3][part+n0] = e;</span>
<span class="lineNum">    1585 </span><span class="lineNoCov">          0 :     (fPythia-&gt;GetPyjets())-&gt;P[4][part+n0] = m;</span>
<span class="lineNum">    1586 </span>            :     
<span class="lineNum">    1587 </span><span class="lineNoCov">          0 :     (fPythia-&gt;GetPyjets())-&gt;K[1][part+n0] = kf;</span>
<span class="lineNum">    1588 </span><span class="lineNoCov">          0 :     (fPythia-&gt;GetPyjets())-&gt;K[0][part+n0] = ks;</span>
<span class="lineNum">    1589 </span><span class="lineNoCov">          0 :     (fPythia-&gt;GetPyjets())-&gt;K[3][part+n0] = idf + 1;</span>
<span class="lineNum">    1590 </span><span class="lineNoCov">          0 :     (fPythia-&gt;GetPyjets())-&gt;K[4][part+n0] = idl + 1;</span>
<span class="lineNum">    1591 </span><span class="lineNoCov">          0 :     (fPythia-&gt;GetPyjets())-&gt;K[2][part+n0] = mPart-&gt;GetFirstMother() + 1;</span>
<span class="lineNum">    1592 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">    1593 </span><span class="lineNoCov">          0 : }</span>
<a name="1594"><span class="lineNum">    1594 </span>            : </a>
<span class="lineNum">    1595 </span>            : 
<span class="lineNum">    1596 </span>            : void AliGenPythia::RecJetsUA1(Int_t&amp; njets, Float_t jets [4][50])
<span class="lineNum">    1597 </span>            : {
<span class="lineNum">    1598 </span>            : //
<span class="lineNum">    1599 </span>            : //  Calls the Pythia jet finding algorithm to find jets in the current event
<span class="lineNum">    1600 </span>            : //
<span class="lineNum">    1601 </span>            : //
<span class="lineNum">    1602 </span>            : //
<span class="lineNum">    1603 </span>            : //  Save jets
<span class="lineNum">    1604 </span><span class="lineNoCov">          0 :     Int_t n     = fPythia-&gt;GetN();</span>
<span class="lineNum">    1605 </span>            : 
<span class="lineNum">    1606 </span>            : //
<span class="lineNum">    1607 </span>            : //  Run Jet Finder
<span class="lineNum">    1608 </span><span class="lineNoCov">          0 :     fPythia-&gt;Pycell(njets);</span>
<span class="lineNum">    1609 </span>            :     Int_t i;
<span class="lineNum">    1610 </span><span class="lineNoCov">          0 :     for (i = 0; i &lt; njets; i++) {</span>
<span class="lineNum">    1611 </span><span class="lineNoCov">          0 :         Float_t px    = (fPythia-&gt;GetPyjets())-&gt;P[0][n+i];</span>
<span class="lineNum">    1612 </span><span class="lineNoCov">          0 :         Float_t py    = (fPythia-&gt;GetPyjets())-&gt;P[1][n+i];</span>
<span class="lineNum">    1613 </span><span class="lineNoCov">          0 :         Float_t pz    = (fPythia-&gt;GetPyjets())-&gt;P[2][n+i];</span>
<span class="lineNum">    1614 </span><span class="lineNoCov">          0 :         Float_t e     = (fPythia-&gt;GetPyjets())-&gt;P[3][n+i];</span>
<span class="lineNum">    1615 </span>            : 
<span class="lineNum">    1616 </span><span class="lineNoCov">          0 :         jets[0][i] = px;</span>
<span class="lineNum">    1617 </span><span class="lineNoCov">          0 :         jets[1][i] = py;</span>
<span class="lineNum">    1618 </span><span class="lineNoCov">          0 :         jets[2][i] = pz;</span>
<span class="lineNum">    1619 </span><span class="lineNoCov">          0 :         jets[3][i] = e;</span>
<span class="lineNum">    1620 </span>            :     }
<span class="lineNum">    1621 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">    1622 </span>            : 
<a name="1623"><span class="lineNum">    1623 </span>            : </a>
<span class="lineNum">    1624 </span>            : 
<span class="lineNum">    1625 </span>            : void  AliGenPythia::GetJets(Int_t&amp; nJets, Int_t&amp; nJetsTrig, Float_t jets[4][10])
<span class="lineNum">    1626 </span>            : {
<span class="lineNum">    1627 </span>            : //
<span class="lineNum">    1628 </span>            : //  Calls the Pythia clustering algorithm to find jets in the current event
<span class="lineNum">    1629 </span>            : //
<span class="lineNum">    1630 </span><span class="lineNoCov">          0 :     Int_t n     = fPythia-&gt;GetN();</span>
<span class="lineNum">    1631 </span><span class="lineNoCov">          0 :     nJets       = 0;</span>
<span class="lineNum">    1632 </span><span class="lineNoCov">          0 :     nJetsTrig   = 0;</span>
<span class="lineNum">    1633 </span><span class="lineNoCov">          0 :     if (fJetReconstruction == kCluster) {</span>
<span class="lineNum">    1634 </span>            : //
<span class="lineNum">    1635 </span>            : //  Configure cluster algorithm
<span class="lineNum">    1636 </span>            : //    
<span class="lineNum">    1637 </span><span class="lineNoCov">          0 :         fPythia-&gt;SetPARU(43, 2.);</span>
<span class="lineNum">    1638 </span><span class="lineNoCov">          0 :         fPythia-&gt;SetMSTU(41, 1);</span>
<span class="lineNum">    1639 </span>            : //
<span class="lineNum">    1640 </span>            : //  Call cluster algorithm
<span class="lineNum">    1641 </span>            : //    
<span class="lineNum">    1642 </span><span class="lineNoCov">          0 :         fPythia-&gt;Pyclus(nJets);</span>
<span class="lineNum">    1643 </span>            : //
<span class="lineNum">    1644 </span>            : //  Loading jets from common block
<span class="lineNum">    1645 </span>            : //
<span class="lineNum">    1646 </span><span class="lineNoCov">          0 :     } else {</span>
<span class="lineNum">    1647 </span>            : 
<span class="lineNum">    1648 </span>            : //
<span class="lineNum">    1649 </span>            : //  Run Jet Finder
<span class="lineNum">    1650 </span><span class="lineNoCov">          0 :         fPythia-&gt;Pycell(nJets);</span>
<span class="lineNum">    1651 </span>            :     }
<span class="lineNum">    1652 </span>            : 
<span class="lineNum">    1653 </span>            :     Int_t i;
<span class="lineNum">    1654 </span><span class="lineNoCov">          0 :     for (i = 0; i &lt; nJets; i++) {</span>
<span class="lineNum">    1655 </span><span class="lineNoCov">          0 :         Float_t px    = (fPythia-&gt;GetPyjets())-&gt;P[0][n+i];</span>
<span class="lineNum">    1656 </span><span class="lineNoCov">          0 :         Float_t py    = (fPythia-&gt;GetPyjets())-&gt;P[1][n+i];</span>
<span class="lineNum">    1657 </span><span class="lineNoCov">          0 :         Float_t pz    = (fPythia-&gt;GetPyjets())-&gt;P[2][n+i];</span>
<span class="lineNum">    1658 </span><span class="lineNoCov">          0 :         Float_t e     = (fPythia-&gt;GetPyjets())-&gt;P[3][n+i];</span>
<span class="lineNum">    1659 </span><span class="lineNoCov">          0 :         Float_t pt    = TMath::Sqrt(px * px + py * py);</span>
<span class="lineNum">    1660 </span><span class="lineNoCov">          0 :         Float_t phi   = TMath::Pi() + TMath::ATan2(-py, -px);  </span>
<span class="lineNum">    1661 </span><span class="lineNoCov">          0 :         Float_t theta = TMath::ATan2(pt,pz);</span>
<span class="lineNum">    1662 </span><span class="lineNoCov">          0 :         Float_t et    = e * TMath::Sin(theta);</span>
<span class="lineNum">    1663 </span><span class="lineNoCov">          0 :         Float_t eta   = -TMath::Log(TMath::Tan(theta / 2.));</span>
<span class="lineNum">    1664 </span>            :         if (
<span class="lineNum">    1665 </span><span class="lineNoCov">          0 :             eta &gt; fEtaMinJet &amp;&amp; eta &lt; fEtaMaxJet &amp;&amp; </span>
<span class="lineNum">    1666 </span><span class="lineNoCov">          0 :             phi &gt; fPhiMinJet &amp;&amp; phi &lt; fPhiMaxJet &amp;&amp;</span>
<span class="lineNum">    1667 </span><span class="lineNoCov">          0 :             et  &gt; fEtMinJet  &amp;&amp; et  &lt; fEtMaxJet     </span>
<span class="lineNum">    1668 </span>            :             ) 
<span class="lineNum">    1669 </span>            :         {
<span class="lineNum">    1670 </span><span class="lineNoCov">          0 :             jets[0][nJetsTrig] = px;</span>
<span class="lineNum">    1671 </span><span class="lineNoCov">          0 :             jets[1][nJetsTrig] = py;</span>
<span class="lineNum">    1672 </span><span class="lineNoCov">          0 :             jets[2][nJetsTrig] = pz;</span>
<span class="lineNum">    1673 </span><span class="lineNoCov">          0 :             jets[3][nJetsTrig] = e;</span>
<span class="lineNum">    1674 </span><span class="lineNoCov">          0 :             nJetsTrig++;</span>
<span class="lineNum">    1675 </span>            : //          printf(&quot;\n........-Jet #%d: %10.3f %10.3f %10.3f %10.3f \n&quot;, i, pt, et, eta, phi * kRaddeg);
<span class="lineNum">    1676 </span><span class="lineNoCov">          0 :         } else {</span>
<span class="lineNum">    1677 </span>            : //          printf(&quot;\n........-Jet #%d: %10.3f %10.3f %10.3f %10.3f \n&quot;, i, pt, et, eta, phi * kRaddeg);
<span class="lineNum">    1678 </span>            :         }
<span class="lineNum">    1679 </span>            :     }
<a name="1680"><span class="lineNum">    1680 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1681 </span>            : 
<span class="lineNum">    1682 </span>            : void AliGenPythia::GetSubEventTime()
<span class="lineNum">    1683 </span>            : {
<span class="lineNum">    1684 </span>            :   // Calculates time of the next subevent
<span class="lineNum">    1685 </span><span class="lineNoCov">          0 :   fEventTime = 0.;</span>
<span class="lineNum">    1686 </span><span class="lineNoCov">          0 :   if (fEventsTime) {</span>
<span class="lineNum">    1687 </span>            :     TArrayF &amp;array = *fEventsTime;
<span class="lineNum">    1688 </span><span class="lineNoCov">          0 :     fEventTime = array[fCurSubEvent++];</span>
<span class="lineNum">    1689 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">    1690 </span>            :   //  printf(&quot; Event time: %d %f %p&quot;,fCurSubEvent,fEventTime,fEventsTime);
<span class="lineNum">    1691 </span><span class="lineNoCov">          0 :   return;</span>
<a name="1692"><span class="lineNum">    1692 </span>            : }</a>
<span class="lineNum">    1693 </span>            : 
<span class="lineNum">    1694 </span>            : Bool_t AliGenPythia::IsInBarrel(Float_t eta) const
<span class="lineNum">    1695 </span>            : {
<span class="lineNum">    1696 </span>            :   // Is particle in Central Barrel acceptance? 
<span class="lineNum">    1697 </span>            :   // etamin=-etamax
<span class="lineNum">    1698 </span><span class="lineNoCov">          0 :   if( eta &lt; fTriggerEta  ) </span>
<span class="lineNum">    1699 </span><span class="lineNoCov">          0 :     return kTRUE;</span>
<span class="lineNum">    1700 </span>            :   else 
<span class="lineNum">    1701 </span><span class="lineNoCov">          0 :     return kFALSE;</span>
<a name="1702"><span class="lineNum">    1702 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1703 </span>            : 
<span class="lineNum">    1704 </span>            : Bool_t AliGenPythia::IsInEMCAL(Float_t phi, Float_t eta) const
<span class="lineNum">    1705 </span>            : {
<span class="lineNum">    1706 </span>            :   // Is particle in EMCAL acceptance? 
<span class="lineNum">    1707 </span>            :   // phi in degrees, etamin=-etamax
<span class="lineNum">    1708 </span><span class="lineNoCov">          0 :   if(phi &gt; fEMCALMinPhi  &amp;&amp; phi &lt; fEMCALMaxPhi &amp;&amp; </span>
<span class="lineNum">    1709 </span><span class="lineNoCov">          0 :      eta &lt; fEMCALEta  ) </span>
<span class="lineNum">    1710 </span><span class="lineNoCov">          0 :     return kTRUE;</span>
<span class="lineNum">    1711 </span>            :   else 
<span class="lineNum">    1712 </span><span class="lineNoCov">          0 :     return kFALSE;</span>
<a name="1713"><span class="lineNum">    1713 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1714 </span>            : 
<span class="lineNum">    1715 </span>            : Bool_t AliGenPythia::IsInPHOS(Float_t phi, Float_t eta, Int_t iparticle)
<span class="lineNum">    1716 </span>            : {
<span class="lineNum">    1717 </span>            :   // Is particle in PHOS acceptance? 
<span class="lineNum">    1718 </span>            :   // Acceptance slightly larger considered.
<span class="lineNum">    1719 </span>            :   // phi in degrees, etamin=-etamax
<span class="lineNum">    1720 </span>            :   // iparticle is the index of the particle to be checked, for PHOS rotation case
<span class="lineNum">    1721 </span>            : 
<span class="lineNum">    1722 </span><span class="lineNoCov">          0 :   if(phi &gt; fPHOSMinPhi  &amp;&amp; phi &lt; fPHOSMaxPhi &amp;&amp; </span>
<span class="lineNum">    1723 </span><span class="lineNoCov">          0 :      eta &lt; fPHOSEta  ) </span>
<span class="lineNum">    1724 </span><span class="lineNoCov">          0 :     return kTRUE;</span>
<span class="lineNum">    1725 </span>            :   else 
<span class="lineNum">    1726 </span>            :   {
<span class="lineNum">    1727 </span><span class="lineNoCov">          0 :     if( fCheckPHOSeta &amp;&amp; eta &lt; fPHOSEta) fPHOSRotateCandidate = iparticle;</span>
<span class="lineNum">    1728 </span>            : 
<span class="lineNum">    1729 </span><span class="lineNoCov">          0 :     return kFALSE;</span>
<span class="lineNum">    1730 </span>            :   }
<a name="1731"><span class="lineNum">    1731 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    1732 </span>            : 
<span class="lineNum">    1733 </span>            : void AliGenPythia::RotatePhi(Bool_t&amp; okdd)
<span class="lineNum">    1734 </span>            : {
<span class="lineNum">    1735 </span>            :   //Rotate event in phi to enhance events in PHOS acceptance
<span class="lineNum">    1736 </span>            :   
<span class="lineNum">    1737 </span><span class="lineNoCov">          0 :   if(fPHOSRotateCandidate &lt; 0) return ; </span>
<span class="lineNum">    1738 </span>            :   
<span class="lineNum">    1739 </span>            :   //calculate the new position random between fPHOSMinPhi and fPHOSMaxPhi 
<span class="lineNum">    1740 </span><span class="lineNoCov">          0 :   Double_t phiPHOSmin = TMath::Pi()*fPHOSMinPhi/180;</span>
<span class="lineNum">    1741 </span><span class="lineNoCov">          0 :   Double_t phiPHOSmax = TMath::Pi()*fPHOSMaxPhi/180;</span>
<span class="lineNum">    1742 </span><span class="lineNoCov">          0 :   Double_t phiPHOS = (AliPythiaRndm::GetPythiaRandom())-&gt;Uniform(phiPHOSmin,phiPHOSmax);</span>
<span class="lineNum">    1743 </span>            :   
<span class="lineNum">    1744 </span>            :   //calculate deltaphi
<span class="lineNum">    1745 </span><span class="lineNoCov">          0 :   TParticle* ph = (TParticle *) fParticles.At(fPHOSRotateCandidate);</span>
<span class="lineNum">    1746 </span><span class="lineNoCov">          0 :   Double_t phphi = ph-&gt;Phi();</span>
<span class="lineNum">    1747 </span><span class="lineNoCov">          0 :   Double_t deltaphi = phiPHOS - phphi;</span>
<span class="lineNum">    1748 </span>            :   
<span class="lineNum">    1749 </span>            :   
<span class="lineNum">    1750 </span>            :   
<span class="lineNum">    1751 </span>            :   //loop for all particles and produce the phi rotation
<span class="lineNum">    1752 </span><span class="lineNoCov">          0 :   Int_t np = (fHadronisation) ? fParticles.GetEntriesFast() : fNpartons;</span>
<span class="lineNum">    1753 </span>            :   Double_t oldphi, newphi;
<span class="lineNum">    1754 </span>            :   Double_t newVx, newVy, r, vZ, time; 
<span class="lineNum">    1755 </span>            :   Double_t newPx, newPy, pt, pz, e;
<span class="lineNum">    1756 </span><span class="lineNoCov">          0 :   for(Int_t i=0; i&lt; np; i++) {</span>
<span class="lineNum">    1757 </span><span class="lineNoCov">          0 :     TParticle* iparticle = (TParticle *) fParticles.At(i);</span>
<span class="lineNum">    1758 </span><span class="lineNoCov">          0 :     oldphi = iparticle-&gt;Phi();</span>
<span class="lineNum">    1759 </span><span class="lineNoCov">          0 :     newphi = oldphi + deltaphi;</span>
<span class="lineNum">    1760 </span><span class="lineNoCov">          0 :     if(newphi &lt; 0) newphi = 2*TMath::Pi() + newphi; // correct angle </span>
<span class="lineNum">    1761 </span><span class="lineNoCov">          0 :     if(newphi &gt; 2*TMath::Pi()) newphi = newphi - 2*TMath::Pi(); // correct angle</span>
<span class="lineNum">    1762 </span>            :     
<span class="lineNum">    1763 </span><span class="lineNoCov">          0 :     r = iparticle-&gt;R();</span>
<span class="lineNum">    1764 </span><span class="lineNoCov">          0 :     newVx = r * TMath::Cos(newphi);</span>
<span class="lineNum">    1765 </span><span class="lineNoCov">          0 :     newVy = r * TMath::Sin(newphi);</span>
<span class="lineNum">    1766 </span><span class="lineNoCov">          0 :     vZ   = iparticle-&gt;Vz(); // don't transform</span>
<span class="lineNum">    1767 </span><span class="lineNoCov">          0 :     time = iparticle-&gt;T(); // don't transform</span>
<span class="lineNum">    1768 </span>            :     
<span class="lineNum">    1769 </span><span class="lineNoCov">          0 :     pt = iparticle-&gt;Pt();</span>
<span class="lineNum">    1770 </span><span class="lineNoCov">          0 :     newPx = pt * TMath::Cos(newphi);</span>
<span class="lineNum">    1771 </span><span class="lineNoCov">          0 :     newPy = pt * TMath::Sin(newphi);</span>
<span class="lineNum">    1772 </span><span class="lineNoCov">          0 :     pz = iparticle-&gt;Pz(); // don't transform</span>
<span class="lineNum">    1773 </span><span class="lineNoCov">          0 :     e  = iparticle-&gt;Energy(); // don't transform</span>
<span class="lineNum">    1774 </span>            :     
<span class="lineNum">    1775 </span>            :     // apply rotation 
<span class="lineNum">    1776 </span><span class="lineNoCov">          0 :     iparticle-&gt;SetProductionVertex(newVx, newVy, vZ, time);</span>
<span class="lineNum">    1777 </span><span class="lineNoCov">          0 :     iparticle-&gt;SetMomentum(newPx, newPy, pz, e);</span>
<span class="lineNum">    1778 </span>            :     
<span class="lineNum">    1779 </span>            :   } //end particle loop 
<span class="lineNum">    1780 </span>            :   
<span class="lineNum">    1781 </span>            :   // now let's check that we put correctly the candidate photon in PHOS
<span class="lineNum">    1782 </span><span class="lineNoCov">          0 :   Float_t phi = ph-&gt;Phi()*180./TMath::Pi(); //Convert to degrees</span>
<span class="lineNum">    1783 </span><span class="lineNoCov">          0 :   Float_t eta =TMath::Abs(ph-&gt;Eta());//in calos etamin=-etamax </span>
<span class="lineNum">    1784 </span><span class="lineNoCov">          0 :   if(IsInPHOS(phi,eta,-1)) </span>
<span class="lineNum">    1785 </span><span class="lineNoCov">          0 :     okdd = kTRUE;</span>
<span class="lineNum">    1786 </span>            :   
<span class="lineNum">    1787 </span>            :   // reset the value for next event
<span class="lineNum">    1788 </span><span class="lineNoCov">          0 :   fPHOSRotateCandidate = -1;</span>
<span class="lineNum">    1789 </span>            :   
<span class="lineNum">    1790 </span><span class="lineNoCov">          0 : }</span>
<a name="1791"><span class="lineNum">    1791 </span>            : </a>
<span class="lineNum">    1792 </span>            : 
<span class="lineNum">    1793 </span>            : Bool_t AliGenPythia::CheckDiffraction()
<span class="lineNum">    1794 </span>            : {
<span class="lineNum">    1795 </span>            :   // use this method only with Perugia-0 tune!
<span class="lineNum">    1796 </span>            : 
<span class="lineNum">    1797 </span>            :   //  printf(&quot;AAA\n&quot;);
<span class="lineNum">    1798 </span>            : 
<span class="lineNum">    1799 </span><span class="lineNoCov">          0 :    Int_t np = (fHadronisation) ? fParticles.GetEntriesFast() : fNpartons;</span>
<span class="lineNum">    1800 </span>            : 
<span class="lineNum">    1801 </span>            :    Int_t iPart1=-1;
<span class="lineNum">    1802 </span>            :    Int_t iPart2=-1;
<span class="lineNum">    1803 </span>            : 
<span class="lineNum">    1804 </span>            :    Double_t y1 = 1e10;
<span class="lineNum">    1805 </span>            :    Double_t y2 = -1e10;
<span class="lineNum">    1806 </span>            : 
<span class="lineNum">    1807 </span>            :   const Int_t kNstable=20;
<span class="lineNum">    1808 </span>            :   const Int_t pdgStable[20] = {
<span class="lineNum">    1809 </span>            :     22,             // Photon
<span class="lineNum">    1810 </span>            :     11,             // Electron
<span class="lineNum">    1811 </span>            :     12,             // Electron Neutrino 
<span class="lineNum">    1812 </span>            :     13,             // Muon 
<span class="lineNum">    1813 </span>            :     14,             // Muon Neutrino
<span class="lineNum">    1814 </span>            :     15,             // Tau 
<span class="lineNum">    1815 </span>            :     16,             // Tau Neutrino
<span class="lineNum">    1816 </span>            :     211,            // Pion
<span class="lineNum">    1817 </span>            :     321,            // Kaon
<span class="lineNum">    1818 </span>            :     311,            // K0
<span class="lineNum">    1819 </span>            :     130,            // K0s
<span class="lineNum">    1820 </span>            :     310,            // K0l
<span class="lineNum">    1821 </span>            :     2212,           // Proton 
<span class="lineNum">    1822 </span>            :     2112,           // Neutron
<span class="lineNum">    1823 </span>            :     3122,           // Lambda_0
<span class="lineNum">    1824 </span>            :     3112,           // Sigma Minus
<span class="lineNum">    1825 </span>            :     3222,           // Sigma Plus
<span class="lineNum">    1826 </span>            :     3312,           // Xsi Minus 
<span class="lineNum">    1827 </span>            :     3322,           // Xsi0
<span class="lineNum">    1828 </span>            :     3334            // Omega
<span class="lineNum">    1829 </span>            :   };
<span class="lineNum">    1830 </span>            :     
<span class="lineNum">    1831 </span><span class="lineNoCov">          0 :      for (Int_t i = 0; i &lt; np; i++) {</span>
<span class="lineNum">    1832 </span><span class="lineNoCov">          0 :         TParticle *  part = (TParticle *) fParticles.At(i);</span>
<span class="lineNum">    1833 </span>            :         
<span class="lineNum">    1834 </span><span class="lineNoCov">          0 :         Int_t statusCode = part-&gt;GetStatusCode();</span>
<span class="lineNum">    1835 </span>            :         
<span class="lineNum">    1836 </span>            :         // Initial state particle
<span class="lineNum">    1837 </span><span class="lineNoCov">          0 :         if (statusCode != 1)</span>
<span class="lineNum">    1838 </span><span class="lineNoCov">          0 :           continue;</span>
<span class="lineNum">    1839 </span>            : 
<span class="lineNum">    1840 </span><span class="lineNoCov">          0 :         Int_t pdg = TMath::Abs(part-&gt;GetPdgCode());</span>
<span class="lineNum">    1841 </span>            :         Bool_t isStable = kFALSE;
<span class="lineNum">    1842 </span><span class="lineNoCov">          0 :         for (Int_t i1 = 0; i1 &lt; kNstable; i1++) {</span>
<span class="lineNum">    1843 </span><span class="lineNoCov">          0 :           if (pdg == pdgStable[i1]) {</span>
<span class="lineNum">    1844 </span>            :             isStable = kTRUE;
<span class="lineNum">    1845 </span><span class="lineNoCov">          0 :             break;</span>
<span class="lineNum">    1846 </span>            :           }
<span class="lineNum">    1847 </span>            :         }
<span class="lineNum">    1848 </span><span class="lineNoCov">          0 :         if(!isStable) </span>
<span class="lineNum">    1849 </span><span class="lineNoCov">          0 :           continue;</span>
<span class="lineNum">    1850 </span>            : 
<span class="lineNum">    1851 </span><span class="lineNoCov">          0 :         Double_t y = part-&gt;Y();</span>
<span class="lineNum">    1852 </span>            : 
<span class="lineNum">    1853 </span><span class="lineNoCov">          0 :         if (y &lt; y1)</span>
<span class="lineNum">    1854 </span>            :           {
<span class="lineNum">    1855 </span>            :             y1 = y;
<span class="lineNum">    1856 </span>            :             iPart1 = i;
<span class="lineNum">    1857 </span><span class="lineNoCov">          0 :           }</span>
<span class="lineNum">    1858 </span><span class="lineNoCov">          0 :         if (y &gt; y2)</span>
<span class="lineNum">    1859 </span>            :         {
<span class="lineNum">    1860 </span>            :           y2 = y;
<span class="lineNum">    1861 </span>            :           iPart2 = i;
<span class="lineNum">    1862 </span><span class="lineNoCov">          0 :         }</span>
<span class="lineNum">    1863 </span><span class="lineNoCov">          0 :      }</span>
<span class="lineNum">    1864 </span>            : 
<span class="lineNum">    1865 </span><span class="lineNoCov">          0 :      if(iPart1&lt;0 || iPart2&lt;0) return kFALSE;</span>
<span class="lineNum">    1866 </span>            : 
<span class="lineNum">    1867 </span><span class="lineNoCov">          0 :      y1=TMath::Abs(y1);</span>
<span class="lineNum">    1868 </span><span class="lineNoCov">          0 :      y2=TMath::Abs(y2);</span>
<span class="lineNum">    1869 </span>            : 
<span class="lineNum">    1870 </span><span class="lineNoCov">          0 :      TParticle *  part1 = (TParticle *) fParticles.At(iPart1);</span>
<span class="lineNum">    1871 </span><span class="lineNoCov">          0 :      TParticle *  part2 = (TParticle *) fParticles.At(iPart2);</span>
<span class="lineNum">    1872 </span>            : 
<span class="lineNum">    1873 </span><span class="lineNoCov">          0 :      Int_t pdg1 = part1-&gt;GetPdgCode();</span>
<span class="lineNum">    1874 </span><span class="lineNoCov">          0 :      Int_t pdg2 = part2-&gt;GetPdgCode();</span>
<span class="lineNum">    1875 </span>            : 
<span class="lineNum">    1876 </span>            : 
<span class="lineNum">    1877 </span>            :      Int_t iPart = -1;
<span class="lineNum">    1878 </span><span class="lineNoCov">          0 :      if (pdg1 == 2212 &amp;&amp; pdg2 == 2212)</span>
<span class="lineNum">    1879 </span>            :        {
<span class="lineNum">    1880 </span><span class="lineNoCov">          0 :          if(y1 &gt; y2) </span>
<span class="lineNum">    1881 </span><span class="lineNoCov">          0 :            iPart = iPart1;</span>
<span class="lineNum">    1882 </span><span class="lineNoCov">          0 :          else if(y1 &lt; y2) </span>
<span class="lineNum">    1883 </span><span class="lineNoCov">          0 :            iPart = iPart2;</span>
<span class="lineNum">    1884 </span>            :          else {
<span class="lineNum">    1885 </span>            :            iPart = iPart1;
<span class="lineNum">    1886 </span><span class="lineNoCov">          0 :            if((AliPythiaRndm::GetPythiaRandom())-&gt;Uniform(0.,1.)&gt;0.5) iPart = iPart2;</span>
<span class="lineNum">    1887 </span>            :          }
<span class="lineNum">    1888 </span>            :        }
<span class="lineNum">    1889 </span><span class="lineNoCov">          0 :      else if (pdg1 == 2212)</span>
<span class="lineNum">    1890 </span><span class="lineNoCov">          0 :        iPart = iPart1;</span>
<span class="lineNum">    1891 </span><span class="lineNoCov">          0 :      else if (pdg2 == 2212)</span>
<span class="lineNum">    1892 </span><span class="lineNoCov">          0 :        iPart = iPart2;</span>
<span class="lineNum">    1893 </span>            : 
<span class="lineNum">    1894 </span>            : 
<span class="lineNum">    1895 </span>            : 
<span class="lineNum">    1896 </span>            : 
<span class="lineNum">    1897 </span>            : 
<span class="lineNum">    1898 </span>            :      Double_t M=-1.;
<span class="lineNum">    1899 </span><span class="lineNoCov">          0 :      if(iPart&gt;0) {</span>
<span class="lineNum">    1900 </span><span class="lineNoCov">          0 :        TParticle *  part = (TParticle *) fParticles.At(iPart);</span>
<span class="lineNum">    1901 </span><span class="lineNoCov">          0 :        Double_t E= part-&gt;Energy();</span>
<span class="lineNum">    1902 </span><span class="lineNoCov">          0 :        Double_t P= part-&gt;P();</span>
<span class="lineNum">    1903 </span><span class="lineNoCov">          0 :        Double_t M2 = (fEnergyCMS-E-P)*(fEnergyCMS-E+P);</span>
<span class="lineNum">    1904 </span><span class="lineNoCov">          0 :        if(M2&lt;0)  return kFALSE;</span>
<span class="lineNum">    1905 </span><span class="lineNoCov">          0 :        M= TMath::Sqrt(M2);</span>
<span class="lineNum">    1906 </span><span class="lineNoCov">          0 :      }</span>
<span class="lineNum">    1907 </span>            : 
<span class="lineNum">    1908 </span><span class="lineNoCov">          0 :      Double_t Mmin, Mmax, wSD, wDD, wND;</span>
<span class="lineNum">    1909 </span><span class="lineNoCov">          0 :      if(!GetWeightsDiffraction(M, Mmin, Mmax, wSD, wDD, wND)) return kFALSE;</span>
<span class="lineNum">    1910 </span>            : 
<span class="lineNum">    1911 </span><span class="lineNoCov">          0 :      if(M&gt;-1 &amp;&amp; M&lt;Mmin) return kFALSE;</span>
<span class="lineNum">    1912 </span><span class="lineNoCov">          0 :      if(M&gt;Mmax) M=-1;</span>
<span class="lineNum">    1913 </span>            : 
<span class="lineNum">    1914 </span><span class="lineNoCov">          0 :      Int_t procType=fPythia-&gt;GetMSTI(1);</span>
<span class="lineNum">    1915 </span>            :      Int_t proc0=2;
<span class="lineNum">    1916 </span><span class="lineNoCov">          0 :      if(procType== 94) proc0=1;</span>
<span class="lineNum">    1917 </span><span class="lineNoCov">          0 :      if(procType== 92 || procType== 93) proc0=0;</span>
<span class="lineNum">    1918 </span>            : 
<span class="lineNum">    1919 </span>            :      Int_t proc=2;
<span class="lineNum">    1920 </span><span class="lineNoCov">          0 :      if(M&gt;0) proc=0;</span>
<span class="lineNum">    1921 </span><span class="lineNoCov">          0 :      else if(proc0==1) proc=1;</span>
<span class="lineNum">    1922 </span>            : 
<span class="lineNum">    1923 </span><span class="lineNoCov">          0 :      if(proc==1 &amp;&amp; (AliPythiaRndm::GetPythiaRandom())-&gt;Uniform(0.,1.) &gt; wDD) return kFALSE;</span>
<span class="lineNum">    1924 </span><span class="lineNoCov">          0 :      if(proc==2 &amp;&amp; (AliPythiaRndm::GetPythiaRandom())-&gt;Uniform(0.,1.) &gt; wND) return kFALSE;</span>
<span class="lineNum">    1925 </span>            : 
<span class="lineNum">    1926 </span>            : 
<span class="lineNum">    1927 </span>            :     //     if(proc==1 || proc==2) return kFALSE;
<span class="lineNum">    1928 </span>            : 
<span class="lineNum">    1929 </span><span class="lineNoCov">          0 :      if(proc!=0) {</span>
<span class="lineNum">    1930 </span><span class="lineNoCov">          0 :        if(proc0!=0) fProcDiff = procType;</span>
<span class="lineNum">    1931 </span><span class="lineNoCov">          0 :        else       fProcDiff = 95;</span>
<span class="lineNum">    1932 </span><span class="lineNoCov">          0 :        return kTRUE;</span>
<span class="lineNum">    1933 </span>            :      }
<span class="lineNum">    1934 </span>            : 
<span class="lineNum">    1935 </span><span class="lineNoCov">          0 :     if(wSD&lt;0)  AliError(&quot;wSD&lt;0 ! \n&quot;);</span>
<span class="lineNum">    1936 </span>            : 
<span class="lineNum">    1937 </span><span class="lineNoCov">          0 :     if((AliPythiaRndm::GetPythiaRandom())-&gt;Uniform(0.,1.)&gt; wSD) return kFALSE;</span>
<span class="lineNum">    1938 </span>            : 
<span class="lineNum">    1939 </span>            :     //    printf(&quot;iPart = %d\n&quot;, iPart);
<span class="lineNum">    1940 </span>            : 
<span class="lineNum">    1941 </span><span class="lineNoCov">          0 :     if(iPart==iPart1) fProcDiff=93;</span>
<span class="lineNum">    1942 </span><span class="lineNoCov">          0 :     else if(iPart==iPart2) fProcDiff=92;</span>
<span class="lineNum">    1943 </span>            :     else {
<span class="lineNum">    1944 </span><span class="lineNoCov">          0 :       printf(&quot;EROOR:  iPart!=iPart1 &amp;&amp; iPart!=iPart2\n&quot;);</span>
<span class="lineNum">    1945 </span>            : 
<span class="lineNum">    1946 </span>            :     }
<span class="lineNum">    1947 </span>            : 
<span class="lineNum">    1948 </span><span class="lineNoCov">          0 :     return kTRUE;</span>
<span class="lineNum">    1949 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">    1950 </span>            : 
<a name="1951"><span class="lineNum">    1951 </span>            : </a>
<span class="lineNum">    1952 </span>            : 
<span class="lineNum">    1953 </span>            : Bool_t AliGenPythia::GetWeightsDiffraction(Double_t M, Double_t &amp;Mmin, Double_t &amp;Mmax, 
<span class="lineNum">    1954 </span>            :                                                        Double_t &amp;wSD, Double_t &amp;wDD, Double_t &amp;wND)
<span class="lineNum">    1955 </span>            : {
<span class="lineNum">    1956 </span>            : 
<span class="lineNum">    1957 </span>            :   // 900 GeV
<span class="lineNum">    1958 </span><span class="lineNoCov">          0 :   if(TMath::Abs(fEnergyCMS-900)&lt;1 ){</span>
<span class="lineNum">    1959 </span>            : 
<span class="lineNum">    1960 </span>            : const Int_t nbin=400;
<span class="lineNum">    1961 </span><span class="lineNoCov">          0 : Double_t bin[]={</span>
<span class="lineNum">    1962 </span>            : 1.080000, 1.577300, 2.074600, 2.571900, 3.069200, 3.566500, 
<span class="lineNum">    1963 </span>            : 4.063800, 4.561100, 5.058400, 5.555700, 6.053000, 6.550300, 
<span class="lineNum">    1964 </span>            : 7.047600, 7.544900, 8.042200, 8.539500, 9.036800, 9.534100, 
<span class="lineNum">    1965 </span>            : 10.031400, 10.528700, 11.026000, 11.523300, 12.020600, 12.517900, 
<span class="lineNum">    1966 </span>            : 13.015200, 13.512500, 14.009800, 14.507100, 15.004400, 15.501700, 
<span class="lineNum">    1967 </span>            : 15.999000, 16.496300, 16.993600, 17.490900, 17.988200, 18.485500, 
<span class="lineNum">    1968 </span>            : 18.982800, 19.480100, 19.977400, 20.474700, 20.972000, 21.469300, 
<span class="lineNum">    1969 </span>            : 21.966600, 22.463900, 22.961200, 23.458500, 23.955800, 24.453100, 
<span class="lineNum">    1970 </span>            : 24.950400, 25.447700, 25.945000, 26.442300, 26.939600, 27.436900, 
<span class="lineNum">    1971 </span>            : 27.934200, 28.431500, 28.928800, 29.426100, 29.923400, 30.420700, 
<span class="lineNum">    1972 </span>            : 30.918000, 31.415300, 31.912600, 32.409900, 32.907200, 33.404500, 
<span class="lineNum">    1973 </span>            : 33.901800, 34.399100, 34.896400, 35.393700, 35.891000, 36.388300, 
<span class="lineNum">    1974 </span>            : 36.885600, 37.382900, 37.880200, 38.377500, 38.874800, 39.372100, 
<span class="lineNum">    1975 </span>            : 39.869400, 40.366700, 40.864000, 41.361300, 41.858600, 42.355900, 
<span class="lineNum">    1976 </span>            : 42.853200, 43.350500, 43.847800, 44.345100, 44.842400, 45.339700, 
<span class="lineNum">    1977 </span>            : 45.837000, 46.334300, 46.831600, 47.328900, 47.826200, 48.323500, 
<span class="lineNum">    1978 </span>            : 48.820800, 49.318100, 49.815400, 50.312700, 50.810000, 51.307300, 
<span class="lineNum">    1979 </span>            : 51.804600, 52.301900, 52.799200, 53.296500, 53.793800, 54.291100, 
<span class="lineNum">    1980 </span>            : 54.788400, 55.285700, 55.783000, 56.280300, 56.777600, 57.274900, 
<span class="lineNum">    1981 </span>            : 57.772200, 58.269500, 58.766800, 59.264100, 59.761400, 60.258700, 
<span class="lineNum">    1982 </span>            : 60.756000, 61.253300, 61.750600, 62.247900, 62.745200, 63.242500, 
<span class="lineNum">    1983 </span>            : 63.739800, 64.237100, 64.734400, 65.231700, 65.729000, 66.226300, 
<span class="lineNum">    1984 </span>            : 66.723600, 67.220900, 67.718200, 68.215500, 68.712800, 69.210100, 
<span class="lineNum">    1985 </span>            : 69.707400, 70.204700, 70.702000, 71.199300, 71.696600, 72.193900, 
<span class="lineNum">    1986 </span>            : 72.691200, 73.188500, 73.685800, 74.183100, 74.680400, 75.177700, 
<span class="lineNum">    1987 </span>            : 75.675000, 76.172300, 76.669600, 77.166900, 77.664200, 78.161500, 
<span class="lineNum">    1988 </span>            : 78.658800, 79.156100, 79.653400, 80.150700, 80.648000, 81.145300, 
<span class="lineNum">    1989 </span>            : 81.642600, 82.139900, 82.637200, 83.134500, 83.631800, 84.129100, 
<span class="lineNum">    1990 </span>            : 84.626400, 85.123700, 85.621000, 86.118300, 86.615600, 87.112900, 
<span class="lineNum">    1991 </span>            : 87.610200, 88.107500, 88.604800, 89.102100, 89.599400, 90.096700, 
<span class="lineNum">    1992 </span>            : 90.594000, 91.091300, 91.588600, 92.085900, 92.583200, 93.080500, 
<span class="lineNum">    1993 </span>            : 93.577800, 94.075100, 94.572400, 95.069700, 95.567000, 96.064300, 
<span class="lineNum">    1994 </span>            : 96.561600, 97.058900, 97.556200, 98.053500, 98.550800, 99.048100, 
<span class="lineNum">    1995 </span>            : 99.545400, 100.042700, 100.540000, 101.037300, 101.534600, 102.031900, 
<span class="lineNum">    1996 </span>            : 102.529200, 103.026500, 103.523800, 104.021100, 104.518400, 105.015700, 
<span class="lineNum">    1997 </span>            : 105.513000, 106.010300, 106.507600, 107.004900, 107.502200, 107.999500, 
<span class="lineNum">    1998 </span>            : 108.496800, 108.994100, 109.491400, 109.988700, 110.486000, 110.983300, 
<span class="lineNum">    1999 </span>            : 111.480600, 111.977900, 112.475200, 112.972500, 113.469800, 113.967100, 
<span class="lineNum">    2000 </span>            : 114.464400, 114.961700, 115.459000, 115.956300, 116.453600, 116.950900, 
<span class="lineNum">    2001 </span>            : 117.448200, 117.945500, 118.442800, 118.940100, 119.437400, 119.934700, 
<span class="lineNum">    2002 </span>            : 120.432000, 120.929300, 121.426600, 121.923900, 122.421200, 122.918500, 
<span class="lineNum">    2003 </span>            : 123.415800, 123.913100, 124.410400, 124.907700, 125.405000, 125.902300, 
<span class="lineNum">    2004 </span>            : 126.399600, 126.896900, 127.394200, 127.891500, 128.388800, 128.886100, 
<span class="lineNum">    2005 </span>            : 129.383400, 129.880700, 130.378000, 130.875300, 131.372600, 131.869900, 
<span class="lineNum">    2006 </span>            : 132.367200, 132.864500, 133.361800, 133.859100, 134.356400, 134.853700, 
<span class="lineNum">    2007 </span>            : 135.351000, 135.848300, 136.345600, 136.842900, 137.340200, 137.837500, 
<span class="lineNum">    2008 </span>            : 138.334800, 138.832100, 139.329400, 139.826700, 140.324000, 140.821300, 
<span class="lineNum">    2009 </span>            : 141.318600, 141.815900, 142.313200, 142.810500, 143.307800, 143.805100, 
<span class="lineNum">    2010 </span>            : 144.302400, 144.799700, 145.297000, 145.794300, 146.291600, 146.788900, 
<span class="lineNum">    2011 </span>            : 147.286200, 147.783500, 148.280800, 148.778100, 149.275400, 149.772700, 
<span class="lineNum">    2012 </span>            : 150.270000, 150.767300, 151.264600, 151.761900, 152.259200, 152.756500, 
<span class="lineNum">    2013 </span>            : 153.253800, 153.751100, 154.248400, 154.745700, 155.243000, 155.740300, 
<span class="lineNum">    2014 </span>            : 156.237600, 156.734900, 157.232200, 157.729500, 158.226800, 158.724100, 
<span class="lineNum">    2015 </span>            : 159.221400, 159.718700, 160.216000, 160.713300, 161.210600, 161.707900, 
<span class="lineNum">    2016 </span>            : 162.205200, 162.702500, 163.199800, 163.697100, 164.194400, 164.691700, 
<span class="lineNum">    2017 </span>            : 165.189000, 165.686300, 166.183600, 166.680900, 167.178200, 167.675500, 
<span class="lineNum">    2018 </span>            : 168.172800, 168.670100, 169.167400, 169.664700, 170.162000, 170.659300, 
<span class="lineNum">    2019 </span>            : 171.156600, 171.653900, 172.151200, 172.648500, 173.145800, 173.643100, 
<span class="lineNum">    2020 </span>            : 174.140400, 174.637700, 175.135000, 175.632300, 176.129600, 176.626900, 
<span class="lineNum">    2021 </span>            : 177.124200, 177.621500, 178.118800, 178.616100, 179.113400, 179.610700, 
<span class="lineNum">    2022 </span>            : 180.108000, 180.605300, 181.102600, 181.599900, 182.097200, 182.594500, 
<span class="lineNum">    2023 </span>            : 183.091800, 183.589100, 184.086400, 184.583700, 185.081000, 185.578300, 
<span class="lineNum">    2024 </span>            : 186.075600, 186.572900, 187.070200, 187.567500, 188.064800, 188.562100, 
<span class="lineNum">    2025 </span>            : 189.059400, 189.556700, 190.054000, 190.551300, 191.048600, 191.545900, 
<span class="lineNum">    2026 </span>            : 192.043200, 192.540500, 193.037800, 193.535100, 194.032400, 194.529700, 
<span class="lineNum">    2027 </span>            : 195.027000, 195.524300, 196.021600, 196.518900, 197.016200, 197.513500, 
<span class="lineNum">    2028 </span>            : 198.010800, 198.508100, 199.005400, 199.502700, 200.000000};
<span class="lineNum">    2029 </span><span class="lineNoCov">          0 : Double_t w[]={</span>
<span class="lineNum">    2030 </span>            : 1.000000, 0.643457, 0.645609, 0.648347, 0.604563, 0.605002, 
<span class="lineNum">    2031 </span>            : 0.602819, 0.611473, 0.576412, 0.562354, 0.550216, 0.529285, 
<span class="lineNum">    2032 </span>            : 0.534558, 0.534364, 0.530358, 0.518475, 0.489253, 0.469754, 
<span class="lineNum">    2033 </span>            : 0.469825, 0.450513, 0.455849, 0.435312, 0.437210, 0.456686, 
<span class="lineNum">    2034 </span>            : 0.413577, 0.427093, 0.426894, 0.418834, 0.409475, 0.388483, 
<span class="lineNum">    2035 </span>            : 0.412208, 0.388912, 0.389611, 0.382572, 0.389220, 0.370964, 
<span class="lineNum">    2036 </span>            : 0.380463, 0.370873, 0.363701, 0.369363, 0.357361, 0.365759, 
<span class="lineNum">    2037 </span>            : 0.348566, 0.337062, 0.348190, 0.332330, 0.359001, 0.335836, 
<span class="lineNum">    2038 </span>            : 0.339154, 0.335599, 0.336035, 0.335204, 0.353440, 0.337836, 
<span class="lineNum">    2039 </span>            : 0.333874, 0.307120, 0.294963, 0.324978, 0.313359, 0.317688, 
<span class="lineNum">    2040 </span>            : 0.323758, 0.319304, 0.335317, 0.301765, 0.317257, 0.356331, 
<span class="lineNum">    2041 </span>            : 0.323119, 0.297732, 0.303188, 0.326102, 0.316467, 0.294728, 
<span class="lineNum">    2042 </span>            : 0.308135, 0.288857, 0.325692, 0.312493, 0.291100, 0.325921, 
<span class="lineNum">    2043 </span>            : 0.313317, 0.295980, 0.308481, 0.328380, 0.313081, 0.296763, 
<span class="lineNum">    2044 </span>            : 0.295431, 0.317325, 0.320462, 0.286918, 0.316035, 0.335208, 
<span class="lineNum">    2045 </span>            : 0.283193, 0.333945, 0.292534, 0.294164, 0.330680, 0.296992, 
<span class="lineNum">    2046 </span>            : 0.285509, 0.317260, 0.298269, 0.311299, 0.312129, 0.286822, 
<span class="lineNum">    2047 </span>            : 0.287442, 0.319139, 0.283314, 0.318454, 0.297727, 0.301597, 
<span class="lineNum">    2048 </span>            : 0.282483, 0.294792, 0.305569, 0.290957, 0.297817, 0.282908, 
<span class="lineNum">    2049 </span>            : 0.272401, 0.305584, 0.300220, 0.297020, 0.298781, 0.278008, 
<span class="lineNum">    2050 </span>            : 0.277727, 0.323777, 0.287419, 0.342074, 0.287259, 0.303658, 
<span class="lineNum">    2051 </span>            : 0.302668, 0.279622, 0.280586, 0.313630, 0.276068, 0.257051, 
<span class="lineNum">    2052 </span>            : 0.309996, 0.265534, 0.297138, 0.281738, 0.294610, 0.292882, 
<span class="lineNum">    2053 </span>            : 0.286860, 0.312686, 0.293244, 0.293744, 0.271375, 0.278734, 
<span class="lineNum">    2054 </span>            : 0.280308, 0.304739, 0.287907, 0.285261, 0.311180, 0.313476, 
<span class="lineNum">    2055 </span>            : 0.289660, 0.289282, 0.319505, 0.271285, 0.272008, 0.289245, 
<span class="lineNum">    2056 </span>            : 0.281038, 0.285284, 0.295836, 0.281416, 0.283501, 0.295417, 
<span class="lineNum">    2057 </span>            : 0.304372, 0.297764, 0.291378, 0.321530, 0.315604, 0.329507, 
<span class="lineNum">    2058 </span>            : 0.282609, 0.275576, 0.283721, 0.311714, 0.283760, 0.273188, 
<span class="lineNum">    2059 </span>            : 0.312193, 0.264347, 0.281532, 0.301226, 0.281718, 0.336408, 
<span class="lineNum">    2060 </span>            : 0.283157, 0.332010, 0.289974, 0.290256, 0.301569, 0.332228, 
<span class="lineNum">    2061 </span>            : 0.288282, 0.326339, 0.313653, 0.300361, 0.289470, 0.264830, 
<span class="lineNum">    2062 </span>            : 0.298659, 0.272359, 0.278878, 0.306001, 0.328168, 0.294991, 
<span class="lineNum">    2063 </span>            : 0.327737, 0.278056, 0.302435, 0.284183, 0.279270, 0.307279, 
<span class="lineNum">    2064 </span>            : 0.307917, 0.315196, 0.283803, 0.313333, 0.315730, 0.304818, 
<span class="lineNum">    2065 </span>            : 0.307171, 0.295223, 0.333741, 0.346911, 0.310143, 0.336686, 
<span class="lineNum">    2066 </span>            : 0.275459, 0.334781, 0.295405, 0.275816, 0.301678, 0.327242, 
<span class="lineNum">    2067 </span>            : 0.320717, 0.309230, 0.292145, 0.294489, 0.305088, 0.300969, 
<span class="lineNum">    2068 </span>            : 0.277438, 0.326159, 0.297065, 0.301177, 0.303843, 0.275382, 
<span class="lineNum">    2069 </span>            : 0.304019, 0.284166, 0.289610, 0.331611, 0.317131, 0.310880, 
<span class="lineNum">    2070 </span>            : 0.360456, 0.294052, 0.342694, 0.327166, 0.336797, 0.298040, 
<span class="lineNum">    2071 </span>            : 0.295767, 0.260053, 0.325544, 0.335310, 0.320182, 0.301072, 
<span class="lineNum">    2072 </span>            : 0.313117, 0.283407, 0.299206, 0.293525, 0.305067, 0.255978, 
<span class="lineNum">    2073 </span>            : 0.327055, 0.316382, 0.317700, 0.278993, 0.283120, 0.314000, 
<span class="lineNum">    2074 </span>            : 0.274396, 0.291208, 0.348813, 0.319603, 0.313076, 0.289155, 
<span class="lineNum">    2075 </span>            : 0.343988, 0.311426, 0.322896, 0.328726, 0.337062, 0.389093, 
<span class="lineNum">    2076 </span>            : 0.284122, 0.312184, 0.304008, 0.319170, 0.320778, 0.288390, 
<span class="lineNum">    2077 </span>            : 0.337272, 0.356273, 0.343310, 0.312209, 0.330709, 0.297977, 
<span class="lineNum">    2078 </span>            : 0.346146, 0.369162, 0.324385, 0.339831, 0.337037, 0.318739, 
<span class="lineNum">    2079 </span>            : 0.343157, 0.277720, 0.368407, 0.321330, 0.338997, 0.314220, 
<span class="lineNum">    2080 </span>            : 0.328861, 0.321824, 0.328013, 0.356925, 0.359144, 0.296314, 
<span class="lineNum">    2081 </span>            : 0.345415, 0.396711, 0.347032, 0.294928, 0.343799, 0.322331, 
<span class="lineNum">    2082 </span>            : 0.328656, 0.326098, 0.337338, 0.337038, 0.300179, 0.351391, 
<span class="lineNum">    2083 </span>            : 0.324337, 0.330896, 0.302842, 0.310522, 0.337052, 0.359989, 
<span class="lineNum">    2084 </span>            : 0.383250, 0.359355, 0.315382, 0.333113, 0.342598, 0.355348, 
<span class="lineNum">    2085 </span>            : 0.320751, 0.320475, 0.351762, 0.351475, 0.338358, 0.326153, 
<span class="lineNum">    2086 </span>            : 0.302507, 0.340048, 0.318685, 0.381646, 0.339320, 0.299453, 
<span class="lineNum">    2087 </span>            : 0.426599, 0.393515, 0.353929, 0.328435, 0.413976, 0.292558, 
<span class="lineNum">    2088 </span>            : 0.379340, 0.358344, 0.409259, 0.313821, 0.336675, 0.324521, 
<span class="lineNum">    2089 </span>            : 0.408382, 0.346273, 0.312939, 0.362453, 0.343152, 0.330577, 
<span class="lineNum">    2090 </span>            : 0.332831, 0.353299, 0.347745, 0.334818, 0.332234, 0.385585, 
<span class="lineNum">    2091 </span>            : 0.395483, 0.395316, 0.326972, 0.349434, 0.317604, 0.328980, 
<span class="lineNum">    2092 </span>            : 0.375056, 0.317290, 0.357083, 0.346165, 0.310444, 0.356873, 
<span class="lineNum">    2093 </span>            : 0.359523, 0.365308, 0.365122, 0.383685, 0.370975, 0.396928, 
<span class="lineNum">    2094 </span>            : 0.407654, 0.307755, 0.323033, 0.350580, 0.345231, 0.342462, 
<span class="lineNum">    2095 </span>            : 0.400000, 0.318309, 0.403570, 0.322856, 0.383053, 0.422252, 
<span class="lineNum">    2096 </span>            : 0.386112, 0.364314, 0.434375, 0.334629};
<span class="lineNum">    2097 </span><span class="lineNoCov">          0 : wDD = 0.379611;</span>
<span class="lineNum">    2098 </span><span class="lineNoCov">          0 : wND = 0.496961;</span>
<span class="lineNum">    2099 </span><span class="lineNoCov">          0 : wSD = -1;</span>
<span class="lineNum">    2100 </span>            : 
<span class="lineNum">    2101 </span><span class="lineNoCov">          0 :     Mmin = bin[0];</span>
<span class="lineNum">    2102 </span><span class="lineNoCov">          0 :     Mmax = bin[nbin];</span>
<span class="lineNum">    2103 </span><span class="lineNoCov">          0 :     if(M&lt;Mmin || M&gt;Mmax) return kTRUE;</span>
<span class="lineNum">    2104 </span>            : 
<span class="lineNum">    2105 </span>            :     Int_t ibin=nbin-1;
<span class="lineNum">    2106 </span><span class="lineNoCov">          0 :     for(Int_t i=1; i&lt;=nbin; i++) </span>
<span class="lineNum">    2107 </span><span class="lineNoCov">          0 :       if(M&lt;=bin[i]) {</span>
<span class="lineNum">    2108 </span><span class="lineNoCov">          0 :         ibin=i-1;</span>
<span class="lineNum">    2109 </span>            :         //      printf(&quot;Mi&gt; %f &amp;&amp; Mi&lt; %f\n&quot;, bin[i-1], bin[i]);
<span class="lineNum">    2110 </span><span class="lineNoCov">          0 :         break;</span>
<span class="lineNum">    2111 </span>            :       }
<span class="lineNum">    2112 </span><span class="lineNoCov">          0 :     wSD=w[ibin];</span>
<span class="lineNum">    2113 </span>            :     return kTRUE;
<span class="lineNum">    2114 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">    2115 </span><span class="lineNoCov">          0 :  else if(TMath::Abs(fEnergyCMS-2760)&lt;1 ){</span>
<span class="lineNum">    2116 </span>            : 
<span class="lineNum">    2117 </span>            : const Int_t nbin=400;
<span class="lineNum">    2118 </span><span class="lineNoCov">          0 : Double_t bin[]={</span>
<span class="lineNum">    2119 </span>            : 1.080000, 1.577300, 2.074600, 2.571900, 3.069200, 3.566500, 
<span class="lineNum">    2120 </span>            : 4.063800, 4.561100, 5.058400, 5.555700, 6.053000, 6.550300, 
<span class="lineNum">    2121 </span>            : 7.047600, 7.544900, 8.042200, 8.539500, 9.036800, 9.534100, 
<span class="lineNum">    2122 </span>            : 10.031400, 10.528700, 11.026000, 11.523300, 12.020600, 12.517900, 
<span class="lineNum">    2123 </span>            : 13.015200, 13.512500, 14.009800, 14.507100, 15.004400, 15.501700, 
<span class="lineNum">    2124 </span>            : 15.999000, 16.496300, 16.993600, 17.490900, 17.988200, 18.485500, 
<span class="lineNum">    2125 </span>            : 18.982800, 19.480100, 19.977400, 20.474700, 20.972000, 21.469300, 
<span class="lineNum">    2126 </span>            : 21.966600, 22.463900, 22.961200, 23.458500, 23.955800, 24.453100, 
<span class="lineNum">    2127 </span>            : 24.950400, 25.447700, 25.945000, 26.442300, 26.939600, 27.436900, 
<span class="lineNum">    2128 </span>            : 27.934200, 28.431500, 28.928800, 29.426100, 29.923400, 30.420700, 
<span class="lineNum">    2129 </span>            : 30.918000, 31.415300, 31.912600, 32.409900, 32.907200, 33.404500, 
<span class="lineNum">    2130 </span>            : 33.901800, 34.399100, 34.896400, 35.393700, 35.891000, 36.388300, 
<span class="lineNum">    2131 </span>            : 36.885600, 37.382900, 37.880200, 38.377500, 38.874800, 39.372100, 
<span class="lineNum">    2132 </span>            : 39.869400, 40.366700, 40.864000, 41.361300, 41.858600, 42.355900, 
<span class="lineNum">    2133 </span>            : 42.853200, 43.350500, 43.847800, 44.345100, 44.842400, 45.339700, 
<span class="lineNum">    2134 </span>            : 45.837000, 46.334300, 46.831600, 47.328900, 47.826200, 48.323500, 
<span class="lineNum">    2135 </span>            : 48.820800, 49.318100, 49.815400, 50.312700, 50.810000, 51.307300, 
<span class="lineNum">    2136 </span>            : 51.804600, 52.301900, 52.799200, 53.296500, 53.793800, 54.291100, 
<span class="lineNum">    2137 </span>            : 54.788400, 55.285700, 55.783000, 56.280300, 56.777600, 57.274900, 
<span class="lineNum">    2138 </span>            : 57.772200, 58.269500, 58.766800, 59.264100, 59.761400, 60.258700, 
<span class="lineNum">    2139 </span>            : 60.756000, 61.253300, 61.750600, 62.247900, 62.745200, 63.242500, 
<span class="lineNum">    2140 </span>            : 63.739800, 64.237100, 64.734400, 65.231700, 65.729000, 66.226300, 
<span class="lineNum">    2141 </span>            : 66.723600, 67.220900, 67.718200, 68.215500, 68.712800, 69.210100, 
<span class="lineNum">    2142 </span>            : 69.707400, 70.204700, 70.702000, 71.199300, 71.696600, 72.193900, 
<span class="lineNum">    2143 </span>            : 72.691200, 73.188500, 73.685800, 74.183100, 74.680400, 75.177700, 
<span class="lineNum">    2144 </span>            : 75.675000, 76.172300, 76.669600, 77.166900, 77.664200, 78.161500, 
<span class="lineNum">    2145 </span>            : 78.658800, 79.156100, 79.653400, 80.150700, 80.648000, 81.145300, 
<span class="lineNum">    2146 </span>            : 81.642600, 82.139900, 82.637200, 83.134500, 83.631800, 84.129100, 
<span class="lineNum">    2147 </span>            : 84.626400, 85.123700, 85.621000, 86.118300, 86.615600, 87.112900, 
<span class="lineNum">    2148 </span>            : 87.610200, 88.107500, 88.604800, 89.102100, 89.599400, 90.096700, 
<span class="lineNum">    2149 </span>            : 90.594000, 91.091300, 91.588600, 92.085900, 92.583200, 93.080500, 
<span class="lineNum">    2150 </span>            : 93.577800, 94.075100, 94.572400, 95.069700, 95.567000, 96.064300, 
<span class="lineNum">    2151 </span>            : 96.561600, 97.058900, 97.556200, 98.053500, 98.550800, 99.048100, 
<span class="lineNum">    2152 </span>            : 99.545400, 100.042700, 100.540000, 101.037300, 101.534600, 102.031900, 
<span class="lineNum">    2153 </span>            : 102.529200, 103.026500, 103.523800, 104.021100, 104.518400, 105.015700, 
<span class="lineNum">    2154 </span>            : 105.513000, 106.010300, 106.507600, 107.004900, 107.502200, 107.999500, 
<span class="lineNum">    2155 </span>            : 108.496800, 108.994100, 109.491400, 109.988700, 110.486000, 110.983300, 
<span class="lineNum">    2156 </span>            : 111.480600, 111.977900, 112.475200, 112.972500, 113.469800, 113.967100, 
<span class="lineNum">    2157 </span>            : 114.464400, 114.961700, 115.459000, 115.956300, 116.453600, 116.950900, 
<span class="lineNum">    2158 </span>            : 117.448200, 117.945500, 118.442800, 118.940100, 119.437400, 119.934700, 
<span class="lineNum">    2159 </span>            : 120.432000, 120.929300, 121.426600, 121.923900, 122.421200, 122.918500, 
<span class="lineNum">    2160 </span>            : 123.415800, 123.913100, 124.410400, 124.907700, 125.405000, 125.902300, 
<span class="lineNum">    2161 </span>            : 126.399600, 126.896900, 127.394200, 127.891500, 128.388800, 128.886100, 
<span class="lineNum">    2162 </span>            : 129.383400, 129.880700, 130.378000, 130.875300, 131.372600, 131.869900, 
<span class="lineNum">    2163 </span>            : 132.367200, 132.864500, 133.361800, 133.859100, 134.356400, 134.853700, 
<span class="lineNum">    2164 </span>            : 135.351000, 135.848300, 136.345600, 136.842900, 137.340200, 137.837500, 
<span class="lineNum">    2165 </span>            : 138.334800, 138.832100, 139.329400, 139.826700, 140.324000, 140.821300, 
<span class="lineNum">    2166 </span>            : 141.318600, 141.815900, 142.313200, 142.810500, 143.307800, 143.805100, 
<span class="lineNum">    2167 </span>            : 144.302400, 144.799700, 145.297000, 145.794300, 146.291600, 146.788900, 
<span class="lineNum">    2168 </span>            : 147.286200, 147.783500, 148.280800, 148.778100, 149.275400, 149.772700, 
<span class="lineNum">    2169 </span>            : 150.270000, 150.767300, 151.264600, 151.761900, 152.259200, 152.756500, 
<span class="lineNum">    2170 </span>            : 153.253800, 153.751100, 154.248400, 154.745700, 155.243000, 155.740300, 
<span class="lineNum">    2171 </span>            : 156.237600, 156.734900, 157.232200, 157.729500, 158.226800, 158.724100, 
<span class="lineNum">    2172 </span>            : 159.221400, 159.718700, 160.216000, 160.713300, 161.210600, 161.707900, 
<span class="lineNum">    2173 </span>            : 162.205200, 162.702500, 163.199800, 163.697100, 164.194400, 164.691700, 
<span class="lineNum">    2174 </span>            : 165.189000, 165.686300, 166.183600, 166.680900, 167.178200, 167.675500, 
<span class="lineNum">    2175 </span>            : 168.172800, 168.670100, 169.167400, 169.664700, 170.162000, 170.659300, 
<span class="lineNum">    2176 </span>            : 171.156600, 171.653900, 172.151200, 172.648500, 173.145800, 173.643100, 
<span class="lineNum">    2177 </span>            : 174.140400, 174.637700, 175.135000, 175.632300, 176.129600, 176.626900, 
<span class="lineNum">    2178 </span>            : 177.124200, 177.621500, 178.118800, 178.616100, 179.113400, 179.610700, 
<span class="lineNum">    2179 </span>            : 180.108000, 180.605300, 181.102600, 181.599900, 182.097200, 182.594500, 
<span class="lineNum">    2180 </span>            : 183.091800, 183.589100, 184.086400, 184.583700, 185.081000, 185.578300, 
<span class="lineNum">    2181 </span>            : 186.075600, 186.572900, 187.070200, 187.567500, 188.064800, 188.562100, 
<span class="lineNum">    2182 </span>            : 189.059400, 189.556700, 190.054000, 190.551300, 191.048600, 191.545900, 
<span class="lineNum">    2183 </span>            : 192.043200, 192.540500, 193.037800, 193.535100, 194.032400, 194.529700, 
<span class="lineNum">    2184 </span>            : 195.027000, 195.524300, 196.021600, 196.518900, 197.016200, 197.513500, 
<span class="lineNum">    2185 </span>            : 198.010800, 198.508100, 199.005400, 199.502700, 200.000000};
<span class="lineNum">    2186 </span><span class="lineNoCov">          0 : Double_t w[]={</span>
<span class="lineNum">    2187 </span>            : 1.000000, 0.692593, 0.673384, 0.666273, 0.657285, 0.637723, 
<span class="lineNum">    2188 </span>            : 0.625881, 0.643590, 0.606100, 0.589007, 0.567824, 0.578705, 
<span class="lineNum">    2189 </span>            : 0.538530, 0.517937, 0.528278, 0.515918, 0.539461, 0.466186, 
<span class="lineNum">    2190 </span>            : 0.489869, 0.468402, 0.465017, 0.453336, 0.460769, 0.474638, 
<span class="lineNum">    2191 </span>            : 0.456347, 0.434471, 0.427478, 0.435435, 0.410934, 0.366431, 
<span class="lineNum">    2192 </span>            : 0.382240, 0.379513, 0.394249, 0.386837, 0.353103, 0.382138, 
<span class="lineNum">    2193 </span>            : 0.377497, 0.389479, 0.378736, 0.347933, 0.354605, 0.352077, 
<span class="lineNum">    2194 </span>            : 0.324443, 0.358792, 0.339968, 0.359052, 0.330734, 0.318291, 
<span class="lineNum">    2195 </span>            : 0.333703, 0.358644, 0.335819, 0.332213, 0.309051, 0.309975, 
<span class="lineNum">    2196 </span>            : 0.331626, 0.304407, 0.309819, 0.312097, 0.312462, 0.320411, 
<span class="lineNum">    2197 </span>            : 0.280401, 0.302311, 0.315863, 0.281479, 0.310003, 0.296911, 
<span class="lineNum">    2198 </span>            : 0.313676, 0.281071, 0.294163, 0.306500, 0.283462, 0.274867, 
<span class="lineNum">    2199 </span>            : 0.307149, 0.270555, 0.282264, 0.287373, 0.307849, 0.278675, 
<span class="lineNum">    2200 </span>            : 0.286990, 0.278269, 0.300105, 0.286799, 0.265674, 0.275140, 
<span class="lineNum">    2201 </span>            : 0.285702, 0.257352, 0.267714, 0.248204, 0.252220, 0.255678, 
<span class="lineNum">    2202 </span>            : 0.282946, 0.268257, 0.282375, 0.262675, 0.275564, 0.248345, 
<span class="lineNum">    2203 </span>            : 0.236259, 0.291914, 0.259936, 0.241338, 0.267389, 0.285044, 
<span class="lineNum">    2204 </span>            : 0.289419, 0.253594, 0.284568, 0.231840, 0.260008, 0.268527, 
<span class="lineNum">    2205 </span>            : 0.275363, 0.224115, 0.281260, 0.257913, 0.295152, 0.264399, 
<span class="lineNum">    2206 </span>            : 0.232287, 0.282533, 0.223431, 0.255756, 0.244471, 0.221695, 
<span class="lineNum">    2207 </span>            : 0.272450, 0.284244, 0.253682, 0.270717, 0.275403, 0.240323, 
<span class="lineNum">    2208 </span>            : 0.245081, 0.241859, 0.216340, 0.244789, 0.220291, 0.238478, 
<span class="lineNum">    2209 </span>            : 0.224691, 0.244058, 0.266117, 0.271478, 0.242012, 0.267321, 
<span class="lineNum">    2210 </span>            : 0.248494, 0.253343, 0.255606, 0.235458, 0.241079, 0.233223, 
<span class="lineNum">    2211 </span>            : 0.226813, 0.259224, 0.234239, 0.258606, 0.210892, 0.238186, 
<span class="lineNum">    2212 </span>            : 0.243271, 0.222678, 0.213437, 0.273939, 0.247966, 0.232548, 
<span class="lineNum">    2213 </span>            : 0.263438, 0.222089, 0.272111, 0.248818, 0.244295, 0.238368, 
<span class="lineNum">    2214 </span>            : 0.236908, 0.248776, 0.232604, 0.231194, 0.227117, 0.231152, 
<span class="lineNum">    2215 </span>            : 0.282140, 0.229778, 0.232631, 0.261794, 0.216633, 0.253471, 
<span class="lineNum">    2216 </span>            : 0.242157, 0.227406, 0.269335, 0.230547, 0.210618, 0.285872, 
<span class="lineNum">    2217 </span>            : 0.248776, 0.229875, 0.242728, 0.227388, 0.220567, 0.222062, 
<span class="lineNum">    2218 </span>            : 0.235950, 0.224087, 0.228895, 0.208287, 0.235999, 0.208696, 
<span class="lineNum">    2219 </span>            : 0.230367, 0.267667, 0.220484, 0.233402, 0.233815, 0.250455, 
<span class="lineNum">    2220 </span>            : 0.253120, 0.219556, 0.230980, 0.236661, 0.222395, 0.226111, 
<span class="lineNum">    2221 </span>            : 0.198315, 0.210555, 0.202813, 0.208594, 0.235976, 0.221490, 
<span class="lineNum">    2222 </span>            : 0.243059, 0.204901, 0.216987, 0.229039, 0.231466, 0.221975, 
<span class="lineNum">    2223 </span>            : 0.231220, 0.253638, 0.250448, 0.260291, 0.328345, 0.205739, 
<span class="lineNum">    2224 </span>            : 0.222014, 0.251513, 0.279427, 0.270506, 0.248409, 0.222472, 
<span class="lineNum">    2225 </span>            : 0.291632, 0.227796, 0.248769, 0.276896, 0.214742, 0.200139, 
<span class="lineNum">    2226 </span>            : 0.230693, 0.226031, 0.268900, 0.185160, 0.245353, 0.205843, 
<span class="lineNum">    2227 </span>            : 0.231155, 0.219122, 0.214811, 0.199763, 0.274179, 0.217598, 
<span class="lineNum">    2228 </span>            : 0.274988, 0.237244, 0.211820, 0.225459, 0.252799, 0.235948, 
<span class="lineNum">    2229 </span>            : 0.224986, 0.245385, 0.237770, 0.213373, 0.229737, 0.215487, 
<span class="lineNum">    2230 </span>            : 0.234453, 0.249684, 0.239435, 0.250422, 0.257194, 0.214762, 
<span class="lineNum">    2231 </span>            : 0.212266, 0.228988, 0.253798, 0.201607, 0.239946, 0.205245, 
<span class="lineNum">    2232 </span>            : 0.231670, 0.212774, 0.206768, 0.231563, 0.189388, 0.227926, 
<span class="lineNum">    2233 </span>            : 0.227203, 0.237754, 0.221628, 0.211138, 0.203322, 0.200985, 
<span class="lineNum">    2234 </span>            : 0.231780, 0.220294, 0.232686, 0.234243, 0.218264, 0.255870, 
<span class="lineNum">    2235 </span>            : 0.223213, 0.238670, 0.213713, 0.213064, 0.246700, 0.233446, 
<span class="lineNum">    2236 </span>            : 0.221503, 0.206767, 0.200722, 0.226179, 0.237425, 0.239229, 
<span class="lineNum">    2237 </span>            : 0.238611, 0.240419, 0.247806, 0.215923, 0.205298, 0.232778, 
<span class="lineNum">    2238 </span>            : 0.272312, 0.226773, 0.258103, 0.223287, 0.269404, 0.203398, 
<span class="lineNum">    2239 </span>            : 0.223782, 0.204213, 0.229664, 0.234040, 0.228419, 0.203936, 
<span class="lineNum">    2240 </span>            : 0.263686, 0.199141, 0.236127, 0.214058, 0.204611, 0.224324, 
<span class="lineNum">    2241 </span>            : 0.292140, 0.190735, 0.235157, 0.213018, 0.257085, 0.190554, 
<span class="lineNum">    2242 </span>            : 0.203197, 0.213044, 0.237023, 0.214243, 0.193562, 0.262403, 
<span class="lineNum">    2243 </span>            : 0.206256, 0.221396, 0.233588, 0.256611, 0.249731, 0.226683, 
<span class="lineNum">    2244 </span>            : 0.199330, 0.251026, 0.222596, 0.201941, 0.186374, 0.221038, 
<span class="lineNum">    2245 </span>            : 0.196555, 0.222560, 0.299419, 0.231979, 0.242924, 0.198310, 
<span class="lineNum">    2246 </span>            : 0.217628, 0.235458, 0.278595, 0.218624, 0.277305, 0.239109, 
<span class="lineNum">    2247 </span>            : 0.205600, 0.253715, 0.221173, 0.218195, 0.277647, 0.241974, 
<span class="lineNum">    2248 </span>            : 0.268748, 0.268128, 0.292258, 0.249420, 0.191034, 0.219506, 
<span class="lineNum">    2249 </span>            : 0.216502, 0.250677, 0.193386, 0.201310, 0.259464, 0.255351, 
<span class="lineNum">    2250 </span>            : 0.269628, 0.221063, 0.294079, 0.196726, 0.233634, 0.221870, 
<span class="lineNum">    2251 </span>            : 0.216236, 0.197259, 0.247433, 0.272765, 0.294079, 0.236336, 
<span class="lineNum">    2252 </span>            : 0.206396, 0.238524, 0.247846, 0.269519, 0.237141, 0.230611, 
<span class="lineNum">    2253 </span>            : 0.201712, 0.242225, 0.255565, 0.258738};
<span class="lineNum">    2254 </span><span class="lineNoCov">          0 : wDD = 0.512813;</span>
<span class="lineNum">    2255 </span><span class="lineNoCov">          0 : wND = 0.518820;</span>
<span class="lineNum">    2256 </span><span class="lineNoCov">          0 : wSD = -1;</span>
<span class="lineNum">    2257 </span>            : 
<span class="lineNum">    2258 </span><span class="lineNoCov">          0 :     Mmin = bin[0];</span>
<span class="lineNum">    2259 </span><span class="lineNoCov">          0 :     Mmax = bin[nbin];</span>
<span class="lineNum">    2260 </span><span class="lineNoCov">          0 :     if(M&lt;Mmin || M&gt;Mmax) return kTRUE;</span>
<span class="lineNum">    2261 </span>            : 
<span class="lineNum">    2262 </span>            :     Int_t ibin=nbin-1;
<span class="lineNum">    2263 </span><span class="lineNoCov">          0 :     for(Int_t i=1; i&lt;=nbin; i++) </span>
<span class="lineNum">    2264 </span><span class="lineNoCov">          0 :       if(M&lt;=bin[i]) {</span>
<span class="lineNum">    2265 </span><span class="lineNoCov">          0 :         ibin=i-1;</span>
<span class="lineNum">    2266 </span>            :         //      printf(&quot;Mi&gt; %f &amp;&amp; Mi&lt; %f\n&quot;, bin[i-1], bin[i]);
<span class="lineNum">    2267 </span><span class="lineNoCov">          0 :         break;</span>
<span class="lineNum">    2268 </span>            :       }
<span class="lineNum">    2269 </span><span class="lineNoCov">          0 :     wSD=w[ibin];</span>
<span class="lineNum">    2270 </span>            :     return kTRUE;
<span class="lineNum">    2271 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">    2272 </span>            : 
<span class="lineNum">    2273 </span>            : 
<span class="lineNum">    2274 </span><span class="lineNoCov">          0 :   else if(TMath::Abs(fEnergyCMS-7000)&lt;1 ){</span>
<span class="lineNum">    2275 </span>            : const Int_t nbin=400;
<span class="lineNum">    2276 </span><span class="lineNoCov">          0 : Double_t bin[]={</span>
<span class="lineNum">    2277 </span>            : 1.080000, 1.577300, 2.074600, 2.571900, 3.069200, 3.566500, 
<span class="lineNum">    2278 </span>            : 4.063800, 4.561100, 5.058400, 5.555700, 6.053000, 6.550300, 
<span class="lineNum">    2279 </span>            : 7.047600, 7.544900, 8.042200, 8.539500, 9.036800, 9.534100, 
<span class="lineNum">    2280 </span>            : 10.031400, 10.528700, 11.026000, 11.523300, 12.020600, 12.517900, 
<span class="lineNum">    2281 </span>            : 13.015200, 13.512500, 14.009800, 14.507100, 15.004400, 15.501700, 
<span class="lineNum">    2282 </span>            : 15.999000, 16.496300, 16.993600, 17.490900, 17.988200, 18.485500, 
<span class="lineNum">    2283 </span>            : 18.982800, 19.480100, 19.977400, 20.474700, 20.972000, 21.469300, 
<span class="lineNum">    2284 </span>            : 21.966600, 22.463900, 22.961200, 23.458500, 23.955800, 24.453100, 
<span class="lineNum">    2285 </span>            : 24.950400, 25.447700, 25.945000, 26.442300, 26.939600, 27.436900, 
<span class="lineNum">    2286 </span>            : 27.934200, 28.431500, 28.928800, 29.426100, 29.923400, 30.420700, 
<span class="lineNum">    2287 </span>            : 30.918000, 31.415300, 31.912600, 32.409900, 32.907200, 33.404500, 
<span class="lineNum">    2288 </span>            : 33.901800, 34.399100, 34.896400, 35.393700, 35.891000, 36.388300, 
<span class="lineNum">    2289 </span>            : 36.885600, 37.382900, 37.880200, 38.377500, 38.874800, 39.372100, 
<span class="lineNum">    2290 </span>            : 39.869400, 40.366700, 40.864000, 41.361300, 41.858600, 42.355900, 
<span class="lineNum">    2291 </span>            : 42.853200, 43.350500, 43.847800, 44.345100, 44.842400, 45.339700, 
<span class="lineNum">    2292 </span>            : 45.837000, 46.334300, 46.831600, 47.328900, 47.826200, 48.323500, 
<span class="lineNum">    2293 </span>            : 48.820800, 49.318100, 49.815400, 50.312700, 50.810000, 51.307300, 
<span class="lineNum">    2294 </span>            : 51.804600, 52.301900, 52.799200, 53.296500, 53.793800, 54.291100, 
<span class="lineNum">    2295 </span>            : 54.788400, 55.285700, 55.783000, 56.280300, 56.777600, 57.274900, 
<span class="lineNum">    2296 </span>            : 57.772200, 58.269500, 58.766800, 59.264100, 59.761400, 60.258700, 
<span class="lineNum">    2297 </span>            : 60.756000, 61.253300, 61.750600, 62.247900, 62.745200, 63.242500, 
<span class="lineNum">    2298 </span>            : 63.739800, 64.237100, 64.734400, 65.231700, 65.729000, 66.226300, 
<span class="lineNum">    2299 </span>            : 66.723600, 67.220900, 67.718200, 68.215500, 68.712800, 69.210100, 
<span class="lineNum">    2300 </span>            : 69.707400, 70.204700, 70.702000, 71.199300, 71.696600, 72.193900, 
<span class="lineNum">    2301 </span>            : 72.691200, 73.188500, 73.685800, 74.183100, 74.680400, 75.177700, 
<span class="lineNum">    2302 </span>            : 75.675000, 76.172300, 76.669600, 77.166900, 77.664200, 78.161500, 
<span class="lineNum">    2303 </span>            : 78.658800, 79.156100, 79.653400, 80.150700, 80.648000, 81.145300, 
<span class="lineNum">    2304 </span>            : 81.642600, 82.139900, 82.637200, 83.134500, 83.631800, 84.129100, 
<span class="lineNum">    2305 </span>            : 84.626400, 85.123700, 85.621000, 86.118300, 86.615600, 87.112900, 
<span class="lineNum">    2306 </span>            : 87.610200, 88.107500, 88.604800, 89.102100, 89.599400, 90.096700, 
<span class="lineNum">    2307 </span>            : 90.594000, 91.091300, 91.588600, 92.085900, 92.583200, 93.080500, 
<span class="lineNum">    2308 </span>            : 93.577800, 94.075100, 94.572400, 95.069700, 95.567000, 96.064300, 
<span class="lineNum">    2309 </span>            : 96.561600, 97.058900, 97.556200, 98.053500, 98.550800, 99.048100, 
<span class="lineNum">    2310 </span>            : 99.545400, 100.042700, 100.540000, 101.037300, 101.534600, 102.031900, 
<span class="lineNum">    2311 </span>            : 102.529200, 103.026500, 103.523800, 104.021100, 104.518400, 105.015700, 
<span class="lineNum">    2312 </span>            : 105.513000, 106.010300, 106.507600, 107.004900, 107.502200, 107.999500, 
<span class="lineNum">    2313 </span>            : 108.496800, 108.994100, 109.491400, 109.988700, 110.486000, 110.983300, 
<span class="lineNum">    2314 </span>            : 111.480600, 111.977900, 112.475200, 112.972500, 113.469800, 113.967100, 
<span class="lineNum">    2315 </span>            : 114.464400, 114.961700, 115.459000, 115.956300, 116.453600, 116.950900, 
<span class="lineNum">    2316 </span>            : 117.448200, 117.945500, 118.442800, 118.940100, 119.437400, 119.934700, 
<span class="lineNum">    2317 </span>            : 120.432000, 120.929300, 121.426600, 121.923900, 122.421200, 122.918500, 
<span class="lineNum">    2318 </span>            : 123.415800, 123.913100, 124.410400, 124.907700, 125.405000, 125.902300, 
<span class="lineNum">    2319 </span>            : 126.399600, 126.896900, 127.394200, 127.891500, 128.388800, 128.886100, 
<span class="lineNum">    2320 </span>            : 129.383400, 129.880700, 130.378000, 130.875300, 131.372600, 131.869900, 
<span class="lineNum">    2321 </span>            : 132.367200, 132.864500, 133.361800, 133.859100, 134.356400, 134.853700, 
<span class="lineNum">    2322 </span>            : 135.351000, 135.848300, 136.345600, 136.842900, 137.340200, 137.837500, 
<span class="lineNum">    2323 </span>            : 138.334800, 138.832100, 139.329400, 139.826700, 140.324000, 140.821300, 
<span class="lineNum">    2324 </span>            : 141.318600, 141.815900, 142.313200, 142.810500, 143.307800, 143.805100, 
<span class="lineNum">    2325 </span>            : 144.302400, 144.799700, 145.297000, 145.794300, 146.291600, 146.788900, 
<span class="lineNum">    2326 </span>            : 147.286200, 147.783500, 148.280800, 148.778100, 149.275400, 149.772700, 
<span class="lineNum">    2327 </span>            : 150.270000, 150.767300, 151.264600, 151.761900, 152.259200, 152.756500, 
<span class="lineNum">    2328 </span>            : 153.253800, 153.751100, 154.248400, 154.745700, 155.243000, 155.740300, 
<span class="lineNum">    2329 </span>            : 156.237600, 156.734900, 157.232200, 157.729500, 158.226800, 158.724100, 
<span class="lineNum">    2330 </span>            : 159.221400, 159.718700, 160.216000, 160.713300, 161.210600, 161.707900, 
<span class="lineNum">    2331 </span>            : 162.205200, 162.702500, 163.199800, 163.697100, 164.194400, 164.691700, 
<span class="lineNum">    2332 </span>            : 165.189000, 165.686300, 166.183600, 166.680900, 167.178200, 167.675500, 
<span class="lineNum">    2333 </span>            : 168.172800, 168.670100, 169.167400, 169.664700, 170.162000, 170.659300, 
<span class="lineNum">    2334 </span>            : 171.156600, 171.653900, 172.151200, 172.648500, 173.145800, 173.643100, 
<span class="lineNum">    2335 </span>            : 174.140400, 174.637700, 175.135000, 175.632300, 176.129600, 176.626900, 
<span class="lineNum">    2336 </span>            : 177.124200, 177.621500, 178.118800, 178.616100, 179.113400, 179.610700, 
<span class="lineNum">    2337 </span>            : 180.108000, 180.605300, 181.102600, 181.599900, 182.097200, 182.594500, 
<span class="lineNum">    2338 </span>            : 183.091800, 183.589100, 184.086400, 184.583700, 185.081000, 185.578300, 
<span class="lineNum">    2339 </span>            : 186.075600, 186.572900, 187.070200, 187.567500, 188.064800, 188.562100, 
<span class="lineNum">    2340 </span>            : 189.059400, 189.556700, 190.054000, 190.551300, 191.048600, 191.545900, 
<span class="lineNum">    2341 </span>            : 192.043200, 192.540500, 193.037800, 193.535100, 194.032400, 194.529700, 
<span class="lineNum">    2342 </span>            : 195.027000, 195.524300, 196.021600, 196.518900, 197.016200, 197.513500, 
<span class="lineNum">    2343 </span>            : 198.010800, 198.508100, 199.005400, 199.502700, 200.000000};
<span class="lineNum">    2344 </span><span class="lineNoCov">          0 : Double_t w[]={</span>
<span class="lineNum">    2345 </span>            : 1.000000, 0.798640, 0.770197, 0.717990, 0.699434, 0.692093, 
<span class="lineNum">    2346 </span>            : 0.620940, 0.655294, 0.636496, 0.633483, 0.600518, 0.594548, 
<span class="lineNum">    2347 </span>            : 0.550759, 0.550413, 0.528926, 0.525877, 0.506701, 0.504117, 
<span class="lineNum">    2348 </span>            : 0.486973, 0.492930, 0.461833, 0.488695, 0.438874, 0.460274, 
<span class="lineNum">    2349 </span>            : 0.451551, 0.454424, 0.449270, 0.387571, 0.427556, 0.428740, 
<span class="lineNum">    2350 </span>            : 0.401682, 0.402260, 0.408961, 0.395417, 0.387426, 0.378602, 
<span class="lineNum">    2351 </span>            : 0.357826, 0.359125, 0.348494, 0.363710, 0.356117, 0.340363, 
<span class="lineNum">    2352 </span>            : 0.337637, 0.396084, 0.341777, 0.340551, 0.348838, 0.344014, 
<span class="lineNum">    2353 </span>            : 0.340468, 0.317654, 0.355584, 0.326023, 0.373416, 0.312298, 
<span class="lineNum">    2354 </span>            : 0.326522, 0.290540, 0.335557, 0.318689, 0.327544, 0.319501, 
<span class="lineNum">    2355 </span>            : 0.331754, 0.312728, 0.282263, 0.274937, 0.303867, 0.307820, 
<span class="lineNum">    2356 </span>            : 0.289344, 0.268934, 0.288908, 0.290018, 0.291369, 0.295242, 
<span class="lineNum">    2357 </span>            : 0.289067, 0.277685, 0.267957, 0.267559, 0.320229, 0.265060, 
<span class="lineNum">    2358 </span>            : 0.305931, 0.305352, 0.262064, 0.281879, 0.287780, 0.270033, 
<span class="lineNum">    2359 </span>            : 0.270814, 0.276667, 0.271531, 0.275283, 0.258189, 0.287969, 
<span class="lineNum">    2360 </span>            : 0.251247, 0.301527, 0.267230, 0.245860, 0.293125, 0.253421, 
<span class="lineNum">    2361 </span>            : 0.272396, 0.243637, 0.236206, 0.278452, 0.246544, 0.263165, 
<span class="lineNum">    2362 </span>            : 0.230484, 0.231102, 0.258281, 0.244707, 0.270111, 0.248295, 
<span class="lineNum">    2363 </span>            : 0.246942, 0.245592, 0.272766, 0.254243, 0.199647, 0.262590, 
<span class="lineNum">    2364 </span>            : 0.226710, 0.243836, 0.214153, 0.233535, 0.235207, 0.234245, 
<span class="lineNum">    2365 </span>            : 0.247698, 0.248379, 0.241463, 0.265230, 0.223242, 0.236191, 
<span class="lineNum">    2366 </span>            : 0.252700, 0.231865, 0.228352, 0.229101, 0.237385, 0.246485, 
<span class="lineNum">    2367 </span>            : 0.254706, 0.245565, 0.224841, 0.257301, 0.240968, 0.202379, 
<span class="lineNum">    2368 </span>            : 0.236943, 0.241683, 0.220809, 0.219014, 0.213015, 0.244470, 
<span class="lineNum">    2369 </span>            : 0.221042, 0.198996, 0.225295, 0.264466, 0.200600, 0.228143, 
<span class="lineNum">    2370 </span>            : 0.250138, 0.216784, 0.268002, 0.275734, 0.218144, 0.229866, 
<span class="lineNum">    2371 </span>            : 0.235443, 0.208909, 0.215067, 0.189743, 0.216741, 0.242686, 
<span class="lineNum">    2372 </span>            : 0.200234, 0.218882, 0.245991, 0.222815, 0.219576, 0.209773, 
<span class="lineNum">    2373 </span>            : 0.205247, 0.203855, 0.202534, 0.192536, 0.223447, 0.225810, 
<span class="lineNum">    2374 </span>            : 0.220583, 0.248421, 0.223424, 0.206033, 0.203130, 0.221225, 
<span class="lineNum">    2375 </span>            : 0.223763, 0.239216, 0.252311, 0.206893, 0.228461, 0.233591, 
<span class="lineNum">    2376 </span>            : 0.201512, 0.242382, 0.215147, 0.232578, 0.207116, 0.239213, 
<span class="lineNum">    2377 </span>            : 0.196215, 0.184367, 0.235135, 0.189768, 0.274084, 0.206267, 
<span class="lineNum">    2378 </span>            : 0.203283, 0.248828, 0.250214, 0.217465, 0.232080, 0.215150, 
<span class="lineNum">    2379 </span>            : 0.207936, 0.176789, 0.191338, 0.188655, 0.196181, 0.223691, 
<span class="lineNum">    2380 </span>            : 0.254257, 0.216874, 0.213536, 0.221399, 0.192024, 0.212534, 
<span class="lineNum">    2381 </span>            : 0.218169, 0.226635, 0.201191, 0.212700, 0.211634, 0.232353, 
<span class="lineNum">    2382 </span>            : 0.223636, 0.208605, 0.249132, 0.183681, 0.221842, 0.187136, 
<span class="lineNum">    2383 </span>            : 0.203772, 0.249575, 0.217713, 0.205193, 0.193941, 0.219707, 
<span class="lineNum">    2384 </span>            : 0.264226, 0.182105, 0.207183, 0.220845, 0.236571, 0.182390, 
<span class="lineNum">    2385 </span>            : 0.212914, 0.186266, 0.195361, 0.217665, 0.204527, 0.188804, 
<span class="lineNum">    2386 </span>            : 0.222832, 0.191193, 0.201073, 0.185616, 0.195011, 0.200828, 
<span class="lineNum">    2387 </span>            : 0.181434, 0.233707, 0.202925, 0.211992, 0.173100, 0.205258, 
<span class="lineNum">    2388 </span>            : 0.182695, 0.216520, 0.218422, 0.209490, 0.211257, 0.215801, 
<span class="lineNum">    2389 </span>            : 0.220652, 0.211409, 0.195731, 0.194957, 0.198888, 0.234926, 
<span class="lineNum">    2390 </span>            : 0.221377, 0.229822, 0.176700, 0.172322, 0.212265, 0.206133, 
<span class="lineNum">    2391 </span>            : 0.170355, 0.253305, 0.198688, 0.240043, 0.225384, 0.174729, 
<span class="lineNum">    2392 </span>            : 0.195820, 0.200093, 0.196912, 0.212308, 0.200490, 0.240415, 
<span class="lineNum">    2393 </span>            : 0.159744, 0.173686, 0.223853, 0.213604, 0.193779, 0.179328, 
<span class="lineNum">    2394 </span>            : 0.180873, 0.237481, 0.179640, 0.235857, 0.202847, 0.167690, 
<span class="lineNum">    2395 </span>            : 0.245093, 0.215504, 0.205848, 0.184408, 0.201626, 0.209651, 
<span class="lineNum">    2396 </span>            : 0.236306, 0.217803, 0.188534, 0.187861, 0.161663, 0.221718, 
<span class="lineNum">    2397 </span>            : 0.152044, 0.190412, 0.173505, 0.208995, 0.174575, 0.180734, 
<span class="lineNum">    2398 </span>            : 0.247704, 0.203388, 0.194184, 0.169679, 0.182703, 0.213402, 
<span class="lineNum">    2399 </span>            : 0.191808, 0.178604, 0.178116, 0.198452, 0.174687, 0.169809, 
<span class="lineNum">    2400 </span>            : 0.222851, 0.156811, 0.229170, 0.210359, 0.178557, 0.248570, 
<span class="lineNum">    2401 </span>            : 0.208536, 0.192571, 0.178912, 0.224505, 0.170822, 0.205492, 
<span class="lineNum">    2402 </span>            : 0.330973, 0.160924, 0.203724, 0.213255, 0.205827, 0.187162, 
<span class="lineNum">    2403 </span>            : 0.181252, 0.191723, 0.238106, 0.182398, 0.202358, 0.212066, 
<span class="lineNum">    2404 </span>            : 0.201255, 0.168159, 0.185219, 0.229176, 0.158222, 0.164092, 
<span class="lineNum">    2405 </span>            : 0.215405, 0.200724, 0.234811, 0.184488, 0.213112, 0.198577, 
<span class="lineNum">    2406 </span>            : 0.219622, 0.160671, 0.179349, 0.206681, 0.206091, 0.165618, 
<span class="lineNum">    2407 </span>            : 0.165203, 0.174442, 0.179287, 0.187318, 0.163481, 0.217440, 
<span class="lineNum">    2408 </span>            : 0.160381, 0.177025, 0.204385, 0.163676, 0.210733, 0.186519, 
<span class="lineNum">    2409 </span>            : 0.230701, 0.191764, 0.185119, 0.190770, 0.242987, 0.186812, 
<span class="lineNum">    2410 </span>            : 0.202906, 0.161935, 0.182426, 0.197922, 0.181475, 0.155903, 
<span class="lineNum">    2411 </span>            : 0.175006, 0.223482, 0.202706, 0.218108};
<span class="lineNum">    2412 </span><span class="lineNoCov">          0 : wDD = 0.207705;</span>
<span class="lineNum">    2413 </span><span class="lineNoCov">          0 : wND = 0.289628;</span>
<span class="lineNum">    2414 </span><span class="lineNoCov">          0 : wSD = -1;</span>
<span class="lineNum">    2415 </span>            : 
<span class="lineNum">    2416 </span><span class="lineNoCov">          0 :     Mmin = bin[0];</span>
<span class="lineNum">    2417 </span><span class="lineNoCov">          0 :     Mmax = bin[nbin];</span>
<span class="lineNum">    2418 </span>            : 
<span class="lineNum">    2419 </span><span class="lineNoCov">          0 :     if(M&lt;Mmin || M&gt;Mmax) return kTRUE;</span>
<span class="lineNum">    2420 </span>            : 
<span class="lineNum">    2421 </span>            :     Int_t ibin=nbin-1;
<span class="lineNum">    2422 </span><span class="lineNoCov">          0 :     for(Int_t i=1; i&lt;=nbin; i++) </span>
<span class="lineNum">    2423 </span><span class="lineNoCov">          0 :       if(M&lt;=bin[i]) {</span>
<span class="lineNum">    2424 </span><span class="lineNoCov">          0 :         ibin=i-1;</span>
<span class="lineNum">    2425 </span>            :         //      printf(&quot;Mi&gt; %f &amp;&amp; Mi&lt; %f\n&quot;, bin[i-1], bin[i]);
<span class="lineNum">    2426 </span><span class="lineNoCov">          0 :         break;</span>
<span class="lineNum">    2427 </span>            :       }
<span class="lineNum">    2428 </span><span class="lineNoCov">          0 :     wSD=w[ibin];</span>
<span class="lineNum">    2429 </span>            :     return kTRUE;
<span class="lineNum">    2430 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">    2431 </span>            : 
<span class="lineNum">    2432 </span><span class="lineNoCov">          0 :   return kFALSE;</span>
<a name="2433"><span class="lineNum">    2433 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    2434 </span>            : 
<span class="lineNum">    2435 </span>            : Bool_t AliGenPythia::IsFromHeavyFlavor(Int_t ipart)
<span class="lineNum">    2436 </span>            : {
<span class="lineNum">    2437 </span>            : // Check if this is a heavy flavor decay product
<span class="lineNum">    2438 </span><span class="lineNoCov">          0 :   TParticle *  part = (TParticle *) fParticles.At(ipart);</span>
<span class="lineNum">    2439 </span><span class="lineNoCov">          0 :   Int_t mpdg = TMath::Abs(part-&gt;GetPdgCode());</span>
<span class="lineNum">    2440 </span><span class="lineNoCov">          0 :   Int_t mfl  = Int_t (mpdg / TMath::Power(10, Int_t(TMath::Log10(mpdg))));</span>
<span class="lineNum">    2441 </span>            :   //
<span class="lineNum">    2442 </span>            :   // Light hadron
<span class="lineNum">    2443 </span><span class="lineNoCov">          0 :   if (mfl &gt;= 4 &amp;&amp; mfl &lt; 6) return kTRUE;</span>
<span class="lineNum">    2444 </span>            :   
<span class="lineNum">    2445 </span><span class="lineNoCov">          0 :   Int_t imo = part-&gt;GetFirstMother()-1;</span>
<span class="lineNum">    2446 </span>            :   TParticle* pm = part;
<span class="lineNum">    2447 </span>            :   //
<span class="lineNum">    2448 </span>            :   // Heavy flavor hadron produced by generator
<span class="lineNum">    2449 </span><span class="lineNoCov">          0 :   while (imo &gt;  -1) {</span>
<span class="lineNum">    2450 </span><span class="lineNoCov">          0 :     pm  =  (TParticle*)fParticles.At(imo);</span>
<span class="lineNum">    2451 </span><span class="lineNoCov">          0 :     mpdg = TMath::Abs(pm-&gt;GetPdgCode());</span>
<span class="lineNum">    2452 </span><span class="lineNoCov">          0 :     mfl  = Int_t (mpdg / TMath::Power(10, Int_t(TMath::Log10(mpdg))));</span>
<span class="lineNum">    2453 </span><span class="lineNoCov">          0 :     if ((mfl &gt; 3) &amp;&amp; (mfl &lt;6) &amp;&amp; mpdg &gt; 400) return kTRUE;</span>
<span class="lineNum">    2454 </span><span class="lineNoCov">          0 :     imo = pm-&gt;GetFirstMother()-1;</span>
<span class="lineNum">    2455 </span>            :   }
<span class="lineNum">    2456 </span><span class="lineNoCov">          0 :   return kFALSE;</span>
<a name="2457"><span class="lineNum">    2457 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    2458 </span>            : 
<span class="lineNum">    2459 </span>            : Bool_t AliGenPythia::CheckDetectorAcceptance(Float_t phi, Float_t eta, Int_t iparticle)
<span class="lineNum">    2460 </span>            : {
<span class="lineNum">    2461 </span>            :   // check the eta/phi correspond to the detectors acceptance
<span class="lineNum">    2462 </span>            :   // iparticle is the index of the particle to be checked, for PHOS rotation case
<span class="lineNum">    2463 </span><span class="lineNoCov">          0 :   if     (fCheckPHOS   &amp;&amp; IsInPHOS  (phi,eta,iparticle)) return kTRUE;</span>
<span class="lineNum">    2464 </span><span class="lineNoCov">          0 :   else if(fCheckEMCAL  &amp;&amp; IsInEMCAL (phi,eta)) return kTRUE;</span>
<span class="lineNum">    2465 </span><span class="lineNoCov">          0 :   else if(fCheckBarrel &amp;&amp; IsInBarrel(    eta)) return kTRUE;</span>
<span class="lineNum">    2466 </span><span class="lineNoCov">          0 :   else                                         return kFALSE;</span>
<a name="2467"><span class="lineNum">    2467 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    2468 </span>            : 
<span class="lineNum">    2469 </span>            : Bool_t AliGenPythia::TriggerOnSelectedParticles(Int_t np)
<span class="lineNum">    2470 </span>            : {
<span class="lineNum">    2471 </span>            :   // Select events with fragmentation photon, decay photon, pi0, eta or other hadrons going to PHOS or EMCAL or central barrel,
<span class="lineNum">    2472 </span>            :   // implemented primaryly for kPyJets, but extended to any kind of process.
<span class="lineNum">    2473 </span>            :   
<span class="lineNum">    2474 </span>            :   //printf(&quot;Check: frag photon %d, pi0 %d, eta %d, electron %d, hadron %d, decay %d, PHOS %d, EMCAL %d, Barrel %d \n&quot;,
<span class="lineNum">    2475 </span>            :   //       fFragPhotonInCalo,fPi0InCalo, fEtaInCalo,fEleInCalo,fHadronInCalo,fDecayPhotonInCalo,fCheckPHOS,fCheckEMCAL, fCheckBarrel); 
<span class="lineNum">    2476 </span>            :   
<span class="lineNum">    2477 </span><span class="lineNoCov">          0 :   Bool_t ok = kFALSE;</span>
<span class="lineNum">    2478 </span><span class="lineNoCov">          0 :   for (Int_t i=0; i&lt; np; i++) {</span>
<span class="lineNum">    2479 </span>            :     
<span class="lineNum">    2480 </span><span class="lineNoCov">          0 :     TParticle* iparticle = (TParticle *) fParticles.At(i);</span>
<span class="lineNum">    2481 </span>            :     
<span class="lineNum">    2482 </span><span class="lineNoCov">          0 :     Int_t pdg          = iparticle-&gt;GetPdgCode();</span>
<span class="lineNum">    2483 </span><span class="lineNoCov">          0 :     Int_t status       = iparticle-&gt;GetStatusCode();</span>
<span class="lineNum">    2484 </span><span class="lineNoCov">          0 :     Int_t imother      = iparticle-&gt;GetFirstMother() - 1;</span>
<span class="lineNum">    2485 </span>            :     
<span class="lineNum">    2486 </span>            :     TParticle* pmother = 0x0;
<span class="lineNum">    2487 </span>            :     Int_t momStatus    = -1;
<span class="lineNum">    2488 </span>            :     Int_t momPdg       = -1;
<span class="lineNum">    2489 </span><span class="lineNoCov">          0 :     if(imother &gt; 0 ){  </span>
<span class="lineNum">    2490 </span><span class="lineNoCov">          0 :       pmother = (TParticle *) fParticles.At(imother);</span>
<span class="lineNum">    2491 </span><span class="lineNoCov">          0 :       momStatus    = pmother-&gt;GetStatusCode();</span>
<span class="lineNum">    2492 </span><span class="lineNoCov">          0 :       momPdg       = pmother-&gt;GetPdgCode();</span>
<span class="lineNum">    2493 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">    2494 </span>            :     
<span class="lineNum">    2495 </span><span class="lineNoCov">          0 :     ok = kFALSE;</span>
<span class="lineNum">    2496 </span>            :     
<span class="lineNum">    2497 </span>            :     //
<span class="lineNum">    2498 </span>            :     // Check the particle type: hadron (not pi0 or eta), electron, decay photon (from pi0 or eta or any), pi0 or eta
<span class="lineNum">    2499 </span>            :     //
<span class="lineNum">    2500 </span>            :     // Hadron
<span class="lineNum">    2501 </span><span class="lineNoCov">          0 :     if (fHadronInCalo &amp;&amp; status == 1)</span>
<span class="lineNum">    2502 </span>            :     {
<span class="lineNum">    2503 </span><span class="lineNoCov">          0 :       if(TMath::Abs(pdg) &gt; 23 &amp;&amp; pdg !=221 &amp;&amp; pdg != 111) // avoid photons, electrons, muons, neutrinos and eta or pi0 </span>
<span class="lineNum">    2504 </span>            :         // (in case neutral mesons were declared stable)
<span class="lineNum">    2505 </span><span class="lineNoCov">          0 :         ok = kTRUE;</span>
<span class="lineNum">    2506 </span>            :     }
<span class="lineNum">    2507 </span>            :     //Electron
<span class="lineNum">    2508 </span><span class="lineNoCov">          0 :     else if (fEleInCalo &amp;&amp; status == 1 &amp;&amp; TMath::Abs(pdg) == 11)</span>
<span class="lineNum">    2509 </span>            :     {
<span class="lineNum">    2510 </span><span class="lineNoCov">          0 :         ok = kTRUE;</span>
<span class="lineNum">    2511 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">    2512 </span>            :     //Fragmentation photon
<span class="lineNum">    2513 </span><span class="lineNoCov">          0 :     else if (fFragPhotonInCalo &amp;&amp; pdg == 22 &amp;&amp; status == 1)</span>
<span class="lineNum">    2514 </span>            :     {        
<span class="lineNum">    2515 </span><span class="lineNoCov">          0 :       if(momStatus != 11) ok = kTRUE ;  // No photon from hadron decay</span>
<span class="lineNum">    2516 </span>            :     }
<span class="lineNum">    2517 </span>            :     // Decay photon
<span class="lineNum">    2518 </span><span class="lineNoCov">          0 :     else if (fDecayPhotonInCalo &amp;&amp; !fForceNeutralMeson2PhotonDecay &amp;&amp; pdg == 22) // pi0 status can be 1 or 11 depending on decay settings, work only for 11</span>
<span class="lineNum">    2519 </span>            :     {              
<span class="lineNum">    2520 </span><span class="lineNoCov">          0 :       if( momStatus == 11)</span>
<span class="lineNum">    2521 </span>            :       {
<span class="lineNum">    2522 </span>            :         //if(iparticle-&gt;Pt() &gt; fTriggerParticleMinPt) printf(&quot;Decay photon! pdg %d, status %d, pt %2.2f, mom: pdg %d, pt %2.2f\n&quot;,
<span class="lineNum">    2523 </span>            :         //                                                   pdg,status,iparticle-&gt;Pt(),momPdg,pmother-&gt;Pt());
<span class="lineNum">    2524 </span><span class="lineNoCov">          0 :         ok = kTRUE ;  // photon from hadron decay</span>
<span class="lineNum">    2525 </span>            :         
<span class="lineNum">    2526 </span>            :         //In case only decays from pi0 or eta requested
<span class="lineNum">    2527 </span><span class="lineNoCov">          0 :         if(fPi0InCalo &amp;&amp; momPdg!=111) ok = kFALSE;</span>
<span class="lineNum">    2528 </span><span class="lineNoCov">          0 :         if(fEtaInCalo &amp;&amp; momPdg!=221) ok = kFALSE;</span>
<span class="lineNum">    2529 </span>            :       }
<span class="lineNum">    2530 </span>            : 
<span class="lineNum">    2531 </span>            :     }
<span class="lineNum">    2532 </span>            :     // Pi0 or Eta particle
<span class="lineNum">    2533 </span><span class="lineNoCov">          0 :     else if ((fPi0InCalo || fEtaInCalo))</span>
<span class="lineNum">    2534 </span>            :     {
<span class="lineNum">    2535 </span><span class="lineNoCov">          0 :       if(fDecayPhotonInCalo &amp;&amp; !fForceNeutralMeson2PhotonDecay ) continue ;</span>
<span class="lineNum">    2536 </span>            :       
<span class="lineNum">    2537 </span><span class="lineNoCov">          0 :       if (fPi0InCalo &amp;&amp; pdg == 111) // pi0 status can be 1 or 11 depending on decay settings</span>
<span class="lineNum">    2538 </span>            :       {
<span class="lineNum">    2539 </span>            :         //if(iparticle-&gt;Pt() &gt; fTriggerParticleMinPt) printf(&quot;Pi0! pdg %d, status %d, pt %2.2f\n&quot;,pdg,status,iparticle-&gt;Pt());
<span class="lineNum">    2540 </span><span class="lineNoCov">          0 :         ok = kTRUE;</span>
<span class="lineNum">    2541 </span><span class="lineNoCov">          0 :       }      </span>
<span class="lineNum">    2542 </span><span class="lineNoCov">          0 :       else if (fEtaInCalo &amp;&amp; pdg == 221) </span>
<span class="lineNum">    2543 </span>            :       {
<span class="lineNum">    2544 </span>            :         //if(iparticle-&gt;Pt() &gt; fTriggerParticleMinPt) printf(&quot;Eta! pdg %d, status %d, pt %2.2f\n&quot;,pdg,status,iparticle-&gt;Pt());
<span class="lineNum">    2545 </span><span class="lineNoCov">          0 :         ok = kTRUE;</span>
<span class="lineNum">    2546 </span><span class="lineNoCov">          0 :       }</span>
<span class="lineNum">    2547 </span>            :       
<span class="lineNum">    2548 </span>            :     }// pi0 or eta
<span class="lineNum">    2549 </span>            :     
<span class="lineNum">    2550 </span>            :     //
<span class="lineNum">    2551 </span>            :     // Check that the selected particle is in the calorimeter acceptance
<span class="lineNum">    2552 </span>            :     //
<span class="lineNum">    2553 </span><span class="lineNoCov">          0 :     if(ok &amp;&amp; iparticle-&gt;Pt() &gt; fTriggerParticleMinPt)</span>
<span class="lineNum">    2554 </span>            :     {
<span class="lineNum">    2555 </span>            :       //Just check if the selected particle falls in the acceptance
<span class="lineNum">    2556 </span><span class="lineNoCov">          0 :       if(!fForceNeutralMeson2PhotonDecay )</span>
<span class="lineNum">    2557 </span>            :       {
<span class="lineNum">    2558 </span>            :         //printf(&quot;\t Check acceptance! \n&quot;);
<span class="lineNum">    2559 </span><span class="lineNoCov">          0 :         Float_t phi = iparticle-&gt;Phi()*180./TMath::Pi(); //Convert to degrees</span>
<span class="lineNum">    2560 </span><span class="lineNoCov">          0 :         Float_t eta =TMath::Abs(iparticle-&gt;Eta()); //in calos etamin=-etamax   </span>
<span class="lineNum">    2561 </span>            :         
<span class="lineNum">    2562 </span><span class="lineNoCov">          0 :         if(CheckDetectorAcceptance(phi,eta,i))</span>
<span class="lineNum">    2563 </span>            :         {
<span class="lineNum">    2564 </span><span class="lineNoCov">          0 :           ok =kTRUE;</span>
<span class="lineNum">    2565 </span><span class="lineNoCov">          0 :           AliDebug(1,Form(&quot;Selected trigger pdg %d, status %d, pt %2.2f, eta %2.2f, phi %2.2f\n&quot;,pdg,status,iparticle-&gt;Pt(), eta, phi));</span>
<span class="lineNum">    2566 </span>            :           //printf(&quot;\t Accept \n&quot;);
<span class="lineNum">    2567 </span><span class="lineNoCov">          0 :           break;</span>
<span class="lineNum">    2568 </span>            :         }
<span class="lineNum">    2569 </span><span class="lineNoCov">          0 :         else ok = kFALSE;</span>
<span class="lineNum">    2570 </span><span class="lineNoCov">          0 :       }</span>
<span class="lineNum">    2571 </span>            :       //Mesons have several decay modes, select only those decaying into 2 photons
<span class="lineNum">    2572 </span><span class="lineNoCov">          0 :       else if(fForceNeutralMeson2PhotonDecay &amp;&amp; (fPi0InCalo || fEtaInCalo))</span>
<span class="lineNum">    2573 </span>            :       {
<span class="lineNum">    2574 </span>            :         // In case we want the pi0/eta trigger, 
<span class="lineNum">    2575 </span>            :         // check the decay mode (2 photons)
<span class="lineNum">    2576 </span>            :         
<span class="lineNum">    2577 </span>            :         //printf(&quot;\t Force decay 2 gamma\n&quot;);          
<span class="lineNum">    2578 </span>            :         
<span class="lineNum">    2579 </span><span class="lineNoCov">          0 :         Int_t ndaughters = iparticle-&gt;GetNDaughters();</span>
<span class="lineNum">    2580 </span><span class="lineNoCov">          0 :         if(ndaughters != 2){</span>
<span class="lineNum">    2581 </span><span class="lineNoCov">          0 :           ok=kFALSE;</span>
<span class="lineNum">    2582 </span><span class="lineNoCov">          0 :           continue;</span>
<span class="lineNum">    2583 </span>            :         }
<span class="lineNum">    2584 </span>            :         
<span class="lineNum">    2585 </span><span class="lineNoCov">          0 :         TParticle*d1 = (TParticle *) fParticles.At(iparticle-&gt;GetDaughter(0)-1);</span>
<span class="lineNum">    2586 </span><span class="lineNoCov">          0 :         TParticle*d2 = (TParticle *) fParticles.At(iparticle-&gt;GetDaughter(1)-1);</span>
<span class="lineNum">    2587 </span><span class="lineNoCov">          0 :         if(!d1 || !d2) {</span>
<span class="lineNum">    2588 </span><span class="lineNoCov">          0 :           ok=kFALSE;</span>
<span class="lineNum">    2589 </span><span class="lineNoCov">          0 :           continue;</span>
<span class="lineNum">    2590 </span>            :         }
<span class="lineNum">    2591 </span>            :         
<span class="lineNum">    2592 </span>            :         //iparticle-&gt;Print();
<span class="lineNum">    2593 </span>            :         //d1-&gt;Print();
<span class="lineNum">    2594 </span>            :         //d2-&gt;Print();
<span class="lineNum">    2595 </span>            :         
<span class="lineNum">    2596 </span><span class="lineNoCov">          0 :         Int_t pdgD1 = d1-&gt;GetPdgCode();</span>
<span class="lineNum">    2597 </span><span class="lineNoCov">          0 :         Int_t pdgD2 = d2-&gt;GetPdgCode();</span>
<span class="lineNum">    2598 </span>            :         //printf(&quot;\t \t 2 daughters pdg = %d - %d\n&quot;,pdgD1,pdgD2);
<span class="lineNum">    2599 </span>            :         //printf(&quot;mother %d - %d\n&quot;,d1-&gt;GetFirstMother(),d2-&gt;GetFirstMother());
<span class="lineNum">    2600 </span>            :         
<span class="lineNum">    2601 </span><span class="lineNoCov">          0 :         if(pdgD1 != 22  || pdgD2 != 22){ </span>
<span class="lineNum">    2602 </span><span class="lineNoCov">          0 :           ok = kFALSE;</span>
<span class="lineNum">    2603 </span><span class="lineNoCov">          0 :           continue;</span>
<span class="lineNum">    2604 </span>            :         }
<span class="lineNum">    2605 </span>            :         
<span class="lineNum">    2606 </span>            :         //printf(&quot;\t accept decay\n&quot;);
<span class="lineNum">    2607 </span>            :         
<span class="lineNum">    2608 </span>            :         //Trigger on the meson, not on the daughter
<span class="lineNum">    2609 </span><span class="lineNoCov">          0 :         if(!fDecayPhotonInCalo){    </span>
<span class="lineNum">    2610 </span>            :           
<span class="lineNum">    2611 </span><span class="lineNoCov">          0 :           Float_t phi = iparticle-&gt;Phi()*180./TMath::Pi(); //Convert to degrees</span>
<span class="lineNum">    2612 </span><span class="lineNoCov">          0 :           Float_t eta =TMath::Abs(iparticle-&gt;Eta()); //in calos etamin=-etamax       </span>
<span class="lineNum">    2613 </span>            :           
<span class="lineNum">    2614 </span><span class="lineNoCov">          0 :           if(CheckDetectorAcceptance(phi,eta,i))</span>
<span class="lineNum">    2615 </span>            :           {
<span class="lineNum">    2616 </span>            :             //printf(&quot;\t Accept meson pdg %d\n&quot;,pdg);
<span class="lineNum">    2617 </span><span class="lineNoCov">          0 :             ok =kTRUE;</span>
<span class="lineNum">    2618 </span><span class="lineNoCov">          0 :             AliDebug(1,Form(&quot;Selected trigger pdg %d (decay), status %d, pt %2.2f, eta %2.2f, phi %2.2f\n&quot;,pdg,status,iparticle-&gt;Pt(), eta, phi));</span>
<span class="lineNum">    2619 </span><span class="lineNoCov">          0 :             break;</span>
<span class="lineNum">    2620 </span>            :           } else {
<span class="lineNum">    2621 </span><span class="lineNoCov">          0 :             ok=kFALSE;</span>
<span class="lineNum">    2622 </span><span class="lineNoCov">          0 :             continue;</span>
<span class="lineNum">    2623 </span>            :           }
<span class="lineNum">    2624 </span>            :         }
<span class="lineNum">    2625 </span>            :         
<span class="lineNum">    2626 </span>            :         //printf(&quot;Check daughters acceptance\n&quot;);
<span class="lineNum">    2627 </span>            :         
<span class="lineNum">    2628 </span>            :         //Trigger on the meson daughters
<span class="lineNum">    2629 </span>            :         //Photon 1
<span class="lineNum">    2630 </span><span class="lineNoCov">          0 :         Float_t phi = d1-&gt;Phi()*180./TMath::Pi(); //Convert to degrees</span>
<span class="lineNum">    2631 </span><span class="lineNoCov">          0 :         Float_t eta =TMath::Abs(d1-&gt;Eta()); //in calos etamin=-etamax          </span>
<span class="lineNum">    2632 </span><span class="lineNoCov">          0 :         if(d1-&gt;Pt() &gt; fTriggerParticleMinPt)</span>
<span class="lineNum">    2633 </span>            :         {
<span class="lineNum">    2634 </span>            :           //printf(&quot;\t Check acceptance photon 1! \n&quot;);
<span class="lineNum">    2635 </span><span class="lineNoCov">          0 :           if(CheckDetectorAcceptance(phi,eta,i))</span>
<span class="lineNum">    2636 </span>            :           {
<span class="lineNum">    2637 </span>            :             //printf(&quot;\t Accept Photon 1\n&quot;);
<span class="lineNum">    2638 </span><span class="lineNoCov">          0 :             ok =kTRUE;</span>
<span class="lineNum">    2639 </span><span class="lineNoCov">          0 :             AliDebug(1,Form(&quot;Selected trigger pdg %d (decay), status %d, pt %2.2f, eta %2.2f, phi %2.2f\n&quot;,pdg,status,iparticle-&gt;Pt(), eta, phi));</span>
<span class="lineNum">    2640 </span><span class="lineNoCov">          0 :             break;</span>
<span class="lineNum">    2641 </span>            :           }
<span class="lineNum">    2642 </span><span class="lineNoCov">          0 :           else ok = kFALSE;</span>
<span class="lineNum">    2643 </span><span class="lineNoCov">          0 :         } // pt cut</span>
<span class="lineNum">    2644 </span><span class="lineNoCov">          0 :         else  ok = kFALSE;</span>
<span class="lineNum">    2645 </span>            :         
<span class="lineNum">    2646 </span>            :         //Photon 2
<span class="lineNum">    2647 </span><span class="lineNoCov">          0 :         phi = d2-&gt;Phi()*180./TMath::Pi(); //Convert to degrees</span>
<span class="lineNum">    2648 </span><span class="lineNoCov">          0 :         eta =TMath::Abs(d2-&gt;Eta()); //in calos etamin=-etamax        </span>
<span class="lineNum">    2649 </span>            :         
<span class="lineNum">    2650 </span><span class="lineNoCov">          0 :         if(d2-&gt;Pt() &gt; fTriggerParticleMinPt)</span>
<span class="lineNum">    2651 </span>            :         {
<span class="lineNum">    2652 </span>            :           //printf(&quot;\t Check acceptance photon 2! \n&quot;);
<span class="lineNum">    2653 </span><span class="lineNoCov">          0 :           if(CheckDetectorAcceptance(phi,eta,i))</span>
<span class="lineNum">    2654 </span>            :           {
<span class="lineNum">    2655 </span>            :             //printf(&quot;\t Accept Photon 2\n&quot;);
<span class="lineNum">    2656 </span><span class="lineNoCov">          0 :             ok =kTRUE;</span>
<span class="lineNum">    2657 </span><span class="lineNoCov">          0 :             AliDebug(1,Form(&quot;Selected trigger pdg %d (decay), status %d, pt %2.2f, eta %2.2f, phi %2.2f\n&quot;,pdg,status,iparticle-&gt;Pt(), eta, phi));</span>
<span class="lineNum">    2658 </span><span class="lineNoCov">          0 :             break;</span>
<span class="lineNum">    2659 </span>            :           } 
<span class="lineNum">    2660 </span><span class="lineNoCov">          0 :           else ok = kFALSE;         </span>
<span class="lineNum">    2661 </span><span class="lineNoCov">          0 :         } // pt cut</span>
<span class="lineNum">    2662 </span><span class="lineNoCov">          0 :         else ok = kFALSE;</span>
<span class="lineNum">    2663 </span><span class="lineNoCov">          0 :       } // force 2 photon daughters in pi0/eta decays</span>
<span class="lineNum">    2664 </span><span class="lineNoCov">          0 :       else ok = kFALSE;</span>
<span class="lineNum">    2665 </span><span class="lineNoCov">          0 :     } else ok = kFALSE; // check acceptance</span>
<span class="lineNum">    2666 </span><span class="lineNoCov">          0 :   } // primary loop</span>
<span class="lineNum">    2667 </span>            :     
<span class="lineNum">    2668 </span>            :   //
<span class="lineNum">    2669 </span>            :   // If requested, rotate the particles event in phi to enhance/speed PHOS selection
<span class="lineNum">    2670 </span>            :   // A particle passing all trigger conditions except phi position in PHOS, is used as reference
<span class="lineNum">    2671 </span>            :   //
<span class="lineNum">    2672 </span><span class="lineNoCov">          0 :   if(fCheckPHOSeta)</span>
<span class="lineNum">    2673 </span>            :   {
<span class="lineNum">    2674 </span><span class="lineNoCov">          0 :     RotatePhi(ok);</span>
<span class="lineNum">    2675 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">    2676 </span>            :   
<span class="lineNum">    2677 </span><span class="lineNoCov">          0 :   return ok;</span>
<a name="2678"><span class="lineNum">    2678 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">    2679 </span>            : 
<span class="lineNum">    2680 </span>            : void AliGenPythia::SetSeed(UInt_t seed)
<span class="lineNum">    2681 </span>            : {
<span class="lineNum">    2682 </span><span class="lineNoCov">          0 :   GetRandom()-&gt;SetSeed(seed);</span>
<span class="lineNum">    2683 </span><span class="lineNoCov">          0 : }</span>
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.11</a></td></tr>
  </table>
  <br>

</body>
</html>
