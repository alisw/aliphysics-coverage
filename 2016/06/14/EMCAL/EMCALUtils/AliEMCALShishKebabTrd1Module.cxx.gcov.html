<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - coverage.info - EMCAL/EMCALUtils/AliEMCALShishKebabTrd1Module.cxx</title>
  <link rel="stylesheet" type="text/css" href="../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../index.html">top level</a> - <a href="index.html">EMCAL/EMCALUtils</a> - AliEMCALShishKebabTrd1Module.cxx<span style="font-size: 80%;"> (source / <a href="AliEMCALShishKebabTrd1Module.cxx.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">coverage.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">136</td>
            <td class="headerCovTableEntry">199</td>
            <td class="headerCovTableEntryLo">68.3 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2016-06-14 17:26:59</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">13</td>
            <td class="headerCovTableEntry">17</td>
            <td class="headerCovTableEntryMed">76.5 %</td>
          </tr>
          <tr><td><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            : /**************************************************************************</a>
<span class="lineNum">       2 </span>            :  * Copyright(c) 1998-2010, ALICE Experiment at CERN, All rights reserved. *
<span class="lineNum">       3 </span>            :  *                                                                        *
<span class="lineNum">       4 </span>            :  * Author: The ALICE Off-line Project.                                    *
<span class="lineNum">       5 </span>            :  * Contributors are mentioned in the code where appropriate.              *
<span class="lineNum">       6 </span>            :  *                                                                        *
<span class="lineNum">       7 </span>            :  * Permission to use, copy, modify and distribute this software and its   *
<span class="lineNum">       8 </span>            :  * documentation strictly for non-commercial purposes is hereby granted   *
<span class="lineNum">       9 </span>            :  * without fee, provided that the above copyright notice appears in all   *
<span class="lineNum">      10 </span>            :  * copies and that both the copyright notice and this permission notice   *
<span class="lineNum">      11 </span>            :  * appear in the supporting documentation. The authors make no claims     *
<span class="lineNum">      12 </span>            :  * about the suitability of this software for any purpose. It is          *
<span class="lineNum">      13 </span>            :  * provided &quot;as is&quot; without express or implied warranty.                  *
<span class="lineNum">      14 </span>            :  **************************************************************************/
<span class="lineNum">      15 </span>            : 
<span class="lineNum">      16 </span>            : /* $Id$ */
<span class="lineNum">      17 </span>            : 
<span class="lineNum">      18 </span>            : //_________________________________________________________________________
<span class="lineNum">      19 </span>            : // Main class for TRD1 geometry of Shish-Kebab case.
<span class="lineNum">      20 </span>            : // Author: Alexei Pavlinov(WSU).
<span class="lineNum">      21 </span>            : // Sep 20004 - Nov 2006; Apr 2010
<span class="lineNum">      22 </span>            : // See web page with description of Shish-Kebab geometries:
<span class="lineNum">      23 </span>            : // http://pdsfweb01.nersc.gov/~pavlinov/ALICE/SHISHKEBAB/RES/shishkebabALICE.html
<span class="lineNum">      24 </span>            : // Nov 9,2006 - added case of 3X3
<span class="lineNum">      25 </span>            : //_________________________________________________________________________
<span class="lineNum">      26 </span>            : 
<span class="lineNum">      27 </span>            : #include &quot;AliLog.h&quot;
<span class="lineNum">      28 </span>            : #include &quot;AliEMCALShishKebabTrd1Module.h&quot;
<span class="lineNum">      29 </span>            : #include &quot;AliEMCALEMCGeometry.h&quot;
<span class="lineNum">      30 </span>            : 
<a name="31"><span class="lineNum">      31 </span>            : #include &lt;cassert&gt;</a>
<span class="lineNum">      32 </span>            : 
<span class="lineNum">      33 </span><span class="lineCov">         72 : ClassImp(AliEMCALShishKebabTrd1Module)</span>
<span class="lineNum">      34 </span>            : 
<span class="lineNum">      35 </span>            :   //AliEMCALEMCGeometry *AliEMCALShishKebabTrd1Module::fgGeometry=0; 
<span class="lineNum">      36 </span>            :   Double_t AliEMCALShishKebabTrd1Module::fga=0.; 
<span class="lineNum">      37 </span>            :   Double_t AliEMCALShishKebabTrd1Module::fga2=0.; 
<span class="lineNum">      38 </span>            :   Double_t AliEMCALShishKebabTrd1Module::fgb=0.; 
<span class="lineNum">      39 </span>            :   Double_t AliEMCALShishKebabTrd1Module::fgr=0.; 
<span class="lineNum">      40 </span>            :   Double_t AliEMCALShishKebabTrd1Module::fgangle=0.;   // around one degree 
<span class="lineNum">      41 </span>            :   Double_t AliEMCALShishKebabTrd1Module::fgtanBetta=0; //
<a name="42"><span class="lineNum">      42 </span>            : </a>
<span class="lineNum">      43 </span>            : //_____________________________________________________________________________
<span class="lineNum">      44 </span>            : AliEMCALShishKebabTrd1Module::AliEMCALShishKebabTrd1Module(Double_t theta, AliEMCALEMCGeometry *g) 
<span class="lineNum">      45 </span><span class="lineCov">          5 :   : TNamed(),</span>
<span class="lineNum">      46 </span><span class="lineCov">          5 :     fGeometry(g),</span>
<span class="lineNum">      47 </span><span class="lineCov">          5 :     fOK(),</span>
<span class="lineNum">      48 </span><span class="lineCov">          5 :     fA(0.),</span>
<span class="lineNum">      49 </span><span class="lineCov">          5 :     fB(0.),</span>
<span class="lineNum">      50 </span><span class="lineCov">          5 :     fThetaA(0.),</span>
<span class="lineNum">      51 </span><span class="lineCov">          5 :     fTheta(theta),</span>
<span class="lineNum">      52 </span><span class="lineCov">          5 :     fOK1(),</span>
<span class="lineNum">      53 </span><span class="lineCov">          5 :     fOK2(),</span>
<span class="lineNum">      54 </span><span class="lineCov">          5 :     fOB(),</span>
<span class="lineNum">      55 </span><span class="lineCov">          5 :     fOB1(),</span>
<span class="lineNum">      56 </span><span class="lineCov">          5 :     fOB2(),</span>
<span class="lineNum">      57 </span><span class="lineCov">          5 :     fThetaOB1(0.),</span>
<span class="lineNum">      58 </span><span class="lineCov">          5 :     fThetaOB2(0.),</span>
<span class="lineNum">      59 </span><span class="lineCov">         35 :     fOK3X3(),</span>
<span class="lineNum">      60 </span><span class="lineCov">          5 :     fORB(), </span>
<span class="lineNum">      61 </span><span class="lineCov">          5 :     fORT()</span>
<span class="lineNum">      62 </span><span class="lineCov">         25 : { </span>
<span class="lineNum">      63 </span>            :   // ctor
<span class="lineNum">      64 </span>            :   
<span class="lineNum">      65 </span><span class="lineCov">         10 :   TString snam(g-&gt;GetName());</span>
<span class="lineNum">      66 </span>            :   Int_t key=0;
<span class="lineNum">      67 </span><span class="lineCov">         15 :   if     (snam.Contains(&quot;v1&quot;,TString::kIgnoreCase)) key=1; //EMCAL_COMPLETEV1 vs EMCAL_COMPLETEv1 (or other)</span>
<span class="lineNum">      68 </span>            :   
<span class="lineNum">      69 </span><span class="lineCov">         10 :   if(GetParameters()) {</span>
<span class="lineNum">      70 </span><span class="lineCov">          5 :     DefineFirstModule(key);</span>
<span class="lineNum">      71 </span>            :   }
<span class="lineNum">      72 </span><span class="lineCov">          5 :   DefineName(fTheta);</span>
<span class="lineNum">      73 </span><span class="lineCov">         25 :   AliDebug(10,Form(&quot;AliEMCALShishKebabTrd1Module - first module key=%i:  theta %1.4f geometry %s\n&quot;,key,fTheta, g-&gt;GetName()));</span>
<span class="lineNum">      74 </span><span class="lineCov">         10 : }</span>
<a name="75"><span class="lineNum">      75 </span>            : </a>
<span class="lineNum">      76 </span>            : //_____________________________________________________________________________
<span class="lineNum">      77 </span>            : AliEMCALShishKebabTrd1Module::AliEMCALShishKebabTrd1Module(AliEMCALShishKebabTrd1Module &amp;leftNeighbor) 
<span class="lineNum">      78 </span><span class="lineCov">        115 :   : TNamed(),</span>
<span class="lineNum">      79 </span><span class="lineCov">        115 :     fGeometry(leftNeighbor.fGeometry),</span>
<span class="lineNum">      80 </span><span class="lineCov">        115 :     fOK(),</span>
<span class="lineNum">      81 </span><span class="lineCov">        115 :     fA(0.),</span>
<span class="lineNum">      82 </span><span class="lineCov">        115 :     fB(0.),</span>
<span class="lineNum">      83 </span><span class="lineCov">        115 :     fThetaA(0.),</span>
<span class="lineNum">      84 </span><span class="lineCov">        115 :     fTheta(0.),</span>
<span class="lineNum">      85 </span><span class="lineCov">        115 :     fOK1(),</span>
<span class="lineNum">      86 </span><span class="lineCov">        115 :     fOK2(),</span>
<span class="lineNum">      87 </span><span class="lineCov">        115 :     fOB(),</span>
<span class="lineNum">      88 </span><span class="lineCov">        115 :     fOB1(),</span>
<span class="lineNum">      89 </span><span class="lineCov">        115 :     fOB2(),</span>
<span class="lineNum">      90 </span><span class="lineCov">        115 :     fThetaOB1(0.),</span>
<span class="lineNum">      91 </span><span class="lineCov">        115 :     fThetaOB2(0.),</span>
<span class="lineNum">      92 </span><span class="lineCov">        805 :     fOK3X3(),</span>
<span class="lineNum">      93 </span><span class="lineCov">        115 :     fORB(), </span>
<span class="lineNum">      94 </span><span class="lineCov">        115 :     fORT()</span>
<span class="lineNum">      95 </span><span class="lineCov">        575 : { </span>
<span class="lineNum">      96 </span>            :   
<span class="lineNum">      97 </span>            :   // ctor
<span class="lineNum">      98 </span>            :   
<span class="lineNum">      99 </span>            :   //  printf(&quot;** Left Neighbor : %s **\n&quot;, leftNeighbor.GetName());
<span class="lineNum">     100 </span><span class="lineCov">        115 :   fTheta  = leftNeighbor.GetTheta() - fgangle; </span>
<span class="lineNum">     101 </span>            : 
<span class="lineNum">     102 </span><span class="lineCov">        230 :   TObject::SetUniqueID(leftNeighbor.GetUniqueID()+1);</span>
<span class="lineNum">     103 </span>            : 
<span class="lineNum">     104 </span><span class="lineCov">        115 :   Init(leftNeighbor.GetA(),leftNeighbor.GetB());</span>
<span class="lineNum">     105 </span><span class="lineCov">        230 : }</span>
<a name="106"><span class="lineNum">     106 </span>            : </a>
<span class="lineNum">     107 </span>            : //________________________________________________________________
<span class="lineNum">     108 </span><span class="lineNoCov">          0 : AliEMCALShishKebabTrd1Module::AliEMCALShishKebabTrd1Module(const AliEMCALShishKebabTrd1Module&amp; mod) </span>
<span class="lineNum">     109 </span><span class="lineNoCov">          0 :   : TNamed(mod.GetName(),mod.GetTitle()),</span>
<span class="lineNum">     110 </span><span class="lineNoCov">          0 :     fGeometry(mod.fGeometry),</span>
<span class="lineNum">     111 </span><span class="lineNoCov">          0 :     fOK(mod.fOK),</span>
<span class="lineNum">     112 </span><span class="lineNoCov">          0 :     fA(mod.fA),</span>
<span class="lineNum">     113 </span><span class="lineNoCov">          0 :     fB(mod.fB),</span>
<span class="lineNum">     114 </span><span class="lineNoCov">          0 :     fThetaA(mod.fThetaA),</span>
<span class="lineNum">     115 </span><span class="lineNoCov">          0 :     fTheta(mod.fTheta),</span>
<span class="lineNum">     116 </span><span class="lineNoCov">          0 :     fOK1(mod.fOK1),</span>
<span class="lineNum">     117 </span><span class="lineNoCov">          0 :     fOK2(mod.fOK2),</span>
<span class="lineNum">     118 </span><span class="lineNoCov">          0 :     fOB(mod.fOB),</span>
<span class="lineNum">     119 </span><span class="lineNoCov">          0 :     fOB1(mod.fOB1),</span>
<span class="lineNum">     120 </span><span class="lineNoCov">          0 :     fOB2(mod.fOB2),</span>
<span class="lineNum">     121 </span><span class="lineNoCov">          0 :     fThetaOB1(mod.fThetaOB1),</span>
<span class="lineNum">     122 </span><span class="lineNoCov">          0 :     fThetaOB2(mod.fThetaOB2),</span>
<span class="lineNum">     123 </span><span class="lineNoCov">          0 :     fORB(mod.fORB),</span>
<span class="lineNum">     124 </span><span class="lineNoCov">          0 :     fORT(mod.fORT)</span>
<span class="lineNum">     125 </span><span class="lineNoCov">          0 : {</span>
<span class="lineNum">     126 </span>            :   // copy ctor
<span class="lineNum">     127 </span>            :   
<span class="lineNum">     128 </span><span class="lineNoCov">          0 :   for (Int_t i=0; i&lt;3; i++) fOK3X3[i] = mod.fOK3X3[i];</span>
<span class="lineNum">     129 </span><span class="lineNoCov">          0 : }</span>
<a name="130"><span class="lineNum">     130 </span>            : </a>
<span class="lineNum">     131 </span>            : //________________________________________________________________
<span class="lineNum">     132 </span>            : void AliEMCALShishKebabTrd1Module::Init(Double_t A, Double_t B)
<span class="lineNum">     133 </span>            : { 
<span class="lineNum">     134 </span>            :   // Define parameter module from parameters A,B from previos.
<span class="lineNum">     135 </span><span class="lineCov">        230 :   Double_t yl = (fgb/2)*TMath::Sin(fTheta) + (fga/2)*TMath::Cos(fTheta) + fgr, y = yl;</span>
<span class="lineNum">     136 </span><span class="lineCov">        115 :   Double_t xl = (yl - B) / A;     // y=A*x+B</span>
<span class="lineNum">     137 </span>            : 
<span class="lineNum">     138 </span>            :   //  Double_t xp1 = (fga/2. + fgb/2.*fgtanBetta)/(TMath::Sin(fTheta) + fgtanBetta*TMath::Cos(fTheta));
<span class="lineNum">     139 </span>            :   //  printf(&quot; xp1 %9.3f \n &quot;, xp1);
<span class="lineNum">     140 </span>            :   // xp1 == xp =&gt; both methods give the same results - 3-feb-05
<span class="lineNum">     141 </span><span class="lineCov">        115 :   Double_t alpha = TMath::Pi()/2. + fgangle/2;</span>
<span class="lineNum">     142 </span><span class="lineCov">        115 :   Double_t xt = (fga+fga2)*TMath::Tan(fTheta)*TMath::Tan(alpha)/(4.*(1.-TMath::Tan(fTheta)*TMath::Tan(alpha)));</span>
<span class="lineNum">     143 </span><span class="lineCov">        115 :   Double_t yt = xt / TMath::Tan(fTheta), xp = TMath::Sqrt(xt*xt + yt*yt);</span>
<span class="lineNum">     144 </span><span class="lineCov">        115 :   Double_t x  = xl + xp;</span>
<span class="lineNum">     145 </span><span class="lineCov">        115 :   fOK.Set(x, y);</span>
<span class="lineNum">     146 </span>            :   //  printf(&quot; yl %9.3f | xl %9.3f | xp %9.3f \n&quot;, yl, xl, xp);
<span class="lineNum">     147 </span>            : 
<span class="lineNum">     148 </span>            :   // have to define A and B; 
<span class="lineNum">     149 </span><span class="lineCov">        115 :   Double_t yCprev = fgr + fga*TMath::Cos(fTheta);</span>
<span class="lineNum">     150 </span><span class="lineCov">        115 :   Double_t xCprev = (yCprev - B) / A;</span>
<span class="lineNum">     151 </span><span class="lineCov">        115 :   Double_t xA     = xCprev + fga*TMath::Sin(fTheta), yA = fgr;</span>
<span class="lineNum">     152 </span>            : 
<span class="lineNum">     153 </span><span class="lineCov">        115 :   fThetaA = fTheta - fgangle/2.;</span>
<span class="lineNum">     154 </span><span class="lineCov">        115 :   fA = TMath::Tan(fThetaA); // !!</span>
<span class="lineNum">     155 </span><span class="lineCov">        115 :   fB = yA - fA*xA;</span>
<span class="lineNum">     156 </span>            : 
<span class="lineNum">     157 </span><span class="lineCov">        115 :   DefineAllStaff();</span>
<a name="158"><span class="lineNum">     158 </span><span class="lineCov">        115 : }</span></a>
<span class="lineNum">     159 </span>            : 
<span class="lineNum">     160 </span>            : void AliEMCALShishKebabTrd1Module::DefineAllStaff()
<span class="lineNum">     161 </span>            : { 
<span class="lineNum">     162 </span>            :   //Define some parameters      
<span class="lineNum">     163 </span><span class="lineCov">        240 :   DefineName(fTheta);</span>
<span class="lineNum">     164 </span>            :   // Centers of cells - 2X2 case
<span class="lineNum">     165 </span><span class="lineCov">        120 :   Double_t kk1 = (fga+fga2)/(2.*4.); // kk1=kk2 </span>
<span class="lineNum">     166 </span>            : 
<span class="lineNum">     167 </span><span class="lineCov">        120 :   Double_t xk1 = fOK.X() - kk1*TMath::Sin(fTheta);</span>
<span class="lineNum">     168 </span><span class="lineCov">        120 :   Double_t yk1 = fOK.Y() + kk1*TMath::Cos(fTheta) - fgr;</span>
<span class="lineNum">     169 </span><span class="lineCov">        120 :   fOK1.Set(xk1,yk1);</span>
<span class="lineNum">     170 </span>            : 
<span class="lineNum">     171 </span><span class="lineCov">        120 :   Double_t xk2 = fOK.X() + kk1*TMath::Sin(fTheta);</span>
<span class="lineNum">     172 </span><span class="lineCov">        120 :   Double_t yk2 = fOK.Y() - kk1*TMath::Cos(fTheta) - fgr;</span>
<span class="lineNum">     173 </span><span class="lineCov">        120 :   fOK2.Set(xk2,yk2);</span>
<span class="lineNum">     174 </span>            : 
<span class="lineNum">     175 </span>            :   // Centers of cells - 3X3 case; Nov 9,2006
<span class="lineNum">     176 </span><span class="lineCov">        120 :   fOK3X3[1].Set(fOK.X(), fOK.Y()-fgr); // coincide with module center</span>
<span class="lineNum">     177 </span>            : 
<span class="lineNum">     178 </span><span class="lineCov">        120 :   kk1 = ((fga+fga2)/4. + fga/6.)/2.; </span>
<span class="lineNum">     179 </span>            : 
<span class="lineNum">     180 </span><span class="lineCov">        120 :   xk1 = fOK.X() - kk1*TMath::Sin(fTheta);</span>
<span class="lineNum">     181 </span><span class="lineCov">        120 :   yk1 = fOK.Y() + kk1*TMath::Cos(fTheta) - fgr;</span>
<span class="lineNum">     182 </span><span class="lineCov">        120 :   fOK3X3[0].Set(xk1,yk1);</span>
<span class="lineNum">     183 </span>            : 
<span class="lineNum">     184 </span><span class="lineCov">        120 :   xk2 = fOK.X() + kk1*TMath::Sin(fTheta);</span>
<span class="lineNum">     185 </span><span class="lineCov">        120 :   yk2 = fOK.Y() - kk1*TMath::Cos(fTheta) - fgr;</span>
<span class="lineNum">     186 </span><span class="lineCov">        120 :   fOK3X3[2].Set(xk2,yk2);</span>
<span class="lineNum">     187 </span>            : 
<span class="lineNum">     188 </span>            :   // May 15, 2006; position of module(cells) center face 
<span class="lineNum">     189 </span><span class="lineCov">        120 :   fOB.Set(fOK.X()-fgb/2.*TMath::Cos(fTheta),  fOK.Y()-fgb/2.*TMath::Sin(fTheta)-fgr);</span>
<span class="lineNum">     190 </span><span class="lineCov">        120 :   fOB1.Set(fOB.X()-fga/4.*TMath::Sin(fTheta), fOB.Y()+fga/4.*TMath::Cos(fTheta));</span>
<span class="lineNum">     191 </span><span class="lineCov">        120 :   fOB2.Set(fOB.X()+fga/4.*TMath::Sin(fTheta), fOB.Y()-fga/4.*TMath::Cos(fTheta));</span>
<span class="lineNum">     192 </span>            :   // Jul 30, 2007 - for taking into account a position of shower maximum
<span class="lineNum">     193 </span><span class="lineCov">        120 :   fThetaOB1 = fTheta - fgangle/4.; // ??</span>
<span class="lineNum">     194 </span><span class="lineCov">        120 :   fThetaOB2 = fTheta + fgangle/4.;</span>
<span class="lineNum">     195 </span>            : 
<span class="lineNum">     196 </span>            :   // Position of right/top point of module
<span class="lineNum">     197 </span>            :   // Gives the posibility to estimate SM size in z direction
<span class="lineNum">     198 </span><span class="lineCov">        120 :   Double_t xBottom     = (fgr - fB) / fA;</span>
<span class="lineNum">     199 </span>            :   Double_t yBottom     = fgr;
<span class="lineNum">     200 </span><span class="lineCov">        120 :   fORB.Set(xBottom, yBottom);</span>
<span class="lineNum">     201 </span>            : 
<span class="lineNum">     202 </span><span class="lineCov">        120 :   Double_t l = fgb / TMath::Cos(fgangle/2.); // length of lateral module side</span>
<span class="lineNum">     203 </span><span class="lineCov">        120 :   Double_t xTop = xBottom + l*TMath::Cos(TMath::ATan(fA));</span>
<span class="lineNum">     204 </span><span class="lineCov">        120 :   Double_t yTop = fA*xTop + fB;</span>
<span class="lineNum">     205 </span><span class="lineCov">        120 :   fORT.Set(xTop, yTop);</span>
<span class="lineNum">     206 </span><span class="lineCov">        120 : }</span>
<a name="207"><span class="lineNum">     207 </span>            : </a>
<span class="lineNum">     208 </span>            : //_____________________________________________________________________________
<span class="lineNum">     209 </span>            : void AliEMCALShishKebabTrd1Module::DefineFirstModule(const Int_t key)
<span class="lineNum">     210 </span>            : {
<span class="lineNum">     211 </span>            :   //    Oct 23-25, 2010
<span class="lineNum">     212 </span>            :   //  key=0 - zero tilt of first module;
<span class="lineNum">     213 </span>            :   //  key=1 - angle=fgangle/2 = 0.75 degree.
<span class="lineNum">     214 </span>            :   //  This is what we have in produced SM. 
<span class="lineNum">     215 </span>            : 
<span class="lineNum">     216 </span>            :   // Define first module
<span class="lineNum">     217 </span><span class="lineCov">         10 :   if(key==0) {</span>
<span class="lineNum">     218 </span>            :     // theta in radians ; first object theta=pi/2.
<span class="lineNum">     219 </span><span class="lineNoCov">          0 :     fTheta = TMath::PiOver2();</span>
<span class="lineNum">     220 </span><span class="lineNoCov">          0 :     fOK.Set(fga2/2., fgr + fgb/2.); // position the center of module vs o</span>
<span class="lineNum">     221 </span>            : 
<span class="lineNum">     222 </span>            :     // parameters of right line : y = A*z + B in system where zero point is IP.
<span class="lineNum">     223 </span><span class="lineNoCov">          0 :     fThetaA = fTheta - fgangle/2.;</span>
<span class="lineNum">     224 </span><span class="lineNoCov">          0 :     fA      = TMath::Tan(fThetaA);</span>
<span class="lineNum">     225 </span><span class="lineNoCov">          0 :     Double_t xA = fga/2. + fga2/2.;</span>
<span class="lineNum">     226 </span><span class="lineNoCov">          0 :     Double_t yA = fgr;</span>
<span class="lineNum">     227 </span><span class="lineNoCov">          0 :     fB = yA - fA*xA;</span>
<span class="lineNum">     228 </span>            : 
<span class="lineNum">     229 </span><span class="lineCov">          5 :   } else if(key==1) {</span>
<span class="lineNum">     230 </span>            :     // theta in radians ; first object theta = 90-0.75 = 89.25 degree
<span class="lineNum">     231 </span><span class="lineCov">          5 :     fTheta = 89.25*TMath::DegToRad();</span>
<span class="lineNum">     232 </span><span class="lineCov">          5 :     Double_t al1 = fgangle/2.;</span>
<span class="lineNum">     233 </span><span class="lineCov">          5 :     Double_t x = 0.5*(fga*TMath::Cos(al1) + fgb*TMath::Sin(al1));</span>
<span class="lineNum">     234 </span><span class="lineCov">          5 :     Double_t y = 0.5*(fgb + fga*TMath::Sin(al1))*TMath::Cos(al1);</span>
<span class="lineNum">     235 </span><span class="lineCov">          5 :     fOK.Set(x, fgr + y);</span>
<span class="lineNum">     236 </span>            :     // parameters of right line : y = A*z + B in system where zero point is IP.
<span class="lineNum">     237 </span><span class="lineCov">          5 :     fThetaA = fTheta - fgangle/2.;</span>
<span class="lineNum">     238 </span><span class="lineCov">          5 :     fA      = TMath::Tan(fThetaA);</span>
<span class="lineNum">     239 </span><span class="lineCov">          5 :     Double_t xA = fga*TMath::Cos(al1);</span>
<span class="lineNum">     240 </span><span class="lineCov">          5 :     Double_t yA = fgr;</span>
<span class="lineNum">     241 </span><span class="lineCov">          5 :     fB = yA - fA*xA;</span>
<span class="lineNum">     242 </span>            : 
<span class="lineNum">     243 </span>            :   } else {
<span class="lineNum">     244 </span><span class="lineNoCov">          0 :     printf(&quot;&lt;E&gt; key=%i : wrong case \n&quot;,key);</span>
<span class="lineNum">     245 </span><span class="lineNoCov">          0 :     assert(0);</span>
<span class="lineNum">     246 </span>            :   }
<span class="lineNum">     247 </span><span class="lineCov">          5 :   TObject::SetUniqueID(1); //</span>
<span class="lineNum">     248 </span>            : 
<span class="lineNum">     249 </span><span class="lineCov">          5 :   DefineAllStaff();</span>
<span class="lineNum">     250 </span><span class="lineCov">          5 : }</span>
<a name="251"><span class="lineNum">     251 </span>            : </a>
<span class="lineNum">     252 </span>            : //_____________________________________________________________________________
<span class="lineNum">     253 </span>            : void AliEMCALShishKebabTrd1Module::DefineName(Double_t theta)
<span class="lineNum">     254 </span>            : {
<span class="lineNum">     255 </span>            :   // Define name of object
<span class="lineNum">     256 </span><span class="lineCov">        250 :   SetName(Form(&quot;%2i(%5.2f)&quot;, TObject::GetUniqueID(), theta*TMath::RadToDeg()));</span>
<span class="lineNum">     257 </span><span class="lineCov">        125 : }</span>
<a name="258"><span class="lineNum">     258 </span>            : </a>
<span class="lineNum">     259 </span>            : //_____________________________________________________________________________
<span class="lineNum">     260 </span>            : Bool_t AliEMCALShishKebabTrd1Module::GetParameters()
<span class="lineNum">     261 </span>            : {
<span class="lineNum">     262 </span>            :   
<span class="lineNum">     263 </span>            :   // Get needing module parameters from EMCAL geometry
<span class="lineNum">     264 </span>            :   
<span class="lineNum">     265 </span><span class="lineCov">         10 :   if(!fGeometry) {</span>
<span class="lineNum">     266 </span><span class="lineNoCov">          0 :     Warning(&quot;GetParameters()&quot;,&quot; No geometry &quot;);</span>
<span class="lineNum">     267 </span><span class="lineNoCov">          0 :     return kFALSE; </span>
<span class="lineNum">     268 </span>            :   }  
<span class="lineNum">     269 </span>            :   
<span class="lineNum">     270 </span><span class="lineCov">          5 :   TString sn(fGeometry-&gt;GetName()); // 2-Feb-05</span>
<span class="lineNum">     271 </span><span class="lineCov">          5 :   sn.ToUpper();</span>
<span class="lineNum">     272 </span>            :   
<span class="lineNum">     273 </span><span class="lineCov">          5 :   fga        = (Double_t)fGeometry-&gt;GetEtaModuleSize();</span>
<span class="lineNum">     274 </span><span class="lineCov">          5 :   fgb        = (Double_t)fGeometry-&gt;GetLongModuleSize();</span>
<span class="lineNum">     275 </span><span class="lineCov">          5 :   fgangle    = Double_t(fGeometry-&gt;GetTrd1Angle())*TMath::DegToRad();</span>
<span class="lineNum">     276 </span><span class="lineCov">          5 :   fgtanBetta = TMath::Tan(fgangle/2.);</span>
<span class="lineNum">     277 </span><span class="lineCov">          5 :   fgr        = (Double_t)fGeometry-&gt;GetIPDistance();</span>
<span class="lineNum">     278 </span>            : 
<span class="lineNum">     279 </span><span class="lineCov">          5 :   fgr += fGeometry-&gt;GetSteelFrontThickness();</span>
<span class="lineNum">     280 </span>            : 
<span class="lineNum">     281 </span><span class="lineCov">          5 :   fga2       = Double_t(fGeometry-&gt;Get2Trd1Dx2());</span>
<span class="lineNum">     282 </span>            :   //PH  PrintShish(0);
<span class="lineNum">     283 </span>            :   return kTRUE;
<span class="lineNum">     284 </span><span class="lineCov">         10 : }</span>
<span class="lineNum">     285 </span>            : 
<a name="286"><span class="lineNum">     286 </span>            : // service methods</a>
<span class="lineNum">     287 </span>            : //_____________________________________________________________________________
<span class="lineNum">     288 </span>            : void AliEMCALShishKebabTrd1Module::PrintShish(int pri) const
<span class="lineNum">     289 </span>            : {
<span class="lineNum">     290 </span>            :   // service method
<span class="lineNum">     291 </span><span class="lineNoCov">          0 :   if(pri&gt;=0) { </span>
<span class="lineNum">     292 </span><span class="lineNoCov">          0 :     if(pri &gt;= 1) {</span>
<span class="lineNum">     293 </span><span class="lineNoCov">          0 :       printf(&quot;PrintShish() \n a %7.3f:%7.3f | b %7.2f | r %7.2f \n TRD1 angle %7.6f(%5.2f) | tanBetta %7.6f&quot;, </span>
<span class="lineNum">     294 </span><span class="lineNoCov">          0 :       fga, fga2, fgb, fgr, fgangle, fgangle*TMath::RadToDeg(), fgtanBetta);</span>
<span class="lineNum">     295 </span><span class="lineNoCov">          0 :       printf(&quot; fTheta %f : %5.2f : cos(theta) %f\n&quot;, </span>
<span class="lineNum">     296 </span><span class="lineNoCov">          0 :       fTheta, GetThetaInDegree(),TMath::Cos(fTheta)); </span>
<span class="lineNum">     297 </span><span class="lineNoCov">          0 :       printf(&quot; OK : %i |%s| theta %f :  phi = %f(%5.2f) \n&quot;, </span>
<span class="lineNum">     298 </span><span class="lineNoCov">          0 :       GetUniqueID(), GetName(), fTheta, fOK.Phi(),fOK.Phi()*TMath::RadToDeg());</span>
<span class="lineNum">     299 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">     300 </span><span class="lineNoCov">          0 :     printf(&quot; y %9.3f x %9.3f xrb %9.3f (right bottom on r=%9.3f ) \n&quot;, </span>
<span class="lineNum">     301 </span><span class="lineNoCov">          0 :            fOK.X(), fOK.Y(), fORB.X(),fORB.Y());</span>
<span class="lineNum">     302 </span><span class="lineNoCov">          0 :     if(pri&gt;=2) {</span>
<span class="lineNum">     303 </span><span class="lineNoCov">          0 :       printf(&quot; A %f B %f | fThetaA %7.6f(%5.2f)\n&quot;, fA,fB, fThetaA,fThetaA*TMath::RadToDeg());</span>
<span class="lineNum">     304 </span><span class="lineNoCov">          0 :       printf(&quot; fOK  : X %9.4f: Y %9.4f : eta  %5.3f\n&quot;,  fOK.X(), fOK.Y(), GetEtaOfCenterOfModule());</span>
<span class="lineNum">     305 </span><span class="lineNoCov">          0 :       printf(&quot; fOK1 : X %9.4f: Y %9.4f :   (local, ieta=2)\n&quot;, fOK1.X(), fOK1.Y());</span>
<span class="lineNum">     306 </span><span class="lineNoCov">          0 :       printf(&quot; fOK2 : X %9.4f: Y %9.4f :   (local, ieta=1)\n\n&quot;, fOK2.X(), fOK2.Y());</span>
<span class="lineNum">     307 </span><span class="lineNoCov">          0 :       printf(&quot; fOB  : X %9.4f: Y %9.4f \n&quot;, fOB.X(), fOB.Y());</span>
<span class="lineNum">     308 </span><span class="lineNoCov">          0 :       printf(&quot; fOB1 : X %9.4f: Y %9.4f (local, ieta=2)\n&quot;, fOB1.X(), fOB1.Y());</span>
<span class="lineNum">     309 </span><span class="lineNoCov">          0 :       printf(&quot; fOB2 : X %9.4f: Y %9.4f (local, ieta=1)\n&quot;, fOB2.X(), fOB2.Y());</span>
<span class="lineNum">     310 </span>            :       // 3X3 
<span class="lineNum">     311 </span><span class="lineNoCov">          0 :       printf(&quot; 3X3 \n&quot;);</span>
<span class="lineNum">     312 </span><span class="lineNoCov">          0 :       for(int ieta=0; ieta&lt;3; ieta++) {</span>
<span class="lineNum">     313 </span><span class="lineNoCov">          0 :         printf(&quot; fOK3X3[%i] : X %9.4f: Y %9.4f (local) \n&quot;, ieta, fOK3X3[ieta].X(), fOK3X3[ieta].Y());</span>
<span class="lineNum">     314 </span>            :       }
<span class="lineNum">     315 </span>            :       //      fOK.Dump();
<span class="lineNum">     316 </span><span class="lineNoCov">          0 :       GetMaxEtaOfModule(pri);</span>
<span class="lineNum">     317 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">     318 </span>            :   }
<span class="lineNum">     319 </span><span class="lineNoCov">          0 : }</span>
<a name="320"><span class="lineNum">     320 </span>            : </a>
<span class="lineNum">     321 </span>            : //_____________________________________________________________________________
<span class="lineNum">     322 </span>            : Double_t  AliEMCALShishKebabTrd1Module::GetThetaInDegree() const 
<span class="lineNum">     323 </span>            : {
<span class="lineNum">     324 </span><span class="lineCov">        192 :   return fTheta*TMath::RadToDeg();</span>
<span class="lineNum">     325 </span>            : }
<a name="326"><span class="lineNum">     326 </span>            : </a>
<span class="lineNum">     327 </span>            : //_____________________________________________________________________________
<span class="lineNum">     328 </span>            : Double_t  AliEMCALShishKebabTrd1Module::GetEtaOfCenterOfModule() const 
<span class="lineNum">     329 </span>            : { 
<span class="lineNum">     330 </span><span class="lineNoCov">          0 :   return -TMath::Log(TMath::Tan(fOK.Phi()/2.));</span>
<span class="lineNum">     331 </span>            : }
<a name="332"><span class="lineNum">     332 </span>            : </a>
<span class="lineNum">     333 </span>            : //_____________________________________________________________________________
<span class="lineNum">     334 </span>            : void AliEMCALShishKebabTrd1Module::GetPositionAtCenterCellLine(Int_t ieta, Double_t dist, TVector2 &amp;v)
<span class="lineNum">     335 </span>            : {
<span class="lineNum">     336 </span>            :   // Jul 30, 2007
<span class="lineNum">     337 </span>            :   static Double_t theta=0., x=0., y=0.;
<span class="lineNum">     338 </span><span class="lineCov">        388 :   if(ieta==0) {    </span>
<span class="lineNum">     339 </span><span class="lineCov">         62 :     v     = fOB2;</span>
<span class="lineNum">     340 </span><span class="lineCov">         62 :     theta = fTheta;</span>
<span class="lineNum">     341 </span><span class="lineCov">        194 :   } else if(ieta==1) {</span>
<span class="lineNum">     342 </span><span class="lineCov">        132 :     v     = fOB1;</span>
<span class="lineNum">     343 </span><span class="lineCov">        132 :     theta = fTheta;</span>
<span class="lineNum">     344 </span>            :   } else {
<span class="lineNum">     345 </span><span class="lineNoCov">          0 :     assert(0);</span>
<span class="lineNum">     346 </span>            :   }
<span class="lineNum">     347 </span>            :   
<span class="lineNum">     348 </span><span class="lineCov">        194 :   x = v.X() + TMath::Cos(theta) * dist;</span>
<span class="lineNum">     349 </span><span class="lineCov">        194 :   y = v.Y() + TMath::Sin(theta) * dist;</span>
<span class="lineNum">     350 </span>            :   //  printf(&quot; GetPositionAtCenterCellLine() %s : dist %f : ieta %i : x %f %f v.X() | y %f %f v.Y() : cos %f sin %f \n&quot;, 
<span class="lineNum">     351 </span>            :   //GetName(), dist, ieta, v.X(),x, y,v.Y(),TMath::Cos(theta),TMath::Sin(theta));
<span class="lineNum">     352 </span><span class="lineCov">        194 :   v.Set(x,y);</span>
<span class="lineNum">     353 </span><span class="lineCov">        194 : }  </span>
<span class="lineNum">     354 </span>            : 
<a name="355"><span class="lineNum">     355 </span>            : </a>
<span class="lineNum">     356 </span>            : //_____________________________________________________________________________
<span class="lineNum">     357 </span>            : Double_t  AliEMCALShishKebabTrd1Module::GetMaxEtaOfModule(int pri) const 
<span class="lineNum">     358 </span>            : { 
<span class="lineNum">     359 </span>            :   // Right bottom point of module
<span class="lineNum">     360 </span><span class="lineCov">         10 :   Double_t thetaBottom = TMath::ATan2(fORB.Y(),fORB.X());</span>
<span class="lineNum">     361 </span><span class="lineCov">          5 :   Double_t etaBottom   = ThetaToEta(thetaBottom);</span>
<span class="lineNum">     362 </span>            :   // Right top point of module
<span class="lineNum">     363 </span><span class="lineCov">          5 :   Double_t thetaTop = TMath::ATan2(fORT.Y(),fORT.X());</span>
<span class="lineNum">     364 </span><span class="lineCov">          5 :   Double_t etaTop   = ThetaToEta(thetaTop);</span>
<span class="lineNum">     365 </span>            : 
<span class="lineNum">     366 </span><span class="lineCov">          5 :   if(pri) { </span>
<span class="lineNum">     367 </span><span class="lineNoCov">          0 :     printf(&quot; Right bottom point of module : eta %5.4f : theta %6.4f (%6.2f) : x(zglob) %7.2f y(phi) %5.2f \n&quot;, </span>
<span class="lineNum">     368 </span><span class="lineNoCov">          0 :            etaBottom, thetaBottom, thetaBottom * TMath::RadToDeg(), fORB.X(), fORB.Y());</span>
<span class="lineNum">     369 </span><span class="lineNoCov">          0 :     printf(&quot; Right    top point of module : eta %5.4f : theta %6.4f (%6.2f) : x(zglob) %7.2f y(phi) %5.2f \n&quot;, </span>
<span class="lineNum">     370 </span><span class="lineNoCov">          0 :            etaTop, thetaTop, thetaTop * TMath::RadToDeg(), fORT.X(), fORT.Y());</span>
<span class="lineNum">     371 </span><span class="lineNoCov">          0 :   }</span>
<span class="lineNum">     372 </span><span class="lineCov">          5 :   return etaBottom&gt;etaTop ? etaBottom : etaTop;</span>
<span class="lineNum">     373 </span>            : }
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.11</a></td></tr>
  </table>
  <br>

</body>
</html>
