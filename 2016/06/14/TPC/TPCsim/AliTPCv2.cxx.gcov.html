<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - coverage.info - TPC/TPCsim/AliTPCv2.cxx</title>
  <link rel="stylesheet" type="text/css" href="../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../index.html">top level</a> - <a href="index.html">TPC/TPCsim</a> - AliTPCv2.cxx<span style="font-size: 80%;"> (source / <a href="AliTPCv2.cxx.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">coverage.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">1411</td>
            <td class="headerCovTableEntry">1458</td>
            <td class="headerCovTableEntryHi">96.8 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2016-06-14 17:26:59</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">10</td>
            <td class="headerCovTableEntry">10</td>
            <td class="headerCovTableEntryHi">100.0 %</td>
          </tr>
          <tr><td><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            : /**************************************************************************</a>
<span class="lineNum">       2 </span>            :  * Copyright(c) 1998-1999, ALICE Experiment at CERN, All rights reserved. *
<span class="lineNum">       3 </span>            :  *                                                                        *
<span class="lineNum">       4 </span>            :  * Author: The ALICE Off-line Project.                                    *
<span class="lineNum">       5 </span>            :  * Contributors are mentioned in the code where appropriate.              *
<span class="lineNum">       6 </span>            :  *                                                                        *
<span class="lineNum">       7 </span>            :  * Permission to use, copy, modify and distribute this software and its   *
<span class="lineNum">       8 </span>            :  * documentation strictly for non-commercial purposes is hereby granted   *
<span class="lineNum">       9 </span>            :  * without fee, provided that the above copyright notice appears in all   *
<span class="lineNum">      10 </span>            :  * copies and that both the copyright notice and this permission notice   *
<span class="lineNum">      11 </span>            :  * appear in the supporting documentation. The authors make no claims     *
<span class="lineNum">      12 </span>            :  * about the suitability of this software for any purpose. It is          *
<span class="lineNum">      13 </span>            :  * provided &quot;as is&quot; without express or implied warranty.                  *
<span class="lineNum">      14 </span>            :  **************************************************************************/
<span class="lineNum">      15 </span>            : 
<span class="lineNum">      16 </span>            : /* $Id$ */
<span class="lineNum">      17 </span>            : 
<span class="lineNum">      18 </span>            : //
<span class="lineNum">      19 </span>            : ///////////////////////////////////////////////////////////////////////////////
<span class="lineNum">      20 </span>            : //                                                                           //
<span class="lineNum">      21 </span>            : //  Time Projection Chamber version 2 -- detailed TPC and slow simulation    //
<span class="lineNum">      22 </span>            : //                                                                           //
<span class="lineNum">      23 </span>            : //Begin_Html
<span class="lineNum">      24 </span>            : /*
<span class="lineNum">      25 </span>            : &lt;img src=&quot;picts/AliTPCv2Class.gif&quot;&gt;
<span class="lineNum">      26 </span>            : */
<span class="lineNum">      27 </span>            : //End_Html
<span class="lineNum">      28 </span>            : //                                                                           //
<span class="lineNum">      29 </span>            : //                                                                           //
<span class="lineNum">      30 </span>            : ///////////////////////////////////////////////////////////////////////////////
<span class="lineNum">      31 </span>            : 
<span class="lineNum">      32 </span>            : //#include &lt;stdlib.h&gt;
<span class="lineNum">      33 </span>            : 
<span class="lineNum">      34 </span>            : #include &lt;TLorentzVector.h&gt;
<span class="lineNum">      35 </span>            : #include &lt;TPDGCode.h&gt;
<span class="lineNum">      36 </span>            : #include &lt;TString.h&gt;
<span class="lineNum">      37 </span>            : #include &quot;AliLog.h&quot;
<span class="lineNum">      38 </span>            : #include &quot;AliMathBase.h&quot;
<span class="lineNum">      39 </span>            : #include &quot;AliTrackReference.h&quot;
<span class="lineNum">      40 </span>            : #include &quot;AliTPCParam.h&quot;
<span class="lineNum">      41 </span>            : #include &quot;AliTPCTrackHitsV2.h&quot;
<span class="lineNum">      42 </span>            : #include &quot;AliTPCv2.h&quot;
<span class="lineNum">      43 </span>            : #include &quot;AliGeomManager.h&quot;
<span class="lineNum">      44 </span>            : #include &quot;TGeoVolume.h&quot;
<span class="lineNum">      45 </span>            : #include &quot;TGeoPcon.h&quot;
<span class="lineNum">      46 </span>            : #include &quot;TGeoTube.h&quot;
<span class="lineNum">      47 </span>            : #include &quot;TGeoCone.h&quot;
<span class="lineNum">      48 </span>            : #include &quot;TGeoPgon.h&quot;
<span class="lineNum">      49 </span>            : #include &quot;TGeoTrd1.h&quot;
<span class="lineNum">      50 </span>            : #include &quot;TGeoCompositeShape.h&quot;
<span class="lineNum">      51 </span>            : #include &quot;TGeoPara.h&quot;
<span class="lineNum">      52 </span>            : #include &quot;TGeoPhysicalNode.h&quot;
<span class="lineNum">      53 </span>            : #include &quot;TGeoHalfSpace.h&quot;
<span class="lineNum">      54 </span>            : #include &quot;TTreeStream.h&quot;
<span class="lineNum">      55 </span>            : #include &quot;TGeoArb8.h&quot;
<span class="lineNum">      56 </span>            : #include &lt;iostream&gt;
<span class="lineNum">      57 </span>            : #include &lt;fstream&gt;
<span class="lineNum">      58 </span>            : 
<span class="lineNum">      59 </span>            : using std::ifstream;
<span class="lineNum">      60 </span>            : using std::ios_base;
<span class="lineNum">      61 </span>            : extern &quot;C&quot;{
<a name="62"><span class="lineNum">      62 </span>            :   Gas gaspar_;</a>
<span class="lineNum">      63 </span>            : };
<span class="lineNum">      64 </span><span class="lineCov">         12 : ClassImp(AliTPCv2)</span>
<a name="65"><span class="lineNum">      65 </span>            :  </a>
<span class="lineNum">      66 </span>            : //_____________________________________________________________________________
<span class="lineNum">      67 </span>            : AliTPCv2::AliTPCv2(const char *name, const char *title) :
<span class="lineNum">      68 </span><span class="lineCov">          1 :   AliTPC(name, title),</span>
<span class="lineNum">      69 </span><span class="lineCov">          1 :   fIdSens(0),</span>
<span class="lineNum">      70 </span><span class="lineCov">          1 :   fIDrift(0),</span>
<span class="lineNum">      71 </span><span class="lineCov">          1 :   fSecOld(0) </span>
<span class="lineNum">      72 </span><span class="lineCov">          5 : {</span>
<span class="lineNum">      73 </span>            :   //
<span class="lineNum">      74 </span>            :   // Standard constructor for Time Projection Chamber version 2
<span class="lineNum">      75 </span>            :   //
<span class="lineNum">      76 </span>            : 
<span class="lineNum">      77 </span>            : 
<span class="lineNum">      78 </span><span class="lineCov">          1 :   SetBufferSize(128000);</span>
<span class="lineNum">      79 </span><span class="lineCov">          1 :   if(!fTPCParam) {AliFatal(&quot;TPC parameters not set&quot;);</span>
<span class="lineNum">      80 </span>            :       return;
<span class="lineNum">      81 </span>            :   }
<span class="lineNum">      82 </span><span class="lineCov">          1 :   gaspar_.fpot=fTPCParam-&gt;GetFpot();</span>
<span class="lineNum">      83 </span><span class="lineCov">          1 :   gaspar_.eend=fTPCParam-&gt;GetEend();</span>
<span class="lineNum">      84 </span><span class="lineCov">          1 :   gaspar_.eexpo=fTPCParam-&gt;GetExp();</span>
<span class="lineNum">      85 </span>            : 
<span class="lineNum">      86 </span>            : 
<span class="lineNum">      87 </span><span class="lineCov">          3 : }</span>
<a name="88"><span class="lineNum">      88 </span>            :  </a>
<span class="lineNum">      89 </span>            : //_____________________________________________________________________________
<span class="lineNum">      90 </span>            : void AliTPCv2::CreateGeometry()
<span class="lineNum">      91 </span>            : {
<span class="lineNum">      92 </span>            :   //
<span class="lineNum">      93 </span>            :   // Create the geometry of Time Projection Chamber version 2
<span class="lineNum">      94 </span>            :   //
<span class="lineNum">      95 </span>            :   //Begin_Html
<span class="lineNum">      96 </span>            :   /*
<span class="lineNum">      97 </span>            :     &lt;img src=&quot;picts/AliTPC.gif&quot;&gt;
<span class="lineNum">      98 </span>            :   */
<span class="lineNum">      99 </span>            :   //End_Html
<span class="lineNum">     100 </span>            :   //Begin_Html
<span class="lineNum">     101 </span>            :   /*
<span class="lineNum">     102 </span>            :     &lt;img src=&quot;picts/AliTPCv2Tree.gif&quot;&gt;
<span class="lineNum">     103 </span>            :   */
<span class="lineNum">     104 </span>            :   //End_Html
<span class="lineNum">     105 </span>            : 
<span class="lineNum">     106 </span>            :   //----------------------------------------------------------
<span class="lineNum">     107 </span>            :   // This geometry is written using TGeo class
<span class="lineNum">     108 </span>            :   // Firstly the shapes are defined, and only then the volumes
<span class="lineNum">     109 </span>            :   // What is recognized by the MC are volumes
<span class="lineNum">     110 </span>            :   //----------------------------------------------------------
<span class="lineNum">     111 </span>            :   //
<span class="lineNum">     112 </span>            :   //  tpc - this will be the mother volume
<span class="lineNum">     113 </span>            :   //
<span class="lineNum">     114 </span>            : 
<span class="lineNum">     115 </span>            :   //
<span class="lineNum">     116 </span>            :   // here I define a volume TPC
<span class="lineNum">     117 </span>            :   // retrive the medium name with &quot;TPC_&quot; as a leading string
<span class="lineNum">     118 </span>            :   //
<span class="lineNum">     119 </span><span class="lineCov">          2 :   TGeoPcon *tpc = new TGeoPcon(0.,360.,30); //30 sections</span>
<span class="lineNum">     120 </span>            :   //
<span class="lineNum">     121 </span><span class="lineCov">          1 :   tpc-&gt;DefineSection(0,-289.6,77.,278.);</span>
<span class="lineNum">     122 </span><span class="lineCov">          1 :   tpc-&gt;DefineSection(1,-262.1,77.,278.);</span>
<span class="lineNum">     123 </span>            :   //
<span class="lineNum">     124 </span><span class="lineCov">          1 :   tpc-&gt;DefineSection(2,-262.1,83.1,278.);</span>
<span class="lineNum">     125 </span><span class="lineCov">          1 :   tpc-&gt;DefineSection(3,-260.,83.1,278.);</span>
<span class="lineNum">     126 </span>            :   //
<span class="lineNum">     127 </span><span class="lineCov">          1 :   tpc-&gt;DefineSection(4,-260.,70.,278.);    </span>
<span class="lineNum">     128 </span><span class="lineCov">          1 :   tpc-&gt;DefineSection(5,-259.6,70.,278.);</span>
<span class="lineNum">     129 </span>            :   //
<span class="lineNum">     130 </span><span class="lineCov">          1 :   tpc-&gt;DefineSection(6,-259.6,68.1,278.);</span>
<span class="lineNum">     131 </span><span class="lineCov">          1 :   tpc-&gt;DefineSection(7,-253.6,68.1,278.);</span>
<span class="lineNum">     132 </span>            :   //
<span class="lineNum">     133 </span><span class="lineCov">          1 :   tpc-&gt;DefineSection(8,-253.6,67.88,278.);//hs</span>
<span class="lineNum">     134 </span><span class="lineCov">          1 :   tpc-&gt;DefineSection(9,-74.0,60.68,278.);// hs</span>
<span class="lineNum">     135 </span>            :   //
<span class="lineNum">     136 </span><span class="lineCov">          1 :   tpc-&gt;DefineSection(10,-74.0,60.1,278.);</span>
<span class="lineNum">     137 </span><span class="lineCov">          1 :   tpc-&gt;DefineSection(11,-73.3,60.1,278.);</span>
<span class="lineNum">     138 </span>            :   //
<span class="lineNum">     139 </span><span class="lineCov">          1 :   tpc-&gt;DefineSection(12,-73.3,56.9,278.); </span>
<span class="lineNum">     140 </span><span class="lineCov">          1 :   tpc-&gt;DefineSection(13,-68.5,56.9,278.);</span>
<span class="lineNum">     141 </span>            :   //
<span class="lineNum">     142 </span><span class="lineCov">          1 :   tpc-&gt;DefineSection(14,-68.5,60.,278.);</span>
<span class="lineNum">     143 </span><span class="lineCov">          1 :   tpc-&gt;DefineSection(15,-64.7,60.,278.);</span>
<span class="lineNum">     144 </span>            :   //
<span class="lineNum">     145 </span><span class="lineCov">          1 :   tpc-&gt;DefineSection(16,-64.7,56.9,278.); </span>
<span class="lineNum">     146 </span><span class="lineCov">          1 :   tpc-&gt;DefineSection(17,73.3,56.9,278.);</span>
<span class="lineNum">     147 </span>            :   //
<span class="lineNum">     148 </span><span class="lineCov">          1 :   tpc-&gt;DefineSection(18,73.3,60.1,278.);</span>
<span class="lineNum">     149 </span><span class="lineCov">          1 :   tpc-&gt;DefineSection(19,74.0,60.1,278.);</span>
<span class="lineNum">     150 </span>            :   //
<span class="lineNum">     151 </span><span class="lineCov">          1 :   tpc-&gt;DefineSection(20,74.0,60.68,278.);// hs</span>
<span class="lineNum">     152 </span><span class="lineCov">          1 :   tpc-&gt;DefineSection(21,253.6,65.38,278.);// hs</span>
<span class="lineNum">     153 </span>            :   //
<span class="lineNum">     154 </span><span class="lineCov">          1 :   tpc-&gt;DefineSection(22,253.6,65.6,278.);</span>
<span class="lineNum">     155 </span><span class="lineCov">          1 :   tpc-&gt;DefineSection(23,259.6,65.6,278.);</span>
<span class="lineNum">     156 </span>            :   //
<span class="lineNum">     157 </span><span class="lineCov">          1 :   tpc-&gt;DefineSection(24,259.6,70.0,278.);</span>
<span class="lineNum">     158 </span><span class="lineCov">          1 :   tpc-&gt;DefineSection(25,260.,70.0,278.);</span>
<span class="lineNum">     159 </span>            :   //
<span class="lineNum">     160 </span><span class="lineCov">          1 :   tpc-&gt;DefineSection(26,260.,83.1,278.);</span>
<span class="lineNum">     161 </span><span class="lineCov">          1 :   tpc-&gt;DefineSection(27,262.1,83.1,278.);</span>
<span class="lineNum">     162 </span>            :   //
<span class="lineNum">     163 </span><span class="lineCov">          1 :   tpc-&gt;DefineSection(28,262.1,77.,278);</span>
<span class="lineNum">     164 </span><span class="lineCov">          1 :   tpc-&gt;DefineSection(29,289.6,77.,278.);</span>
<span class="lineNum">     165 </span>            :   //
<span class="lineNum">     166 </span><span class="lineCov">          1 :   TGeoMedium *m1 = gGeoManager-&gt;GetMedium(&quot;TPC_Air&quot;);</span>
<span class="lineNum">     167 </span><span class="lineCov">          1 :   TGeoVolume *v1 = new TGeoVolume(&quot;TPC_M&quot;,tpc,m1);</span>
<span class="lineNum">     168 </span>            :   //
<span class="lineNum">     169 </span>            :   // drift volume - sensitive volume, extended beyond the
<span class="lineNum">     170 </span>            :   // endcaps, because of the alignment
<span class="lineNum">     171 </span>            :   //
<span class="lineNum">     172 </span><span class="lineCov">          1 :   TGeoPcon *dvol = new TGeoPcon(0.,360.,6);</span>
<span class="lineNum">     173 </span><span class="lineCov">          1 :   dvol-&gt;DefineSection(0,-260.,74.5,264.4);</span>
<span class="lineNum">     174 </span><span class="lineCov">          1 :   dvol-&gt;DefineSection(1,-253.6,74.5,264.4);</span>
<span class="lineNum">     175 </span>            :   //
<span class="lineNum">     176 </span><span class="lineCov">          1 :   dvol-&gt;DefineSection(2,-253.6,76.6774,258.);</span>
<span class="lineNum">     177 </span><span class="lineCov">          1 :   dvol-&gt;DefineSection(3,253.6,76.6774,258.); </span>
<span class="lineNum">     178 </span>            :   //
<span class="lineNum">     179 </span><span class="lineCov">          1 :   dvol-&gt;DefineSection(4,253.6,74.5,264.4);</span>
<span class="lineNum">     180 </span><span class="lineCov">          1 :   dvol-&gt;DefineSection(5,260.,74.5,264.4);</span>
<span class="lineNum">     181 </span>            :   //
<span class="lineNum">     182 </span><span class="lineCov">          1 :   TGeoMedium *m5 = gGeoManager-&gt;GetMedium(&quot;TPC_DriftGas2&quot;);</span>
<span class="lineNum">     183 </span><span class="lineCov">          1 :   TGeoVolume *v9 = new TGeoVolume(&quot;TPC_Drift&quot;,dvol,m5);</span>
<span class="lineNum">     184 </span>            :   //
<span class="lineNum">     185 </span><span class="lineCov">          1 :   v1-&gt;AddNode(v9,1);</span>
<span class="lineNum">     186 </span>            :   //
<span class="lineNum">     187 </span>            :   // outer insulator
<span class="lineNum">     188 </span>            :   //
<span class="lineNum">     189 </span><span class="lineCov">          1 :   TGeoPcon *tpco = new TGeoPcon(0.,360.,6); //insulator</span>
<span class="lineNum">     190 </span>            :   //
<span class="lineNum">     191 </span><span class="lineCov">          1 :   tpco-&gt;DefineSection(0,-256.6,264.8,278.);</span>
<span class="lineNum">     192 </span><span class="lineCov">          1 :   tpco-&gt;DefineSection(1,-253.6,264.8,278.);</span>
<span class="lineNum">     193 </span>            :   //
<span class="lineNum">     194 </span><span class="lineCov">          1 :   tpco-&gt;DefineSection(2,-253.6,258.,278.);</span>
<span class="lineNum">     195 </span><span class="lineCov">          1 :   tpco-&gt;DefineSection(3,250.6,258.,278.);</span>
<span class="lineNum">     196 </span>            :   //
<span class="lineNum">     197 </span><span class="lineCov">          1 :   tpco-&gt;DefineSection(4,250.6,258.,275.5);</span>
<span class="lineNum">     198 </span><span class="lineCov">          1 :   tpco-&gt;DefineSection(5,253.6,258.,275.5);</span>
<span class="lineNum">     199 </span>            :   //
<span class="lineNum">     200 </span><span class="lineCov">          1 :   TGeoMedium *m2 = gGeoManager-&gt;GetMedium(&quot;TPC_CO2&quot;);</span>
<span class="lineNum">     201 </span><span class="lineCov">          1 :   TGeoVolume *v2 = new TGeoVolume(&quot;TPC_OI&quot;,tpco,m2);</span>
<span class="lineNum">     202 </span>            :   //
<span class="lineNum">     203 </span>            :   TGeoRotation *segrot;//segment rotations
<span class="lineNum">     204 </span>            :   //
<span class="lineNum">     205 </span>            :   // outer containment vessel
<span class="lineNum">     206 </span>            :   //
<span class="lineNum">     207 </span><span class="lineCov">          1 :   TGeoPcon *tocv = new TGeoPcon(0.,360.,6);  // containment vessel</span>
<span class="lineNum">     208 </span>            :   //
<span class="lineNum">     209 </span><span class="lineCov">          1 :   tocv-&gt;DefineSection(0,-256.6,264.8,278.);</span>
<span class="lineNum">     210 </span><span class="lineCov">          1 :   tocv-&gt;DefineSection(1,-253.6,264.8,278.);</span>
<span class="lineNum">     211 </span>            :   //
<span class="lineNum">     212 </span><span class="lineCov">          1 :   tocv-&gt;DefineSection(2,-253.6,274.8124,278.);</span>
<span class="lineNum">     213 </span><span class="lineCov">          1 :   tocv-&gt;DefineSection(3,247.6,274.8124,278.);  </span>
<span class="lineNum">     214 </span>            :   //
<span class="lineNum">     215 </span><span class="lineCov">          1 :   tocv-&gt;DefineSection(4,247.6,270.4,278.);</span>
<span class="lineNum">     216 </span><span class="lineCov">          1 :   tocv-&gt;DefineSection(5,250.6,270.4,278.);</span>
<span class="lineNum">     217 </span>            :   //
<span class="lineNum">     218 </span><span class="lineCov">          1 :   TGeoMedium *m3 = gGeoManager-&gt;GetMedium(&quot;TPC_Al&quot;);</span>
<span class="lineNum">     219 </span><span class="lineCov">          1 :   TGeoVolume *v3 = new TGeoVolume(&quot;TPC_OCV&quot;,tocv,m3); </span>
<span class="lineNum">     220 </span>            :   //
<span class="lineNum">     221 </span><span class="lineCov">          1 :   TGeoTubeSeg *to1 = new TGeoTubeSeg(274.8174,277.995,252.1,0.,59.9); //epoxy</span>
<span class="lineNum">     222 </span><span class="lineCov">          1 :   TGeoTubeSeg *to2 = new TGeoTubeSeg(274.8274,277.985,252.1,0.,59.9); //tedlar</span>
<span class="lineNum">     223 </span><span class="lineCov">          1 :   TGeoTubeSeg *to3 = new TGeoTubeSeg(274.8312,277.9812,252.1,0.,59.9);//prepreg2</span>
<span class="lineNum">     224 </span><span class="lineCov">          1 :   TGeoTubeSeg *to4 = new TGeoTubeSeg(274.9062,277.9062,252.1,0.,59.9);//nomex</span>
<span class="lineNum">     225 </span><span class="lineCov">          1 :   TGeoTubeSeg *tog5 = new TGeoTubeSeg(274.8174,277.995,252.1,59.9,60.);//epoxy</span>
<span class="lineNum">     226 </span>            :   //
<span class="lineNum">     227 </span><span class="lineCov">          1 :   TGeoMedium *sm1 = gGeoManager-&gt;GetMedium(&quot;TPC_Epoxy&quot;);</span>
<span class="lineNum">     228 </span><span class="lineCov">          1 :   TGeoMedium *sm2 = gGeoManager-&gt;GetMedium(&quot;TPC_Tedlar&quot;);</span>
<span class="lineNum">     229 </span><span class="lineCov">          1 :   TGeoMedium *sm3 = gGeoManager-&gt;GetMedium(&quot;TPC_Prepreg2&quot;);</span>
<span class="lineNum">     230 </span><span class="lineCov">          1 :   TGeoMedium *sm4 = gGeoManager-&gt;GetMedium(&quot;TPC_Nomex&quot;);</span>
<span class="lineNum">     231 </span>            :   //
<span class="lineNum">     232 </span><span class="lineCov">          1 :   TGeoMedium *smep = gGeoManager-&gt;GetMedium(&quot;TPC_Epoxy1&quot;);</span>
<span class="lineNum">     233 </span>            :   //
<span class="lineNum">     234 </span><span class="lineCov">          1 :   TGeoVolume *tov1 = new TGeoVolume(&quot;TPC_OCV1&quot;,to1,sm1);</span>
<span class="lineNum">     235 </span><span class="lineCov">          1 :   TGeoVolume *tov2 = new TGeoVolume(&quot;TPC_OCV2&quot;,to2,sm2);</span>
<span class="lineNum">     236 </span><span class="lineCov">          1 :   TGeoVolume *tov3 = new TGeoVolume(&quot;TPC_OCV3&quot;,to3,sm3);</span>
<span class="lineNum">     237 </span><span class="lineCov">          1 :   TGeoVolume *tov4 = new TGeoVolume(&quot;TPC_OCV4&quot;,to4,sm4);</span>
<span class="lineNum">     238 </span><span class="lineCov">          1 :   TGeoVolume *togv5 = new TGeoVolume(&quot;TPC_OCVG5&quot;,tog5,sm1);</span>
<span class="lineNum">     239 </span>            :   //
<span class="lineNum">     240 </span><span class="lineCov">          1 :   TGeoMedium *mhs = gGeoManager-&gt;GetMedium(&quot;TPC_Steel&quot;);</span>
<span class="lineNum">     241 </span><span class="lineCov">          1 :   TGeoMedium *m12 =  gGeoManager-&gt;GetMedium(&quot;TPC_Water&quot;);</span>
<span class="lineNum">     242 </span>            :   //-------------------------------------------------------
<span class="lineNum">     243 </span>            :   //  Tpc Outer Field Cage
<span class="lineNum">     244 </span>            :   //  daughters - composite (sandwich)
<span class="lineNum">     245 </span>            :   //-------------------------------------------------------
<span class="lineNum">     246 </span>            : 
<span class="lineNum">     247 </span><span class="lineCov">          1 :   TGeoPcon *tofc = new TGeoPcon(0.,360.,6);</span>
<span class="lineNum">     248 </span>            :   //
<span class="lineNum">     249 </span><span class="lineCov">          1 :   tofc-&gt;DefineSection(0,-253.6,258.,269.6);</span>
<span class="lineNum">     250 </span><span class="lineCov">          1 :   tofc-&gt;DefineSection(1,-250.6,258.,269.6);</span>
<span class="lineNum">     251 </span>            :   //
<span class="lineNum">     252 </span><span class="lineCov">          1 :   tofc-&gt;DefineSection(2,-250.6,258.,260.0676); </span>
<span class="lineNum">     253 </span><span class="lineCov">          1 :   tofc-&gt;DefineSection(3,250.6,258.,260.0676);</span>
<span class="lineNum">     254 </span>            :   //
<span class="lineNum">     255 </span><span class="lineCov">          1 :   tofc-&gt;DefineSection(4,250.6,258.,275.5);</span>
<span class="lineNum">     256 </span><span class="lineCov">          1 :   tofc-&gt;DefineSection(5,253.6,258.,275.5);</span>
<span class="lineNum">     257 </span>            :   //
<span class="lineNum">     258 </span><span class="lineCov">          1 :   TGeoVolume *v4 = new TGeoVolume(&quot;TPC_TOFC&quot;,tofc,m3); </span>
<span class="lineNum">     259 </span>            :   //sandwich
<span class="lineNum">     260 </span><span class="lineCov">          1 :   TGeoTubeSeg *tf1 = new TGeoTubeSeg(258.0,260.0676,252.1,0.,59.9); //tedlar</span>
<span class="lineNum">     261 </span><span class="lineCov">          1 :   TGeoTubeSeg *tf2 = new TGeoTubeSeg(258.0038,260.0638,252.1,0.,59.9); //prepreg3</span>
<span class="lineNum">     262 </span><span class="lineCov">          1 :   TGeoTubeSeg *tf3 = new TGeoTubeSeg(258.0338,260.0338,252.1,0.,59.9);//nomex</span>
<span class="lineNum">     263 </span><span class="lineCov">          1 :   TGeoTubeSeg *tfg4 = new TGeoTubeSeg(258.0,260.0676,252.1,59.9,60.); //epoxy glue</span>
<span class="lineNum">     264 </span>            :   //
<span class="lineNum">     265 </span><span class="lineCov">          1 :   TGeoMedium *sm5 = gGeoManager-&gt;GetMedium(&quot;TPC_Prepreg3&quot;);</span>
<span class="lineNum">     266 </span>            :   //
<span class="lineNum">     267 </span><span class="lineCov">          1 :   TGeoVolume *tf1v = new TGeoVolume(&quot;TPC_OFC1&quot;,tf1,sm2);</span>
<span class="lineNum">     268 </span><span class="lineCov">          1 :   TGeoVolume *tf2v = new TGeoVolume(&quot;TPC_OFC2&quot;,tf2,sm5);</span>
<span class="lineNum">     269 </span><span class="lineCov">          1 :   TGeoVolume *tf3v = new TGeoVolume(&quot;TPC_OFC3&quot;,tf3,sm4);</span>
<span class="lineNum">     270 </span><span class="lineCov">          1 :   TGeoVolume *tfg4v = new TGeoVolume(&quot;TPC_OFCG4&quot;,tfg4,smep);</span>
<span class="lineNum">     271 </span>            :   //
<span class="lineNum">     272 </span>            :   // outer part - positioning
<span class="lineNum">     273 </span>            :   //
<span class="lineNum">     274 </span><span class="lineCov">          1 :   tov1-&gt;AddNode(tov2,1); tov2-&gt;AddNode(tov3,1); tov3-&gt;AddNode(tov4,1);//ocv</span>
<span class="lineNum">     275 </span>            :   //
<span class="lineNum">     276 </span><span class="lineCov">          1 :   tf1v-&gt;AddNode(tf2v,1); tf2v-&gt;AddNode(tf3v,1);//ofc</span>
<span class="lineNum">     277 </span>            :   //
<span class="lineNum">     278 </span><span class="lineCov">          1 :   TGeoVolumeAssembly *t200 = new TGeoVolumeAssembly(&quot;TPC_OCVSEG&quot;);</span>
<span class="lineNum">     279 </span><span class="lineCov">          1 :   TGeoVolumeAssembly *t300 = new TGeoVolumeAssembly(&quot;TPC_OFCSEG&quot;);</span>
<span class="lineNum">     280 </span>            :   //
<span class="lineNum">     281 </span>            :   // assembly OCV and OFC
<span class="lineNum">     282 </span>            :   //
<span class="lineNum">     283 </span>            :   // 1st - no rotation
<span class="lineNum">     284 </span><span class="lineCov">          1 :   t200-&gt;AddNode(tov1,1); t200-&gt;AddNode(togv5,1);</span>
<span class="lineNum">     285 </span><span class="lineCov">          1 :   t300-&gt;AddNode(tf1v,1); t300-&gt;AddNode(tfg4v,1);</span>
<span class="lineNum">     286 </span>            :   // 2nd - rotation 60 deg
<span class="lineNum">     287 </span><span class="lineCov">          1 :   segrot = new TGeoRotation();</span>
<span class="lineNum">     288 </span><span class="lineCov">          1 :   segrot-&gt;RotateZ(60.);</span>
<span class="lineNum">     289 </span><span class="lineCov">          1 :   t200-&gt;AddNode(tov1,2,segrot); t200-&gt;AddNode(togv5,2,segrot);</span>
<span class="lineNum">     290 </span><span class="lineCov">          1 :   t300-&gt;AddNode(tf1v,2,segrot); t300-&gt;AddNode(tfg4v,2,segrot);</span>
<span class="lineNum">     291 </span>            :   // 3rd rotation 120 deg
<span class="lineNum">     292 </span><span class="lineCov">          1 :   segrot = new TGeoRotation();</span>
<span class="lineNum">     293 </span><span class="lineCov">          1 :   segrot-&gt;RotateZ(120.);</span>
<span class="lineNum">     294 </span><span class="lineCov">          1 :   t200-&gt;AddNode(tov1,3,segrot); t200-&gt;AddNode(togv5,3,segrot);</span>
<span class="lineNum">     295 </span><span class="lineCov">          1 :   t300-&gt;AddNode(tf1v,3,segrot); t300-&gt;AddNode(tfg4v,3,segrot);</span>
<span class="lineNum">     296 </span>            :   //4th rotation 180 deg
<span class="lineNum">     297 </span><span class="lineCov">          1 :   segrot = new TGeoRotation();</span>
<span class="lineNum">     298 </span><span class="lineCov">          1 :   segrot-&gt;RotateZ(180.);</span>
<span class="lineNum">     299 </span><span class="lineCov">          1 :   t200-&gt;AddNode(tov1,4,segrot); t200-&gt;AddNode(togv5,4,segrot);</span>
<span class="lineNum">     300 </span><span class="lineCov">          1 :   t300-&gt;AddNode(tf1v,4,segrot); t300-&gt;AddNode(tfg4v,4,segrot);</span>
<span class="lineNum">     301 </span>            :   //5th rotation 240 deg
<span class="lineNum">     302 </span><span class="lineCov">          1 :   segrot = new TGeoRotation();</span>
<span class="lineNum">     303 </span><span class="lineCov">          1 :   segrot-&gt;RotateZ(240.);</span>
<span class="lineNum">     304 </span><span class="lineCov">          1 :   t200-&gt;AddNode(tov1,5,segrot); t200-&gt;AddNode(togv5,5,segrot);</span>
<span class="lineNum">     305 </span><span class="lineCov">          1 :   t300-&gt;AddNode(tf1v,5,segrot); t300-&gt;AddNode(tfg4v,5,segrot);</span>
<span class="lineNum">     306 </span>            :   //6th rotation 300 deg
<span class="lineNum">     307 </span><span class="lineCov">          1 :   segrot = new TGeoRotation();</span>
<span class="lineNum">     308 </span><span class="lineCov">          1 :   segrot-&gt;RotateZ(300.);</span>
<span class="lineNum">     309 </span><span class="lineCov">          1 :   t200-&gt;AddNode(tov1,6,segrot); t200-&gt;AddNode(togv5,6,segrot);</span>
<span class="lineNum">     310 </span><span class="lineCov">          1 :   t300-&gt;AddNode(tf1v,6,segrot); t300-&gt;AddNode(tfg4v,6,segrot);</span>
<span class="lineNum">     311 </span>            :   //
<span class="lineNum">     312 </span><span class="lineCov">          2 :   v3-&gt;AddNode(t200,1,new TGeoTranslation(0.,0.,-1.5)); v4-&gt;AddNode(t300,1);</span>
<span class="lineNum">     313 </span>            :   //
<span class="lineNum">     314 </span><span class="lineCov">          1 :   v2-&gt;AddNode(v3,1); v2-&gt;AddNode(v4,1); </span>
<span class="lineNum">     315 </span>            :   //
<span class="lineNum">     316 </span><span class="lineCov">          1 :   v1-&gt;AddNode(v2,1);</span>
<span class="lineNum">     317 </span>            :   //--------------------------------------------------------------------
<span class="lineNum">     318 </span>            :   // Tpc Inner INsulator (CO2) 
<span class="lineNum">     319 </span>            :   // the cones, the central drum and the inner f.c. sandwich with a piece
<span class="lineNum">     320 </span>            :   // of the flane will be placed in the TPC
<span class="lineNum">     321 </span>            :   //--------------------------------------------------------------------
<span class="lineNum">     322 </span><span class="lineCov">          1 :   TGeoPcon *tpci = new TGeoPcon(0.,360.,4);</span>
<span class="lineNum">     323 </span>            :   //
<span class="lineNum">     324 </span><span class="lineCov">          1 :   tpci-&gt;DefineSection(0,-253.6,68.4,76.6774);</span>
<span class="lineNum">     325 </span><span class="lineCov">          1 :   tpci-&gt;DefineSection(1,-74.0,61.2,76.6774);</span>
<span class="lineNum">     326 </span>            :   //
<span class="lineNum">     327 </span><span class="lineCov">          1 :   tpci-&gt;DefineSection(2,74.0,61.2,76.6774);  </span>
<span class="lineNum">     328 </span>            :   //
<span class="lineNum">     329 </span><span class="lineCov">          1 :   tpci-&gt;DefineSection(3,253.6,65.9,76.6774);</span>
<span class="lineNum">     330 </span>            :   //
<span class="lineNum">     331 </span><span class="lineCov">          1 :   TGeoVolume *v5 = new TGeoVolume(&quot;TPC_INI&quot;,tpci,m2);</span>
<span class="lineNum">     332 </span>            :   //
<span class="lineNum">     333 </span>            :   // now the inner field cage - only part of flanges (2 copies)
<span class="lineNum">     334 </span>            :   //
<span class="lineNum">     335 </span><span class="lineCov">          1 :   TGeoTube *tif1 = new TGeoTube(69.9,76.6774,1.5); </span>
<span class="lineNum">     336 </span><span class="lineCov">          1 :   TGeoVolume *v6 = new TGeoVolume(&quot;TPC_IFC1&quot;,tif1,m3);</span>
<span class="lineNum">     337 </span>            :   //
<span class="lineNum">     338 </span>            :  //---------------------------------------------------------
<span class="lineNum">     339 </span>            :   // Tpc Inner Containment vessel - Muon side
<span class="lineNum">     340 </span>            :   //---------------------------------------------------------
<span class="lineNum">     341 </span><span class="lineCov">          1 :   TGeoPcon *tcms = new TGeoPcon(0.,360.,10);</span>
<span class="lineNum">     342 </span>            :   //
<span class="lineNum">     343 </span><span class="lineCov">          1 :   tcms-&gt;DefineSection(0,-259.1,68.1,74.2);</span>
<span class="lineNum">     344 </span><span class="lineCov">          1 :   tcms-&gt;DefineSection(1,-253.6,68.1,74.2);</span>
<span class="lineNum">     345 </span>            :   //
<span class="lineNum">     346 </span><span class="lineCov">          1 :   tcms-&gt;DefineSection(2,-253.6,68.1,68.4);</span>
<span class="lineNum">     347 </span><span class="lineCov">          1 :   tcms-&gt;DefineSection(3,-74.0,60.9,61.2);</span>
<span class="lineNum">     348 </span>            :   //
<span class="lineNum">     349 </span><span class="lineCov">          1 :   tcms-&gt;DefineSection(4,-74.0,60.1,61.2);</span>
<span class="lineNum">     350 </span><span class="lineCov">          1 :   tcms-&gt;DefineSection(5,-73.3,60.1,61.2);</span>
<span class="lineNum">     351 </span>            :   //
<span class="lineNum">     352 </span><span class="lineCov">          1 :   tcms-&gt;DefineSection(6,-73.3,56.9,61.2);</span>
<span class="lineNum">     353 </span><span class="lineCov">          1 :   tcms-&gt;DefineSection(7,-73.0,56.9,61.2);</span>
<span class="lineNum">     354 </span>            :   //
<span class="lineNum">     355 </span><span class="lineCov">          1 :   tcms-&gt;DefineSection(8,-73.0,56.9,58.8);</span>
<span class="lineNum">     356 </span><span class="lineCov">          1 :   tcms-&gt;DefineSection(9,-71.3,56.9,58.8);</span>
<span class="lineNum">     357 </span>            :   //
<span class="lineNum">     358 </span><span class="lineCov">          1 :   TGeoVolume *v7 = new TGeoVolume(&quot;TPC_ICVM&quot;,tcms,m3);</span>
<span class="lineNum">     359 </span>            :   //------------------------------------------------
<span class="lineNum">     360 </span>            :   //  Heat screen muon side
<span class="lineNum">     361 </span>            :   //------------------------------------------------
<span class="lineNum">     362 </span>            :  
<span class="lineNum">     363 </span><span class="lineCov">          1 :   TGeoCone *thsm = new TGeoCone(89.8,67.88,68.1,60.68,60.9);</span>
<span class="lineNum">     364 </span><span class="lineCov">          1 :   TGeoCone *thsmw = new TGeoCone(89.8,67.94,68.04,60.74,60.84);</span>
<span class="lineNum">     365 </span><span class="lineCov">          1 :   TGeoVolume *hvsm = new TGeoVolume(&quot;TPC_HSM&quot;,thsm,mhs); //steel</span>
<span class="lineNum">     366 </span><span class="lineCov">          1 :   TGeoVolume *hvsmw = new TGeoVolume(&quot;TPC_HSMW&quot;,thsmw,m12); //water </span>
<span class="lineNum">     367 </span>            :   // assembly heat screen muon
<span class="lineNum">     368 </span><span class="lineCov">          1 :   hvsm-&gt;AddNode(hvsmw,1);</span>
<span class="lineNum">     369 </span>            :   //-----------------------------------------------
<span class="lineNum">     370 </span>            :   // inner containment vessel - shaft side
<span class="lineNum">     371 </span>            :   //-----------------------------------------------
<span class="lineNum">     372 </span><span class="lineCov">          1 :   TGeoPcon *tcss = new TGeoPcon(0.,360.,10);</span>
<span class="lineNum">     373 </span>            :   //
<span class="lineNum">     374 </span><span class="lineCov">          1 :   tcss-&gt;DefineSection(0,71.3,56.9,58.8);</span>
<span class="lineNum">     375 </span><span class="lineCov">          1 :   tcss-&gt;DefineSection(1,73.0,56.9,58.8);</span>
<span class="lineNum">     376 </span>            :   //
<span class="lineNum">     377 </span><span class="lineCov">          1 :   tcss-&gt;DefineSection(2,73.0,56.9,61.2);</span>
<span class="lineNum">     378 </span><span class="lineCov">          1 :   tcss-&gt;DefineSection(3,73.3,56.9,61.2);</span>
<span class="lineNum">     379 </span>            :   //  
<span class="lineNum">     380 </span><span class="lineCov">          1 :   tcss-&gt;DefineSection(4,73.3,60.1,61.2);</span>
<span class="lineNum">     381 </span><span class="lineCov">          1 :   tcss-&gt;DefineSection(5,74.0,60.1,61.2);</span>
<span class="lineNum">     382 </span>            :   //
<span class="lineNum">     383 </span><span class="lineCov">          1 :   tcss-&gt;DefineSection(6,74.0,60.9,61.2);</span>
<span class="lineNum">     384 </span><span class="lineCov">          1 :   tcss-&gt;DefineSection(7,253.6,65.6,65.9);</span>
<span class="lineNum">     385 </span>            :   //
<span class="lineNum">     386 </span><span class="lineCov">          1 :   tcss-&gt;DefineSection(8,253.6,65.6,74.2);</span>
<span class="lineNum">     387 </span><span class="lineCov">          1 :   tcss-&gt;DefineSection(9,258.1,65.6,74.2);</span>
<span class="lineNum">     388 </span>            :   //
<span class="lineNum">     389 </span><span class="lineCov">          1 :   TGeoVolume *v8 = new TGeoVolume(&quot;TPC_ICVS&quot;,tcss,m3);</span>
<span class="lineNum">     390 </span>            :   //-------------------------------------------------
<span class="lineNum">     391 </span>            :   //  Heat screen shaft side
<span class="lineNum">     392 </span>            :   //--------------------------------------------------
<span class="lineNum">     393 </span><span class="lineCov">          1 :   TGeoCone *thss = new TGeoCone(89.8,60.68,60.9,65.38,65.6);       </span>
<span class="lineNum">     394 </span><span class="lineCov">          1 :   TGeoCone *thssw = new TGeoCone(89.8,60.74,60.84,65.44,65.54);     </span>
<span class="lineNum">     395 </span><span class="lineCov">          1 :   TGeoVolume *hvss = new TGeoVolume(&quot;TPC_HSS&quot;,thss,mhs); //steel</span>
<span class="lineNum">     396 </span><span class="lineCov">          1 :   TGeoVolume *hvssw = new TGeoVolume(&quot;TPC_HSSW&quot;,thssw,m12); //water </span>
<span class="lineNum">     397 </span>            :   //assembly heat screen shaft
<span class="lineNum">     398 </span><span class="lineCov">          1 :   hvss-&gt;AddNode(hvssw,1);</span>
<span class="lineNum">     399 </span>            :   //-----------------------------------------------
<span class="lineNum">     400 </span>            :   //  Inner field cage
<span class="lineNum">     401 </span>            :   //  define 4 parts and make an assembly
<span class="lineNum">     402 </span>            :   //-----------------------------------------------
<span class="lineNum">     403 </span>            :   // part1 - Al - 2 copies
<span class="lineNum">     404 </span><span class="lineCov">          1 :   TGeoTube *t1 = new TGeoTube(76.6774,78.845,0.75);</span>
<span class="lineNum">     405 </span><span class="lineCov">          1 :   TGeoVolume *tv1 = new TGeoVolume(&quot;TPC_IFC2&quot;,t1,m3);</span>
<span class="lineNum">     406 </span>            :   // sandwich - outermost parts - 2 copies
<span class="lineNum">     407 </span>            :   //
<span class="lineNum">     408 </span>            :   // segment outermost
<span class="lineNum">     409 </span>            :   //
<span class="lineNum">     410 </span><span class="lineCov">          1 :   TGeoTubeSeg *t2 = new TGeoTubeSeg(76.6774,78.845,74.175,350.,109.4); // tedlar 38 microns</span>
<span class="lineNum">     411 </span><span class="lineCov">          1 :   TGeoTubeSeg *t3 = new TGeoTubeSeg(76.6812,78.8412,74.175,350.,109.4); // prepreg2 500 microns</span>
<span class="lineNum">     412 </span><span class="lineCov">          1 :   TGeoTubeSeg *t4 = new TGeoTubeSeg(76.7312,78.7912,74.175,350.,109.4); // prepreg3 300 microns</span>
<span class="lineNum">     413 </span><span class="lineCov">          1 :   TGeoTubeSeg *t5 = new TGeoTubeSeg(76.7612,78.7612,74.175,350.,109.4); // nomex 2 cm</span>
<span class="lineNum">     414 </span><span class="lineCov">          1 :   TGeoTubeSeg *tepox1 = new TGeoTubeSeg(76.6774,78.845,74.175,109.4,110.);//epoxy</span>
<span class="lineNum">     415 </span><span class="lineCov">          1 :   TGeoTubeSeg *tpr1 = new TGeoTubeSeg(78.845,78.885,74.175,109.,111.);</span>
<span class="lineNum">     416 </span>            :   
<span class="lineNum">     417 </span>            :   // volumes for the outer part  
<span class="lineNum">     418 </span><span class="lineCov">          1 :   TGeoVolume *tv2 = new TGeoVolume(&quot;TPC_IFC3&quot;,t2,sm2);</span>
<span class="lineNum">     419 </span><span class="lineCov">          1 :   TGeoVolume *tv3 = new TGeoVolume(&quot;TPC_IFC4&quot;,t3,sm3);</span>
<span class="lineNum">     420 </span><span class="lineCov">          1 :   TGeoVolume *tv4 = new TGeoVolume(&quot;TPC_IFC5&quot;,t4,sm5);</span>
<span class="lineNum">     421 </span><span class="lineCov">          1 :   TGeoVolume *tv5 = new TGeoVolume(&quot;TPC_IFC6&quot;,t5,sm4);</span>
<span class="lineNum">     422 </span><span class="lineCov">          1 :   TGeoVolume *tvep1 = new TGeoVolume(&quot;TPC_IFEPOX1&quot;,tepox1,smep); </span>
<span class="lineNum">     423 </span><span class="lineCov">          1 :   TGeoVolume *tvpr1 = new TGeoVolume(&quot;TPC_PRSTR1&quot;,tpr1,sm2); </span>
<span class="lineNum">     424 </span>            :   //
<span class="lineNum">     425 </span>            :   // middle parts - 2 copies
<span class="lineNum">     426 </span>            :   //
<span class="lineNum">     427 </span>            :   // segment middle
<span class="lineNum">     428 </span>            :   //
<span class="lineNum">     429 </span><span class="lineCov">          1 :   TGeoTubeSeg *t6 = new TGeoTubeSeg(76.6774,78.795,5.,350.,109.4); // tedlar 38 microns</span>
<span class="lineNum">     430 </span><span class="lineCov">          1 :   TGeoTubeSeg *t7 = new TGeoTubeSeg(76.6812,78.7912,5.,350.,109.4); // prepreg2 250 microns</span>
<span class="lineNum">     431 </span><span class="lineCov">          1 :   TGeoTubeSeg *t8 = new TGeoTubeSeg(76.7062,78.7662,5.,350.,109.4); // prepreg3 300 microns</span>
<span class="lineNum">     432 </span><span class="lineCov">          1 :   TGeoTubeSeg *t9 = new TGeoTubeSeg(76.7362,78.7362,5.,350.,109.4); // nomex 2 cm</span>
<span class="lineNum">     433 </span><span class="lineCov">          1 :   TGeoTubeSeg *tepox2 = new TGeoTubeSeg(76.6774,78.795,5.,109.4,110.);//epoxy</span>
<span class="lineNum">     434 </span><span class="lineCov">          1 :   TGeoTubeSeg *tpr2 = new TGeoTubeSeg(78.795,78.835,5.,109.,111.);</span>
<span class="lineNum">     435 </span>            :   // volumes for the middle part
<span class="lineNum">     436 </span><span class="lineCov">          1 :   TGeoVolume *tv6 = new TGeoVolume(&quot;TPC_IFC7&quot;,t6,sm2);</span>
<span class="lineNum">     437 </span><span class="lineCov">          1 :   TGeoVolume *tv7 = new TGeoVolume(&quot;TPC_IFC8&quot;,t7,sm3);</span>
<span class="lineNum">     438 </span><span class="lineCov">          1 :   TGeoVolume *tv8 = new TGeoVolume(&quot;TPC_IFC9&quot;,t8,sm5);</span>
<span class="lineNum">     439 </span><span class="lineCov">          1 :   TGeoVolume *tv9 = new TGeoVolume(&quot;TPC_IFC10&quot;,t9,sm4);</span>
<span class="lineNum">     440 </span><span class="lineCov">          1 :   TGeoVolume *tvep2 = new TGeoVolume(&quot;TPC_IFEPOX2&quot;,tepox2,smep);</span>
<span class="lineNum">     441 </span><span class="lineCov">          1 :   TGeoVolume *tvpr2 = new TGeoVolume(&quot;TPC_PRSTR2&quot;,tpr2,sm2);</span>
<span class="lineNum">     442 </span>            :   // central part - 1 copy
<span class="lineNum">     443 </span>            :   // 
<span class="lineNum">     444 </span>            :   // segment central part
<span class="lineNum">     445 </span>            :   //
<span class="lineNum">     446 </span><span class="lineCov">          1 :   TGeoTubeSeg *t10 = new TGeoTubeSeg(76.6774,78.785,93.75,350.,109.4); // tedlar 38 microns </span>
<span class="lineNum">     447 </span><span class="lineCov">          1 :   TGeoTubeSeg *t11 = new TGeoTubeSeg(76.6812,78.7812,93.75,350.,109.4); // prepreg3 500 microns</span>
<span class="lineNum">     448 </span><span class="lineCov">          1 :   TGeoTubeSeg *t12 = new TGeoTubeSeg(76.7312,78.7312,93.75,350.,109.4); // nomex 2 cm </span>
<span class="lineNum">     449 </span><span class="lineCov">          1 :   TGeoTubeSeg *tepox3 = new TGeoTubeSeg(76.6774,78.785,93.75,109.4,110.);//epoxy</span>
<span class="lineNum">     450 </span><span class="lineCov">          1 :   TGeoTubeSeg *tpr3 = new TGeoTubeSeg(78.785,78.825,93.75,109.,111.);</span>
<span class="lineNum">     451 </span>            :   // volumes for the central part
<span class="lineNum">     452 </span><span class="lineCov">          1 :   TGeoVolume *tv10 = new TGeoVolume(&quot;TPC_IFC11&quot;,t10,sm2);</span>
<span class="lineNum">     453 </span><span class="lineCov">          1 :   TGeoVolume *tv11 = new TGeoVolume(&quot;TPC_IFC12&quot;,t11,sm5);</span>
<span class="lineNum">     454 </span><span class="lineCov">          1 :   TGeoVolume *tv12 = new TGeoVolume(&quot;TPC_IFC13&quot;,t12,sm4);</span>
<span class="lineNum">     455 </span><span class="lineCov">          1 :   TGeoVolume *tvep3 = new TGeoVolume(&quot;TPC_IFEPOX3&quot;,tepox3,smep);</span>
<span class="lineNum">     456 </span><span class="lineCov">          1 :   TGeoVolume *tvpr3 = new TGeoVolume(&quot;TPC_PRSTR3&quot;,tpr3,sm2);  </span>
<span class="lineNum">     457 </span>            :   //
<span class="lineNum">     458 </span>            :   // creating a sandwich for the outer par,t tv2 is the mother
<span class="lineNum">     459 </span>            :   //
<span class="lineNum">     460 </span><span class="lineCov">          1 :   tv2-&gt;AddNode(tv3,1); tv3-&gt;AddNode(tv4,1); tv4-&gt;AddNode(tv5,1);</span>
<span class="lineNum">     461 </span>            :   //
<span class="lineNum">     462 </span>            :   // creating a sandwich for the middle part, tv6 is the mother
<span class="lineNum">     463 </span>            :   //
<span class="lineNum">     464 </span><span class="lineCov">          1 :   tv6-&gt;AddNode(tv7,1); tv7-&gt;AddNode(tv8,1); tv8-&gt;AddNode(tv9,1);</span>
<span class="lineNum">     465 </span>            :   //
<span class="lineNum">     466 </span>            :   // creating a sandwich for the central part, tv10 is the mother
<span class="lineNum">     467 </span>            :   //
<span class="lineNum">     468 </span><span class="lineCov">          1 :   tv10-&gt;AddNode(tv11,1); tv11-&gt;AddNode(tv12,1);</span>
<span class="lineNum">     469 </span>            :   //
<span class="lineNum">     470 </span><span class="lineCov">          1 :   TGeoVolumeAssembly *tv100 = new TGeoVolumeAssembly(&quot;TPC_IFC&quot;); // ifc itself - 3 segments</span>
<span class="lineNum">     471 </span>            : 
<span class="lineNum">     472 </span>            :   //
<span class="lineNum">     473 </span>            :   // first segment - no rotation
<span class="lineNum">     474 </span>            :   //
<span class="lineNum">     475 </span>            :   // central
<span class="lineNum">     476 </span><span class="lineCov">          1 :   tv100-&gt;AddNode(tv10,1); //sandwich</span>
<span class="lineNum">     477 </span><span class="lineCov">          1 :   tv100-&gt;AddNode(tvep3,1);//epoxy</span>
<span class="lineNum">     478 </span><span class="lineCov">          1 :   tv100-&gt;AddNode(tvpr3,1);//prepreg strip                                 </span>
<span class="lineNum">     479 </span>            :   // middle
<span class="lineNum">     480 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tv6,1,new TGeoTranslation(0.,0.,-98.75)); //sandwich1</span>
<span class="lineNum">     481 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tv6,2,new TGeoTranslation(0.,0.,98.75)); // sandwich2</span>
<span class="lineNum">     482 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tvep2,1,new TGeoTranslation(0.,0.,-98.75)); //epoxy</span>
<span class="lineNum">     483 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tvep2,2,new TGeoTranslation(0.,0.,98.75)); //epoxy</span>
<span class="lineNum">     484 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tvpr2,1,new TGeoTranslation(0.,0.,-98.75));//prepreg strip</span>
<span class="lineNum">     485 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tvpr2,2,new TGeoTranslation(0.,0.,98.75));</span>
<span class="lineNum">     486 </span>            :   // outer
<span class="lineNum">     487 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tv2,1,new TGeoTranslation(0.,0.,-177.925)); //sandwich</span>
<span class="lineNum">     488 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tv2,2,new TGeoTranslation(0.,0.,177.925));</span>
<span class="lineNum">     489 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tvep1,1,new TGeoTranslation(0.,0.,-177.925)); //epoxy</span>
<span class="lineNum">     490 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tvep1,2,new TGeoTranslation(0.,0.,177.925));</span>
<span class="lineNum">     491 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tvpr1,1,new TGeoTranslation(0.,0.,-177.925));//prepreg strip</span>
<span class="lineNum">     492 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tvpr1,2,new TGeoTranslation(0.,0.,-177.925));</span>
<span class="lineNum">     493 </span>            :   //
<span class="lineNum">     494 </span>            :   // second segment - rotation 120 deg.
<span class="lineNum">     495 </span>            :   //
<span class="lineNum">     496 </span><span class="lineCov">          1 :   segrot = new TGeoRotation();</span>
<span class="lineNum">     497 </span><span class="lineCov">          1 :   segrot-&gt;RotateZ(120.);</span>
<span class="lineNum">     498 </span>            :   //
<span class="lineNum">     499 </span>            :   // central    
<span class="lineNum">     500 </span><span class="lineCov">          1 :   tv100-&gt;AddNode(tv10,2,segrot); //sandwich</span>
<span class="lineNum">     501 </span><span class="lineCov">          1 :   tv100-&gt;AddNode(tvep3,2,segrot);//epoxy</span>
<span class="lineNum">     502 </span><span class="lineCov">          1 :   tv100-&gt;AddNode(tvpr3,2,segrot);//prepreg strip</span>
<span class="lineNum">     503 </span>            :   // middle
<span class="lineNum">     504 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tv6,3,new TGeoCombiTrans(0.,0.,-98.75,segrot)); //sandwich1</span>
<span class="lineNum">     505 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tv6,4,new TGeoCombiTrans(0.,0.,98.75,segrot)); // sandwich2</span>
<span class="lineNum">     506 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tvep2,3,new TGeoCombiTrans(0.,0.,-98.75,segrot)); //epoxy</span>
<span class="lineNum">     507 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tvep2,4,new TGeoCombiTrans(0.,0.,98.75,segrot)); //epoxy</span>
<span class="lineNum">     508 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tvpr2,3,new TGeoCombiTrans(0.,0.,-98.75,segrot));//prepreg strip</span>
<span class="lineNum">     509 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tvpr2,4,new TGeoCombiTrans(0.,0.,98.75,segrot));</span>
<span class="lineNum">     510 </span>            :   //outer
<span class="lineNum">     511 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tv2,3,new TGeoCombiTrans(0.,0.,-177.925,segrot));//sandwich</span>
<span class="lineNum">     512 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tv2,4,new TGeoCombiTrans(0.,0.,177.925,segrot));</span>
<span class="lineNum">     513 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tvep1,3,new TGeoCombiTrans(0.,0.,-177.925,segrot));//epoxy</span>
<span class="lineNum">     514 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tvep1,4,new TGeoCombiTrans(0.,0.,177.925,segrot));</span>
<span class="lineNum">     515 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tvpr1,3,new TGeoCombiTrans(0.,0.,-177.925,segrot));//prepreg strip</span>
<span class="lineNum">     516 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tvpr1,4,new TGeoCombiTrans(0.,0.,177.925,segrot));</span>
<span class="lineNum">     517 </span>            :   //
<span class="lineNum">     518 </span>            :   //  third segment - rotation 240 deg.
<span class="lineNum">     519 </span>            :   //
<span class="lineNum">     520 </span><span class="lineCov">          1 :   segrot = new TGeoRotation();</span>
<span class="lineNum">     521 </span><span class="lineCov">          1 :   segrot-&gt;RotateZ(240.);</span>
<span class="lineNum">     522 </span>            :   //
<span class="lineNum">     523 </span>            :   // central    
<span class="lineNum">     524 </span><span class="lineCov">          1 :   tv100-&gt;AddNode(tv10,3,segrot); //sandwich</span>
<span class="lineNum">     525 </span><span class="lineCov">          1 :   tv100-&gt;AddNode(tvep3,3,segrot);//epoxy</span>
<span class="lineNum">     526 </span><span class="lineCov">          1 :   tv100-&gt;AddNode(tvpr3,3,segrot);//prepreg strip</span>
<span class="lineNum">     527 </span>            :   // middle
<span class="lineNum">     528 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tv6,5,new TGeoCombiTrans(0.,0.,-98.75,segrot)); //sandwich1</span>
<span class="lineNum">     529 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tv6,6,new TGeoCombiTrans(0.,0.,98.75,segrot)); // sandwich2</span>
<span class="lineNum">     530 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tvep2,5,new TGeoCombiTrans(0.,0.,-98.75,segrot)); //epoxy</span>
<span class="lineNum">     531 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tvep2,6,new TGeoCombiTrans(0.,0.,98.75,segrot)); //epoxy</span>
<span class="lineNum">     532 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tvpr2,5,new TGeoCombiTrans(0.,0.,-98.75,segrot));//prepreg strip</span>
<span class="lineNum">     533 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tvpr2,6,new TGeoCombiTrans(0.,0.,98.75,segrot));</span>
<span class="lineNum">     534 </span>            :   //outer
<span class="lineNum">     535 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tv2,5,new TGeoCombiTrans(0.,0.,-177.925,segrot));//sandwich</span>
<span class="lineNum">     536 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tv2,6,new TGeoCombiTrans(0.,0.,177.925,segrot));</span>
<span class="lineNum">     537 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tvep1,5,new TGeoCombiTrans(0.,0.,-177.925,segrot));//epoxy</span>
<span class="lineNum">     538 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tvep1,6,new TGeoCombiTrans(0.,0.,177.925,segrot));</span>
<span class="lineNum">     539 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tvpr1,5,new TGeoCombiTrans(0.,0.,-177.925,segrot));//prepreg strip</span>
<span class="lineNum">     540 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tvpr1,6,new TGeoCombiTrans(0.,0.,177.925,segrot));</span>
<span class="lineNum">     541 </span>            :   // Al parts - rings
<span class="lineNum">     542 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tv1,1,new TGeoTranslation(0.,0.,-252.85));</span>
<span class="lineNum">     543 </span><span class="lineCov">          2 :   tv100-&gt;AddNode(tv1,2,new TGeoTranslation(0.,0.,252.85));</span>
<span class="lineNum">     544 </span>            :   //
<span class="lineNum">     545 </span><span class="lineCov">          2 :   v5-&gt;AddNode(v6,1, new TGeoTranslation(0.,0.,-252.1));</span>
<span class="lineNum">     546 </span><span class="lineCov">          2 :   v5-&gt;AddNode(v6,2, new TGeoTranslation(0.,0.,252.1));</span>
<span class="lineNum">     547 </span><span class="lineCov">          1 :   v1-&gt;AddNode(v5,1); v1-&gt;AddNode(v7,1); v1-&gt;AddNode(v8,1); </span>
<span class="lineNum">     548 </span><span class="lineCov">          2 :   v1-&gt;AddNode(hvsm,1,new TGeoTranslation(0.,0.,-163.8)); </span>
<span class="lineNum">     549 </span><span class="lineCov">          2 :   v1-&gt;AddNode(hvss,1,new TGeoTranslation(0.,0.,163.8)); </span>
<span class="lineNum">     550 </span><span class="lineCov">          1 :   v9-&gt;AddNode(tv100,1);</span>
<span class="lineNum">     551 </span>            :   //
<span class="lineNum">     552 </span>            :   // central drum 
<span class="lineNum">     553 </span>            :   //
<span class="lineNum">     554 </span>            :   // flange + sandwich
<span class="lineNum">     555 </span>            :   //
<span class="lineNum">     556 </span><span class="lineCov">          1 :   TGeoPcon *cfl = new TGeoPcon(0.,360.,6);</span>
<span class="lineNum">     557 </span><span class="lineCov">          1 :   cfl-&gt;DefineSection(0,-71.1,59.7,61.2);</span>
<span class="lineNum">     558 </span><span class="lineCov">          1 :   cfl-&gt;DefineSection(1,-68.6,59.7,61.2);</span>
<span class="lineNum">     559 </span>            :   //
<span class="lineNum">     560 </span><span class="lineCov">          1 :   cfl-&gt;DefineSection(2,-68.6,60.6124,61.2);</span>
<span class="lineNum">     561 </span><span class="lineCov">          1 :   cfl-&gt;DefineSection(3,68.6,60.6124,61.2); </span>
<span class="lineNum">     562 </span>            :   //
<span class="lineNum">     563 </span><span class="lineCov">          1 :   cfl-&gt;DefineSection(4,68.6,59.7,61.2);</span>
<span class="lineNum">     564 </span><span class="lineCov">          1 :   cfl-&gt;DefineSection(5,71.1,59.7,61.2);  </span>
<span class="lineNum">     565 </span>            :   //
<span class="lineNum">     566 </span><span class="lineCov">          1 :   TGeoVolume *cflv = new TGeoVolume(&quot;TPC_CDR&quot;,cfl,m3);</span>
<span class="lineNum">     567 </span>            :   // sandwich
<span class="lineNum">     568 </span><span class="lineCov">          1 :   TGeoTubeSeg *cd1 = new TGeoTubeSeg(60.6224,61.19,71.1,0.2,119.2);</span>
<span class="lineNum">     569 </span><span class="lineCov">          1 :   TGeoTubeSeg *cd2 = new TGeoTubeSeg(60.6262,61.1862,71.1,0.2,119.2);</span>
<span class="lineNum">     570 </span><span class="lineCov">          1 :   TGeoTubeSeg *cd3 = new TGeoTubeSeg(60.6462,61.1662,71.1,0.2,119.2);</span>
<span class="lineNum">     571 </span><span class="lineCov">          1 :   TGeoTubeSeg *cd4 = new TGeoTubeSeg(60.6562,61.1562,71.1,0.2,119.2);</span>
<span class="lineNum">     572 </span><span class="lineCov">          1 :   TGeoTubeSeg *tepox4 = new TGeoTubeSeg(60.6224,61.19,71.1,359.8,0.8);</span>
<span class="lineNum">     573 </span>            :   //
<span class="lineNum">     574 </span><span class="lineCov">          1 :   TGeoMedium *sm6 = gGeoManager-&gt;GetMedium(&quot;TPC_Prepreg1&quot;);</span>
<span class="lineNum">     575 </span><span class="lineCov">          1 :   TGeoMedium *sm8 = gGeoManager-&gt;GetMedium(&quot;TPC_Epoxyfm&quot;);</span>
<span class="lineNum">     576 </span><span class="lineCov">          1 :   TGeoVolume *cd1v = new TGeoVolume(&quot;TPC_CDR1&quot;,cd1,sm2); //tedlar</span>
<span class="lineNum">     577 </span><span class="lineCov">          1 :   TGeoVolume *cd2v = new TGeoVolume(&quot;TPC_CDR2&quot;,cd2,sm6);// prepreg1</span>
<span class="lineNum">     578 </span><span class="lineCov">          1 :   TGeoVolume *cd3v = new TGeoVolume(&quot;TPC_CDR3&quot;,cd3,sm8); //epoxy film</span>
<span class="lineNum">     579 </span><span class="lineCov">          1 :   TGeoVolume *cd4v = new TGeoVolume(&quot;TPC_CDR4&quot;,cd4,sm4); //nomex</span>
<span class="lineNum">     580 </span><span class="lineCov">          1 :   TGeoVolume *tvep4 = new TGeoVolume(&quot;TPC_IFEPOX4&quot;,tepox4,smep);</span>
<span class="lineNum">     581 </span>            : 
<span class="lineNum">     582 </span>            :   //
<span class="lineNum">     583 </span>            :   // seals for central drum 2 copies
<span class="lineNum">     584 </span>            :   //
<span class="lineNum">     585 </span><span class="lineCov">          1 :   TGeoTube *cs = new TGeoTube(56.9,61.2,0.1);</span>
<span class="lineNum">     586 </span><span class="lineCov">          1 :   TGeoMedium *sm7 = gGeoManager-&gt;GetMedium(&quot;TPC_Mylar&quot;);</span>
<span class="lineNum">     587 </span><span class="lineCov">          1 :   TGeoVolume *csv = new TGeoVolume(&quot;TPC_CDRS&quot;,cs,sm7);</span>
<span class="lineNum">     588 </span><span class="lineCov">          2 :   v1-&gt;AddNode(csv,1,new TGeoTranslation(0.,0.,-71.2));</span>
<span class="lineNum">     589 </span><span class="lineCov">          2 :   v1-&gt;AddNode(csv,2,new TGeoTranslation(0.,0.,71.2));</span>
<span class="lineNum">     590 </span>            :   //
<span class="lineNum">     591 </span>            :   // seal collars 
<span class="lineNum">     592 </span><span class="lineCov">          1 :   TGeoPcon *se = new TGeoPcon(0.,360.,6);</span>
<span class="lineNum">     593 </span><span class="lineCov">          1 :   se-&gt;DefineSection(0,-72.8,59.7,61.2);</span>
<span class="lineNum">     594 </span><span class="lineCov">          1 :   se-&gt;DefineSection(1,-72.3,59.7,61.2);</span>
<span class="lineNum">     595 </span>            :   //
<span class="lineNum">     596 </span><span class="lineCov">          1 :   se-&gt;DefineSection(2,-72.3,58.85,61.2);</span>
<span class="lineNum">     597 </span><span class="lineCov">          1 :   se-&gt;DefineSection(3,-71.6,58.85,61.2); </span>
<span class="lineNum">     598 </span>            :   //
<span class="lineNum">     599 </span><span class="lineCov">          1 :   se-&gt;DefineSection(4,-71.6,59.7,61.2);</span>
<span class="lineNum">     600 </span><span class="lineCov">          1 :   se-&gt;DefineSection(5,-71.3,59.7,61.2);  </span>
<span class="lineNum">     601 </span>            :   //
<span class="lineNum">     602 </span><span class="lineCov">          1 :   TGeoVolume *sev = new TGeoVolume(&quot;TPC_CDCE&quot;,se,m3);</span>
<span class="lineNum">     603 </span>            :   //
<span class="lineNum">     604 </span><span class="lineCov">          1 :   TGeoTube *si = new TGeoTube(56.9,58.8,1.); </span>
<span class="lineNum">     605 </span><span class="lineCov">          1 :   TGeoVolume *siv = new TGeoVolume(&quot;TPC_CDCI&quot;,si,m3);</span>
<span class="lineNum">     606 </span>            :   //
<span class="lineNum">     607 </span>            :   // define reflection matrix 
<span class="lineNum">     608 </span>            :   //
<span class="lineNum">     609 </span><span class="lineCov">          1 :   TGeoRotation *ref = new TGeoRotation(&quot;ref&quot;,90.,0.,90.,90.,180.,0.);</span>
<span class="lineNum">     610 </span>            :   //
<span class="lineNum">     611 </span><span class="lineCov">          1 :   cd1v-&gt;AddNode(cd2v,1); cd2v-&gt;AddNode(cd3v,1); cd3v-&gt;AddNode(cd4v,1); //sandwich</span>
<span class="lineNum">     612 </span>            :   // first segment  
<span class="lineNum">     613 </span><span class="lineCov">          1 :   cflv-&gt;AddNode(cd1v,1); cflv-&gt;AddNode(tvep4,1);</span>
<span class="lineNum">     614 </span>            :   // second segment
<span class="lineNum">     615 </span><span class="lineCov">          1 :   segrot = new TGeoRotation();</span>
<span class="lineNum">     616 </span><span class="lineCov">          1 :   segrot-&gt;RotateZ(120.);</span>
<span class="lineNum">     617 </span><span class="lineCov">          1 :   cflv-&gt;AddNode(cd1v,2,segrot); cflv-&gt;AddNode(tvep4,2,segrot);</span>
<span class="lineNum">     618 </span>            :   // third segment
<span class="lineNum">     619 </span><span class="lineCov">          1 :   segrot = new TGeoRotation();</span>
<span class="lineNum">     620 </span><span class="lineCov">          1 :   segrot-&gt;RotateZ(240.);</span>
<span class="lineNum">     621 </span><span class="lineCov">          1 :   cflv-&gt;AddNode(cd1v,3,segrot); cflv-&gt;AddNode(tvep4,3,segrot);</span>
<span class="lineNum">     622 </span>            :   //
<span class="lineNum">     623 </span><span class="lineCov">          2 :   v1-&gt;AddNode(siv,1,new TGeoTranslation(0.,0.,-69.9));</span>
<span class="lineNum">     624 </span><span class="lineCov">          2 :   v1-&gt;AddNode(siv,2,new TGeoTranslation(0.,0.,69.9));</span>
<span class="lineNum">     625 </span><span class="lineCov">          1 :   v1-&gt;AddNode(sev,1); v1-&gt;AddNode(sev,2,ref); v1-&gt;AddNode(cflv,1);</span>
<span class="lineNum">     626 </span>            :   //
<span class="lineNum">     627 </span>            :   // central membrane - 2 rings and a mylar membrane - assembly
<span class="lineNum">     628 </span>            :   //
<span class="lineNum">     629 </span><span class="lineCov">          1 :   TGeoTube *ih = new TGeoTube(81.05,84.05,0.3);</span>
<span class="lineNum">     630 </span><span class="lineCov">          1 :   TGeoTube *oh = new TGeoTube(250.,256.,0.5);</span>
<span class="lineNum">     631 </span><span class="lineCov">          1 :   TGeoTube *mem = new TGeoTube(84.05,250.,0.00115);</span>
<span class="lineNum">     632 </span>            : 
<span class="lineNum">     633 </span>            :   //
<span class="lineNum">     634 </span><span class="lineCov">          1 :   TGeoMedium *m4 = gGeoManager-&gt;GetMedium(&quot;TPC_G10&quot;);</span>
<span class="lineNum">     635 </span>            :   //
<span class="lineNum">     636 </span><span class="lineCov">          1 :   TGeoVolume *ihv = new TGeoVolume(&quot;TPC_IHVH&quot;,ih,m3);</span>
<span class="lineNum">     637 </span><span class="lineCov">          1 :   TGeoVolume *ohv = new TGeoVolume(&quot;TPC_OHVH&quot;,oh,m3);</span>
<span class="lineNum">     638 </span>            :   
<span class="lineNum">     639 </span><span class="lineCov">          1 :   TGeoVolume *memv = new TGeoVolume(&quot;TPC_HV&quot;,mem,sm7);</span>
<span class="lineNum">     640 </span>            :   //
<span class="lineNum">     641 </span><span class="lineCov">          1 :   TGeoVolumeAssembly *cm = new TGeoVolumeAssembly(&quot;TPC_HVMEM&quot;);</span>
<span class="lineNum">     642 </span><span class="lineCov">          1 :   cm-&gt;AddNode(ihv,1);</span>
<span class="lineNum">     643 </span><span class="lineCov">          1 :   cm-&gt;AddNode(ohv,1);</span>
<span class="lineNum">     644 </span><span class="lineCov">          1 :   cm-&gt;AddNode(memv,1);</span>
<span class="lineNum">     645 </span>            :  
<span class="lineNum">     646 </span><span class="lineCov">          1 :   v9-&gt;AddNode(cm,1);</span>
<span class="lineNum">     647 </span>            :   //
<span class="lineNum">     648 </span>            :   // end caps - they are make as an assembly of single segments
<span class="lineNum">     649 </span>            :   // containing both readout chambers
<span class="lineNum">     650 </span>            :   //
<span class="lineNum">     651 </span><span class="lineCov">          1 :   Double_t openingAngle = 10.*TMath::DegToRad();</span>
<span class="lineNum">     652 </span>            :   Double_t thick=1.5; // rib
<span class="lineNum">     653 </span><span class="lineCov">          1 :   Double_t shift = thick/TMath::Sin(openingAngle);</span>
<span class="lineNum">     654 </span>            :   //
<span class="lineNum">     655 </span>            :   Double_t lowEdge = 86.3; // hole in the wheel
<span class="lineNum">     656 </span>            :   Double_t upEdge = 240.4; // hole in the wheel
<span class="lineNum">     657 </span>            :   //
<span class="lineNum">     658 </span><span class="lineCov">          1 :   new TGeoTubeSeg(&quot;sec&quot;,74.5,264.4,3.,0.,20.);</span>
<span class="lineNum">     659 </span>            :   //
<span class="lineNum">     660 </span><span class="lineCov">          1 :   TGeoPgon *hole = new TGeoPgon(&quot;hole&quot;,0.,20.,1,4);</span>
<span class="lineNum">     661 </span>            :   //
<span class="lineNum">     662 </span><span class="lineCov">          1 :   hole-&gt;DefineSection(0,-3.5,lowEdge-shift,upEdge-shift);</span>
<span class="lineNum">     663 </span><span class="lineCov">          1 :   hole-&gt;DefineSection(1,-1.5,lowEdge-shift,upEdge-shift);</span>
<span class="lineNum">     664 </span>            :   //
<span class="lineNum">     665 </span><span class="lineCov">          1 :   hole-&gt;DefineSection(2,-1.5,lowEdge-shift,upEdge+3.-shift);</span>
<span class="lineNum">     666 </span><span class="lineCov">          1 :   hole-&gt;DefineSection(3,3.5,lowEdge-shift,upEdge+3.-shift);</span>
<span class="lineNum">     667 </span>            :   //
<span class="lineNum">     668 </span><span class="lineCov">          1 :   Double_t ys = shift*TMath::Sin(openingAngle); </span>
<span class="lineNum">     669 </span><span class="lineCov">          1 :   Double_t xs = shift*TMath::Cos(openingAngle);</span>
<span class="lineNum">     670 </span><span class="lineCov">          1 :   TGeoTranslation *tr = new TGeoTranslation(&quot;tr&quot;,xs,ys,0.);  </span>
<span class="lineNum">     671 </span><span class="lineCov">          1 :   tr-&gt;RegisterYourself();</span>
<span class="lineNum">     672 </span><span class="lineCov">          1 :   TGeoCompositeShape *chamber = new TGeoCompositeShape(&quot;sec-hole:tr&quot;);</span>
<span class="lineNum">     673 </span><span class="lineCov">          1 :   TGeoVolume *sv = new TGeoVolume(&quot;TPC_WSEG&quot;,chamber,m3);</span>
<span class="lineNum">     674 </span><span class="lineCov">          1 :   TGeoPgon *bar = new TGeoPgon(&quot;bar&quot;,0.,20.,1,2);</span>
<span class="lineNum">     675 </span><span class="lineCov">          1 :   bar-&gt;DefineSection(0,-3.,131.5-shift,136.5-shift);</span>
<span class="lineNum">     676 </span><span class="lineCov">          1 :   bar-&gt;DefineSection(1,1.5,131.5-shift,136.5-shift);</span>
<span class="lineNum">     677 </span><span class="lineCov">          1 :   TGeoVolume *barv = new TGeoVolume(&quot;TPC_WBAR&quot;,bar,m3);</span>
<span class="lineNum">     678 </span><span class="lineCov">          1 :   TGeoVolumeAssembly *ch = new TGeoVolumeAssembly(&quot;TPC_WCH&quot;);//empty segment</span>
<span class="lineNum">     679 </span>            :   //
<span class="lineNum">     680 </span><span class="lineCov">          1 :   ch-&gt;AddNode(sv,1); ch-&gt;AddNode(barv,1,tr);</span>
<span class="lineNum">     681 </span>            :   //
<span class="lineNum">     682 </span>            :   // readout chambers
<span class="lineNum">     683 </span>            :   //
<span class="lineNum">     684 </span>            :   // IROC first
<span class="lineNum">     685 </span>            :   //
<span class="lineNum">     686 </span><span class="lineCov">          1 :    TGeoTrd1 *ibody = new TGeoTrd1(13.8742,21.3328,4.29,21.15);</span>
<span class="lineNum">     687 </span><span class="lineCov">          1 :    TGeoVolume *ibdv = new TGeoVolume(&quot;TPC_IROCB&quot;,ibody,m3);</span>
<span class="lineNum">     688 </span>            :   // empty space
<span class="lineNum">     689 </span><span class="lineCov">          1 :    TGeoTrd1 *emp = new TGeoTrd1(12.3742,19.8328,3.99,19.65);</span>
<span class="lineNum">     690 </span><span class="lineCov">          1 :    TGeoVolume *empv = new TGeoVolume(&quot;TPC_IROCE&quot;,emp,m1);</span>
<span class="lineNum">     691 </span><span class="lineCov">          2 :    ibdv-&gt;AddNode(empv,1,new TGeoTranslation(0.,-0.3,0.));</span>
<span class="lineNum">     692 </span>            :    //bars
<span class="lineNum">     693 </span>            :    Double_t tga = (19.8328-12.3742)/39.3;
<span class="lineNum">     694 </span>            :    Double_t xmin,xmax;
<span class="lineNum">     695 </span>            :    xmin = 9.55*tga+12.3742;
<span class="lineNum">     696 </span>            :    xmax = 9.95*tga+12.3742;
<span class="lineNum">     697 </span><span class="lineCov">          1 :    TGeoTrd1 *ib1 = new TGeoTrd1(xmin,xmax,3.29,0.2);</span>
<span class="lineNum">     698 </span><span class="lineCov">          1 :    TGeoVolume *ib1v = new TGeoVolume(&quot;TPC_IRB1&quot;,ib1,m3);</span>
<span class="lineNum">     699 </span><span class="lineCov">          2 :    empv-&gt;AddNode(ib1v,1,new TGeoTranslation(&quot;tt1&quot;,0.,0.7,-9.9));</span>
<span class="lineNum">     700 </span>            :    xmin=19.4*tga+12.3742;
<span class="lineNum">     701 </span>            :    xmax=19.9*tga+12.3742;
<span class="lineNum">     702 </span><span class="lineCov">          1 :    TGeoTrd1 *ib2 = new TGeoTrd1(xmin,xmax,3.29,0.25);</span>
<span class="lineNum">     703 </span><span class="lineCov">          1 :    TGeoVolume *ib2v = new TGeoVolume(&quot;TPC_TRB2&quot;,ib2,m3);</span>
<span class="lineNum">     704 </span><span class="lineCov">          2 :    empv-&gt;AddNode(ib2v,1,new TGeoTranslation(0.,0.7,0.));</span>
<span class="lineNum">     705 </span>            :    xmin=29.35*tga+12.3742;
<span class="lineNum">     706 </span>            :    xmax=29.75*tga+12.3742;
<span class="lineNum">     707 </span><span class="lineCov">          1 :    TGeoTrd1 *ib3 = new TGeoTrd1(xmin,xmax,3.29,0.2); </span>
<span class="lineNum">     708 </span><span class="lineCov">          1 :    TGeoVolume *ib3v = new TGeoVolume(&quot;TPC_IRB3&quot;,ib3,m3);    </span>
<span class="lineNum">     709 </span><span class="lineCov">          2 :    empv-&gt;AddNode(ib3v,1,new TGeoTranslation(0.,0.7,9.9));</span>
<span class="lineNum">     710 </span>            :    //
<span class="lineNum">     711 </span>            :    // holes for connectors
<span class="lineNum">     712 </span>            :    //
<span class="lineNum">     713 </span><span class="lineCov">          1 :    TGeoBBox *conn = new TGeoBBox(0.4,0.3,4.675); // identical for iroc and oroc</span>
<span class="lineNum">     714 </span><span class="lineCov">          1 :    TGeoVolume *connv = new TGeoVolume(&quot;TPC_RCCON&quot;,conn,m1);</span>
<span class="lineNum">     715 </span><span class="lineCov">          1 :    TString fileName(gSystem-&gt;Getenv(&quot;ALICE_ROOT&quot;));</span>
<span class="lineNum">     716 </span><span class="lineCov">          1 :    fileName += &quot;/TPC/conn_iroc.dat&quot;;</span>
<span class="lineNum">     717 </span><span class="lineCov">          1 :    ifstream in;</span>
<span class="lineNum">     718 </span><span class="lineCov">          2 :    in.open(fileName.Data(), ios_base::in); // asci file</span>
<span class="lineNum">     719 </span><span class="lineCov">          1 :    TGeoRotation *rrr[86];</span>
<span class="lineNum">     720 </span><span class="lineCov">        174 :    for(Int_t i =0;i&lt;86;i++){</span>
<span class="lineNum">     721 </span>            :       Double_t y = 3.99;
<span class="lineNum">     722 </span><span class="lineCov">         86 :       Double_t x,z,ang;</span>
<span class="lineNum">     723 </span><span class="lineCov">        258 :       in&gt;&gt;x&gt;&gt;z&gt;&gt;ang;</span>
<span class="lineNum">     724 </span><span class="lineCov">         86 :       z-=26.5;</span>
<span class="lineNum">     725 </span><span class="lineCov">        258 :       rrr[i]= new TGeoRotation();</span>
<span class="lineNum">     726 </span><span class="lineCov">         86 :       rrr[i]-&gt;RotateY(ang);</span>
<span class="lineNum">     727 </span><span class="lineCov">        258 :       ibdv-&gt;AddNode(connv,i+1,new TGeoCombiTrans(x,y,z,rrr[i]));</span>
<span class="lineNum">     728 </span><span class="lineCov">         86 :    }</span>
<span class="lineNum">     729 </span><span class="lineCov">          1 :    in.close();</span>
<span class="lineNum">     730 </span>            :    // &quot;cap&quot;
<span class="lineNum">     731 </span><span class="lineCov">          2 :    new TGeoTrd1(&quot;icap&quot;,14.5974,23.3521,1.19,24.825);</span>
<span class="lineNum">     732 </span>            :    // &quot;hole&quot;
<span class="lineNum">     733 </span><span class="lineCov">          2 :    new TGeoTrd1(&quot;ihole&quot;,13.8742,21.3328,1.2,21.15);</span>
<span class="lineNum">     734 </span><span class="lineCov">          2 :    TGeoTranslation *tr1 = new TGeoTranslation(&quot;tr1&quot;,0.,0.,1.725);  </span>
<span class="lineNum">     735 </span><span class="lineCov">          1 :    tr1-&gt;RegisterYourself();</span>
<span class="lineNum">     736 </span><span class="lineCov">          2 :    TGeoCompositeShape *ic = new TGeoCompositeShape(&quot;icap-ihole:tr1&quot;);</span>
<span class="lineNum">     737 </span><span class="lineCov">          2 :    TGeoVolume *icv = new TGeoVolume(&quot;TPC_IRCAP&quot;,ic,m3);</span>
<span class="lineNum">     738 </span>            :    //
<span class="lineNum">     739 </span>            :    // pad plane and wire fixations
<span class="lineNum">     740 </span>            :    //
<span class="lineNum">     741 </span><span class="lineCov">          2 :    TGeoTrd1 *pp = new TGeoTrd1(14.5974,23.3521,0.3,24.825); //pad+iso</span>
<span class="lineNum">     742 </span><span class="lineCov">          2 :    TGeoVolume *ppv = new TGeoVolume(&quot;TPC_IRPP&quot;,pp,m4);</span>
<span class="lineNum">     743 </span><span class="lineCov">          2 :    TGeoPara *f1 = new TGeoPara(.6,.5,24.825,0.,-10.,0.);</span>
<span class="lineNum">     744 </span><span class="lineCov">          2 :    TGeoVolume *f1v = new TGeoVolume(&quot;TPC_IRF1&quot;,f1,m4);</span>
<span class="lineNum">     745 </span><span class="lineCov">          2 :    TGeoPara *f2 = new TGeoPara(.6,.5,24.825,0.,10.,0.);</span>
<span class="lineNum">     746 </span><span class="lineCov">          2 :    TGeoVolume *f2v = new TGeoVolume(&quot;TPC_IRF2&quot;,f2,m4);</span>
<span class="lineNum">     747 </span>            :    //
<span class="lineNum">     748 </span><span class="lineCov">          2 :    TGeoVolumeAssembly *iroc = new TGeoVolumeAssembly(&quot;TPC_IROC&quot;);</span>
<span class="lineNum">     749 </span>            :    //
<span class="lineNum">     750 </span><span class="lineCov">          1 :    iroc-&gt;AddNode(ibdv,1);</span>
<span class="lineNum">     751 </span><span class="lineCov">          3 :    iroc-&gt;AddNode(icv,1,new TGeoTranslation(0.,3.1,-1.725));</span>
<span class="lineNum">     752 </span><span class="lineCov">          3 :    iroc-&gt;AddNode(ppv,1,new TGeoTranslation(0.,4.59,-1.725));</span>
<span class="lineNum">     753 </span>            :    tga =(23.3521-14.5974)/49.65; 
<span class="lineNum">     754 </span>            :    Double_t xx = 24.825*tga+14.5974-0.6;
<span class="lineNum">     755 </span><span class="lineCov">          3 :    iroc-&gt;AddNode(f1v,1,new TGeoTranslation(-xx,5.39,-1.725));</span>
<span class="lineNum">     756 </span><span class="lineCov">          3 :    iroc-&gt;AddNode(f2v,1,new TGeoTranslation(xx,5.39,-1.725));</span>
<span class="lineNum">     757 </span>            :    //
<span class="lineNum">     758 </span>            :    // OROC
<span class="lineNum">     759 </span>            :    //
<span class="lineNum">     760 </span><span class="lineCov">          2 :    TGeoTrd1 *obody = new TGeoTrd1(22.2938,40.5084,4.19,51.65);</span>
<span class="lineNum">     761 </span><span class="lineCov">          2 :    TGeoVolume *obdv = new TGeoVolume(&quot;TPC_OROCB&quot;,obody,m3);</span>
<span class="lineNum">     762 </span><span class="lineCov">          2 :    TGeoTrd1 *oemp = new TGeoTrd1(20.2938,38.5084,3.89,49.65);</span>
<span class="lineNum">     763 </span><span class="lineCov">          2 :    TGeoVolume *oempv = new TGeoVolume(&quot;TPC_OROCE&quot;,oemp,m1);</span>
<span class="lineNum">     764 </span><span class="lineCov">          3 :    obdv-&gt;AddNode(oempv,1,new TGeoTranslation(0.,-0.3,0.));</span>
<span class="lineNum">     765 </span>            :    //horizontal bars
<span class="lineNum">     766 </span>            :    tga=(38.5084-20.2938)/99.3;
<span class="lineNum">     767 </span>            :    xmin=tga*10.2+20.2938;
<span class="lineNum">     768 </span>            :    xmax=tga*10.6+20.2938;
<span class="lineNum">     769 </span><span class="lineCov">          2 :    TGeoTrd1 *ob1 = new TGeoTrd1(xmin,xmax,2.915,0.2);</span>
<span class="lineNum">     770 </span><span class="lineCov">          2 :    TGeoVolume *ob1v = new TGeoVolume(&quot;TPC_ORB1&quot;,ob1,m3);</span>
<span class="lineNum">     771 </span>            :    //
<span class="lineNum">     772 </span>            :    xmin=22.55*tga+20.2938;
<span class="lineNum">     773 </span>            :    xmax=24.15*tga+20.2938;
<span class="lineNum">     774 </span><span class="lineCov">          2 :    TGeoTrd1 *ob2 = new TGeoTrd1(xmin,xmax,2.915,0.8);</span>
<span class="lineNum">     775 </span><span class="lineCov">          2 :    TGeoVolume *ob2v = new TGeoVolume(&quot;TPC_ORB2&quot;,ob2,m3);</span>
<span class="lineNum">     776 </span>            :    //
<span class="lineNum">     777 </span>            :    xmin=36.1*tga+20.2938;
<span class="lineNum">     778 </span>            :    xmax=36.5*tga+20.2938;
<span class="lineNum">     779 </span><span class="lineCov">          2 :    TGeoTrd1 *ob3 = new TGeoTrd1(xmin,xmax,2.915,0.2);</span>
<span class="lineNum">     780 </span><span class="lineCov">          2 :    TGeoVolume *ob3v = new TGeoVolume(&quot;TPC_ORB3&quot;,ob3,m3);</span>
<span class="lineNum">     781 </span>            :    //
<span class="lineNum">     782 </span>            :    xmin=49.0*tga+20.2938;
<span class="lineNum">     783 </span>            :    xmax=50.6*tga+20.2938;   
<span class="lineNum">     784 </span><span class="lineCov">          2 :    TGeoTrd1 *ob4 = new TGeoTrd1(xmin,xmax,2.915,0.8);</span>
<span class="lineNum">     785 </span><span class="lineCov">          2 :    TGeoVolume *ob4v = new TGeoVolume(&quot;TPC_ORB4&quot;,ob4,m3);</span>
<span class="lineNum">     786 </span>            :    //
<span class="lineNum">     787 </span>            :    xmin=63.6*tga+20.2938;
<span class="lineNum">     788 </span>            :    xmax=64.0*tga+20.2938;
<span class="lineNum">     789 </span><span class="lineCov">          2 :    TGeoTrd1 *ob5 = new TGeoTrd1(xmin,xmax,2.915,0.2);</span>
<span class="lineNum">     790 </span><span class="lineCov">          2 :    TGeoVolume *ob5v = new TGeoVolume(&quot;TPC_ORB5&quot;,ob5,m3);</span>
<span class="lineNum">     791 </span>            :    //
<span class="lineNum">     792 </span>            :    xmin=75.5*tga+20.2938;
<span class="lineNum">     793 </span>            :    xmax=77.15*tga+20.2938;
<span class="lineNum">     794 </span><span class="lineCov">          2 :    TGeoTrd1 *ob6 = new TGeoTrd1(xmin,xmax,2.915,0.8);</span>
<span class="lineNum">     795 </span><span class="lineCov">          2 :    TGeoVolume *ob6v = new TGeoVolume(&quot;TPC_ORB6&quot;,ob6,m3);</span>
<span class="lineNum">     796 </span>            :    //
<span class="lineNum">     797 </span>            :    xmin=88.7*tga+20.2938;
<span class="lineNum">     798 </span>            :    xmax=89.1*tga+20.2938;
<span class="lineNum">     799 </span><span class="lineCov">          2 :    TGeoTrd1 *ob7 = new TGeoTrd1(xmin,xmax,2.915,0.2);</span>
<span class="lineNum">     800 </span><span class="lineCov">          2 :    TGeoVolume *ob7v = new TGeoVolume(&quot;TPC_ORB7&quot;,ob7,m3);</span>
<span class="lineNum">     801 </span>            :    //
<span class="lineNum">     802 </span><span class="lineCov">          3 :    oempv-&gt;AddNode(ob1v,1,new TGeoTranslation(0.,0.975,-39.25));</span>
<span class="lineNum">     803 </span><span class="lineCov">          3 :    oempv-&gt;AddNode(ob2v,1,new TGeoTranslation(0.,0.975,-26.3));</span>
<span class="lineNum">     804 </span><span class="lineCov">          3 :    oempv-&gt;AddNode(ob3v,1,new TGeoTranslation(0.,0.975,-13.35));</span>
<span class="lineNum">     805 </span><span class="lineCov">          3 :    oempv-&gt;AddNode(ob4v,1,new TGeoTranslation(0.,0.975,0.15));</span>
<span class="lineNum">     806 </span><span class="lineCov">          3 :    oempv-&gt;AddNode(ob5v,1,new TGeoTranslation(0.,0.975,14.15));</span>
<span class="lineNum">     807 </span><span class="lineCov">          3 :    oempv-&gt;AddNode(ob6v,1,new TGeoTranslation(0.,0.975,26.7));</span>
<span class="lineNum">     808 </span><span class="lineCov">          3 :    oempv-&gt;AddNode(ob7v,1,new TGeoTranslation(0.,0.975,39.25));</span>
<span class="lineNum">     809 </span>            :    // vertical bars
<span class="lineNum">     810 </span><span class="lineCov">          2 :    TGeoBBox *ob8 = new TGeoBBox(0.8,2.915,5.1); </span>
<span class="lineNum">     811 </span><span class="lineCov">          2 :    TGeoBBox *ob9 = new TGeoBBox(0.8,2.915,5.975);</span>
<span class="lineNum">     812 </span><span class="lineCov">          2 :    TGeoBBox *ob10 = new TGeoBBox(0.8,2.915,5.775);</span>
<span class="lineNum">     813 </span><span class="lineCov">          2 :    TGeoBBox *ob11 = new TGeoBBox(0.8,2.915,6.25);</span>
<span class="lineNum">     814 </span><span class="lineCov">          2 :    TGeoBBox *ob12 = new TGeoBBox(0.8,2.915,6.5);</span>
<span class="lineNum">     815 </span>            :    //
<span class="lineNum">     816 </span><span class="lineCov">          2 :    TGeoVolume *ob8v = new TGeoVolume(&quot;TPC_ORB8&quot;,ob8,m3);</span>
<span class="lineNum">     817 </span><span class="lineCov">          2 :    TGeoVolume *ob9v = new TGeoVolume(&quot;TPC_ORB9&quot;,ob9,m3);</span>
<span class="lineNum">     818 </span><span class="lineCov">          2 :    TGeoVolume *ob10v = new TGeoVolume(&quot;TPC_ORB10&quot;,ob10,m3);</span>
<span class="lineNum">     819 </span><span class="lineCov">          2 :    TGeoVolume *ob11v = new TGeoVolume(&quot;TPC_ORB11&quot;,ob11,m3);</span>
<span class="lineNum">     820 </span><span class="lineCov">          2 :    TGeoVolume *ob12v = new TGeoVolume(&quot;TPC_ORB12&quot;,ob12,m3);</span>
<span class="lineNum">     821 </span>            :    //
<span class="lineNum">     822 </span><span class="lineCov">          3 :    oempv-&gt;AddNode(ob8v,1,new TGeoTranslation(0.,0.975,-44.55));</span>
<span class="lineNum">     823 </span><span class="lineCov">          3 :    oempv-&gt;AddNode(ob8v,2,new TGeoTranslation(0.,0.975,44.55));</span>
<span class="lineNum">     824 </span><span class="lineCov">          3 :    oempv-&gt;AddNode(ob9v,1,new TGeoTranslation(0.,0.975,-33.075));</span>
<span class="lineNum">     825 </span><span class="lineCov">          3 :    oempv-&gt;AddNode(ob9v,2,new TGeoTranslation(0.,0.975,-19.525));</span>
<span class="lineNum">     826 </span><span class="lineCov">          3 :    oempv-&gt;AddNode(ob10v,1,new TGeoTranslation(0.,0.975,20.125));</span>
<span class="lineNum">     827 </span><span class="lineCov">          3 :    oempv-&gt;AddNode(ob10v,2,new TGeoTranslation(0.,0.975,33.275));</span>
<span class="lineNum">     828 </span><span class="lineCov">          3 :    oempv-&gt;AddNode(ob11v,1,new TGeoTranslation(0.,0.975,-6.9));</span>
<span class="lineNum">     829 </span><span class="lineCov">          3 :    oempv-&gt;AddNode(ob12v,1,new TGeoTranslation(0.,0.975,7.45));</span>
<span class="lineNum">     830 </span>            :    //
<span class="lineNum">     831 </span>            :    // holes for connectors
<span class="lineNum">     832 </span>            :    //
<span class="lineNum">     833 </span><span class="lineCov">          2 :    fileName = gSystem-&gt;Getenv(&quot;ALICE_ROOT&quot;);</span>
<span class="lineNum">     834 </span><span class="lineCov">          1 :    fileName += &quot;/TPC/conn_oroc.dat&quot;;</span>
<span class="lineNum">     835 </span><span class="lineCov">          2 :    in.open(fileName.Data(), ios_base::in); // asci file</span>
<span class="lineNum">     836 </span><span class="lineCov">          1 :    TGeoRotation *rr[78];</span>
<span class="lineNum">     837 </span><span class="lineCov">        158 :    for(Int_t i =0;i&lt;78;i++){</span>
<span class="lineNum">     838 </span>            :       Double_t y =3.89;
<span class="lineNum">     839 </span><span class="lineCov">         78 :       Double_t x,z,ang;</span>
<span class="lineNum">     840 </span>            :       Double_t x1,z1,x2,z2;
<span class="lineNum">     841 </span><span class="lineCov">        234 :       in&gt;&gt;x&gt;&gt;z&gt;&gt;ang;        </span>
<span class="lineNum">     842 </span><span class="lineCov">        156 :       Double_t xr = 4.7*TMath::Sin(ang*TMath::DegToRad());</span>
<span class="lineNum">     843 </span><span class="lineCov">        156 :       Double_t zr = 4.7*TMath::Cos(ang*TMath::DegToRad());</span>
<span class="lineNum">     844 </span>            :       //
<span class="lineNum">     845 </span><span class="lineCov">         78 :       x1=xr+x; x2=-xr+x; z1=zr+z; z2 = -zr+z;      </span>
<span class="lineNum">     846 </span>            :       //
<span class="lineNum">     847 </span><span class="lineCov">        234 :       rr[i]= new TGeoRotation();</span>
<span class="lineNum">     848 </span><span class="lineCov">         78 :       rr[i]-&gt;RotateY(ang); </span>
<span class="lineNum">     849 </span><span class="lineCov">         78 :       z1-=54.95;</span>
<span class="lineNum">     850 </span><span class="lineCov">         78 :       z2-=54.95;</span>
<span class="lineNum">     851 </span>            :       //
<span class="lineNum">     852 </span><span class="lineCov">        234 :       obdv-&gt;AddNode(connv,i+1,new TGeoCombiTrans(x1,y,z1,rr[i]));</span>
<span class="lineNum">     853 </span><span class="lineCov">        234 :       obdv-&gt;AddNode(connv,i+79,new TGeoCombiTrans(x2,y,z2,rr[i]));</span>
<span class="lineNum">     854 </span><span class="lineCov">         78 :    }</span>
<span class="lineNum">     855 </span><span class="lineCov">          1 :    in.close();</span>
<span class="lineNum">     856 </span>            :    // cap
<span class="lineNum">     857 </span><span class="lineCov">          2 :    new TGeoTrd1(&quot;ocap&quot;,23.3874,43.5239,1.09,57.1);</span>
<span class="lineNum">     858 </span><span class="lineCov">          2 :    new TGeoTrd1(&quot;ohole&quot;,22.2938,40.5084,1.09,51.65);</span>
<span class="lineNum">     859 </span><span class="lineCov">          2 :    TGeoTranslation *tr5 = new TGeoTranslation(&quot;tr5&quot;,0.,0.,-2.15);</span>
<span class="lineNum">     860 </span><span class="lineCov">          1 :    tr5-&gt;RegisterYourself();</span>
<span class="lineNum">     861 </span><span class="lineCov">          2 :    TGeoCompositeShape *oc = new TGeoCompositeShape(&quot;ocap-ohole:tr5&quot;);</span>
<span class="lineNum">     862 </span><span class="lineCov">          2 :    TGeoVolume *ocv = new TGeoVolume(&quot;TPC_ORCAP&quot;,oc,m3);</span>
<span class="lineNum">     863 </span>            :    //
<span class="lineNum">     864 </span>            :    // pad plane and wire fixations
<span class="lineNum">     865 </span>            :    //
<span class="lineNum">     866 </span><span class="lineCov">          2 :    TGeoTrd1 *opp = new TGeoTrd1(23.3874,43.5239,0.3,57.1);</span>
<span class="lineNum">     867 </span><span class="lineCov">          2 :    TGeoVolume *oppv = new TGeoVolume(&quot;TPC_ORPP&quot;,opp,m4);</span>
<span class="lineNum">     868 </span>            :    //
<span class="lineNum">     869 </span>            :    tga=(43.5239-23.3874)/114.2;
<span class="lineNum">     870 </span><span class="lineCov">          2 :    TGeoPara *f3 = new TGeoPara(.7,.6,57.1,0.,-10.,0.);</span>
<span class="lineNum">     871 </span><span class="lineCov">          2 :    TGeoPara *f4 = new TGeoPara(.7,.6,57.1,0.,10.,0.);  </span>
<span class="lineNum">     872 </span>            :    xx = 57.1*tga+23.3874-0.7;
<span class="lineNum">     873 </span><span class="lineCov">          2 :    TGeoVolume *f3v = new TGeoVolume(&quot;TPC_ORF1&quot;,f3,m4);</span>
<span class="lineNum">     874 </span><span class="lineCov">          2 :    TGeoVolume *f4v = new TGeoVolume(&quot;TPC_ORF2&quot;,f4,m4);</span>
<span class="lineNum">     875 </span>            :    //
<span class="lineNum">     876 </span><span class="lineCov">          2 :    TGeoVolumeAssembly *oroc = new TGeoVolumeAssembly(&quot;TPC_OROC&quot;);</span>
<span class="lineNum">     877 </span>            :    //
<span class="lineNum">     878 </span><span class="lineCov">          1 :    oroc-&gt;AddNode(obdv,1);</span>
<span class="lineNum">     879 </span><span class="lineCov">          3 :    oroc-&gt;AddNode(ocv,1,new TGeoTranslation(0.,3.1,2.15));</span>
<span class="lineNum">     880 </span><span class="lineCov">          3 :    oroc-&gt;AddNode(oppv,1,new TGeoTranslation(0.,4.49,2.15));</span>
<span class="lineNum">     881 </span><span class="lineCov">          3 :    oroc-&gt;AddNode(f3v,1,new TGeoTranslation(-xx,5.39,2.15));</span>
<span class="lineNum">     882 </span><span class="lineCov">          3 :    oroc-&gt;AddNode(f4v,1,new TGeoTranslation(xx,5.39,2.15));</span>
<span class="lineNum">     883 </span>            :    // 
<span class="lineNum">     884 </span>            :    // now iroc and oroc are placed into a sector...
<span class="lineNum">     885 </span>            :    //
<span class="lineNum">     886 </span><span class="lineCov">          2 :    TGeoVolumeAssembly *secta = new TGeoVolumeAssembly(&quot;TPC_SECT&quot;); // a-side</span>
<span class="lineNum">     887 </span><span class="lineCov">          2 :    TGeoVolumeAssembly *sectc = new TGeoVolumeAssembly(&quot;TPC_SECT&quot;); // c-side</span>
<span class="lineNum">     888 </span><span class="lineCov">          1 :    TGeoRotation rot1(&quot;rot1&quot;,90.,90.,0.);</span>
<span class="lineNum">     889 </span><span class="lineCov">          1 :    TGeoRotation rot2(&quot;rot2&quot;);</span>
<span class="lineNum">     890 </span><span class="lineCov">          1 :    rot2.RotateY(10.);</span>
<span class="lineNum">     891 </span><span class="lineCov">          2 :    TGeoRotation *rot = new TGeoRotation(&quot;rot&quot;);</span>
<span class="lineNum">     892 </span><span class="lineCov">          2 :    *rot=rot1*rot2;</span>
<span class="lineNum">     893 </span>            :    //
<span class="lineNum">     894 </span>            :    Double_t x0,y0;
<span class="lineNum">     895 </span><span class="lineCov">          1 :    x0=110.2*TMath::Cos(openingAngle);</span>
<span class="lineNum">     896 </span><span class="lineCov">          1 :    y0=110.2*TMath::Sin(openingAngle);</span>
<span class="lineNum">     897 </span><span class="lineCov">          2 :    TGeoCombiTrans *combi1a = new TGeoCombiTrans(&quot;combi1&quot;,x0,y0,1.09+0.195,rot); //a-side </span>
<span class="lineNum">     898 </span><span class="lineCov">          2 :    TGeoCombiTrans *combi1c = new TGeoCombiTrans(&quot;combi1&quot;,x0,y0,1.09+0.222,rot); //c-side</span>
<span class="lineNum">     899 </span><span class="lineCov">          1 :    x0=188.45*TMath::Cos(openingAngle);</span>
<span class="lineNum">     900 </span><span class="lineCov">          1 :    y0=188.45*TMath::Sin(openingAngle);</span>
<span class="lineNum">     901 </span><span class="lineCov">          2 :    TGeoCombiTrans *combi2a = new TGeoCombiTrans(&quot;combi2&quot;,x0,y0,0.99+0.195,rot); //a-side</span>
<span class="lineNum">     902 </span><span class="lineCov">          2 :    TGeoCombiTrans *combi2c = new TGeoCombiTrans(&quot;combi2&quot;,x0,y0,0.99+0.222,rot); //c-side</span>
<span class="lineNum">     903 </span>            :    //
<span class="lineNum">     904 </span>            :    //
<span class="lineNum">     905 </span>            :    // A-side
<span class="lineNum">     906 </span>            :    //
<span class="lineNum">     907 </span><span class="lineCov">          1 :    secta-&gt;AddNode(ch,1);</span>
<span class="lineNum">     908 </span><span class="lineCov">          1 :    secta-&gt;AddNode(iroc,1,combi1a);</span>
<span class="lineNum">     909 </span><span class="lineCov">          1 :    secta-&gt;AddNode(oroc,1,combi2a);</span>
<span class="lineNum">     910 </span>            :    //
<span class="lineNum">     911 </span>            :    // C-side
<span class="lineNum">     912 </span>            :    //
<span class="lineNum">     913 </span><span class="lineCov">          1 :    sectc-&gt;AddNode(ch,1);</span>
<span class="lineNum">     914 </span><span class="lineCov">          1 :    sectc-&gt;AddNode(iroc,1,combi1c);</span>
<span class="lineNum">     915 </span><span class="lineCov">          1 :    sectc-&gt;AddNode(oroc,1,combi2c);</span>
<span class="lineNum">     916 </span>            :    //
<span class="lineNum">     917 </span>            :    // now I try to make  wheels...
<span class="lineNum">     918 </span>            :    //
<span class="lineNum">     919 </span><span class="lineCov">          2 :    TGeoVolumeAssembly *wheela = new TGeoVolumeAssembly(&quot;TPC_ENDCAP&quot;);</span>
<span class="lineNum">     920 </span><span class="lineCov">          2 :    TGeoVolumeAssembly *wheelc = new TGeoVolumeAssembly(&quot;TPC_ENDCAP&quot;);</span>
<span class="lineNum">     921 </span>            :    //
<span class="lineNum">     922 </span><span class="lineCov">          1 :    TGeoRotation *rwh[18]; </span>
<span class="lineNum">     923 </span><span class="lineCov">         38 :    for(Int_t i =0;i&lt;18;i++){</span>
<span class="lineNum">     924 </span><span class="lineCov">         18 :      Double_t phi = (20.*i);</span>
<span class="lineNum">     925 </span><span class="lineCov">         54 :      rwh[i]=new TGeoRotation();</span>
<span class="lineNum">     926 </span><span class="lineCov">         18 :      rwh[i]-&gt;RotateZ(phi);</span>
<span class="lineNum">     927 </span><span class="lineCov">         18 :      wheela-&gt;AddNode(secta,i+1,rwh[i]);</span>
<span class="lineNum">     928 </span><span class="lineCov">         18 :      wheelc-&gt;AddNode(sectc,i+1,rwh[i]); </span>
<span class="lineNum">     929 </span>            :     
<span class="lineNum">     930 </span>            :    }
<span class="lineNum">     931 </span>            :    // wheels in the drift volume!   
<span class="lineNum">     932 </span>            : 
<span class="lineNum">     933 </span><span class="lineCov">          2 :    TGeoCombiTrans *combi3 = new TGeoCombiTrans(&quot;combi3&quot;,0.,0.,256.6,ref);</span>
<span class="lineNum">     934 </span><span class="lineCov">          1 :    v9-&gt;AddNode(wheela,1,combi3);</span>
<span class="lineNum">     935 </span><span class="lineCov">          3 :    v9-&gt;AddNode(wheelc,2,new TGeoTranslation(0.,0.,-256.6));</span>
<span class="lineNum">     936 </span>            :    //_____________________________________________________________
<span class="lineNum">     937 </span>            :    // service support wheel
<span class="lineNum">     938 </span>            :    //_____________________________________________________________
<span class="lineNum">     939 </span><span class="lineCov">          2 :   TGeoPgon *sw = new TGeoPgon(0.,20.,1,2);</span>
<span class="lineNum">     940 </span><span class="lineCov">          1 :   sw-&gt;DefineSection(0,-4.,80.5,251.75);</span>
<span class="lineNum">     941 </span><span class="lineCov">          1 :   sw-&gt;DefineSection(1,4.,80.5,251.75); </span>
<span class="lineNum">     942 </span><span class="lineCov">          2 :   TGeoVolume *swv = new TGeoVolume(&quot;TPC_SWSEG&quot;,sw,m3); //Al</span>
<span class="lineNum">     943 </span>            :   //
<span class="lineNum">     944 </span>            :   thick=1.;
<span class="lineNum">     945 </span><span class="lineCov">          1 :   shift = thick/TMath::Sin(openingAngle);</span>
<span class="lineNum">     946 </span><span class="lineCov">          2 :   TGeoPgon *sh = new TGeoPgon(0.,20.,1,2);</span>
<span class="lineNum">     947 </span><span class="lineCov">          1 :   sh-&gt;DefineSection(0,-4.,81.5-shift,250.75-shift);</span>
<span class="lineNum">     948 </span><span class="lineCov">          1 :   sh-&gt;DefineSection(1,4.,81.5-shift,250.75-shift);</span>
<span class="lineNum">     949 </span><span class="lineCov">          2 :   TGeoVolume *shv = new TGeoVolume(&quot;TPC_SWS1&quot;,sh,m1); //Air</span>
<span class="lineNum">     950 </span>            :   //
<span class="lineNum">     951 </span><span class="lineCov">          1 :   TGeoMedium *m9 =  gGeoManager-&gt;GetMedium(&quot;TPC_Si&quot;); </span>
<span class="lineNum">     952 </span><span class="lineCov">          2 :   TGeoPgon *el = new TGeoPgon(0.,20.,1,2);</span>
<span class="lineNum">     953 </span><span class="lineCov">          1 :   el-&gt;DefineSection(0,-1.872,81.5-shift,250.75-shift);</span>
<span class="lineNum">     954 </span><span class="lineCov">          1 :   el-&gt;DefineSection(1,1.872,81.5-shift,250.75-shift);</span>
<span class="lineNum">     955 </span><span class="lineCov">          2 :   TGeoVolume *elv = new TGeoVolume(&quot;TPC_ELEC&quot;,el,m9); //Si </span>
<span class="lineNum">     956 </span>            :   //
<span class="lineNum">     957 </span><span class="lineCov">          1 :   shv-&gt;AddNode(elv,1);</span>
<span class="lineNum">     958 </span>            :   //
<span class="lineNum">     959 </span>            :   //
<span class="lineNum">     960 </span><span class="lineCov">          1 :   ys = shift*TMath::Sin(openingAngle);</span>
<span class="lineNum">     961 </span><span class="lineCov">          1 :   xs = shift*TMath::Cos(openingAngle);</span>
<span class="lineNum">     962 </span><span class="lineCov">          3 :   swv-&gt;AddNode(shv,1,new TGeoTranslation(xs,ys,0.));</span>
<span class="lineNum">     963 </span>            :   // cover
<span class="lineNum">     964 </span><span class="lineCov">          2 :   TGeoPgon *co = new TGeoPgon(0.,20.,1,2);</span>
<span class="lineNum">     965 </span><span class="lineCov">          1 :   co-&gt;DefineSection(0,-0.5,77.,255.25);</span>
<span class="lineNum">     966 </span><span class="lineCov">          1 :   co-&gt;DefineSection(1,0.5,77.,255.25);</span>
<span class="lineNum">     967 </span><span class="lineCov">          2 :   TGeoVolume *cov = new TGeoVolume(&quot;TPC_SWC1&quot;,co,m3);//Al</span>
<span class="lineNum">     968 </span>            :   // hole in a cover
<span class="lineNum">     969 </span><span class="lineCov">          2 :   TGeoPgon *coh = new TGeoPgon(0.,20.,1,2);</span>
<span class="lineNum">     970 </span><span class="lineCov">          1 :   shift=4./TMath::Sin(openingAngle);</span>
<span class="lineNum">     971 </span><span class="lineCov">          1 :   coh-&gt;DefineSection(0,-0.5,85.-shift,247.25-shift);</span>
<span class="lineNum">     972 </span><span class="lineCov">          1 :   coh-&gt;DefineSection(1,0.5,85.-shift,247.25-shift);  </span>
<span class="lineNum">     973 </span>            :   //
<span class="lineNum">     974 </span><span class="lineCov">          2 :   TGeoVolume *cohv = new TGeoVolume(&quot;TPC_SWC2&quot;,coh,m1);</span>
<span class="lineNum">     975 </span>            :   //
<span class="lineNum">     976 </span><span class="lineCov">          1 :   ys = shift*TMath::Sin(openingAngle);</span>
<span class="lineNum">     977 </span><span class="lineCov">          1 :   xs = shift*TMath::Cos(openingAngle);  </span>
<span class="lineNum">     978 </span><span class="lineCov">          3 :   cov-&gt;AddNode(cohv,1,new TGeoTranslation(xs,ys,0.));</span>
<span class="lineNum">     979 </span>            :   //
<span class="lineNum">     980 </span>            :   // Sector as an Assembly
<span class="lineNum">     981 </span>            :   //
<span class="lineNum">     982 </span><span class="lineCov">          2 :   TGeoVolumeAssembly *swhs = new TGeoVolumeAssembly(&quot;TPC_SSWSEC&quot;);</span>
<span class="lineNum">     983 </span><span class="lineCov">          1 :   swhs-&gt;AddNode(swv,1);</span>
<span class="lineNum">     984 </span><span class="lineCov">          3 :   swhs-&gt;AddNode(cov,1,new TGeoTranslation(0.,0.,-4.5));</span>
<span class="lineNum">     985 </span><span class="lineCov">          3 :   swhs-&gt;AddNode(cov,2,new TGeoTranslation(0.,0.,4.5));</span>
<span class="lineNum">     986 </span>            :   //
<span class="lineNum">     987 </span>            :   // SSW as an Assembly of sectors
<span class="lineNum">     988 </span>            :   //
<span class="lineNum">     989 </span><span class="lineCov">          1 :   TGeoRotation *rsw[18];</span>
<span class="lineNum">     990 </span><span class="lineCov">          2 :   TGeoVolumeAssembly *swheel = new TGeoVolumeAssembly(&quot;TPC_SSWHEEL&quot;);</span>
<span class="lineNum">     991 </span><span class="lineCov">         38 :    for(Int_t i =0;i&lt;18;i++){</span>
<span class="lineNum">     992 </span><span class="lineCov">         18 :      Double_t phi = (20.*i);</span>
<span class="lineNum">     993 </span><span class="lineCov">         54 :      rsw[i] = new TGeoRotation();</span>
<span class="lineNum">     994 </span><span class="lineCov">         18 :      rsw[i]-&gt;RotateZ(phi);</span>
<span class="lineNum">     995 </span><span class="lineCov">         18 :      swheel-&gt;AddNode(swhs,i+1,rsw[i]);   </span>
<span class="lineNum">     996 </span>            :    }
<span class="lineNum">     997 </span><span class="lineCov">          3 :    v1-&gt;AddNode(swheel,1,new TGeoTranslation(0.,0.,-284.6));</span>
<span class="lineNum">     998 </span><span class="lineCov">          3 :    v1-&gt;AddNode(swheel,2,new TGeoTranslation(0.,0.,284.6));</span>
<span class="lineNum">     999 </span>            : 
<span class="lineNum">    1000 </span>            :    // sensitive strips - strip &quot;0&quot; is always set
<span class="lineNum">    1001 </span>            :    // conditional
<span class="lineNum">    1002 </span>            :    Int_t totrows;
<span class="lineNum">    1003 </span><span class="lineCov">          3 :    totrows = fTPCParam-&gt;GetNRowLow() + fTPCParam-&gt;GetNRowUp();</span>
<span class="lineNum">    1004 </span>            :    Double_t *upar;
<span class="lineNum">    1005 </span>            :    upar=NULL;
<span class="lineNum">    1006 </span><span class="lineCov">          1 :    gGeoManager-&gt;Volume(&quot;TPC_Strip&quot;,&quot;PGON&quot;,m5-&gt;GetId(),upar);</span>
<span class="lineNum">    1007 </span><span class="lineCov">          2 :    upar=new Double_t [10];</span>
<span class="lineNum">    1008 </span><span class="lineCov">          1 :    upar[0]=0.;</span>
<span class="lineNum">    1009 </span><span class="lineCov">          1 :    upar[1]=360.;</span>
<span class="lineNum">    1010 </span><span class="lineCov">          1 :    upar[2]=18.;</span>
<span class="lineNum">    1011 </span><span class="lineCov">          1 :    upar[3]=2.;</span>
<span class="lineNum">    1012 </span>            :    //
<span class="lineNum">    1013 </span><span class="lineCov">          1 :    upar[4]=-124.8;</span>
<span class="lineNum">    1014 </span><span class="lineCov">          1 :    upar[7]=124.8;</span>
<span class="lineNum">    1015 </span>            : 
<span class="lineNum">    1016 </span><span class="lineCov">          2 :    Double_t rlow=fTPCParam-&gt;GetPadRowRadiiLow(0);</span>
<span class="lineNum">    1017 </span>            : 
<span class="lineNum">    1018 </span><span class="lineCov">          1 :    upar[5]=rlow;</span>
<span class="lineNum">    1019 </span><span class="lineCov">          1 :    upar[6]=rlow+.01;</span>
<span class="lineNum">    1020 </span><span class="lineCov">          1 :    upar[8]=upar[5];</span>
<span class="lineNum">    1021 </span><span class="lineCov">          1 :    upar[9]=upar[6];</span>
<span class="lineNum">    1022 </span>            :    //
<span class="lineNum">    1023 </span><span class="lineCov">          1 :    gGeoManager-&gt;Node(&quot;TPC_Strip&quot;,1,&quot;TPC_Drift&quot;,0.,0.,124.82,0,kTRUE,upar,10);</span>
<span class="lineNum">    1024 </span><span class="lineCov">          1 :    gGeoManager-&gt;Node(&quot;TPC_Strip&quot;,totrows+1,</span>
<span class="lineNum">    1025 </span>            :                      &quot;TPC_Drift&quot;,0.,0.,-124.82,0,kTRUE,upar,10);
<span class="lineNum">    1026 </span>            :    //
<span class="lineNum">    1027 </span>            :    // now, strips optionally
<span class="lineNum">    1028 </span>            :    //
<span class="lineNum">    1029 </span><span class="lineCov">          1 :    if(fSens){</span>
<span class="lineNum">    1030 </span>            :      //lower sectors
<span class="lineNum">    1031 </span><span class="lineNoCov">          0 :      for(Int_t i=2;i&lt;fTPCParam-&gt;GetNRowLow()+1;i++){</span>
<span class="lineNum">    1032 </span><span class="lineNoCov">          0 :        rlow=fTPCParam-&gt;GetPadRowRadiiLow(i-1);</span>
<span class="lineNum">    1033 </span><span class="lineNoCov">          0 :        upar[5]=rlow;</span>
<span class="lineNum">    1034 </span><span class="lineNoCov">          0 :        upar[6]=rlow+.01;</span>
<span class="lineNum">    1035 </span><span class="lineNoCov">          0 :        upar[8]=upar[5];</span>
<span class="lineNum">    1036 </span><span class="lineNoCov">          0 :        upar[9]=upar[6];</span>
<span class="lineNum">    1037 </span><span class="lineNoCov">          0 :        gGeoManager-&gt;Node(&quot;TPC_Strip&quot;,i,</span>
<span class="lineNum">    1038 </span>            :                          &quot;TPC_Drift&quot;,0.,0.,124.82,0,kTRUE,upar,10);
<span class="lineNum">    1039 </span><span class="lineNoCov">          0 :        gGeoManager-&gt;Node(&quot;TPC_Strip&quot;,totrows+i,</span>
<span class="lineNum">    1040 </span>            :                          &quot;TPC_Drift&quot;,0.,0.,-124.82,0,kTRUE,upar,10);       
<span class="lineNum">    1041 </span>            :      }
<span class="lineNum">    1042 </span>            :      //upper sectors
<span class="lineNum">    1043 </span><span class="lineNoCov">          0 :      for(Int_t i=1;i&lt;fTPCParam-&gt;GetNRowUp()+1;i++){</span>
<span class="lineNum">    1044 </span><span class="lineNoCov">          0 :        rlow=fTPCParam-&gt;GetPadRowRadiiUp(i-1); </span>
<span class="lineNum">    1045 </span><span class="lineNoCov">          0 :        upar[5]=rlow;</span>
<span class="lineNum">    1046 </span><span class="lineNoCov">          0 :        upar[6]=rlow+.01;</span>
<span class="lineNum">    1047 </span><span class="lineNoCov">          0 :        upar[8]=upar[5];</span>
<span class="lineNum">    1048 </span><span class="lineNoCov">          0 :        upar[9]=upar[6];</span>
<span class="lineNum">    1049 </span><span class="lineNoCov">          0 :        gGeoManager-&gt;Node(&quot;TPC_Strip&quot;,i+fTPCParam-&gt;GetNRowLow(),</span>
<span class="lineNum">    1050 </span>            :                          &quot;TPC_Drift&quot;,0.,0.,124.82,0,kTRUE,upar,10); 
<span class="lineNum">    1051 </span><span class="lineNoCov">          0 :        gGeoManager-&gt;Node(&quot;TPC_Strip&quot;,totrows+i+fTPCParam-&gt;GetNRowLow(),</span>
<span class="lineNum">    1052 </span>            :                          &quot;TPC_Drift&quot;,0.,0.,-124.82,0,kTRUE,upar,10); 
<span class="lineNum">    1053 </span>            :      }
<span class="lineNum">    1054 </span><span class="lineNoCov">          0 :    }//strips</span>
<span class="lineNum">    1055 </span>            :   //----------------------------------------------------------
<span class="lineNum">    1056 </span>            :   // TPC Support Rods - MAKROLON
<span class="lineNum">    1057 </span>            :   //----------------------------------------------------------
<span class="lineNum">    1058 </span><span class="lineCov">          1 :   TGeoMedium *m6=gGeoManager-&gt;GetMedium(&quot;TPC_Makrolon&quot;);</span>
<span class="lineNum">    1059 </span><span class="lineCov">          1 :   TGeoMedium *m7=gGeoManager-&gt;GetMedium(&quot;TPC_Cu&quot;);</span>
<span class="lineNum">    1060 </span><span class="lineCov">          1 :   TGeoMedium *m10 =  gGeoManager-&gt;GetMedium(&quot;TPC_Alumina&quot;);</span>
<span class="lineNum">    1061 </span><span class="lineCov">          1 :   TGeoMedium *m11 =  gGeoManager-&gt;GetMedium(&quot;TPC_Peek&quot;);;</span>
<span class="lineNum">    1062 </span><span class="lineCov">          1 :   TGeoMedium *m13 = gGeoManager-&gt;GetMedium(&quot;TPC_Brass&quot;);</span>
<span class="lineNum">    1063 </span><span class="lineCov">          1 :   TGeoMedium *m14 = gGeoManager-&gt;GetMedium(&quot;TPC_Alumina1&quot;);</span>
<span class="lineNum">    1064 </span>            :   // 
<span class="lineNum">    1065 </span>            :   // tpc rod is an assembly of 10 long parts and 2 short parts
<span class="lineNum">    1066 </span>            :   // connected with alu rings and plagged on both sides.
<span class="lineNum">    1067 </span>            :   //
<span class="lineNum">    1068 </span>            :   //
<span class="lineNum">    1069 </span>            :   // tpc rod long
<span class="lineNum">    1070 </span>            :   //
<span class="lineNum">    1071 </span><span class="lineCov">          2 :   TGeoPcon *rod = new TGeoPcon(&quot;rod&quot;,0.,360.,6);</span>
<span class="lineNum">    1072 </span><span class="lineCov">          1 :  rod-&gt;DefineSection(0,-10.43,1.92,2.08);</span>
<span class="lineNum">    1073 </span><span class="lineCov">          1 :  rod-&gt;DefineSection(1,-9.75,1.92,2.08);</span>
<span class="lineNum">    1074 </span>            : 
<span class="lineNum">    1075 </span><span class="lineCov">          1 :  rod-&gt;DefineSection(2,-9.75,1.8,2.2);</span>
<span class="lineNum">    1076 </span><span class="lineCov">          1 :  rod-&gt;DefineSection(3,9.75,1.8,2.2);</span>
<span class="lineNum">    1077 </span>            : 
<span class="lineNum">    1078 </span><span class="lineCov">          1 :  rod-&gt;DefineSection(4,9.75,1.92,2.08);</span>
<span class="lineNum">    1079 </span><span class="lineCov">          1 :  rod-&gt;DefineSection(5,10.43,1.92,2.08);</span>
<span class="lineNum">    1080 </span>            :  //
<span class="lineNum">    1081 </span><span class="lineCov">          2 :  TGeoVolume *mrodl = new TGeoVolume(&quot;TPC_mrodl&quot;,rod,m6);</span>
<span class="lineNum">    1082 </span>            :  //
<span class="lineNum">    1083 </span>            :  // tpc rod short 
<span class="lineNum">    1084 </span>            :  //
<span class="lineNum">    1085 </span><span class="lineCov">          2 :  TGeoPcon *rod1 = new TGeoPcon(&quot;rod1&quot;,0.,360.,6);</span>
<span class="lineNum">    1086 </span><span class="lineCov">          1 :  rod1-&gt;DefineSection(0,-8.93,1.92,2.08);</span>
<span class="lineNum">    1087 </span><span class="lineCov">          1 :  rod1-&gt;DefineSection(1,-8.25,1.92,2.08);</span>
<span class="lineNum">    1088 </span>            : 
<span class="lineNum">    1089 </span><span class="lineCov">          1 :  rod1-&gt;DefineSection(2,-8.25,1.8,2.2);</span>
<span class="lineNum">    1090 </span><span class="lineCov">          1 :  rod1-&gt;DefineSection(3,8.25,1.8,2.2);</span>
<span class="lineNum">    1091 </span>            : 
<span class="lineNum">    1092 </span><span class="lineCov">          1 :  rod1-&gt;DefineSection(4,8.25,1.92,2.08);</span>
<span class="lineNum">    1093 </span><span class="lineCov">          1 :  rod1-&gt;DefineSection(5,8.93,1.92,2.08);</span>
<span class="lineNum">    1094 </span>            :  //
<span class="lineNum">    1095 </span><span class="lineCov">          2 :  TGeoVolume *mrods = new TGeoVolume(&quot;TPC_mrods&quot;,rod1,m6);</span>
<span class="lineNum">    1096 </span>            :  //
<span class="lineNum">    1097 </span>            :  // below is for the resistor rod
<span class="lineNum">    1098 </span>            :  //
<span class="lineNum">    1099 </span>            :  // hole for the brass connectors
<span class="lineNum">    1100 </span>            :  //
<span class="lineNum">    1101 </span>            : 
<span class="lineNum">    1102 </span><span class="lineCov">          2 :  new TGeoTube(&quot;hhole&quot;,0.,0.3,0.3);</span>
<span class="lineNum">    1103 </span>            :  //
<span class="lineNum">    1104 </span>            :  //transformations for holes - initialy they
<span class="lineNum">    1105 </span>            :  // are placed at x=0 and negative y
<span class="lineNum">    1106 </span>            :  //
<span class="lineNum">    1107 </span><span class="lineCov">          2 :   TGeoRotation *rhole = new TGeoRotation();</span>
<span class="lineNum">    1108 </span><span class="lineCov">          1 :   rhole-&gt;RotateX(90.);</span>
<span class="lineNum">    1109 </span><span class="lineCov">          1 :   TGeoCombiTrans *transf[13];</span>
<span class="lineNum">    1110 </span><span class="lineCov">          1 :   Char_t name[30];</span>
<span class="lineNum">    1111 </span><span class="lineCov">         28 :   for(Int_t i=0;i&lt;13;i++){</span>
<span class="lineNum">    1112 </span><span class="lineCov">         13 :     snprintf(name,30,&quot;transf%d&quot;,i);</span>
<span class="lineNum">    1113 </span><span class="lineCov">         39 :     transf[i]= new TGeoCombiTrans(name,0.,-2.,-9.+i*1.5,rhole);</span>
<span class="lineNum">    1114 </span><span class="lineCov">         13 :     transf[i]-&gt;RegisterYourself();</span>
<span class="lineNum">    1115 </span>            :   }
<span class="lineNum">    1116 </span>            :   // union expression for holes
<span class="lineNum">    1117 </span><span class="lineCov">          1 :   TString operl(&quot;hhole:transf0&quot;);</span>
<span class="lineNum">    1118 </span><span class="lineCov">         26 :   for (Int_t i=1;i&lt;13;i++){</span>
<span class="lineNum">    1119 </span><span class="lineCov">         12 :     snprintf(name,30,&quot;+hhole:transf%d&quot;,i);</span>
<span class="lineNum">    1120 </span><span class="lineCov">         12 :     operl.Append(name);   </span>
<span class="lineNum">    1121 </span>            :   }
<span class="lineNum">    1122 </span>            :   //
<span class="lineNum">    1123 </span><span class="lineCov">          1 :  TString opers(&quot;hhole:transf1&quot;);</span>
<span class="lineNum">    1124 </span><span class="lineCov">         22 :   for (Int_t i=2;i&lt;12;i++){</span>
<span class="lineNum">    1125 </span><span class="lineCov">         10 :     snprintf(name,30,&quot;+hhole:transf%d&quot;,i); </span>
<span class="lineNum">    1126 </span><span class="lineCov">         10 :     opers.Append(name);   </span>
<span class="lineNum">    1127 </span>            :   }
<span class="lineNum">    1128 </span>            :   //union of holes
<span class="lineNum">    1129 </span><span class="lineCov">          3 :   new TGeoCompositeShape(&quot;hlv&quot;,operl.Data());</span>
<span class="lineNum">    1130 </span><span class="lineCov">          3 :   new TGeoCompositeShape(&quot;hsv&quot;,opers.Data());</span>
<span class="lineNum">    1131 </span>            :   //
<span class="lineNum">    1132 </span><span class="lineCov">          2 :   TGeoCompositeShape *rodl = new TGeoCompositeShape(&quot;rodl&quot;,&quot;rod-hlv&quot;);</span>
<span class="lineNum">    1133 </span><span class="lineCov">          2 :   TGeoCompositeShape *rods = new TGeoCompositeShape(&quot;rods&quot;,&quot;rod1-hsv&quot;);</span>
<span class="lineNum">    1134 </span>            :  //rods - volumes - makrolon rods with holes
<span class="lineNum">    1135 </span><span class="lineCov">          2 :   TGeoVolume *rodlv = new TGeoVolume(&quot;TPC_rodl&quot;,rodl,m6);</span>
<span class="lineNum">    1136 </span><span class="lineCov">          2 :   TGeoVolume *rodsv = new TGeoVolume(&quot;TPC_rods&quot;,rods,m6);</span>
<span class="lineNum">    1137 </span>            :   //brass connectors
<span class="lineNum">    1138 </span>            :  //connectors
<span class="lineNum">    1139 </span><span class="lineCov">          2 :   TGeoTube *bcon = new TGeoTube(0.,0.3,0.3);//connectors</span>
<span class="lineNum">    1140 </span><span class="lineCov">          2 :   TGeoVolume *bconv = new TGeoVolume(&quot;TPC_bcon&quot;,bcon,m13);</span>
<span class="lineNum">    1141 </span>            :  //
<span class="lineNum">    1142 </span>            :  // hooks holding strips
<span class="lineNum">    1143 </span>            :  //
<span class="lineNum">    1144 </span><span class="lineCov">          2 :  new TGeoBBox(&quot;hk1&quot;,0.625,0.015,0.75);</span>
<span class="lineNum">    1145 </span><span class="lineCov">          2 :  new TGeoBBox(&quot;hk2&quot;,0.625,0.015,0.15);</span>
<span class="lineNum">    1146 </span><span class="lineCov">          2 :  TGeoTranslation *tr21 = new TGeoTranslation(&quot;tr21&quot;,0.,-0.03,-0.6);</span>
<span class="lineNum">    1147 </span><span class="lineCov">          2 :  TGeoTranslation *tr12 = new TGeoTranslation(&quot;tr12&quot;,0.,-0.03,0.6);</span>
<span class="lineNum">    1148 </span><span class="lineCov">          1 :  tr21-&gt;RegisterYourself();</span>
<span class="lineNum">    1149 </span><span class="lineCov">          1 :  tr12-&gt;RegisterYourself();</span>
<span class="lineNum">    1150 </span>            :  
<span class="lineNum">    1151 </span><span class="lineCov">          2 :  TGeoCompositeShape *hook = new TGeoCompositeShape(&quot;hook&quot;,&quot;hk1+hk2:tr21+hk2:tr12&quot;);</span>
<span class="lineNum">    1152 </span><span class="lineCov">          2 :  TGeoVolume *hookv = new TGeoVolume(&quot;TPC_hook&quot;,hook,m13);</span>
<span class="lineNum">    1153 </span>            :  //
<span class="lineNum">    1154 </span>            :  // assembly of the short rod with connectors and hooks
<span class="lineNum">    1155 </span>            :  //
<span class="lineNum">    1156 </span>            :  //
<span class="lineNum">    1157 </span>            :  // short rod
<span class="lineNum">    1158 </span>            :  //
<span class="lineNum">    1159 </span><span class="lineCov">          2 :   TGeoVolumeAssembly *spart = new TGeoVolumeAssembly(&quot;TPC_spart&quot;);</span>
<span class="lineNum">    1160 </span>            :   //
<span class="lineNum">    1161 </span><span class="lineCov">          1 :   spart-&gt;AddNode( rodsv,1);</span>
<span class="lineNum">    1162 </span><span class="lineCov">         24 :   for(Int_t i=1;i&lt;12;i++){</span>
<span class="lineNum">    1163 </span><span class="lineCov">         11 :   spart-&gt;AddNode(bconv,i,transf[i]);</span>
<span class="lineNum">    1164 </span>            :   }
<span class="lineNum">    1165 </span><span class="lineCov">         24 :   for(Int_t i =0;i&lt;11;i++){</span>
<span class="lineNum">    1166 </span><span class="lineCov">         33 :     spart-&gt;AddNode(hookv,i+1,new TGeoTranslation(0.,-2.315,-7.5+i*1.5));</span>
<span class="lineNum">    1167 </span>            :   } 
<span class="lineNum">    1168 </span>            :  //
<span class="lineNum">    1169 </span>            :  // long rod
<span class="lineNum">    1170 </span>            :  //
<span class="lineNum">    1171 </span><span class="lineCov">          2 :   TGeoVolumeAssembly *lpart = new TGeoVolumeAssembly(&quot;TPC_lpart&quot;);</span>
<span class="lineNum">    1172 </span>            :   //
<span class="lineNum">    1173 </span><span class="lineCov">          1 :   lpart-&gt;AddNode( rodlv,1);</span>
<span class="lineNum">    1174 </span><span class="lineCov">         28 :   for(Int_t i=0;i&lt;13;i++){</span>
<span class="lineNum">    1175 </span><span class="lineCov">         13 :   lpart-&gt;AddNode(bconv,i+12,transf[i]);</span>
<span class="lineNum">    1176 </span>            :   }
<span class="lineNum">    1177 </span><span class="lineCov">         28 :   for(Int_t i =0;i&lt;13;i++){</span>
<span class="lineNum">    1178 </span><span class="lineCov">         39 :     lpart-&gt;AddNode(hookv,i+12,new TGeoTranslation(0.,-2.315,-9.+i*1.5));</span>
<span class="lineNum">    1179 </span>            :   }   
<span class="lineNum">    1180 </span>            :   //
<span class="lineNum">    1181 </span>            :   // alu ring
<span class="lineNum">    1182 </span>            :   //
<span class="lineNum">    1183 </span><span class="lineCov">          2 :   new TGeoTube(&quot;ring1&quot;,2.1075,2.235,0.53);</span>
<span class="lineNum">    1184 </span><span class="lineCov">          2 :   new TGeoTube(&quot;ring2&quot;,1.7925,1.89,0.43);</span>
<span class="lineNum">    1185 </span><span class="lineCov">          2 :   new TGeoTube(&quot;ring3&quot;,1.89,2.1075,0.05);</span>
<span class="lineNum">    1186 </span><span class="lineCov">          2 :   TGeoCompositeShape *ring = new TGeoCompositeShape(&quot;ring&quot;,&quot;ring1+ring2+ring3&quot;);</span>
<span class="lineNum">    1187 </span><span class="lineCov">          2 :   TGeoVolume *ringv = new TGeoVolume(&quot;TPC_ring&quot;,ring,m3);</span>
<span class="lineNum">    1188 </span>            :   //
<span class="lineNum">    1189 </span>            :   // rod assembly
<span class="lineNum">    1190 </span>            :   //
<span class="lineNum">    1191 </span><span class="lineCov">          2 :   TGeoVolumeAssembly *tpcrrod = new TGeoVolumeAssembly(&quot;TPC_rrod&quot;);//rrod</span>
<span class="lineNum">    1192 </span><span class="lineCov">          2 :   TGeoVolumeAssembly *tpcmrod = new TGeoVolumeAssembly(&quot;TPC_mrod&quot;);//makrolon rod  </span>
<span class="lineNum">    1193 </span>            :   //long pieces
<span class="lineNum">    1194 </span><span class="lineCov">         24 :   for(Int_t i=0;i&lt;11;i++){</span>
<span class="lineNum">    1195 </span><span class="lineCov">         33 :     tpcrrod-&gt;AddNode(ringv,i+1,new TGeoTranslation(0.,0.,-105.+i*21));</span>
<span class="lineNum">    1196 </span><span class="lineCov">         33 :     tpcmrod-&gt;AddNode(ringv,i+12,new TGeoTranslation(0.,0.,-105.+i*21));</span>
<span class="lineNum">    1197 </span>            :   }
<span class="lineNum">    1198 </span><span class="lineCov">         22 :   for(Int_t i=0;i&lt;10;i++){</span>
<span class="lineNum">    1199 </span><span class="lineCov">         30 :     tpcrrod-&gt;AddNode(lpart,i+1,new TGeoTranslation(0.,0.,-94.5+i*21));//resistor rod</span>
<span class="lineNum">    1200 </span><span class="lineCov">         30 :     tpcmrod-&gt;AddNode(mrodl,i+1,new TGeoTranslation(0.,0.,-94.5+i*21));//makrolon rod     </span>
<span class="lineNum">    1201 </span>            :   }
<span class="lineNum">    1202 </span>            :   //
<span class="lineNum">    1203 </span>            :   // right plug - identical for all rods
<span class="lineNum">    1204 </span>            :   //
<span class="lineNum">    1205 </span><span class="lineCov">          2 :   TGeoPcon *tpcrp = new TGeoPcon(0.,360.,6);</span>
<span class="lineNum">    1206 </span>            :   //
<span class="lineNum">    1207 </span><span class="lineCov">          1 :   tpcrp-&gt;DefineSection(0,123.05,1.89,2.1075);</span>
<span class="lineNum">    1208 </span><span class="lineCov">          1 :   tpcrp-&gt;DefineSection(1,123.59,1.89,2.1075);</span>
<span class="lineNum">    1209 </span>            :   //
<span class="lineNum">    1210 </span><span class="lineCov">          1 :   tpcrp-&gt;DefineSection(2,123.59,1.8,2.2);</span>
<span class="lineNum">    1211 </span><span class="lineCov">          1 :   tpcrp-&gt;DefineSection(3,127.,1.8,2.2);</span>
<span class="lineNum">    1212 </span>            :   //
<span class="lineNum">    1213 </span><span class="lineCov">          1 :   tpcrp-&gt;DefineSection(4,127.,0.,2.2);</span>
<span class="lineNum">    1214 </span><span class="lineCov">          1 :   tpcrp-&gt;DefineSection(5,127.5,0.,2.2);</span>
<span class="lineNum">    1215 </span>            :   //
<span class="lineNum">    1216 </span><span class="lineCov">          2 :   TGeoVolume *tpcrpv = new TGeoVolume(&quot;TPC_RP&quot;,tpcrp,m6);</span>
<span class="lineNum">    1217 </span>            :   //
<span class="lineNum">    1218 </span>            :   // adding short pieces and right plug
<span class="lineNum">    1219 </span>            :   //
<span class="lineNum">    1220 </span><span class="lineCov">          3 :   tpcrrod-&gt;AddNode(spart,1,new TGeoTranslation(0.,0.,-114.));</span>
<span class="lineNum">    1221 </span><span class="lineCov">          3 :   tpcrrod-&gt;AddNode(spart,2,new TGeoTranslation(0.,0.,114.)); </span>
<span class="lineNum">    1222 </span><span class="lineCov">          3 :   tpcrrod-&gt;AddNode(ringv,23,new TGeoTranslation(0.,0.,-123.));</span>
<span class="lineNum">    1223 </span><span class="lineCov">          3 :   tpcrrod-&gt;AddNode(ringv,24,new TGeoTranslation(0.,0.,123.));</span>
<span class="lineNum">    1224 </span><span class="lineCov">          1 :   tpcrrod-&gt;AddNode(tpcrpv,1);</span>
<span class="lineNum">    1225 </span>            :   //
<span class="lineNum">    1226 </span><span class="lineCov">          3 :   tpcmrod-&gt;AddNode(mrods,1,new TGeoTranslation(0.,0.,-114.));</span>
<span class="lineNum">    1227 </span><span class="lineCov">          3 :   tpcmrod-&gt;AddNode(mrods,2,new TGeoTranslation(0.,0.,114.)); </span>
<span class="lineNum">    1228 </span><span class="lineCov">          3 :   tpcmrod-&gt;AddNode(ringv,25,new TGeoTranslation(0.,0.,-123.));</span>
<span class="lineNum">    1229 </span><span class="lineCov">          3 :   tpcmrod-&gt;AddNode(ringv,26,new TGeoTranslation(0.,0.,123.));</span>
<span class="lineNum">    1230 </span><span class="lineCov">          1 :   tpcmrod-&gt;AddNode(tpcrpv,2);</span>
<span class="lineNum">    1231 </span>            :   //
<span class="lineNum">    1232 </span>            :   // from the ringv position to the CM is 3.0 cm!
<span class="lineNum">    1233 </span>            :   //----------------------------------------
<span class="lineNum">    1234 </span>            :   //
<span class="lineNum">    1235 </span>            :   //
<span class="lineNum">    1236 </span>            :   //HV rods - makrolon + 0.58cm (diameter) Cu -&gt;check the length
<span class="lineNum">    1237 </span><span class="lineCov">          2 :   TGeoTube *hvr = new TGeoTube(0.,1.465,123.);</span>
<span class="lineNum">    1238 </span><span class="lineCov">          2 :   TGeoTube *hvc = new TGeoTube(0.,0.29,123.);</span>
<span class="lineNum">    1239 </span>            :   //
<span class="lineNum">    1240 </span><span class="lineCov">          2 :   TGeoVolume *hvrv = new TGeoVolume(&quot;TPC_HV_Rod&quot;,hvr,m6);</span>
<span class="lineNum">    1241 </span><span class="lineCov">          2 :   TGeoVolume *hvcv = new TGeoVolume(&quot;TPC_HV_Cable&quot;,hvc,m7);</span>
<span class="lineNum">    1242 </span><span class="lineCov">          1 :   hvrv-&gt;AddNode(hvcv,1);</span>
<span class="lineNum">    1243 </span>            :   //
<span class="lineNum">    1244 </span>            :   //resistor rod
<span class="lineNum">    1245 </span>            :   //
<span class="lineNum">    1246 </span><span class="lineCov">          2 :   TGeoTube *cr = new TGeoTube(0.,0.45,123.);   </span>
<span class="lineNum">    1247 </span><span class="lineCov">          2 :   TGeoTube *cw = new TGeoTube(0.,0.15,123.);  </span>
<span class="lineNum">    1248 </span><span class="lineCov">          2 :   TGeoVolume *crv = new TGeoVolume(&quot;TPC_CR&quot;,cr,m10);</span>
<span class="lineNum">    1249 </span><span class="lineCov">          2 :   TGeoVolume *cwv = new TGeoVolume(&quot;TPC_W&quot;,cw,m12);   </span>
<span class="lineNum">    1250 </span>            :   //
<span class="lineNum">    1251 </span>            :   // ceramic rod with water
<span class="lineNum">    1252 </span>            :   //
<span class="lineNum">    1253 </span><span class="lineCov">          1 :   crv-&gt;AddNode(cwv,1);</span>
<span class="lineNum">    1254 </span>            :   //
<span class="lineNum">    1255 </span>            :   //peek rod
<span class="lineNum">    1256 </span>            :   //
<span class="lineNum">    1257 </span><span class="lineCov">          2 :   TGeoTube *pr =new TGeoTube(0.2,0.35,123.);  </span>
<span class="lineNum">    1258 </span><span class="lineCov">          2 :   TGeoVolume *prv = new TGeoVolume(&quot;TPC_PR&quot;,pr,m11); </span>
<span class="lineNum">    1259 </span>            :   //
<span class="lineNum">    1260 </span>            :   // copper plates with connectors
<span class="lineNum">    1261 </span>            :   //
<span class="lineNum">    1262 </span><span class="lineCov">          2 :   new TGeoTube(&quot;tub&quot;,0.,1.7,0.025);</span>
<span class="lineNum">    1263 </span>            :   //
<span class="lineNum">    1264 </span>            :   // half space - points on the plane and a normal vector
<span class="lineNum">    1265 </span>            :   //
<span class="lineNum">    1266 </span><span class="lineCov">          1 :   Double_t n[3],p[3];</span>
<span class="lineNum">    1267 </span><span class="lineCov">          2 :   Double_t slope = TMath::Tan(22.*TMath::DegToRad());</span>
<span class="lineNum">    1268 </span>            :   Double_t intp = 1.245;
<span class="lineNum">    1269 </span>            :   //
<span class="lineNum">    1270 </span><span class="lineCov">          1 :   Double_t b = slope*slope+1.;</span>
<span class="lineNum">    1271 </span><span class="lineCov">          1 :   p[0]=intp*slope/b;</span>
<span class="lineNum">    1272 </span><span class="lineCov">          1 :   p[1]=-intp/b;</span>
<span class="lineNum">    1273 </span><span class="lineCov">          1 :   p[2]=0.;</span>
<span class="lineNum">    1274 </span>            :   //
<span class="lineNum">    1275 </span><span class="lineCov">          1 :   n[0]=-p[0];</span>
<span class="lineNum">    1276 </span><span class="lineCov">          1 :   n[1]=-p[1];</span>
<span class="lineNum">    1277 </span><span class="lineCov">          1 :   n[2]=0.;</span>
<span class="lineNum">    1278 </span>            :   Double_t norm;
<span class="lineNum">    1279 </span><span class="lineCov">          1 :   norm=TMath::Sqrt(n[0]*n[0]+n[1]*n[1]);</span>
<span class="lineNum">    1280 </span><span class="lineCov">          1 :   n[0] /= norm;</span>
<span class="lineNum">    1281 </span><span class="lineCov">          1 :   n[1] /=norm;</span>
<span class="lineNum">    1282 </span>            :   //
<span class="lineNum">    1283 </span><span class="lineCov">          2 :   new TGeoHalfSpace(&quot;sp1&quot;,p,n);</span>
<span class="lineNum">    1284 </span>            :   //
<span class="lineNum">    1285 </span><span class="lineCov">          1 :   slope = -slope; </span>
<span class="lineNum">    1286 </span>            :   //
<span class="lineNum">    1287 </span><span class="lineCov">          1 :   p[0]=intp*slope/b;</span>
<span class="lineNum">    1288 </span><span class="lineCov">          1 :   p[1]=-intp/b;</span>
<span class="lineNum">    1289 </span>            :   //
<span class="lineNum">    1290 </span><span class="lineCov">          1 :   n[0]=-p[0];</span>
<span class="lineNum">    1291 </span><span class="lineCov">          1 :   n[1]=-p[1];</span>
<span class="lineNum">    1292 </span><span class="lineCov">          1 :   norm=TMath::Sqrt(n[0]*n[0]+n[1]*n[1]);</span>
<span class="lineNum">    1293 </span><span class="lineCov">          1 :   n[0] /= norm;</span>
<span class="lineNum">    1294 </span><span class="lineCov">          1 :   n[1] /=norm;</span>
<span class="lineNum">    1295 </span>            :   //
<span class="lineNum">    1296 </span><span class="lineCov">          2 :   new TGeoHalfSpace(&quot;sp2&quot;,p,n);</span>
<span class="lineNum">    1297 </span>            :   // holes for rods
<span class="lineNum">    1298 </span>            :  //holes
<span class="lineNum">    1299 </span><span class="lineCov">          2 :  new TGeoTube(&quot;h1&quot;,0.,0.5,0.025);</span>
<span class="lineNum">    1300 </span><span class="lineCov">          2 :  new TGeoTube(&quot;h2&quot;,0.,0.35,0.025);</span>
<span class="lineNum">    1301 </span>            :  //translations:
<span class="lineNum">    1302 </span><span class="lineCov">          2 :  TGeoTranslation *ttr11 = new TGeoTranslation(&quot;ttr11&quot;,-0.866,0.5,0.);</span>
<span class="lineNum">    1303 </span><span class="lineCov">          2 :  TGeoTranslation *ttr22 = new TGeoTranslation(&quot;ttr22&quot;,0.866,0.5,0.);</span>
<span class="lineNum">    1304 </span><span class="lineCov">          1 :  ttr11-&gt;RegisterYourself();</span>
<span class="lineNum">    1305 </span><span class="lineCov">          1 :  ttr22-&gt;RegisterYourself();</span>
<span class="lineNum">    1306 </span>            :  // elastic connector
<span class="lineNum">    1307 </span><span class="lineCov">          2 :  new TGeoBBox(&quot;elcon&quot;,0.72,0.005,0.3);</span>
<span class="lineNum">    1308 </span><span class="lineCov">          2 :  TGeoRotation *crr1 = new TGeoRotation();</span>
<span class="lineNum">    1309 </span><span class="lineCov">          1 :  crr1-&gt;RotateZ(-22.);</span>
<span class="lineNum">    1310 </span><span class="lineCov">          2 : TGeoCombiTrans *ctr1 = new TGeoCombiTrans(&quot;ctr1&quot;,-0.36011, -1.09951,-0.325,crr1);</span>
<span class="lineNum">    1311 </span><span class="lineCov">          1 : ctr1-&gt;RegisterYourself();</span>
<span class="lineNum">    1312 </span><span class="lineCov">          2 :  TGeoCompositeShape *cs1 = new TGeoCompositeShape(&quot;cs1&quot;,</span>
<span class="lineNum">    1313 </span>            : &quot;(((((tub-h1:ttr11)-h1:ttr22)-sp1)-sp2)-h2)+elcon:ctr1&quot;);
<span class="lineNum">    1314 </span>            :  //
<span class="lineNum">    1315 </span><span class="lineCov">          2 :  TGeoVolume *csvv = new TGeoVolume(&quot;TPC_RR_CU&quot;,cs1,m7);</span>
<span class="lineNum">    1316 </span>            :  //
<span class="lineNum">    1317 </span>            :  // resistor rod assembly 2 ceramic rods, peak rod, Cu plates
<span class="lineNum">    1318 </span>            :  // and resistors
<span class="lineNum">    1319 </span>            :  //
<span class="lineNum">    1320 </span><span class="lineCov">          2 :  TGeoVolumeAssembly *rrod = new TGeoVolumeAssembly(&quot;TPC_RRIN&quot;);</span>
<span class="lineNum">    1321 </span>            :  // rods
<span class="lineNum">    1322 </span><span class="lineCov">          1 :  rrod-&gt;AddNode(crv,1,ttr11);</span>
<span class="lineNum">    1323 </span><span class="lineCov">          1 :  rrod-&gt;AddNode(crv,2,ttr22); </span>
<span class="lineNum">    1324 </span><span class="lineCov">          1 :  rrod-&gt;AddNode(prv,1);</span>
<span class="lineNum">    1325 </span>            :  //Cu plates
<span class="lineNum">    1326 </span><span class="lineCov">        332 :  for(Int_t i=0;i&lt;165;i++){</span>
<span class="lineNum">    1327 </span><span class="lineCov">        495 :    rrod-&gt;AddNode(csvv,i+1,new TGeoTranslation(0.,0.,-122.675+i*1.5));</span>
<span class="lineNum">    1328 </span>            :  }
<span class="lineNum">    1329 </span>            :  //resistors
<span class="lineNum">    1330 </span><span class="lineCov">          2 :  TGeoTube *res = new TGeoTube(0.,0.15,0.5);</span>
<span class="lineNum">    1331 </span><span class="lineCov">          2 :  TGeoVolume *resv = new TGeoVolume(&quot;TPC_RES&quot;,res,m14);</span>
<span class="lineNum">    1332 </span><span class="lineCov">          2 :  TGeoVolumeAssembly *ress = new TGeoVolumeAssembly(&quot;TPC_RES_CH&quot;);</span>
<span class="lineNum">    1333 </span><span class="lineCov">          3 :  ress-&gt;AddNode(resv,1,new TGeoTranslation(0.2,0.,0.));</span>
<span class="lineNum">    1334 </span><span class="lineCov">          3 :  ress-&gt;AddNode(resv,2,new TGeoTranslation(-0.2,0.,0.));</span>
<span class="lineNum">    1335 </span>            :  //
<span class="lineNum">    1336 </span><span class="lineCov">          2 :  TGeoRotation *crr2 = new TGeoRotation();</span>
<span class="lineNum">    1337 </span><span class="lineCov">          1 :  crr2-&gt;RotateY(30.);</span>
<span class="lineNum">    1338 </span><span class="lineCov">          2 :  TGeoRotation *crr3 = new TGeoRotation();</span>
<span class="lineNum">    1339 </span><span class="lineCov">          1 :  crr3-&gt;RotateY(-30.); </span>
<span class="lineNum">    1340 </span>            :  //
<span class="lineNum">    1341 </span><span class="lineCov">        166 :  for(Int_t i=0;i&lt;164;i+=2){</span>
<span class="lineNum">    1342 </span><span class="lineCov">        246 :    rrod-&gt;AddNode(ress,i+1, new TGeoCombiTrans(0.,1.2,-121.925+i*1.5,crr2));</span>
<span class="lineNum">    1343 </span><span class="lineCov">        246 :    rrod-&gt;AddNode(ress,i+2, new TGeoCombiTrans(0.,1.2,-121.925+(i+1)*1.5,crr3));</span>
<span class="lineNum">    1344 </span>            :  }
<span class="lineNum">    1345 </span>            : 
<span class="lineNum">    1346 </span><span class="lineCov">          3 :  tpcrrod-&gt;AddNode(rrod,1,new TGeoCombiTrans(0.,0.,0.5,crr1));</span>
<span class="lineNum">    1347 </span>            :  //
<span class="lineNum">    1348 </span>            :  // rod left head with holders - inner
<span class="lineNum">    1349 </span>            :  //
<span class="lineNum">    1350 </span>            :  // first element - support for inner holder  TPC_IHS
<span class="lineNum">    1351 </span><span class="lineCov">          1 :  Double_t shift1[3] = {0.0,-0.175,0.0};</span>
<span class="lineNum">    1352 </span>            : 
<span class="lineNum">    1353 </span><span class="lineCov">          2 : new TGeoBBox(&quot;tpcihs1&quot;, 4.7, 0.66, 2.35);               </span>
<span class="lineNum">    1354 </span><span class="lineCov">          2 : new TGeoBBox(&quot;tpcihs2&quot;, 4.7, 0.485, 1.0, shift1);</span>
<span class="lineNum">    1355 </span><span class="lineCov">          2 : new TGeoBBox(&quot;tpcihs3&quot;, 1.5, 0.485, 2.35, shift1);</span>
<span class="lineNum">    1356 </span><span class="lineCov">          2 : new TGeoTube(&quot;tpcihs4&quot;, 0.0, 2.38, 0.1);</span>
<span class="lineNum">    1357 </span>            : //
<span class="lineNum">    1358 </span><span class="lineCov">          1 : Double_t pointstrap[16];    </span>
<span class="lineNum">    1359 </span><span class="lineCov">          1 : pointstrap[0]= 0.0;</span>
<span class="lineNum">    1360 </span><span class="lineCov">          1 : pointstrap[1]= 0.0;</span>
<span class="lineNum">    1361 </span><span class="lineCov">          1 : pointstrap[2]= 0.0;</span>
<span class="lineNum">    1362 </span><span class="lineCov">          1 : pointstrap[3]= 1.08;</span>
<span class="lineNum">    1363 </span><span class="lineCov">          1 : pointstrap[4]= 2.3;</span>
<span class="lineNum">    1364 </span><span class="lineCov">          1 : pointstrap[5]= 1.08;</span>
<span class="lineNum">    1365 </span><span class="lineCov">          1 : pointstrap[6]= 3.38;</span>
<span class="lineNum">    1366 </span><span class="lineCov">          1 : pointstrap[7]= 0.0;</span>
<span class="lineNum">    1367 </span><span class="lineCov">          1 : pointstrap[8]= 0.0;</span>
<span class="lineNum">    1368 </span><span class="lineCov">          1 : pointstrap[9]= 0.0;</span>
<span class="lineNum">    1369 </span><span class="lineCov">          1 : pointstrap[10]= 0.0;</span>
<span class="lineNum">    1370 </span><span class="lineCov">          1 : pointstrap[11]= 1.08;</span>
<span class="lineNum">    1371 </span><span class="lineCov">          1 : pointstrap[12]= 2.3;</span>
<span class="lineNum">    1372 </span><span class="lineCov">          1 : pointstrap[13]= 1.08;</span>
<span class="lineNum">    1373 </span><span class="lineCov">          1 : pointstrap[14]= 3.38;</span>
<span class="lineNum">    1374 </span><span class="lineCov">          1 : pointstrap[15]= 0.0;</span>
<span class="lineNum">    1375 </span>            : //
<span class="lineNum">    1376 </span><span class="lineCov">          2 : TGeoArb8 *tpcihs5 = new TGeoArb8(&quot;tpcihs5&quot;, 0.6, pointstrap);</span>
<span class="lineNum">    1377 </span>            : //
<span class="lineNum">    1378 </span>            : //  half space - cutting &quot;legs&quot;
<span class="lineNum">    1379 </span>            : // 
<span class="lineNum">    1380 </span><span class="lineCov">          1 :  p[0]=0.0;</span>
<span class="lineNum">    1381 </span><span class="lineCov">          1 :  p[1]=0.105;</span>
<span class="lineNum">    1382 </span><span class="lineCov">          1 :  p[2]=0.0;</span>
<span class="lineNum">    1383 </span>            :  //       
<span class="lineNum">    1384 </span><span class="lineCov">          1 : n[0] = 0.0;</span>
<span class="lineNum">    1385 </span><span class="lineCov">          1 : n[1] = 1.0;</span>
<span class="lineNum">    1386 </span><span class="lineCov">          1 : n[2] = 0.0;</span>
<span class="lineNum">    1387 </span>            : 
<span class="lineNum">    1388 </span><span class="lineCov">          2 : new TGeoHalfSpace(&quot;cutil1&quot;, p, n);</span>
<span class="lineNum">    1389 </span>            : 
<span class="lineNum">    1390 </span>            : //
<span class="lineNum">    1391 </span>            : // transformations
<span class="lineNum">    1392 </span>            : //
<span class="lineNum">    1393 </span><span class="lineCov">          2 : TGeoTranslation *trans2 = new TGeoTranslation(&quot;trans2&quot;, 0.0, 2.84, 2.25);</span>
<span class="lineNum">    1394 </span><span class="lineCov">          1 : trans2-&gt;RegisterYourself();</span>
<span class="lineNum">    1395 </span><span class="lineCov">          2 : TGeoTranslation*trans3= new TGeoTranslation(&quot;trans3&quot;, 0.0, 2.84, -2.25);</span>
<span class="lineNum">    1396 </span><span class="lineCov">          1 : trans3-&gt;RegisterYourself();</span>
<span class="lineNum">    1397 </span>            : //support - composite volume
<span class="lineNum">    1398 </span>            : //
<span class="lineNum">    1399 </span><span class="lineCov">          2 : TGeoCompositeShape *tpcihs6 = new TGeoCompositeShape(&quot;tpcihs6&quot;, &quot;tpcihs1-(tpcihs2+tpcihs3)-(tpcihs4:trans2)-(tpcihs4:trans3)-cutil1&quot;);</span>
<span class="lineNum">    1400 </span>            : //
<span class="lineNum">    1401 </span>            : // volumes - all makrolon
<span class="lineNum">    1402 </span>            : //  
<span class="lineNum">    1403 </span><span class="lineCov">          2 :  TGeoVolume *tpcihss = new TGeoVolume(&quot;TPC_IHSS&quot;, tpcihs6, m6); //support</span>
<span class="lineNum">    1404 </span><span class="lineCov">          2 :  TGeoVolume *tpcihst = new TGeoVolume(&quot;TPC_IHSTR&quot;,tpcihs5 , m6); //trapesoid</span>
<span class="lineNum">    1405 </span>            :  //now assembly
<span class="lineNum">    1406 </span><span class="lineCov">          2 : TGeoRotation *rot111 = new TGeoRotation(); </span>
<span class="lineNum">    1407 </span><span class="lineCov">          1 : rot111-&gt;RotateY(180.0);</span>
<span class="lineNum">    1408 </span>            : //
<span class="lineNum">    1409 </span><span class="lineCov">          2 : TGeoVolumeAssembly *tpcihs = new TGeoVolumeAssembly(&quot;TPC_IHS&quot;);    // assembly of the support</span>
<span class="lineNum">    1410 </span><span class="lineCov">          1 : tpcihs-&gt;AddNode(tpcihss, 1);</span>
<span class="lineNum">    1411 </span><span class="lineCov">          3 : tpcihs-&gt;AddNode(tpcihst, 1, new TGeoTranslation(-4.7, 0.66, 0.0));</span>
<span class="lineNum">    1412 </span><span class="lineCov">          3 : tpcihs-&gt;AddNode(tpcihst, 2, new TGeoCombiTrans(4.7, 0.66, 0.0, rot111));</span>
<span class="lineNum">    1413 </span>            : //
<span class="lineNum">    1414 </span>            : // two rod holders (TPC_IRH) assembled with the support
<span class="lineNum">    1415 </span>            : //
<span class="lineNum">    1416 </span><span class="lineCov">          2 : new TGeoBBox(&quot;tpcirh1&quot;, 4.7, 1.33, 0.5);</span>
<span class="lineNum">    1417 </span><span class="lineCov">          1 :  shift1[0]=-3.65;</span>
<span class="lineNum">    1418 </span><span class="lineCov">          1 :  shift1[1]=0.53;</span>
<span class="lineNum">    1419 </span><span class="lineCov">          1 :  shift1[2]=0.;</span>
<span class="lineNum">    1420 </span><span class="lineCov">          2 : new TGeoBBox(&quot;tpcirh2&quot;, 1.05, 0.8, 0.5, shift1);</span>
<span class="lineNum">    1421 </span><span class="lineCov">          1 :  shift1[0]=3.65;</span>
<span class="lineNum">    1422 </span><span class="lineCov">          1 :  shift1[1]=0.53;</span>
<span class="lineNum">    1423 </span><span class="lineCov">          1 :  shift1[2]=0.;</span>
<span class="lineNum">    1424 </span><span class="lineCov">          2 : new TGeoBBox(&quot;tpcirh3&quot;, 1.05, 0.8, 0.5, shift1);</span>
<span class="lineNum">    1425 </span><span class="lineCov">          1 :  shift1[0]=0.0;</span>
<span class="lineNum">    1426 </span><span class="lineCov">          1 :  shift1[1]=1.08;</span>
<span class="lineNum">    1427 </span><span class="lineCov">          1 :  shift1[2]=0.;</span>
<span class="lineNum">    1428 </span><span class="lineCov">          2 : new TGeoBBox(&quot;tpcirh4&quot;, 1.9, 0.25, 0.5, shift1);</span>
<span class="lineNum">    1429 </span><span class="lineCov">          2 : new TGeoTube(&quot;tpcirh5&quot;, 0, 1.9, 5);</span>
<span class="lineNum">    1430 </span>            : //
<span class="lineNum">    1431 </span><span class="lineCov">          2 : TGeoTranslation *trans4 = new TGeoTranslation(&quot;trans4&quot;, 0, 0.83, 0.0); </span>
<span class="lineNum">    1432 </span><span class="lineCov">          1 : trans4-&gt;RegisterYourself();</span>
<span class="lineNum">    1433 </span>            : //
<span class="lineNum">    1434 </span><span class="lineCov">          2 : TGeoCompositeShape *tpcirh6 = new TGeoCompositeShape(&quot;tpcirh6&quot;, &quot;tpcirh1-tpcirh2-tpcirh3-(tpcirh5:trans4)-tpcirh4&quot;);</span>
<span class="lineNum">    1435 </span>            : //
<span class="lineNum">    1436 </span>            : // now volume
<span class="lineNum">    1437 </span>            : //
<span class="lineNum">    1438 </span><span class="lineCov">          2 : TGeoVolume *tpcirh = new TGeoVolume(&quot;TPC_IRH&quot;, tpcirh6, m6);   </span>
<span class="lineNum">    1439 </span>            : //
<span class="lineNum">    1440 </span>            : // and all together...
<span class="lineNum">    1441 </span>            : //
<span class="lineNum">    1442 </span><span class="lineCov">          3 : TGeoVolume *tpciclamp = new TGeoVolumeAssembly(&quot;TPC_ICLP&quot;);</span>
<span class="lineNum">    1443 </span><span class="lineCov">          1 : tpciclamp-&gt;AddNode(tpcihs, 1);</span>
<span class="lineNum">    1444 </span><span class="lineCov">          3 : tpciclamp-&gt;AddNode(tpcirh, 1, new TGeoTranslation(0, 1.99, 1.1));</span>
<span class="lineNum">    1445 </span><span class="lineCov">          3 : tpciclamp-&gt;AddNode(tpcirh, 2, new TGeoTranslation(0, 1.99, -1.1));</span>
<span class="lineNum">    1446 </span>            : //
<span class="lineNum">    1447 </span>            : // and now left inner &quot;head&quot;
<span class="lineNum">    1448 </span>            : //
<span class="lineNum">    1449 </span><span class="lineCov">          2 : TGeoPcon *inplug = new TGeoPcon(&quot;inplug&quot;, 0.0, 360.0, 14); </span>
<span class="lineNum">    1450 </span>            : 
<span class="lineNum">    1451 </span><span class="lineCov">          1 : inplug-&gt;DefineSection(0, 0.3, 0.0, 2.2);</span>
<span class="lineNum">    1452 </span><span class="lineCov">          1 : inplug-&gt;DefineSection(1, 0.6, 0.0, 2.2);</span>
<span class="lineNum">    1453 </span>            : 
<span class="lineNum">    1454 </span><span class="lineCov">          1 : inplug-&gt;DefineSection(2, 0.6, 0.0, 1.75);</span>
<span class="lineNum">    1455 </span><span class="lineCov">          1 : inplug-&gt;DefineSection(3, 0.7, 0.0, 1.75);</span>
<span class="lineNum">    1456 </span>            : 
<span class="lineNum">    1457 </span><span class="lineCov">          1 : inplug-&gt;DefineSection(4, 0.7, 1.55, 1.75);</span>
<span class="lineNum">    1458 </span><span class="lineCov">          1 : inplug-&gt;DefineSection(5, 1.6, 1.55, 1.75);</span>
<span class="lineNum">    1459 </span>            : 
<span class="lineNum">    1460 </span><span class="lineCov">          1 : inplug-&gt;DefineSection(6, 1.6, 1.55, 2.2);</span>
<span class="lineNum">    1461 </span><span class="lineCov">          1 : inplug-&gt;DefineSection(7, 1.875, 1.55, 2.2);</span>
<span class="lineNum">    1462 </span>            : 
<span class="lineNum">    1463 </span><span class="lineCov">          1 : inplug-&gt;DefineSection(8, 1.875, 1.55, 2.2);</span>
<span class="lineNum">    1464 </span><span class="lineCov">          1 : inplug-&gt;DefineSection(9, 2.47, 1.75, 2.2);</span>
<span class="lineNum">    1465 </span>            : 
<span class="lineNum">    1466 </span><span class="lineCov">          1 : inplug-&gt;DefineSection(10, 2.47, 1.75, 2.08);</span>
<span class="lineNum">    1467 </span><span class="lineCov">          1 : inplug-&gt;DefineSection(11, 2.57, 1.8, 2.08);</span>
<span class="lineNum">    1468 </span>            : 
<span class="lineNum">    1469 </span><span class="lineCov">          1 : inplug-&gt;DefineSection(12, 2.57, 1.92, 2.08);</span>
<span class="lineNum">    1470 </span><span class="lineCov">          1 : inplug-&gt;DefineSection(13, 2.95, 1.92, 2.08);</span>
<span class="lineNum">    1471 </span>            : //
<span class="lineNum">    1472 </span><span class="lineCov">          1 :  shift1[0]=0.0;</span>
<span class="lineNum">    1473 </span><span class="lineCov">          1 :  shift1[1]=-2.09;</span>
<span class="lineNum">    1474 </span><span class="lineCov">          1 :  shift1[2]=1.075;</span>
<span class="lineNum">    1475 </span>            :  //
<span class="lineNum">    1476 </span><span class="lineCov">          2 : new TGeoBBox(&quot;pcuti&quot;, 1.5, 0.11, 1.075, shift1);</span>
<span class="lineNum">    1477 </span>            : //
<span class="lineNum">    1478 </span><span class="lineCov">          2 : TGeoCompositeShape *inplleft = new TGeoCompositeShape(&quot;inplleft&quot;, &quot;inplug-pcuti&quot;);</span>
<span class="lineNum">    1479 </span><span class="lineCov">          2 : TGeoVolume *tpcinlplug = new TGeoVolume(&quot;TPC_INPLL&quot;, inplleft, m6);   </span>
<span class="lineNum">    1480 </span>            : //
<span class="lineNum">    1481 </span>            : //  holder + plugs
<span class="lineNum">    1482 </span>            : //
<span class="lineNum">    1483 </span><span class="lineCov">          3 :  TGeoVolume *tpcihpl = new TGeoVolumeAssembly(&quot;TPC_IHPL&quot;); //holder+2 plugs (reflected)</span>
<span class="lineNum">    1484 </span><span class="lineCov">          1 :  tpcihpl-&gt;AddNode(tpcinlplug, 1);</span>
<span class="lineNum">    1485 </span><span class="lineCov">          1 :  tpcihpl-&gt;AddNode(tpcinlplug, 2,ref);</span>
<span class="lineNum">    1486 </span><span class="lineCov">          3 :  tpcihpl-&gt;AddNode(tpciclamp,1,new TGeoTranslation(0.0, -2.765, 0.0)); </span>
<span class="lineNum">    1487 </span>            :  //
<span class="lineNum">    1488 </span>            :  // outer holders and clamps
<span class="lineNum">    1489 </span>            :  //
<span class="lineNum">    1490 </span>            : 
<span class="lineNum">    1491 </span>            :  // outer membrane holder (between rods)  
<span class="lineNum">    1492 </span><span class="lineCov">          1 : pointstrap[0]= 0.0;</span>
<span class="lineNum">    1493 </span><span class="lineCov">          1 : pointstrap[1]= 0.0;</span>
<span class="lineNum">    1494 </span><span class="lineCov">          1 : pointstrap[2]= 0.0;</span>
<span class="lineNum">    1495 </span><span class="lineCov">          1 : pointstrap[3]= 2.8;</span>
<span class="lineNum">    1496 </span><span class="lineCov">          1 : pointstrap[4]= 3.1;</span>
<span class="lineNum">    1497 </span><span class="lineCov">          2 : pointstrap[5]= 2.8-3.1*TMath::Tan(15.*TMath::DegToRad());</span>
<span class="lineNum">    1498 </span><span class="lineCov">          1 : pointstrap[6]= 3.1;</span>
<span class="lineNum">    1499 </span><span class="lineCov">          1 : pointstrap[7]= 0.0;</span>
<span class="lineNum">    1500 </span><span class="lineCov">          1 : pointstrap[8]= 0.0;</span>
<span class="lineNum">    1501 </span><span class="lineCov">          1 : pointstrap[9]= 0.0;</span>
<span class="lineNum">    1502 </span><span class="lineCov">          1 : pointstrap[10]= 0.0;</span>
<span class="lineNum">    1503 </span><span class="lineCov">          1 : pointstrap[11]= 2.8;</span>
<span class="lineNum">    1504 </span><span class="lineCov">          1 : pointstrap[12]= 3.1;</span>
<span class="lineNum">    1505 </span><span class="lineCov">          2 : pointstrap[13]= 2.8-3.1*TMath::Tan(15.*TMath::DegToRad());</span>
<span class="lineNum">    1506 </span><span class="lineCov">          1 : pointstrap[14]= 3.1;</span>
<span class="lineNum">    1507 </span><span class="lineCov">          1 : pointstrap[15]= 0.0;</span>
<span class="lineNum">    1508 </span>            : //
<span class="lineNum">    1509 </span><span class="lineCov">          2 : TGeoArb8 *tpcomh1 = new TGeoArb8(&quot;tpcomh1&quot;, 1.05, pointstrap);   </span>
<span class="lineNum">    1510 </span><span class="lineCov">          2 : TGeoBBox *tpcomh2 = new TGeoBBox(&quot;tpcomh2&quot;, 0.8, 1.4, 6);</span>
<span class="lineNum">    1511 </span>            : //
<span class="lineNum">    1512 </span><span class="lineCov">          2 : TGeoVolume *tpcomh1v = new TGeoVolume(&quot;TPC_OMH1&quot;, tpcomh1, m7);    </span>
<span class="lineNum">    1513 </span><span class="lineCov">          2 : TGeoVolume *tpcomh2v = new TGeoVolume(&quot;TPC_OMH2&quot;, tpcomh2, m7);</span>
<span class="lineNum">    1514 </span>            : //
<span class="lineNum">    1515 </span><span class="lineCov">          3 : TGeoVolume *tpcomh3v = new TGeoVolumeAssembly(&quot;TPC_OMH3&quot;);    // assembly1</span>
<span class="lineNum">    1516 </span><span class="lineCov">          3 : tpcomh3v-&gt;AddNode(tpcomh1v, 1, new TGeoTranslation(0.8, -1.4, 4.95));</span>
<span class="lineNum">    1517 </span><span class="lineCov">          3 :  tpcomh3v-&gt;AddNode(tpcomh1v, 2, new TGeoTranslation(0.8, -1.4, -4.95));</span>
<span class="lineNum">    1518 </span><span class="lineCov">          1 : tpcomh3v-&gt;AddNode(tpcomh2v, 1);</span>
<span class="lineNum">    1519 </span>            : //
<span class="lineNum">    1520 </span><span class="lineCov">          1 : shift1[0] = 0.9;</span>
<span class="lineNum">    1521 </span><span class="lineCov">          1 : shift1[1] = -1.85;</span>
<span class="lineNum">    1522 </span><span class="lineCov">          1 : shift1[2] = 0.0;</span>
<span class="lineNum">    1523 </span>            : //
<span class="lineNum">    1524 </span><span class="lineCov">          2 : new TGeoBBox(&quot;tpcomh3&quot;, 1.65, 1.15, 3.4);</span>
<span class="lineNum">    1525 </span><span class="lineCov">          2 : TGeoBBox *tpcomh4 = new TGeoBBox(&quot;tpcomh4&quot;, 0.75, 0.7, 3.4, shift1);</span>
<span class="lineNum">    1526 </span>            : //
<span class="lineNum">    1527 </span>            : // halfspace 1
<span class="lineNum">    1528 </span>            : //
<span class="lineNum">    1529 </span><span class="lineCov">          1 : p[0] = 0.0;</span>
<span class="lineNum">    1530 </span><span class="lineCov">          1 : p[1] = -1.05;   </span>
<span class="lineNum">    1531 </span><span class="lineCov">          1 : p[2] = -3.4;</span>
<span class="lineNum">    1532 </span>            : //
<span class="lineNum">    1533 </span><span class="lineCov">          1 : n[0] = 0.0;</span>
<span class="lineNum">    1534 </span><span class="lineCov">          2 : n[1] = -1.0*TMath::Tan(30.*TMath::DegToRad());</span>
<span class="lineNum">    1535 </span><span class="lineCov">          1 : n[2] = 1.0;</span>
<span class="lineNum">    1536 </span>            : //
<span class="lineNum">    1537 </span><span class="lineCov">          2 : new TGeoHalfSpace(&quot;cutomh1&quot;, p, n); </span>
<span class="lineNum">    1538 </span>            : //
<span class="lineNum">    1539 </span>            : // halfspace 2
<span class="lineNum">    1540 </span>            : //
<span class="lineNum">    1541 </span><span class="lineCov">          1 : p[0] = 0.0;</span>
<span class="lineNum">    1542 </span><span class="lineCov">          1 : p[1] = -1.05;   </span>
<span class="lineNum">    1543 </span><span class="lineCov">          1 : p[2] = 3.4;</span>
<span class="lineNum">    1544 </span>            : //
<span class="lineNum">    1545 </span><span class="lineCov">          1 : n[0] = 0.0;</span>
<span class="lineNum">    1546 </span><span class="lineCov">          2 : n[1] = -1.0*TMath::Tan(30.*TMath::DegToRad());</span>
<span class="lineNum">    1547 </span><span class="lineCov">          1 : n[2] = -1.0;</span>
<span class="lineNum">    1548 </span>            : //
<span class="lineNum">    1549 </span><span class="lineCov">          2 : new TGeoHalfSpace(&quot;cutomh2&quot;, p, n);</span>
<span class="lineNum">    1550 </span>            : //
<span class="lineNum">    1551 </span>            : // halfspace 3
<span class="lineNum">    1552 </span>            : //
<span class="lineNum">    1553 </span><span class="lineCov">          1 : p[0] = -1.65;</span>
<span class="lineNum">    1554 </span><span class="lineCov">          1 : p[1] = 0.0;     </span>
<span class="lineNum">    1555 </span><span class="lineCov">          1 : p[2] = -0.9;</span>
<span class="lineNum">    1556 </span>            : //
<span class="lineNum">    1557 </span><span class="lineCov">          2 : n[0] = 1.0*TMath::Tan(75.*TMath::DegToRad());</span>
<span class="lineNum">    1558 </span><span class="lineCov">          1 : n[1] = 0.0;</span>
<span class="lineNum">    1559 </span><span class="lineCov">          1 : n[2] = 1.0;</span>
<span class="lineNum">    1560 </span>            : //
<span class="lineNum">    1561 </span><span class="lineCov">          2 : new TGeoHalfSpace(&quot;cutomh3&quot;, p, n);   </span>
<span class="lineNum">    1562 </span>            : //
<span class="lineNum">    1563 </span>            : // halfspace 4
<span class="lineNum">    1564 </span>            : //
<span class="lineNum">    1565 </span><span class="lineCov">          1 : p[0] = -1.65;</span>
<span class="lineNum">    1566 </span><span class="lineCov">          1 : p[1] = 0.0;      </span>
<span class="lineNum">    1567 </span><span class="lineCov">          1 : p[2] = 0.9;</span>
<span class="lineNum">    1568 </span>            : //
<span class="lineNum">    1569 </span><span class="lineCov">          2 : n[0] = 1.0*TMath::Tan(75*TMath::DegToRad());</span>
<span class="lineNum">    1570 </span><span class="lineCov">          1 : n[1] = 0.0;</span>
<span class="lineNum">    1571 </span><span class="lineCov">          1 : n[2] = -1.0;</span>
<span class="lineNum">    1572 </span>            : //
<span class="lineNum">    1573 </span><span class="lineCov">          2 : new TGeoHalfSpace(&quot;cutomh4&quot;, p, n); </span>
<span class="lineNum">    1574 </span>            : //
<span class="lineNum">    1575 </span>            : // halsfspace 5
<span class="lineNum">    1576 </span>            : //
<span class="lineNum">    1577 </span><span class="lineCov">          1 : p[0] = 1.65;</span>
<span class="lineNum">    1578 </span><span class="lineCov">          1 : p[1] = -1.05;      </span>
<span class="lineNum">    1579 </span><span class="lineCov">          1 : p[2] = 0.0;  </span>
<span class="lineNum">    1580 </span>            : //
<span class="lineNum">    1581 </span><span class="lineCov">          1 : n[0] = -1.0;</span>
<span class="lineNum">    1582 </span><span class="lineCov">          2 : n[1] = -1.0*TMath::Tan(20.*TMath::DegToRad());</span>
<span class="lineNum">    1583 </span><span class="lineCov">          1 : n[2] = 0.0;</span>
<span class="lineNum">    1584 </span>            : //
<span class="lineNum">    1585 </span><span class="lineCov">          2 : new TGeoHalfSpace(&quot;cutomh5&quot;, p, n); </span>
<span class="lineNum">    1586 </span>            : //  
<span class="lineNum">    1587 </span><span class="lineCov">          2 : TGeoCompositeShape *tpcomh5 = new TGeoCompositeShape(&quot;tpcomh5&quot;, &quot;tpcomh3-cutomh1-cutomh2-cutomh3-cutomh4-cutomh5&quot;); </span>
<span class="lineNum">    1588 </span>            : //
<span class="lineNum">    1589 </span><span class="lineCov">          2 :  TGeoVolume *tpcomh5v = new TGeoVolume(&quot;TPC_OMH5&quot;,tpcomh5,m6);</span>
<span class="lineNum">    1590 </span><span class="lineCov">          2 :  TGeoVolume *tpcomh4v = new TGeoVolume(&quot;TPC_OMH6&quot;,tpcomh4,m6);</span>
<span class="lineNum">    1591 </span>            :  //
<span class="lineNum">    1592 </span><span class="lineCov">          2 :  TGeoVolumeAssembly *tpcomh7v = new TGeoVolumeAssembly(&quot;TPC_OMH7&quot;);</span>
<span class="lineNum">    1593 </span><span class="lineCov">          1 :  tpcomh7v-&gt;AddNode(tpcomh5v,1);</span>
<span class="lineNum">    1594 </span><span class="lineCov">          1 :  tpcomh7v-&gt;AddNode(tpcomh4v,1);</span>
<span class="lineNum">    1595 </span>            :  //
<span class="lineNum">    1596 </span>            :  // full membrane holder - tpcomh3v + tpcomh7v
<span class="lineNum">    1597 </span>            :  //
<span class="lineNum">    1598 </span><span class="lineCov">          2 :  TGeoVolumeAssembly *tpcomh = new TGeoVolumeAssembly(&quot;TPC_OMH&quot;);</span>
<span class="lineNum">    1599 </span><span class="lineCov">          3 :  tpcomh-&gt;AddNode(tpcomh3v,1,new TGeoTranslation(1.5,0.,0.));</span>
<span class="lineNum">    1600 </span><span class="lineCov">          3 :  tpcomh-&gt;AddNode(tpcomh3v,2,new TGeoCombiTrans(-1.5,0.,0.,rot111));</span>
<span class="lineNum">    1601 </span><span class="lineCov">          3 :  tpcomh-&gt;AddNode(tpcomh7v,1,new TGeoTranslation(0.65+1.5, 2.55, 0.0));</span>
<span class="lineNum">    1602 </span><span class="lineCov">          3 :  tpcomh-&gt;AddNode(tpcomh7v,2,new TGeoCombiTrans(-0.65-1.5, 2.55, 0.0,rot111)); </span>
<span class="lineNum">    1603 </span>            :  //
<span class="lineNum">    1604 </span>            :  //  outer rod holder support
<span class="lineNum">    1605 </span>            :  //
<span class="lineNum">    1606 </span><span class="lineCov">          2 : new TGeoBBox(&quot;tpcohs1&quot;, 3.8, 0.675, 2.35); </span>
<span class="lineNum">    1607 </span>            : //
<span class="lineNum">    1608 </span><span class="lineCov">          1 : shift1[0] = 0.0;</span>
<span class="lineNum">    1609 </span><span class="lineCov">          1 : shift1[1] = 0.175;</span>
<span class="lineNum">    1610 </span><span class="lineCov">          1 : shift1[2] = 0.0;</span>
<span class="lineNum">    1611 </span>            : //
<span class="lineNum">    1612 </span><span class="lineCov">          2 : new TGeoBBox(&quot;tpcohs2&quot;, 1.5, 0.5, 2.35, shift1);</span>
<span class="lineNum">    1613 </span><span class="lineCov">          2 : new TGeoBBox(&quot;tpcohs3&quot;, 3.8, 0.5, 0.85, shift1);</span>
<span class="lineNum">    1614 </span>            : //
<span class="lineNum">    1615 </span><span class="lineCov">          1 : shift1[0] = 0.0;</span>
<span class="lineNum">    1616 </span><span class="lineCov">          1 : shift1[1] = -1.175;</span>
<span class="lineNum">    1617 </span><span class="lineCov">          1 : shift1[2] = 0.0;</span>
<span class="lineNum">    1618 </span>            : //
<span class="lineNum">    1619 </span><span class="lineCov">          2 : TGeoBBox *tpcohs4 = new TGeoBBox(&quot;tpsohs4&quot;, 3.1, 0.5, 0.7, shift1);</span>
<span class="lineNum">    1620 </span>            : //
<span class="lineNum">    1621 </span><span class="lineCov">          2 : TGeoVolume *tpcohs4v = new TGeoVolume(&quot;TPC_OHS4&quot;, tpcohs4, m6);</span>
<span class="lineNum">    1622 </span>            : //
<span class="lineNum">    1623 </span><span class="lineCov">          1 : p[0] = 0.0;</span>
<span class="lineNum">    1624 </span><span class="lineCov">          1 : p[1] = -0.186;   </span>
<span class="lineNum">    1625 </span><span class="lineCov">          1 : p[2] = 0.0;</span>
<span class="lineNum">    1626 </span>            : //
<span class="lineNum">    1627 </span><span class="lineCov">          1 : n[0] = 0.0;</span>
<span class="lineNum">    1628 </span><span class="lineCov">          1 : n[1] = -1.0;</span>
<span class="lineNum">    1629 </span><span class="lineCov">          1 : n[2] = 0.0;</span>
<span class="lineNum">    1630 </span>            : //
<span class="lineNum">    1631 </span><span class="lineCov">          2 : new TGeoHalfSpace(&quot;cutohs1&quot;, p, n);</span>
<span class="lineNum">    1632 </span>            : //
<span class="lineNum">    1633 </span><span class="lineCov">          2 : TGeoCompositeShape *tpcohs5 = new TGeoCompositeShape(&quot;tpcohs5&quot;, &quot;tpcohs1-tpcohs2-tpcohs3-cutohs1&quot;); </span>
<span class="lineNum">    1634 </span><span class="lineCov">          2 : TGeoVolume *tpcohs5v = new TGeoVolume(&quot;TPC_OHS5&quot;, tpcohs5, m6); </span>
<span class="lineNum">    1635 </span>            : //
<span class="lineNum">    1636 </span><span class="lineCov">          2 : TGeoVolumeAssembly *tpcohs = new TGeoVolumeAssembly(&quot;TPC_OHS&quot;);    </span>
<span class="lineNum">    1637 </span><span class="lineCov">          1 : tpcohs-&gt;AddNode(tpcohs5v, 1);</span>
<span class="lineNum">    1638 </span><span class="lineCov">          1 : tpcohs-&gt;AddNode(tpcohs4v, 1); </span>
<span class="lineNum">    1639 </span>            : //
<span class="lineNum">    1640 </span>            : // outer rod holder itself
<span class="lineNum">    1641 </span>            : //
<span class="lineNum">    1642 </span><span class="lineCov">          1 : shift1[0] = 0.0;</span>
<span class="lineNum">    1643 </span><span class="lineCov">          1 : shift1[1] = 1.325;</span>
<span class="lineNum">    1644 </span><span class="lineCov">          1 : shift1[2] = 0.0;</span>
<span class="lineNum">    1645 </span><span class="lineCov">          2 :  new TGeoBBox(&quot;tpcorh1&quot;, 3.1, 1.825, 0.55); //from this box we cut pieces...</span>
<span class="lineNum">    1646 </span>            :  //
<span class="lineNum">    1647 </span><span class="lineCov">          1 : shift1[0] = -3.1;       </span>
<span class="lineNum">    1648 </span><span class="lineCov">          1 : shift1[1] = -0.5;       </span>
<span class="lineNum">    1649 </span><span class="lineCov">          1 : shift1[2] = 0.0;</span>
<span class="lineNum">    1650 </span>            : //
<span class="lineNum">    1651 </span><span class="lineCov">          2 : new TGeoBBox(&quot;tpcorh2&quot;, 0.5, 2.75, 1.1, shift1);</span>
<span class="lineNum">    1652 </span>            : //
<span class="lineNum">    1653 </span><span class="lineCov">          1 : shift1[0] = 3.1;        </span>
<span class="lineNum">    1654 </span><span class="lineCov">          1 : shift1[1] = -0.5;       </span>
<span class="lineNum">    1655 </span><span class="lineCov">          1 : shift1[2] = 0.0;</span>
<span class="lineNum">    1656 </span>            : //
<span class="lineNum">    1657 </span><span class="lineCov">          2 : new TGeoBBox(&quot;tpcorh3&quot;, 0.5, 2.75, 1.1, shift1);</span>
<span class="lineNum">    1658 </span>            : //
<span class="lineNum">    1659 </span><span class="lineCov">          1 : shift1[0] = 0.0;</span>
<span class="lineNum">    1660 </span><span class="lineCov">          1 : shift1[1] = -0.5;       </span>
<span class="lineNum">    1661 </span><span class="lineCov">          1 : shift1[2] = -0.95;</span>
<span class="lineNum">    1662 </span>            : //
<span class="lineNum">    1663 </span><span class="lineCov">          2 : new TGeoBBox(&quot;tpcorh4&quot;, 3.9, 2.75, 0.5, shift1);</span>
<span class="lineNum">    1664 </span>            : //
<span class="lineNum">    1665 </span><span class="lineCov">          1 : shift1[0] = 0.0;</span>
<span class="lineNum">    1666 </span><span class="lineCov">          1 : shift1[1] = -0.5;</span>
<span class="lineNum">    1667 </span><span class="lineCov">          1 : shift1[2] = 0.0;</span>
<span class="lineNum">    1668 </span>            : //
<span class="lineNum">    1669 </span><span class="lineCov">          2 : new TGeoBBox(&quot;tpcorh5&quot;, 1.95, 0.5, 1.1, shift1);</span>
<span class="lineNum">    1670 </span>            : //
<span class="lineNum">    1671 </span><span class="lineCov">          1 : shift1[0] = 0.0;</span>
<span class="lineNum">    1672 </span><span class="lineCov">          1 : shift1[1] = -0.5;</span>
<span class="lineNum">    1673 </span><span class="lineCov">          1 : shift1[2] = 0.55;</span>
<span class="lineNum">    1674 </span>            : //
<span class="lineNum">    1675 </span><span class="lineCov">          2 : new TGeoBBox(&quot;tpcorh6&quot;, 2.4, 0.5, 0.6, shift1);</span>
<span class="lineNum">    1676 </span>            : //
<span class="lineNum">    1677 </span><span class="lineCov">          2 : new TGeoTube(&quot;tpcorh7&quot;, 0, 1.95, 0.85);</span>
<span class="lineNum">    1678 </span><span class="lineCov">          2 : new TGeoTube(&quot;tpcorh8&quot;, 0, 2.4, 0.6);</span>
<span class="lineNum">    1679 </span>            : //
<span class="lineNum">    1680 </span><span class="lineCov">          2 : TGeoTranslation *trans33 = new TGeoTranslation(&quot;trans33&quot;, 0.0, 0.0, 0.55); </span>
<span class="lineNum">    1681 </span><span class="lineCov">          1 : trans33-&gt;RegisterYourself();</span>
<span class="lineNum">    1682 </span>            : //
<span class="lineNum">    1683 </span><span class="lineCov">          2 : TGeoCompositeShape *tpcorh9 = new TGeoCompositeShape(&quot;tpcorh9&quot;, &quot;tpcorh1-tpcorh2-tpcorh3-tpcorh4-tpcorh5-tpcorh6-(tpcorh8:trans33)-tpcorh7&quot;);</span>
<span class="lineNum">    1684 </span>            : //
<span class="lineNum">    1685 </span><span class="lineCov">          2 :  TGeoVolume *tpcorh9v = new TGeoVolume(&quot;TPC_ORH&quot;,tpcorh9,m6); //outer rod holder </span>
<span class="lineNum">    1686 </span>            :  //
<span class="lineNum">    1687 </span>            :  // now 2 holders together
<span class="lineNum">    1688 </span>            :  //
<span class="lineNum">    1689 </span><span class="lineCov">          2 :  TGeoVolumeAssembly *tpcorh = new TGeoVolumeAssembly(&quot;TPC_ORH2&quot;);</span>
<span class="lineNum">    1690 </span>            :  //
<span class="lineNum">    1691 </span><span class="lineCov">          3 :  tpcorh-&gt;AddNode(tpcorh9v,1,new TGeoTranslation(0.0, 0.0, 1.25));</span>
<span class="lineNum">    1692 </span><span class="lineCov">          3 :  tpcorh-&gt;AddNode(tpcorh9v,2,new TGeoCombiTrans(0.0, 0.0, -1.25,rot111));</span>
<span class="lineNum">    1693 </span>            : //
<span class="lineNum">    1694 </span>            : // outer rod plug left
<span class="lineNum">    1695 </span>            : //
<span class="lineNum">    1696 </span><span class="lineCov">          2 : TGeoPcon *outplug = new TGeoPcon(&quot;outplug&quot;, 0.0, 360.0, 14); </span>
<span class="lineNum">    1697 </span>            : 
<span class="lineNum">    1698 </span><span class="lineCov">          1 : outplug-&gt;DefineSection(0, 0.5, 0.0, 2.2);</span>
<span class="lineNum">    1699 </span><span class="lineCov">          1 : outplug-&gt;DefineSection(1, 0.7, 0.0, 2.2);</span>
<span class="lineNum">    1700 </span>            : 
<span class="lineNum">    1701 </span><span class="lineCov">          1 : outplug-&gt;DefineSection(2, 0.7, 1.55, 2.2);</span>
<span class="lineNum">    1702 </span><span class="lineCov">          1 : outplug-&gt;DefineSection(3, 0.8, 1.55, 2.2);</span>
<span class="lineNum">    1703 </span>            : 
<span class="lineNum">    1704 </span><span class="lineCov">          1 : outplug-&gt;DefineSection(4, 0.8, 1.55, 1.75);</span>
<span class="lineNum">    1705 </span><span class="lineCov">          1 : outplug-&gt;DefineSection(5, 1.2, 1.55, 1.75);</span>
<span class="lineNum">    1706 </span>            : 
<span class="lineNum">    1707 </span><span class="lineCov">          1 : outplug-&gt;DefineSection(6, 1.2, 1.55, 2.2);</span>
<span class="lineNum">    1708 </span><span class="lineCov">          1 : outplug-&gt;DefineSection(7, 1.875, 1.55, 2.2);</span>
<span class="lineNum">    1709 </span>            : 
<span class="lineNum">    1710 </span><span class="lineCov">          1 : outplug-&gt;DefineSection(8, 1.875, 1.55, 2.2);</span>
<span class="lineNum">    1711 </span><span class="lineCov">          1 : outplug-&gt;DefineSection(9, 2.47, 1.75, 2.2);</span>
<span class="lineNum">    1712 </span>            : 
<span class="lineNum">    1713 </span><span class="lineCov">          1 : outplug-&gt;DefineSection(10, 2.47, 1.75, 2.08);</span>
<span class="lineNum">    1714 </span><span class="lineCov">          1 : outplug-&gt;DefineSection(11, 2.57, 1.8, 2.08);</span>
<span class="lineNum">    1715 </span>            : 
<span class="lineNum">    1716 </span><span class="lineCov">          1 : outplug-&gt;DefineSection(12, 2.57, 1.92, 2.08);</span>
<span class="lineNum">    1717 </span><span class="lineCov">          1 : outplug-&gt;DefineSection(13, 2.95, 1.92, 2.08);</span>
<span class="lineNum">    1718 </span>            : //
<span class="lineNum">    1719 </span><span class="lineCov">          1 : shift1[0] = 0.0;</span>
<span class="lineNum">    1720 </span><span class="lineCov">          1 : shift1[1] = 2.09;</span>
<span class="lineNum">    1721 </span><span class="lineCov">          1 : shift1[2] = 1.01;</span>
<span class="lineNum">    1722 </span>            : 
<span class="lineNum">    1723 </span><span class="lineCov">          2 : new TGeoBBox(&quot;cutout&quot;, 2.5, 0.11, 1.01, shift1);</span>
<span class="lineNum">    1724 </span>            : //
<span class="lineNum">    1725 </span>            : 
<span class="lineNum">    1726 </span><span class="lineCov">          2 : TGeoCompositeShape *outplleft = new TGeoCompositeShape(&quot;outplleft&quot;, &quot;outplug-cutout&quot;);    </span>
<span class="lineNum">    1727 </span><span class="lineCov">          2 : TGeoVolume *outplleftv = new TGeoVolume(&quot;TPC_OPLL&quot;, outplleft, m6); </span>
<span class="lineNum">    1728 </span>            : //
<span class="lineNum">    1729 </span>            : //  support + holder + plug
<span class="lineNum">    1730 </span>            : //
<span class="lineNum">    1731 </span>            : 
<span class="lineNum">    1732 </span>            :  
<span class="lineNum">    1733 </span><span class="lineCov">          2 :  TGeoVolumeAssembly *tpcohpl = new TGeoVolumeAssembly(&quot;TPC_OHPL&quot;); </span>
<span class="lineNum">    1734 </span>            :  //
<span class="lineNum">    1735 </span><span class="lineCov">          1 :  tpcohpl-&gt;AddNode(outplleftv,1); //plug</span>
<span class="lineNum">    1736 </span><span class="lineCov">          1 :  tpcohpl-&gt;AddNode(outplleftv,2,ref); //plug reflected</span>
<span class="lineNum">    1737 </span><span class="lineCov">          1 :  tpcohpl-&gt;AddNode(tpcorh,1); //rod holder</span>
<span class="lineNum">    1738 </span><span class="lineCov">          3 :  tpcohpl-&gt;AddNode(tpcohs,1,new TGeoTranslation(0.0, 3.925, 0)); // support</span>
<span class="lineNum">    1739 </span>            :  //
<span class="lineNum">    1740 </span>            : 
<span class="lineNum">    1741 </span>            :  //
<span class="lineNum">    1742 </span>            :  // main membrane holder
<span class="lineNum">    1743 </span>            :  //           
<span class="lineNum">    1744 </span><span class="lineCov">          1 : pointstrap[0]= 0.0;</span>
<span class="lineNum">    1745 </span><span class="lineCov">          1 : pointstrap[1]= 0.0;</span>
<span class="lineNum">    1746 </span><span class="lineCov">          1 : pointstrap[2]= 0.0;</span>
<span class="lineNum">    1747 </span><span class="lineCov">          1 : pointstrap[3]= 2.8;</span>
<span class="lineNum">    1748 </span><span class="lineCov">          1 : pointstrap[4]= 3.1;</span>
<span class="lineNum">    1749 </span><span class="lineCov">          1 : pointstrap[5]= 1.96;</span>
<span class="lineNum">    1750 </span><span class="lineCov">          1 : pointstrap[6]= 3.1;</span>
<span class="lineNum">    1751 </span><span class="lineCov">          1 : pointstrap[7]= 0.0;</span>
<span class="lineNum">    1752 </span><span class="lineCov">          1 : pointstrap[8]= 0.0;</span>
<span class="lineNum">    1753 </span><span class="lineCov">          1 : pointstrap[9]= 0.0;</span>
<span class="lineNum">    1754 </span><span class="lineCov">          1 : pointstrap[10]= 0.0;</span>
<span class="lineNum">    1755 </span><span class="lineCov">          1 : pointstrap[11]= 2.8;</span>
<span class="lineNum">    1756 </span><span class="lineCov">          1 : pointstrap[12]= 3.1;</span>
<span class="lineNum">    1757 </span><span class="lineCov">          1 : pointstrap[13]= 1.96;</span>
<span class="lineNum">    1758 </span><span class="lineCov">          1 : pointstrap[14]= 3.1;</span>
<span class="lineNum">    1759 </span><span class="lineCov">          1 : pointstrap[15]= 0.0; </span>
<span class="lineNum">    1760 </span>            : //
<span class="lineNum">    1761 </span><span class="lineCov">          2 : TGeoArb8 *tpcmmh1 = new TGeoArb8(&quot;tpcmmh1&quot;, 1.75, pointstrap);</span>
<span class="lineNum">    1762 </span><span class="lineCov">          2 : TGeoBBox *tpcmmh2 = new TGeoBBox(&quot;tpcmmh2&quot;, 0.8, 1.4, 12.5); </span>
<span class="lineNum">    1763 </span>            : //
<span class="lineNum">    1764 </span><span class="lineCov">          2 : TGeoVolume *tpcmmh1v = new TGeoVolume(&quot;TPC_MMH1&quot;, tpcmmh1, m6);   </span>
<span class="lineNum">    1765 </span><span class="lineCov">          2 : TGeoVolume *tpcmmh2v = new TGeoVolume(&quot;TPC_MMH2&quot;, tpcmmh2, m6);</span>
<span class="lineNum">    1766 </span>            : //
<span class="lineNum">    1767 </span><span class="lineCov">          2 :  TGeoVolumeAssembly *tpcmmhs = new TGeoVolumeAssembly(&quot;TPC_MMHS&quot;);</span>
<span class="lineNum">    1768 </span><span class="lineCov">          3 :  tpcmmhs-&gt;AddNode(tpcmmh1v,1,new TGeoTranslation(0.8, -1.4, 10.75));</span>
<span class="lineNum">    1769 </span><span class="lineCov">          3 :  tpcmmhs-&gt;AddNode(tpcmmh1v,2,new TGeoTranslation(0.8, -1.4, -10.75));</span>
<span class="lineNum">    1770 </span><span class="lineCov">          1 :  tpcmmhs-&gt;AddNode(tpcmmh2v,1);</span>
<span class="lineNum">    1771 </span>            :  //
<span class="lineNum">    1772 </span>            :  // main membrahe holder clamp
<span class="lineNum">    1773 </span>            :  //
<span class="lineNum">    1774 </span><span class="lineCov">          1 : shift1[0] = -0.75;</span>
<span class="lineNum">    1775 </span><span class="lineCov">          1 : shift1[1] = -1.15;</span>
<span class="lineNum">    1776 </span><span class="lineCov">          1 : shift1[2] = 0.0;</span>
<span class="lineNum">    1777 </span>            : //
<span class="lineNum">    1778 </span><span class="lineCov">          2 : new TGeoBBox(&quot;tpcmmhc1&quot;, 1.65, 1.85, 8.9); </span>
<span class="lineNum">    1779 </span><span class="lineCov">          2 : new TGeoBBox(&quot;tpcmmhc2&quot;, 0.9, 0.7, 8.9, shift1);</span>
<span class="lineNum">    1780 </span>            : //
<span class="lineNum">    1781 </span>            : // half spaces  - cuts
<span class="lineNum">    1782 </span>            : //
<span class="lineNum">    1783 </span><span class="lineCov">          1 : p[0] = -1.65;</span>
<span class="lineNum">    1784 </span><span class="lineCov">          1 : p[1] = 0.0;   </span>
<span class="lineNum">    1785 </span><span class="lineCov">          1 : p[2] = -0.9;</span>
<span class="lineNum">    1786 </span>            : //
<span class="lineNum">    1787 </span><span class="lineCov">          1 : n[0] = 8.0;</span>
<span class="lineNum">    1788 </span><span class="lineCov">          1 : n[1] = 0.0;</span>
<span class="lineNum">    1789 </span><span class="lineCov">          2 : n[2] = 8.0*TMath::Tan(13.*TMath::DegToRad());</span>
<span class="lineNum">    1790 </span>            : //
<span class="lineNum">    1791 </span><span class="lineCov">          2 : new TGeoHalfSpace(&quot;cutmmh1&quot;, p, n);</span>
<span class="lineNum">    1792 </span>            : //
<span class="lineNum">    1793 </span><span class="lineCov">          1 : p[0] = -1.65;</span>
<span class="lineNum">    1794 </span><span class="lineCov">          1 : p[1] = 0.0;   </span>
<span class="lineNum">    1795 </span><span class="lineCov">          1 : p[2] = 0.9;</span>
<span class="lineNum">    1796 </span>            : //
<span class="lineNum">    1797 </span><span class="lineCov">          1 : n[0] = 8.0;</span>
<span class="lineNum">    1798 </span><span class="lineCov">          1 : n[1] = 0.0;</span>
<span class="lineNum">    1799 </span><span class="lineCov">          2 : n[2] = -8.0*TMath::Tan(13.*TMath::DegToRad());</span>
<span class="lineNum">    1800 </span>            : //
<span class="lineNum">    1801 </span><span class="lineCov">          2 : new TGeoHalfSpace(&quot;cutmmh2&quot;, p, n);</span>
<span class="lineNum">    1802 </span>            : //
<span class="lineNum">    1803 </span><span class="lineCov">          1 : p[0] = 0.0;</span>
<span class="lineNum">    1804 </span><span class="lineCov">          1 : p[1] = 1.85;   </span>
<span class="lineNum">    1805 </span><span class="lineCov">          1 : p[2] = -2.8;</span>
<span class="lineNum">    1806 </span>            : //
<span class="lineNum">    1807 </span><span class="lineCov">          1 : n[0] = 0.0;</span>
<span class="lineNum">    1808 </span><span class="lineCov">          1 : n[1] = -6.1;</span>
<span class="lineNum">    1809 </span><span class="lineCov">          2 : n[2] = 6.1*TMath::Tan(20.*TMath::DegToRad());</span>
<span class="lineNum">    1810 </span>            : //
<span class="lineNum">    1811 </span><span class="lineCov">          2 : new TGeoHalfSpace(&quot;cutmmh3&quot;, p, n);</span>
<span class="lineNum">    1812 </span>            : //
<span class="lineNum">    1813 </span><span class="lineCov">          1 : p[0] = 0.0;</span>
<span class="lineNum">    1814 </span><span class="lineCov">          1 : p[1] = 1.85;      </span>
<span class="lineNum">    1815 </span><span class="lineCov">          1 : p[2] = 2.8;</span>
<span class="lineNum">    1816 </span>            : //
<span class="lineNum">    1817 </span><span class="lineCov">          1 : n[0] = 0.0;</span>
<span class="lineNum">    1818 </span><span class="lineCov">          1 : n[1] = -6.1;</span>
<span class="lineNum">    1819 </span><span class="lineCov">          2 : n[2] = -6.1*TMath::Tan(20*TMath::DegToRad());</span>
<span class="lineNum">    1820 </span>            : //
<span class="lineNum">    1821 </span><span class="lineCov">          2 : new TGeoHalfSpace(&quot;cutmmh4&quot;, p, n);</span>
<span class="lineNum">    1822 </span>            : //
<span class="lineNum">    1823 </span><span class="lineCov">          1 : p[0] = 0.75;</span>
<span class="lineNum">    1824 </span><span class="lineCov">          1 : p[1] = 0.0; </span>
<span class="lineNum">    1825 </span><span class="lineCov">          1 : p[2] = -8.9;</span>
<span class="lineNum">    1826 </span>            : //
<span class="lineNum">    1827 </span><span class="lineCov">          2 : n[0] = 2.4*TMath::Tan(30*TMath::DegToRad());</span>
<span class="lineNum">    1828 </span><span class="lineCov">          1 : n[1] = 0.0;</span>
<span class="lineNum">    1829 </span><span class="lineCov">          1 : n[2] = 2.4;</span>
<span class="lineNum">    1830 </span>            : //
<span class="lineNum">    1831 </span><span class="lineCov">          2 :  new TGeoHalfSpace(&quot;cutmmh5&quot;, p, n);</span>
<span class="lineNum">    1832 </span>            : //
<span class="lineNum">    1833 </span><span class="lineCov">          1 : p[0] = 0.75;</span>
<span class="lineNum">    1834 </span><span class="lineCov">          1 : p[1] = 0.0;</span>
<span class="lineNum">    1835 </span><span class="lineCov">          1 : p[2] = 8.9;</span>
<span class="lineNum">    1836 </span>            : //
<span class="lineNum">    1837 </span><span class="lineCov">          2 : n[0] = 2.4*TMath::Tan(30*TMath::DegToRad());</span>
<span class="lineNum">    1838 </span><span class="lineCov">          1 : n[1] = 0.0;</span>
<span class="lineNum">    1839 </span><span class="lineCov">          1 : n[2] = -2.4;</span>
<span class="lineNum">    1840 </span>            : //
<span class="lineNum">    1841 </span><span class="lineCov">          2 : new TGeoHalfSpace(&quot;cutmmh6&quot;, p, n);</span>
<span class="lineNum">    1842 </span>            : 
<span class="lineNum">    1843 </span><span class="lineCov">          2 : TGeoCompositeShape *tpcmmhc = new TGeoCompositeShape(&quot;TPC_MMHC&quot;, &quot;tpcmmhc1-tpcmmhc2-cutmmh1-cutmmh2-cutmmh3-cutmmh4-cutmmh5-cutmmh6&quot;); </span>
<span class="lineNum">    1844 </span>            : 
<span class="lineNum">    1845 </span><span class="lineCov">          2 :  TGeoVolume *tpcmmhcv = new TGeoVolume(&quot;TPC_MMHC&quot;,tpcmmhc,m6);</span>
<span class="lineNum">    1846 </span>            :  //
<span class="lineNum">    1847 </span><span class="lineCov">          3 : TGeoVolume *tpcmmh = new TGeoVolumeAssembly(&quot;TPC_MMH&quot;);</span>
<span class="lineNum">    1848 </span>            : //
<span class="lineNum">    1849 </span><span class="lineCov">          3 :  tpcmmh-&gt;AddNode(tpcmmhcv,1,new TGeoTranslation(0.65+1.5, 1.85, 0.0));</span>
<span class="lineNum">    1850 </span><span class="lineCov">          3 :  tpcmmh-&gt;AddNode(tpcmmhcv,2,new TGeoCombiTrans(-0.65-1.5, 1.85, 0.0,rot111));</span>
<span class="lineNum">    1851 </span><span class="lineCov">          3 :  tpcmmh-&gt;AddNode(tpcmmhs,1,new TGeoTranslation(1.5, 0.0, 0.0));</span>
<span class="lineNum">    1852 </span><span class="lineCov">          3 :  tpcmmh-&gt;AddNode(tpcmmhs,2,new TGeoCombiTrans(-1.5, 0.0, 0.0,rot111));</span>
<span class="lineNum">    1853 </span>            :  //
<span class="lineNum">    1854 </span>            :  
<span class="lineNum">    1855 </span>            :  //
<span class="lineNum">    1856 </span>            : 
<span class="lineNum">    1857 </span>            : //--------------------------------------------
<span class="lineNum">    1858 </span>            :  //
<span class="lineNum">    1859 </span>            :  // guard ring resistor chain
<span class="lineNum">    1860 </span>            :  //
<span class="lineNum">    1861 </span>            : 
<span class="lineNum">    1862 </span><span class="lineCov">          2 :  TGeoTube *gres1 = new TGeoTube(0.,0.375,125.);// inside ifc</span>
<span class="lineNum">    1863 </span>            :  //
<span class="lineNum">    1864 </span><span class="lineCov">          2 :  TGeoVolume *vgres1 = new TGeoVolume(&quot;TPC_GRES1&quot;,gres1,m14);</span>
<span class="lineNum">    1865 </span>            : 
<span class="lineNum">    1866 </span>            :  //
<span class="lineNum">    1867 </span>            :  Double_t xrc,yrc;
<span class="lineNum">    1868 </span>            :  //
<span class="lineNum">    1869 </span><span class="lineCov">          2 :  xrc=79.3*TMath::Cos(350.*TMath::DegToRad());</span>
<span class="lineNum">    1870 </span><span class="lineCov">          2 :  yrc=79.3*TMath::Sin(350.*TMath::DegToRad());</span>
<span class="lineNum">    1871 </span>            :  //
<span class="lineNum">    1872 </span><span class="lineCov">          3 :  v9-&gt;AddNode(vgres1,1,new TGeoTranslation(xrc,yrc,126.9));</span>
<span class="lineNum">    1873 </span><span class="lineCov">          3 :  v9-&gt;AddNode(vgres1,2,new TGeoTranslation(xrc,yrc,-126.9));</span>
<span class="lineNum">    1874 </span>            :  //
<span class="lineNum">    1875 </span><span class="lineCov">          2 :  xrc=79.3*TMath::Cos(190.*TMath::DegToRad());</span>
<span class="lineNum">    1876 </span><span class="lineCov">          2 :  yrc=79.3*TMath::Sin(190.*TMath::DegToRad()); </span>
<span class="lineNum">    1877 </span>            :  //
<span class="lineNum">    1878 </span><span class="lineCov">          3 :  v9-&gt;AddNode(vgres1,3,new TGeoTranslation(xrc,yrc,126.9));</span>
<span class="lineNum">    1879 </span><span class="lineCov">          3 :  v9-&gt;AddNode(vgres1,4,new TGeoTranslation(xrc,yrc,-126.9));</span>
<span class="lineNum">    1880 </span>            :  //------------------------------------------------------------------
<span class="lineNum">    1881 </span><span class="lineCov">          1 :  TGeoRotation refl(&quot;refl&quot;,90.,0.,90.,90.,180.,0.);</span>
<span class="lineNum">    1882 </span><span class="lineCov">          1 :  TGeoRotation rotrod(&quot;rotrod&quot;);</span>
<span class="lineNum">    1883 </span>            :  //
<span class="lineNum">    1884 </span>            :  TGeoRotation *rotpos[2]; 
<span class="lineNum">    1885 </span>            :  //
<span class="lineNum">    1886 </span>            :  TGeoRotation *rotrod1[2]; 
<span class="lineNum">    1887 </span>            :  //
<span class="lineNum">    1888 </span>            :  // clamps holding rods
<span class="lineNum">    1889 </span>            :  //
<span class="lineNum">    1890 </span><span class="lineCov">          2 :   TGeoBBox *clampi1 = new TGeoBBox(&quot;clampi1&quot;,0.2,3.1,0.8);</span>
<span class="lineNum">    1891 </span><span class="lineCov">          2 :   TGeoVolume *clampi1v = new TGeoVolume(&quot;TPC_clampi1v&quot;,clampi1,m6);</span>
<span class="lineNum">    1892 </span>            :  //
<span class="lineNum">    1893 </span><span class="lineCov">          1 :  pointstrap[0]=0.49;</span>
<span class="lineNum">    1894 </span><span class="lineCov">          1 :  pointstrap[1]=0.375;</span>
<span class="lineNum">    1895 </span>            :  //
<span class="lineNum">    1896 </span><span class="lineCov">          1 :  pointstrap[2]=0.49;</span>
<span class="lineNum">    1897 </span><span class="lineCov">          1 :  pointstrap[3]=-0.375;</span>
<span class="lineNum">    1898 </span>            :  //
<span class="lineNum">    1899 </span><span class="lineCov">          1 :  pointstrap[4]=-0.49;</span>
<span class="lineNum">    1900 </span><span class="lineCov">          1 :  pointstrap[5]=-0.375;</span>
<span class="lineNum">    1901 </span>            :  //
<span class="lineNum">    1902 </span><span class="lineCov">          1 :  pointstrap[6]=-0.49;</span>
<span class="lineNum">    1903 </span><span class="lineCov">          1 :  pointstrap[7]=1.225;</span>
<span class="lineNum">    1904 </span>            :  //
<span class="lineNum">    1905 </span><span class="lineCov">          1 :  pointstrap[8]=0.49;</span>
<span class="lineNum">    1906 </span><span class="lineCov">          1 :  pointstrap[9]=0.375;</span>
<span class="lineNum">    1907 </span>            :  //
<span class="lineNum">    1908 </span><span class="lineCov">          1 :  pointstrap[10]=0.49;</span>
<span class="lineNum">    1909 </span><span class="lineCov">          1 :  pointstrap[11]=-0.375;</span>
<span class="lineNum">    1910 </span>            :  //
<span class="lineNum">    1911 </span><span class="lineCov">          1 :  pointstrap[12]=-0.49;</span>
<span class="lineNum">    1912 </span><span class="lineCov">          1 :  pointstrap[13]=-0.375;</span>
<span class="lineNum">    1913 </span>            :  //
<span class="lineNum">    1914 </span><span class="lineCov">          1 :  pointstrap[14]=-0.49;</span>
<span class="lineNum">    1915 </span><span class="lineCov">          1 :  pointstrap[15]=1.225;</span>
<span class="lineNum">    1916 </span>            :  //
<span class="lineNum">    1917 </span><span class="lineCov">          2 :  TGeoArb8 *clitrap = new TGeoArb8(&quot;clitrap&quot;,0.25,pointstrap);</span>
<span class="lineNum">    1918 </span><span class="lineCov">          2 :  TGeoVolume *clitrapv = new TGeoVolume(&quot;TPC_clitrapv&quot;,clitrap,m6);  </span>
<span class="lineNum">    1919 </span>            :  //
<span class="lineNum">    1920 </span><span class="lineCov">          2 :  TGeoRotation *clamprot = new TGeoRotation();</span>
<span class="lineNum">    1921 </span><span class="lineCov">          1 :  clamprot-&gt;RotateX(180.);</span>
<span class="lineNum">    1922 </span>            :  //
<span class="lineNum">    1923 </span><span class="lineCov">          2 :  new TGeoBBox(&quot;clibox&quot;,1.125,3.1,.1);</span>
<span class="lineNum">    1924 </span><span class="lineCov">          2 :  new TGeoTube(&quot;clitub&quot;,0.,2.2,0.1);</span>
<span class="lineNum">    1925 </span>            :  //
<span class="lineNum">    1926 </span>            :  // copmisite shape for the clamp holder
<span class="lineNum">    1927 </span>            :  //
<span class="lineNum">    1928 </span><span class="lineCov">          2 :  TGeoTranslation *clitr1 = new TGeoTranslation(&quot;clitr1&quot;,1.125,0.,0.);</span>
<span class="lineNum">    1929 </span><span class="lineCov">          1 :  clitr1-&gt;RegisterYourself();</span>
<span class="lineNum">    1930 </span><span class="lineCov">          2 :  TGeoCompositeShape *clihold = new TGeoCompositeShape(&quot;clihold&quot;,&quot;clibox-clitub:clitr1&quot;); </span>
<span class="lineNum">    1931 </span><span class="lineCov">          2 :  TGeoVolume *cliholdv = new TGeoVolume(&quot;TPC_cliholdv&quot;,clihold,m6);</span>
<span class="lineNum">    1932 </span>            :  //
<span class="lineNum">    1933 </span>            :  // now assembly the whole inner clamp
<span class="lineNum">    1934 </span>            :  //
<span class="lineNum">    1935 </span><span class="lineCov">          3 :  TGeoVolume *iclamp = new TGeoVolumeAssembly(&quot;TPC_iclamp&quot;);</span>
<span class="lineNum">    1936 </span>            :  //
<span class="lineNum">    1937 </span><span class="lineCov">          1 :  iclamp-&gt;AddNode(clampi1v,1); //main box</span>
<span class="lineNum">    1938 </span><span class="lineCov">          3 :  iclamp-&gt;AddNode(clitrapv,1,new TGeoTranslation(0.69,-2.725,0.35)); //trapezoids</span>
<span class="lineNum">    1939 </span><span class="lineCov">          3 :  iclamp-&gt;AddNode(clitrapv,2,new TGeoTranslation(0.69,-2.725,-0.35));</span>
<span class="lineNum">    1940 </span><span class="lineCov">          3 :  iclamp-&gt;AddNode(clitrapv,3,new TGeoCombiTrans(0.69,2.725,0.35,clamprot));</span>
<span class="lineNum">    1941 </span><span class="lineCov">          3 :  iclamp-&gt;AddNode(clitrapv,4,new TGeoCombiTrans(0.69,2.725,-0.35,clamprot));</span>
<span class="lineNum">    1942 </span><span class="lineCov">          3 :  iclamp-&gt;AddNode(cliholdv,1,new TGeoTranslation(1.325,0.,0.)); //holder</span>
<span class="lineNum">    1943 </span>            :  //
<span class="lineNum">    1944 </span>            :  //  outer clamps
<span class="lineNum">    1945 </span>            :  //
<span class="lineNum">    1946 </span><span class="lineCov">          2 :   TGeoBBox *clampo1 = new TGeoBBox(&quot;clampo1&quot;,0.25,3.1,1.);</span>
<span class="lineNum">    1947 </span><span class="lineCov">          2 :   TGeoBBox *clampo2 = new TGeoBBox(&quot;clampo2&quot;,0.4,0.85,1.);</span>
<span class="lineNum">    1948 </span>            :   //
<span class="lineNum">    1949 </span><span class="lineCov">          2 :   TGeoVolume *clampo1v = new TGeoVolume(&quot;TPC_clampo1v&quot;,clampo1,m6);</span>
<span class="lineNum">    1950 </span><span class="lineCov">          2 :   TGeoVolume *clampo2v = new TGeoVolume(&quot;TPC_clampo2v&quot;,clampo2,m6);</span>
<span class="lineNum">    1951 </span>            :   //
<span class="lineNum">    1952 </span><span class="lineCov">          2 :   TGeoVolumeAssembly *oclamp = new TGeoVolumeAssembly(&quot;TPC_oclamp&quot;);</span>
<span class="lineNum">    1953 </span>            :   //
<span class="lineNum">    1954 </span><span class="lineCov">          1 :   oclamp-&gt;AddNode(clampo1v,1);</span>
<span class="lineNum">    1955 </span>            :  //
<span class="lineNum">    1956 </span><span class="lineCov">          3 :  oclamp-&gt;AddNode(clampo2v,1,new TGeoTranslation(0.65,-2.25,0));</span>
<span class="lineNum">    1957 </span><span class="lineCov">          3 :  oclamp-&gt;AddNode(clampo2v,2,new TGeoTranslation(0.65,2.25,0));</span>
<span class="lineNum">    1958 </span>            : 
<span class="lineNum">    1959 </span>            :  //
<span class="lineNum">    1960 </span><span class="lineCov">          1 :  pointstrap[0]=0.375; </span>
<span class="lineNum">    1961 </span><span class="lineCov">          1 :  pointstrap[1]=0.75;</span>
<span class="lineNum">    1962 </span><span class="lineCov">          1 :  pointstrap[2]=0.375;</span>
<span class="lineNum">    1963 </span><span class="lineCov">          1 :  pointstrap[3]=-0.35;</span>
<span class="lineNum">    1964 </span><span class="lineCov">          1 :  pointstrap[5]=-0.375;</span>
<span class="lineNum">    1965 </span><span class="lineCov">          1 :  pointstrap[4]=-0.35;</span>
<span class="lineNum">    1966 </span><span class="lineCov">          1 :  pointstrap[6]=-0.375; </span>
<span class="lineNum">    1967 </span><span class="lineCov">          1 :  pointstrap[7]=0.35;</span>
<span class="lineNum">    1968 </span>            :  //
<span class="lineNum">    1969 </span><span class="lineCov">          1 :  pointstrap[8]=0.375; </span>
<span class="lineNum">    1970 </span><span class="lineCov">          1 :  pointstrap[9]=0.75;</span>
<span class="lineNum">    1971 </span><span class="lineCov">          1 :  pointstrap[10]=0.375;</span>
<span class="lineNum">    1972 </span><span class="lineCov">          1 :  pointstrap[11]=-0.35;</span>
<span class="lineNum">    1973 </span><span class="lineCov">          1 :  pointstrap[12]=-0.375;</span>
<span class="lineNum">    1974 </span><span class="lineCov">          1 :  pointstrap[13]=-0.35;</span>
<span class="lineNum">    1975 </span><span class="lineCov">          1 :  pointstrap[14]=-0.375; </span>
<span class="lineNum">    1976 </span><span class="lineCov">          1 :  pointstrap[15]=0.35;</span>
<span class="lineNum">    1977 </span>            :  //
<span class="lineNum">    1978 </span><span class="lineCov">          2 :  TGeoArb8 *clotrap = new TGeoArb8(&quot;clotrap&quot;,0.25,pointstrap);</span>
<span class="lineNum">    1979 </span><span class="lineCov">          2 :  TGeoVolume *clotrapv = new TGeoVolume(&quot;TPC_clotrapv&quot;,clotrap,m6);</span>
<span class="lineNum">    1980 </span>            :  //
<span class="lineNum">    1981 </span><span class="lineCov">          3 :  oclamp-&gt;AddNode(clotrapv,1,new TGeoTranslation(-0.625,-2.75,0.35)); </span>
<span class="lineNum">    1982 </span><span class="lineCov">          3 :  oclamp-&gt;AddNode(clotrapv,2,new TGeoTranslation(-0.625,-2.75,-0.35));</span>
<span class="lineNum">    1983 </span><span class="lineCov">          3 :  oclamp-&gt;AddNode(clotrapv,3,new TGeoCombiTrans(-0.625,2.75,0.35,clamprot)); </span>
<span class="lineNum">    1984 </span><span class="lineCov">          3 :  oclamp-&gt;AddNode(clotrapv,4,new TGeoCombiTrans(-0.625,2.75,-0.35,clamprot));  </span>
<span class="lineNum">    1985 </span>            :  //
<span class="lineNum">    1986 </span><span class="lineCov">          2 :  TGeoBBox *clampo3 = new TGeoBBox(&quot;clampo3&quot;,1.6,0.45,.1);</span>
<span class="lineNum">    1987 </span><span class="lineCov">          2 :  TGeoVolume *clampo3v = new TGeoVolume(&quot;TPC_clampo3v&quot;,clampo3,m6); </span>
<span class="lineNum">    1988 </span>            :  //
<span class="lineNum">    1989 </span><span class="lineCov">          3 :  oclamp-&gt;AddNode(clampo3v,1,new TGeoTranslation(-1.85,2.625,0.));</span>
<span class="lineNum">    1990 </span><span class="lineCov">          3 :  oclamp-&gt;AddNode(clampo3v,2,new TGeoTranslation(-1.85,-2.625,0));</span>
<span class="lineNum">    1991 </span>            :  //
<span class="lineNum">    1992 </span><span class="lineCov">          2 :  TGeoTubeSeg *clampo4 = new TGeoTubeSeg(&quot;clampo4&quot;,2.2,3.1,0.1,90.,270.);</span>
<span class="lineNum">    1993 </span><span class="lineCov">          2 :  TGeoVolume *clampo4v = new TGeoVolume(&quot;TPC_clampo4v&quot;,clampo4,m6);</span>
<span class="lineNum">    1994 </span>            :  //
<span class="lineNum">    1995 </span><span class="lineCov">          3 :  oclamp-&gt;AddNode(clampo4v,1,new TGeoTranslation(-3.45,0.,0.));</span>
<span class="lineNum">    1996 </span>            : 
<span class="lineNum">    1997 </span>            : 
<span class="lineNum">    1998 </span>            : 
<span class="lineNum">    1999 </span>            :  //v9 - drift gas
<span class="lineNum">    2000 </span>            : 
<span class="lineNum">    2001 </span><span class="lineCov">          1 :     TGeoRotation rot102(&quot;rot102&quot;);</span>
<span class="lineNum">    2002 </span><span class="lineCov">          1 :     rot102.RotateY(-90.);</span>
<span class="lineNum">    2003 </span>            : 
<span class="lineNum">    2004 </span><span class="lineCov">         38 :   for(Int_t i=0;i&lt;18;i++){</span>
<span class="lineNum">    2005 </span>            :     Double_t angle,x,y;
<span class="lineNum">    2006 </span>            :     Double_t z,r; 
<span class="lineNum">    2007 </span><span class="lineCov">         36 :     angle=TMath::DegToRad()*20.*(Double_t)i;</span>
<span class="lineNum">    2008 </span>            :     //inner rods
<span class="lineNum">    2009 </span>            :     r=81.5;
<span class="lineNum">    2010 </span><span class="lineCov">         18 :     x=r * TMath::Cos(angle);</span>
<span class="lineNum">    2011 </span><span class="lineCov">         18 :     y=r * TMath::Sin(angle);</span>
<span class="lineNum">    2012 </span>            :     z = 126.;
<span class="lineNum">    2013 </span><span class="lineCov">         36 :     TGeoRotation *rot12 = new TGeoRotation();</span>
<span class="lineNum">    2014 </span><span class="lineCov">         18 :     rot12-&gt;RotateZ(-90.0+i*20.);</span>
<span class="lineNum">    2015 </span><span class="lineCov">         54 :     v9-&gt;AddNode(tpcihpl,i+1,new TGeoCombiTrans(x, y, 0., rot12));</span>
<span class="lineNum">    2016 </span>            :     //
<span class="lineNum">    2017 </span><span class="lineCov">         18 :     if(i==11){//resistor rod inner</span>
<span class="lineNum">    2018 </span><span class="lineCov">          1 :        rotrod.RotateZ(-90.+i*20.);</span>
<span class="lineNum">    2019 </span><span class="lineCov">          2 :        rotrod1[0]= new TGeoRotation();</span>
<span class="lineNum">    2020 </span><span class="lineCov">          2 :        rotpos[0]= new TGeoRotation();</span>
<span class="lineNum">    2021 </span>            :        //
<span class="lineNum">    2022 </span><span class="lineCov">          1 :        rotrod1[0]-&gt;RotateZ(90.+i*20.);</span>
<span class="lineNum">    2023 </span><span class="lineCov">          2 :        *rotpos[0] = refl*rotrod; //rotation+reflection</span>
<span class="lineNum">    2024 </span><span class="lineCov">          3 :         v9-&gt;AddNode(tpcrrod,1,new TGeoCombiTrans(x,y, z, rotrod1[0])); //A</span>
<span class="lineNum">    2025 </span><span class="lineCov">          3 :         v9-&gt;AddNode(tpcrrod,2,new TGeoCombiTrans(x,y,-z, rotpos[0])); //C      </span>
<span class="lineNum">    2026 </span>            :     } 
<span class="lineNum">    2027 </span>            :     else { 
<span class="lineNum">    2028 </span><span class="lineCov">         51 :       v9-&gt;AddNode(tpcmrod,i+1,new TGeoTranslation(x,y,z));//shaft</span>
<span class="lineNum">    2029 </span><span class="lineCov">         51 :       v9-&gt;AddNode(tpcmrod,i+19,new TGeoCombiTrans(x,y,-z,ref));//muon</span>
<span class="lineNum">    2030 </span>            :     }
<span class="lineNum">    2031 </span>            :     //
<span class="lineNum">    2032 </span>            :     // inner clamps positioning
<span class="lineNum">    2033 </span>            :     //
<span class="lineNum">    2034 </span>            :     r=79.05;
<span class="lineNum">    2035 </span><span class="lineCov">         18 :     x=r * TMath::Cos(angle);</span>
<span class="lineNum">    2036 </span><span class="lineCov">         18 :     y=r * TMath::Sin(angle);</span>
<span class="lineNum">    2037 </span><span class="lineCov">         36 :     rot12= new TGeoRotation();</span>
<span class="lineNum">    2038 </span><span class="lineCov">         18 :     rot12-&gt;RotateZ(i*20.);</span>
<span class="lineNum">    2039 </span>            :     //
<span class="lineNum">    2040 </span>            :       //A-side
<span class="lineNum">    2041 </span><span class="lineCov">         54 :       v9-&gt;AddNode(iclamp,7*i+1,new TGeoCombiTrans(x,y,5.25,rot12));</span>
<span class="lineNum">    2042 </span><span class="lineCov">         54 :       v9-&gt;AddNode(iclamp,7*i+2,new TGeoCombiTrans(x,y,38.25,rot12));</span>
<span class="lineNum">    2043 </span><span class="lineCov">         54 :       v9-&gt;AddNode(iclamp,7*i+3,new TGeoCombiTrans(x,y,80.25,rot12));</span>
<span class="lineNum">    2044 </span><span class="lineCov">         54 :       v9-&gt;AddNode(iclamp,7*i+4,new TGeoCombiTrans(x,y,122.25,rot12));</span>
<span class="lineNum">    2045 </span><span class="lineCov">         54 :       v9-&gt;AddNode(iclamp,7*i+5,new TGeoCombiTrans(x,y,164.25,rot12));</span>
<span class="lineNum">    2046 </span><span class="lineCov">         54 :       v9-&gt;AddNode(iclamp,7*i+6,new TGeoCombiTrans(x,y,206.25,rot12));</span>
<span class="lineNum">    2047 </span><span class="lineCov">         54 :       v9-&gt;AddNode(iclamp,7*i+7,new TGeoCombiTrans(x,y,246.75,rot12));</span>
<span class="lineNum">    2048 </span>            :       //C-side
<span class="lineNum">    2049 </span><span class="lineCov">         54 :       v9-&gt;AddNode(iclamp,7*i+127,new TGeoCombiTrans(x,y,-5.25,rot12));</span>
<span class="lineNum">    2050 </span><span class="lineCov">         54 :       v9-&gt;AddNode(iclamp,7*i+128,new TGeoCombiTrans(x,y,-38.25,rot12));</span>
<span class="lineNum">    2051 </span><span class="lineCov">         54 :       v9-&gt;AddNode(iclamp,7*i+129,new TGeoCombiTrans(x,y,-80.25,rot12));</span>
<span class="lineNum">    2052 </span><span class="lineCov">         54 :       v9-&gt;AddNode(iclamp,7*i+130,new TGeoCombiTrans(x,y,-122.25,rot12));</span>
<span class="lineNum">    2053 </span><span class="lineCov">         54 :       v9-&gt;AddNode(iclamp,7*i+131,new TGeoCombiTrans(x,y,-164.25,rot12));</span>
<span class="lineNum">    2054 </span><span class="lineCov">         54 :       v9-&gt;AddNode(iclamp,7*i+132,new TGeoCombiTrans(x,y,-206.25,rot12));</span>
<span class="lineNum">    2055 </span><span class="lineCov">         54 :       v9-&gt;AddNode(iclamp,7*i+133,new TGeoCombiTrans(x,y,-246.75,rot12));</span>
<span class="lineNum">    2056 </span>            :     //
<span class="lineNum">    2057 </span>            :     //--------------------------
<span class="lineNum">    2058 </span>            :     // outer rods
<span class="lineNum">    2059 </span>            :     r=254.25;
<span class="lineNum">    2060 </span><span class="lineCov">         18 :     x=r * TMath::Cos(angle);</span>
<span class="lineNum">    2061 </span><span class="lineCov">         18 :     y=r * TMath::Sin(angle);</span>
<span class="lineNum">    2062 </span>            :     z=126.;
<span class="lineNum">    2063 </span>            :     //
<span class="lineNum">    2064 </span>            :     // outer rod holder + outer left plug
<span class="lineNum">    2065 </span>            :     //
<span class="lineNum">    2066 </span>            : 
<span class="lineNum">    2067 </span><span class="lineCov">         36 :     TGeoRotation *rot33 = new TGeoRotation();</span>
<span class="lineNum">    2068 </span><span class="lineCov">         18 :     rot33-&gt;RotateZ(-90+i*20.);</span>
<span class="lineNum">    2069 </span>            :     //
<span class="lineNum">    2070 </span><span class="lineCov">         54 :     v9-&gt;AddNode(tpcohpl,i+1,new TGeoCombiTrans(x, y, 0., rot33));</span>
<span class="lineNum">    2071 </span>            :     //
<span class="lineNum">    2072 </span><span class="lineCov">         36 :     Double_t xxx = 256.297*TMath::Cos((i*20.+10.)*TMath::DegToRad());</span>
<span class="lineNum">    2073 </span><span class="lineCov">         36 :     Double_t yyy = 256.297*TMath::Sin((i*20.+10.)*TMath::DegToRad());</span>
<span class="lineNum">    2074 </span>            :     //
<span class="lineNum">    2075 </span><span class="lineCov">         18 :     TGeoRotation rot101(&quot;rot101&quot;);</span>
<span class="lineNum">    2076 </span><span class="lineCov">         18 :     rot101.RotateZ(90.+i*20.+10.);</span>
<span class="lineNum">    2077 </span><span class="lineCov">         36 :     TGeoRotation *rot103 = new TGeoRotation(&quot;rot103&quot;);</span>
<span class="lineNum">    2078 </span><span class="lineCov">         36 :     *rot103 = rot101*rot102;</span>
<span class="lineNum">    2079 </span>            :     //
<span class="lineNum">    2080 </span><span class="lineCov">         36 :     TGeoCombiTrans *trh100 = new TGeoCombiTrans(xxx,yyy,0.,rot103);</span>
<span class="lineNum">    2081 </span>            :     //
<span class="lineNum">    2082 </span><span class="lineCov">         36 :     if(i==2) {</span>
<span class="lineNum">    2083 </span>            :       //main membrane holder
<span class="lineNum">    2084 </span><span class="lineCov">         19 :       v9-&gt;AddNode(tpcmmh,1,trh100);</span>
<span class="lineNum">    2085 </span>            :     }
<span class="lineNum">    2086 </span>            :     else{
<span class="lineNum">    2087 </span>            :       // &quot;normal&quot; membrane holder
<span class="lineNum">    2088 </span><span class="lineCov">         17 :       v9-&gt;AddNode(tpcomh,i+1,trh100);      </span>
<span class="lineNum">    2089 </span>            :     }
<span class="lineNum">    2090 </span>            : 
<span class="lineNum">    2091 </span>            :     //
<span class="lineNum">    2092 </span><span class="lineCov">         18 :     if(i==3){//resistor rod outer</span>
<span class="lineNum">    2093 </span><span class="lineCov">          1 :       rotrod.RotateZ(90.+i*20.);</span>
<span class="lineNum">    2094 </span><span class="lineCov">          2 :       rotrod1[1]= new TGeoRotation();</span>
<span class="lineNum">    2095 </span><span class="lineCov">          2 :       rotpos[1]= new TGeoRotation();</span>
<span class="lineNum">    2096 </span><span class="lineCov">          1 :       rotrod1[1]-&gt;RotateZ(90.+i*20.);</span>
<span class="lineNum">    2097 </span><span class="lineCov">          2 :       *rotpos[1] = refl*rotrod;//rotation+reflection</span>
<span class="lineNum">    2098 </span><span class="lineCov">          3 :       v9-&gt;AddNode(tpcrrod,3,new TGeoCombiTrans(x,y, z, rotrod1[1])); //A </span>
<span class="lineNum">    2099 </span><span class="lineCov">          3 :       v9-&gt;AddNode(tpcrrod,4,new TGeoCombiTrans(x,y, -z, rotpos[1])); //C</span>
<span class="lineNum">    2100 </span>            :     }
<span class="lineNum">    2101 </span>            :     else {
<span class="lineNum">    2102 </span><span class="lineCov">         51 :       v9-&gt;AddNode(tpcmrod,i+37,new TGeoTranslation(x,y,z));//shaft</span>
<span class="lineNum">    2103 </span><span class="lineCov">         51 :       v9-&gt;AddNode(tpcmrod,i+55,new TGeoCombiTrans(x,y,-z,ref));//muon      </span>
<span class="lineNum">    2104 </span>            :     }
<span class="lineNum">    2105 </span><span class="lineCov">         18 :     if(i==15){</span>
<span class="lineNum">    2106 </span><span class="lineCov">          3 :       v9-&gt;AddNode(hvrv,1,new TGeoTranslation(x,y,z+0.7)); //hv-&gt;A-side only     </span>
<span class="lineNum">    2107 </span>            :     }
<span class="lineNum">    2108 </span>            :     //
<span class="lineNum">    2109 </span>            :     // outer clamps
<span class="lineNum">    2110 </span>            :     //
<span class="lineNum">    2111 </span>            :     r=256.9;
<span class="lineNum">    2112 </span><span class="lineCov">         18 :     x=r * TMath::Cos(angle);</span>
<span class="lineNum">    2113 </span><span class="lineCov">         18 :     y=r * TMath::Sin(angle);</span>
<span class="lineNum">    2114 </span><span class="lineCov">         36 :     rot12= new TGeoRotation();</span>
<span class="lineNum">    2115 </span><span class="lineCov">         18 :     rot12-&gt;RotateZ(i*20.);</span>
<span class="lineNum">    2116 </span>            :     //
<span class="lineNum">    2117 </span>            :       //A-side
<span class="lineNum">    2118 </span><span class="lineCov">         54 :       v9-&gt;AddNode(oclamp,7*i+1,new TGeoCombiTrans(x,y,5.25,rot12));</span>
<span class="lineNum">    2119 </span><span class="lineCov">         54 :       v9-&gt;AddNode(oclamp,7*i+2,new TGeoCombiTrans(x,y,38.25,rot12));</span>
<span class="lineNum">    2120 </span><span class="lineCov">         54 :       v9-&gt;AddNode(oclamp,7*i+3,new TGeoCombiTrans(x,y,80.25,rot12));</span>
<span class="lineNum">    2121 </span><span class="lineCov">         54 :       v9-&gt;AddNode(oclamp,7*i+4,new TGeoCombiTrans(x,y,122.25,rot12));</span>
<span class="lineNum">    2122 </span><span class="lineCov">         54 :       v9-&gt;AddNode(oclamp,7*i+5,new TGeoCombiTrans(x,y,164.25,rot12));</span>
<span class="lineNum">    2123 </span><span class="lineCov">         54 :       v9-&gt;AddNode(oclamp,7*i+6,new TGeoCombiTrans(x,y,206.25,rot12));</span>
<span class="lineNum">    2124 </span><span class="lineCov">         54 :       v9-&gt;AddNode(oclamp,7*i+7,new TGeoCombiTrans(x,y,246.75,rot12));</span>
<span class="lineNum">    2125 </span>            :       //C-side
<span class="lineNum">    2126 </span><span class="lineCov">         54 :       v9-&gt;AddNode(oclamp,7*i+127,new TGeoCombiTrans(x,y,-5.25,rot12));</span>
<span class="lineNum">    2127 </span><span class="lineCov">         54 :       v9-&gt;AddNode(oclamp,7*i+128,new TGeoCombiTrans(x,y,-38.25,rot12));</span>
<span class="lineNum">    2128 </span><span class="lineCov">         54 :       v9-&gt;AddNode(oclamp,7*i+129,new TGeoCombiTrans(x,y,-80.25,rot12));</span>
<span class="lineNum">    2129 </span><span class="lineCov">         54 :       v9-&gt;AddNode(oclamp,7*i+130,new TGeoCombiTrans(x,y,-122.25,rot12));</span>
<span class="lineNum">    2130 </span><span class="lineCov">         54 :       v9-&gt;AddNode(oclamp,7*i+131,new TGeoCombiTrans(x,y,-164.25,rot12));</span>
<span class="lineNum">    2131 </span><span class="lineCov">         54 :       v9-&gt;AddNode(oclamp,7*i+132,new TGeoCombiTrans(x,y,-206.25,rot12));</span>
<span class="lineNum">    2132 </span><span class="lineCov">         54 :       v9-&gt;AddNode(oclamp,7*i+133,new TGeoCombiTrans(x,y,-246.75,rot12));</span>
<span class="lineNum">    2133 </span>            :     
<span class="lineNum">    2134 </span><span class="lineCov">         18 :   } //end of rods positioning</span>
<span class="lineNum">    2135 </span>            : 
<span class="lineNum">    2136 </span><span class="lineCov">          1 :   TGeoVolume *alice = gGeoManager-&gt;GetVolume(&quot;ALIC&quot;);</span>
<span class="lineNum">    2137 </span><span class="lineCov">          1 :   alice-&gt;AddNode(v1,1);  </span>
<span class="lineNum">    2138 </span>            :   
<span class="lineNum">    2139 </span><span class="lineCov">          1 : } // end of function</span>
<a name="2140"><span class="lineNum">    2140 </span>            :  </a>
<span class="lineNum">    2141 </span>            : //_____________________________________________________________________________
<span class="lineNum">    2142 </span>            : void AliTPCv2::AddAlignableVolumes() const
<span class="lineNum">    2143 </span>            : {
<span class="lineNum">    2144 </span>            :   //
<span class="lineNum">    2145 </span>            :   // Create entries for alignable volumes associating the symbolic volume
<span class="lineNum">    2146 </span>            :   // name with the corresponding volume path. Needs to be syncronized with
<span class="lineNum">    2147 </span>            :   // eventual changes in the geometry.
<span class="lineNum">    2148 </span>            :   // 
<span class="lineNum">    2149 </span><span class="lineCov">          2 :   SetInnerChambersAlignable();</span>
<span class="lineNum">    2150 </span><span class="lineCov">          1 :   SetOuterChambersAlignable();</span>
<span class="lineNum">    2151 </span><span class="lineCov">          1 : }</span>
<a name="2152"><span class="lineNum">    2152 </span>            :  </a>
<span class="lineNum">    2153 </span>            : //_____________________________________________________________________________
<span class="lineNum">    2154 </span>            : void AliTPCv2::SetInnerChambersAlignable() const
<span class="lineNum">    2155 </span>            : {
<span class="lineNum">    2156 </span>            :   //
<span class="lineNum">    2157 </span>            :   AliGeomManager::ELayerID idTPC1 = AliGeomManager::kTPC1;
<span class="lineNum">    2158 </span>            :   Int_t modUID, modnum = 0;
<span class="lineNum">    2159 </span><span class="lineCov">          2 :   TString vpstr1 = &quot;ALIC_1/TPC_M_1/TPC_Drift_1/TPC_ENDCAP_1/TPC_SECT_&quot;;</span>
<span class="lineNum">    2160 </span><span class="lineCov">          1 :   TString vpstr2 = &quot;ALIC_1/TPC_M_1/TPC_Drift_1/TPC_ENDCAP_2/TPC_SECT_&quot;;</span>
<span class="lineNum">    2161 </span><span class="lineCov">          1 :   TString vpappend = &quot;/TPC_IROC_1&quot;;</span>
<span class="lineNum">    2162 </span><span class="lineCov">          1 :   TString snstr1=&quot;TPC/EndcapA/Sector&quot;;</span>
<span class="lineNum">    2163 </span><span class="lineCov">          1 :   TString snstr2=&quot;TPC/EndcapC/Sector&quot;;</span>
<span class="lineNum">    2164 </span><span class="lineCov">          1 :   TString snappend=&quot;/InnerChamber&quot;;</span>
<span class="lineNum">    2165 </span><span class="lineCov">          2 :   TString volpath, symname;</span>
<span class="lineNum">    2166 </span>            :   
<span class="lineNum">    2167 </span><span class="lineCov">         38 :   for(Int_t cnt=1; cnt&lt;=18; cnt++){</span>
<span class="lineNum">    2168 </span><span class="lineCov">         36 :     modUID = AliGeomManager::LayerToVolUID(idTPC1,modnum++);</span>
<span class="lineNum">    2169 </span><span class="lineCov">         18 :     volpath = vpstr1;</span>
<span class="lineNum">    2170 </span><span class="lineCov">         18 :     volpath += cnt;</span>
<span class="lineNum">    2171 </span><span class="lineCov">         18 :     volpath += vpappend;</span>
<span class="lineNum">    2172 </span><span class="lineCov">         18 :     symname = snstr1;</span>
<span class="lineNum">    2173 </span><span class="lineCov">         18 :     symname += cnt;</span>
<span class="lineNum">    2174 </span><span class="lineCov">         18 :     symname += snappend;</span>
<span class="lineNum">    2175 </span><span class="lineCov">         72 :     if(!gGeoManager-&gt;SetAlignableEntry(symname.Data(),volpath.Data(),modUID))</span>
<span class="lineNum">    2176 </span><span class="lineNoCov">          0 :       AliFatal(Form(&quot;Alignable entry %s not created. Volume path %s not valid&quot;, symname.Data(),volpath.Data()));</span>
<span class="lineNum">    2177 </span><span class="lineCov">         18 :     TGeoPNEntry *alignableEntry = gGeoManager-&gt;GetAlignableEntryByUID(modUID);</span>
<span class="lineNum">    2178 </span><span class="lineCov">         18 :     TGeoHMatrix* globMatrix = alignableEntry-&gt;GetGlobalOrig();</span>
<span class="lineNum">    2179 </span><span class="lineCov">         18 :     TGeoHMatrix* matTtoL = fTPCParam-&gt;Tracking2LocalMatrix(globMatrix,cnt-1);</span>
<span class="lineNum">    2180 </span><span class="lineCov">         18 :     alignableEntry-&gt;SetMatrix(matTtoL);</span>
<span class="lineNum">    2181 </span>            :   }
<span class="lineNum">    2182 </span>            : 
<span class="lineNum">    2183 </span><span class="lineCov">         38 :   for(Int_t cnt=1; cnt&lt;=18; cnt++){</span>
<span class="lineNum">    2184 </span><span class="lineCov">         36 :     modUID = AliGeomManager::LayerToVolUID(idTPC1,modnum++);</span>
<span class="lineNum">    2185 </span><span class="lineCov">         18 :     volpath = vpstr2;</span>
<span class="lineNum">    2186 </span><span class="lineCov">         18 :     volpath += cnt;</span>
<span class="lineNum">    2187 </span><span class="lineCov">         18 :     volpath += vpappend;</span>
<span class="lineNum">    2188 </span><span class="lineCov">         18 :     symname = snstr2;</span>
<span class="lineNum">    2189 </span><span class="lineCov">         18 :     symname += cnt;</span>
<span class="lineNum">    2190 </span><span class="lineCov">         18 :     symname += snappend;</span>
<span class="lineNum">    2191 </span><span class="lineCov">         72 :     if(!gGeoManager-&gt;SetAlignableEntry(symname.Data(),volpath.Data(),modUID))</span>
<span class="lineNum">    2192 </span><span class="lineNoCov">          0 :       AliFatal(Form(&quot;Alignable entry %s not created. Volume path %s not valid&quot;, symname.Data(),volpath.Data()));</span>
<span class="lineNum">    2193 </span><span class="lineCov">         18 :     TGeoPNEntry *alignableEntry = gGeoManager-&gt;GetAlignableEntryByUID(modUID);</span>
<span class="lineNum">    2194 </span><span class="lineCov">         18 :     TGeoHMatrix* globMatrix = alignableEntry-&gt;GetGlobalOrig();</span>
<span class="lineNum">    2195 </span><span class="lineCov">         18 :     TGeoHMatrix* matTtoL = fTPCParam-&gt;Tracking2LocalMatrix(globMatrix,18+cnt-1);</span>
<span class="lineNum">    2196 </span><span class="lineCov">         18 :     alignableEntry-&gt;SetMatrix(matTtoL);</span>
<span class="lineNum">    2197 </span>            :   }
<span class="lineNum">    2198 </span><span class="lineCov">          1 : }</span>
<a name="2199"><span class="lineNum">    2199 </span>            : </a>
<span class="lineNum">    2200 </span>            : //_____________________________________________________________________________
<span class="lineNum">    2201 </span>            : void AliTPCv2::SetOuterChambersAlignable() const
<span class="lineNum">    2202 </span>            : {
<span class="lineNum">    2203 </span>            :   //
<span class="lineNum">    2204 </span>            :   AliGeomManager::ELayerID idTPC2 = AliGeomManager::kTPC2;
<span class="lineNum">    2205 </span>            :   Int_t modUID, modnum = 0;
<span class="lineNum">    2206 </span><span class="lineCov">          2 :   TString vpstr1 = &quot;ALIC_1/TPC_M_1/TPC_Drift_1/TPC_ENDCAP_1/TPC_SECT_&quot;;</span>
<span class="lineNum">    2207 </span><span class="lineCov">          1 :   TString vpstr2 = &quot;ALIC_1/TPC_M_1/TPC_Drift_1/TPC_ENDCAP_2/TPC_SECT_&quot;;</span>
<span class="lineNum">    2208 </span><span class="lineCov">          1 :   TString vpappend = &quot;/TPC_OROC_1&quot;;</span>
<span class="lineNum">    2209 </span><span class="lineCov">          1 :   TString snstr1=&quot;TPC/EndcapA/Sector&quot;;</span>
<span class="lineNum">    2210 </span><span class="lineCov">          1 :   TString snstr2=&quot;TPC/EndcapC/Sector&quot;;</span>
<span class="lineNum">    2211 </span><span class="lineCov">          1 :   TString snappend=&quot;/OuterChamber&quot;;</span>
<span class="lineNum">    2212 </span><span class="lineCov">          2 :   TString volpath, symname;</span>
<span class="lineNum">    2213 </span>            :   
<span class="lineNum">    2214 </span><span class="lineCov">         38 :   for(Int_t cnt=1; cnt&lt;=18; cnt++){</span>
<span class="lineNum">    2215 </span><span class="lineCov">         36 :     modUID = AliGeomManager::LayerToVolUID(idTPC2,modnum++);</span>
<span class="lineNum">    2216 </span><span class="lineCov">         18 :     volpath = vpstr1;</span>
<span class="lineNum">    2217 </span><span class="lineCov">         18 :     volpath += cnt;</span>
<span class="lineNum">    2218 </span><span class="lineCov">         18 :     volpath += vpappend;</span>
<span class="lineNum">    2219 </span><span class="lineCov">         18 :     symname = snstr1;</span>
<span class="lineNum">    2220 </span><span class="lineCov">         18 :     symname += cnt;</span>
<span class="lineNum">    2221 </span><span class="lineCov">         18 :     symname += snappend;</span>
<span class="lineNum">    2222 </span><span class="lineCov">         72 :     if(!gGeoManager-&gt;SetAlignableEntry(symname.Data(),volpath.Data(),modUID))</span>
<span class="lineNum">    2223 </span><span class="lineNoCov">          0 :       AliFatal(Form(&quot;Alignable entry %s not created. Volume path %s not valid&quot;, symname.Data(),volpath.Data()));</span>
<span class="lineNum">    2224 </span><span class="lineCov">         18 :     TGeoPNEntry *alignableEntry = gGeoManager-&gt;GetAlignableEntryByUID(modUID);</span>
<span class="lineNum">    2225 </span><span class="lineCov">         18 :     TGeoHMatrix* globMatrix = alignableEntry-&gt;GetGlobalOrig();</span>
<span class="lineNum">    2226 </span><span class="lineCov">         18 :     TGeoHMatrix* matTtoL = fTPCParam-&gt;Tracking2LocalMatrix(globMatrix,36+cnt-1);</span>
<span class="lineNum">    2227 </span><span class="lineCov">         18 :     alignableEntry-&gt;SetMatrix(matTtoL);</span>
<span class="lineNum">    2228 </span>            :   }
<span class="lineNum">    2229 </span>            : 
<span class="lineNum">    2230 </span><span class="lineCov">         38 :   for(Int_t cnt=1; cnt&lt;=18; cnt++){</span>
<span class="lineNum">    2231 </span><span class="lineCov">         36 :     modUID = AliGeomManager::LayerToVolUID(idTPC2,modnum++);</span>
<span class="lineNum">    2232 </span><span class="lineCov">         18 :     volpath = vpstr2;</span>
<span class="lineNum">    2233 </span><span class="lineCov">         18 :     volpath += cnt;</span>
<span class="lineNum">    2234 </span><span class="lineCov">         18 :     volpath += vpappend;</span>
<span class="lineNum">    2235 </span><span class="lineCov">         18 :     symname = snstr2;</span>
<span class="lineNum">    2236 </span><span class="lineCov">         18 :     symname += cnt;</span>
<span class="lineNum">    2237 </span><span class="lineCov">         18 :     symname += snappend;</span>
<span class="lineNum">    2238 </span><span class="lineCov">         72 :     if(!gGeoManager-&gt;SetAlignableEntry(symname.Data(),volpath.Data(),modUID))</span>
<span class="lineNum">    2239 </span><span class="lineNoCov">          0 :       AliFatal(Form(&quot;Alignable entry %s not created. Volume path %s not valid&quot;, symname.Data(),volpath.Data()));</span>
<span class="lineNum">    2240 </span><span class="lineCov">         18 :     TGeoPNEntry *alignableEntry = gGeoManager-&gt;GetAlignableEntryByUID(modUID);</span>
<span class="lineNum">    2241 </span><span class="lineCov">         18 :     TGeoHMatrix* globMatrix = alignableEntry-&gt;GetGlobalOrig();</span>
<span class="lineNum">    2242 </span><span class="lineCov">         18 :     TGeoHMatrix* matTtoL = fTPCParam-&gt;Tracking2LocalMatrix(globMatrix,36+18+cnt-1);</span>
<span class="lineNum">    2243 </span><span class="lineCov">         18 :     alignableEntry-&gt;SetMatrix(matTtoL);</span>
<span class="lineNum">    2244 </span>            :   }
<span class="lineNum">    2245 </span><span class="lineCov">          1 : }</span>
<span class="lineNum">    2246 </span>            : 
<a name="2247"><span class="lineNum">    2247 </span>            : </a>
<span class="lineNum">    2248 </span>            : //_____________________________________________________________________________
<span class="lineNum">    2249 </span>            : void AliTPCv2::CreateMaterials()
<span class="lineNum">    2250 </span>            : {
<span class="lineNum">    2251 </span>            :   //
<span class="lineNum">    2252 </span>            :   // Define materials for version 2 of the Time Projection Chamber
<span class="lineNum">    2253 </span>            :   //
<span class="lineNum">    2254 </span>            :  
<span class="lineNum">    2255 </span><span class="lineCov">          2 :   AliTPC::CreateMaterials();</span>
<span class="lineNum">    2256 </span><span class="lineCov">          1 : }</span>
<a name="2257"><span class="lineNum">    2257 </span>            : </a>
<span class="lineNum">    2258 </span>            : //_____________________________________________________________________________
<span class="lineNum">    2259 </span>            : void AliTPCv2::Init()
<span class="lineNum">    2260 </span>            : {
<span class="lineNum">    2261 </span>            :   //
<span class="lineNum">    2262 </span>            :   // Initialises version 2 of the TPC after that it has been built
<span class="lineNum">    2263 </span>            :   //
<span class="lineNum">    2264 </span>            : 
<span class="lineNum">    2265 </span><span class="lineCov">          2 :   Int_t *idtmed = fIdtmed-&gt;GetArray();</span>
<span class="lineNum">    2266 </span>            :   
<span class="lineNum">    2267 </span><span class="lineCov">          1 :   AliTPC::Init();</span>
<span class="lineNum">    2268 </span>            : 
<span class="lineNum">    2269 </span>            :  
<span class="lineNum">    2270 </span><span class="lineCov">          1 :   fIdSens=TVirtualMC::GetMC()-&gt;VolId(&quot;TPC_Strip&quot;);  // one strip is always selected...</span>
<span class="lineNum">    2271 </span>            : 
<span class="lineNum">    2272 </span><span class="lineCov">          1 :   fIDrift=TVirtualMC::GetMC()-&gt;VolId(&quot;TPC_Drift&quot;);</span>
<span class="lineNum">    2273 </span><span class="lineCov">          1 :   fSecOld=-100; // fake number </span>
<span class="lineNum">    2274 </span>            : 
<span class="lineNum">    2275 </span><span class="lineCov">          1 :   TVirtualMC::GetMC()-&gt;SetMaxNStep(-120000); // max. number of steps increased</span>
<span class="lineNum">    2276 </span>            : 
<span class="lineNum">    2277 </span><span class="lineCov">          1 :   if (fPrimaryIonisation) {</span>
<span class="lineNum">    2278 </span>            :     // for FLUKA
<span class="lineNum">    2279 </span><span class="lineNoCov">          0 :       TVirtualMC::GetMC()-&gt;Gstpar(idtmed[2],&quot;PRIMIO_E&quot;, 20.77); // 1st ionisation potential</span>
<span class="lineNum">    2280 </span>            :  
<span class="lineNum">    2281 </span><span class="lineNoCov">          0 :       TVirtualMC::GetMC()-&gt;Gstpar(idtmed[2],&quot;PRIMIO_N&quot;, 14.35);</span>
<span class="lineNum">    2282 </span><span class="lineNoCov">          0 :       TVirtualMC::GetMC()-&gt;Gstpar(idtmed[2],&quot;LOSS&quot;, 14); // specific energy loss</span>
<span class="lineNum">    2283 </span><span class="lineNoCov">          0 :       TVirtualMC::GetMC()-&gt;Gstpar(idtmed[2],&quot;STRA&quot;,4);</span>
<span class="lineNum">    2284 </span><span class="lineNoCov">          0 :   } </span>
<span class="lineNum">    2285 </span>            :   // specific energy loss for geant3 is now defined in galice.cuts
<span class="lineNum">    2286 </span>            : 
<span class="lineNum">    2287 </span>            : 
<span class="lineNum">    2288 </span><span class="lineCov">          3 :   AliDebug(1,&quot;*** TPC version 2 initialized ***&quot;);</span>
<span class="lineNum">    2289 </span><span class="lineCov">          3 :   AliDebug(1,Form(&quot;Maximum number of steps = %d&quot;,TVirtualMC::GetMC()-&gt;GetMaxNStep()));</span>
<span class="lineNum">    2290 </span>            : 
<span class="lineNum">    2291 </span>            :   //
<span class="lineNum">    2292 </span>            :   
<span class="lineNum">    2293 </span><span class="lineCov">          1 : }</span>
<a name="2294"><span class="lineNum">    2294 </span>            : </a>
<span class="lineNum">    2295 </span>            : //_____________________________________________________________________________
<span class="lineNum">    2296 </span>            : void AliTPCv2::StepManager()
<span class="lineNum">    2297 </span>            : {
<span class="lineNum">    2298 </span>            :   //
<span class="lineNum">    2299 </span>            :   // Called for every step in the Time Projection Chamber
<span class="lineNum">    2300 </span>            :   //
<span class="lineNum">    2301 </span>            : 
<span class="lineNum">    2302 </span>            :   //
<span class="lineNum">    2303 </span>            :   // parameters used for the energy loss calculations
<span class="lineNum">    2304 </span>            :   //
<span class="lineNum">    2305 </span>            :   //const Float_t kprim = 14.35; // number of primary collisions per 1 cm
<span class="lineNum">    2306 </span>            :   //const Float_t kpoti = 20.77e-9; // first ionization potential for Ne/CO2
<span class="lineNum">    2307 </span>            :   //const Float_t kwIon = 35.97e-9; // energy for the ion-electron pair creation 
<span class="lineNum">    2308 </span>            :   const Float_t kScalewIonG4 = 0.85; // scale factor to tune kwIon for Geant4 
<span class="lineNum">    2309 </span>            :   const Float_t kFanoFactorG4 = 0.7; // parameter for smearing the number of ionizations (nel) using Geant4
<span class="lineNum">    2310 </span>            :   const Int_t   kMaxDistRef =15;     // maximal difference between 2 stored references 
<span class="lineNum">    2311 </span><span class="lineCov">    1729272 :   Float_t prim = fTPCParam-&gt;GetNprim();</span>
<span class="lineNum">    2312 </span><span class="lineCov">     864636 :   Float_t poti = fTPCParam-&gt;GetFpot();</span>
<span class="lineNum">    2313 </span><span class="lineCov">     864636 :   Float_t wIon = fTPCParam-&gt;GetWmean();</span>
<span class="lineNum">    2314 </span>            :  
<span class="lineNum">    2315 </span>            :   const Float_t kbig = 1.e10;
<span class="lineNum">    2316 </span>            : 
<span class="lineNum">    2317 </span><span class="lineCov">     864636 :   Int_t id,copy;</span>
<span class="lineNum">    2318 </span><span class="lineCov">     864636 :   Float_t hits[5];</span>
<span class="lineNum">    2319 </span><span class="lineCov">     864636 :   Int_t vol[2];  </span>
<span class="lineNum">    2320 </span><span class="lineCov">     864636 :   TLorentzVector p;</span>
<span class="lineNum">    2321 </span>            :   
<span class="lineNum">    2322 </span><span class="lineCov">     864636 :   vol[1]=0; // preset row number to 0</span>
<span class="lineNum">    2323 </span>            :   //
<span class="lineNum">    2324 </span><span class="lineCov">    2593908 :   if (!fPrimaryIonisation) TVirtualMC::GetMC()-&gt;SetMaxStep(kbig);</span>
<span class="lineNum">    2325 </span>            :   
<span class="lineNum">    2326 </span><span class="lineCov">    2594911 :   if(!TVirtualMC::GetMC()-&gt;IsTrackAlive()) return; // particle has disappeared</span>
<span class="lineNum">    2327 </span>            :   
<span class="lineNum">    2328 </span><span class="lineCov">    2590899 :   Float_t charge = TVirtualMC::GetMC()-&gt;TrackCharge();</span>
<span class="lineNum">    2329 </span>            :   
<span class="lineNum">    2330 </span><span class="lineCov">     889931 :   if(TMath::Abs(charge)&lt;=0.) return; // take only charged particles</span>
<span class="lineNum">    2331 </span>            :   
<span class="lineNum">    2332 </span>            :   // check the sensitive volume
<span class="lineNum">    2333 </span>            : 
<span class="lineNum">    2334 </span><span class="lineCov">    1674670 :   id = TVirtualMC::GetMC()-&gt;CurrentVolID(copy); // vol ID and copy number (starts from 1!)</span>
<span class="lineNum">    2335 </span><span class="lineCov">     863493 :   if(id != fIDrift &amp;&amp; id != fIdSens) return; // not in the sensitive folume </span>
<span class="lineNum">    2336 </span>            : 
<span class="lineNum">    2337 </span><span class="lineCov">     824399 :   if ( fPrimaryIonisation &amp;&amp; id == fIDrift ) {</span>
<span class="lineNum">    2338 </span><span class="lineNoCov">          0 :     Double_t rnd = TVirtualMC::GetMC()-&gt;GetRandom()-&gt;Rndm();</span>
<span class="lineNum">    2339 </span><span class="lineNoCov">          0 :     TVirtualMC::GetMC()-&gt;SetMaxStep(0.2+(2.*rnd-1.)*0.05);  // 2 mm +- rndm*0.5mm step</span>
<span class="lineNum">    2340 </span><span class="lineNoCov">          0 :   }   </span>
<span class="lineNum">    2341 </span>            : 
<span class="lineNum">    2342 </span>            :   //if ( fPrimaryIonisation &amp;&amp; id == fIDrift &amp;&amp; TVirtualMC::GetMC()-&gt;IsTrackEntering()) {
<span class="lineNum">    2343 </span>            :   //  TVirtualMC::GetMC()-&gt;SetMaxStep(0.2);  // 2 mm 
<span class="lineNum">    2344 </span>            :   //}   
<span class="lineNum">    2345 </span>            :   
<span class="lineNum">    2346 </span><span class="lineCov">    1648798 :   TVirtualMC::GetMC()-&gt;TrackPosition(p);</span>
<span class="lineNum">    2347 </span><span class="lineCov">    4121995 :   Double_t r = TMath::Sqrt(p[0]*p[0]+p[1]*p[1]);</span>
<span class="lineNum">    2348 </span>            :   //
<span class="lineNum">    2349 </span>            :   
<span class="lineNum">    2350 </span>            :   //
<span class="lineNum">    2351 </span><span class="lineCov">    1648798 :   Double_t angle = TMath::ACos(p[0]/r);  </span>
<span class="lineNum">    2352 </span><span class="lineCov">    3297596 :   angle = (p[1]&lt;0.) ? TMath::TwoPi()-angle : angle;</span>
<span class="lineNum">    2353 </span>            :   //
<span class="lineNum">    2354 </span>            :   // angular segment, it is not a real sector number...
<span class="lineNum">    2355 </span>            :   //
<span class="lineNum">    2356 </span><span class="lineCov">    2473197 :   Int_t sector=TMath::Nint((angle-fTPCParam-&gt;GetInnerAngleShift())/</span>
<span class="lineNum">    2357 </span><span class="lineCov">    1648798 :                fTPCParam-&gt;GetInnerAngle());</span>
<span class="lineNum">    2358 </span>            :   // rotate to segment &quot;0&quot;
<span class="lineNum">    2359 </span><span class="lineCov">     824399 :   Float_t cos,sin;</span>
<span class="lineNum">    2360 </span><span class="lineCov">     824399 :   fTPCParam-&gt;AdjustCosSin(sector,cos,sin);</span>
<span class="lineNum">    2361 </span><span class="lineCov">    2473197 :   Float_t x1=p[0]*cos + p[1]*sin;</span>
<span class="lineNum">    2362 </span>            :   // check if within sector's limits
<span class="lineNum">    2363 </span><span class="lineCov">    2009805 :   if((x1&gt;=fTPCParam-&gt;GetInnerRadiusLow()&amp;&amp;x1&lt;=fTPCParam-&gt;GetInnerRadiusUp())</span>
<span class="lineNum">    2364 </span><span class="lineCov">    1579824 :      ||(x1&gt;=fTPCParam-&gt;GetOuterRadiusLow()&amp;&amp;x1&lt;=fTPCParam-&gt;GetOuterRadiusUp())){</span>
<span class="lineNum">    2365 </span>            :   // calculate real sector number...
<span class="lineNum">    2366 </span><span class="lineCov">     740611 :   if (x1&gt;fTPCParam-&gt;GetOuterRadiusLow()){</span>
<span class="lineNum">    2367 </span><span class="lineCov">     931890 :     sector = TMath::Nint((angle-fTPCParam-&gt;GetOuterAngleShift())/</span>
<span class="lineNum">    2368 </span><span class="lineCov">     931890 :              fTPCParam-&gt;GetOuterAngle())+fTPCParam-&gt;GetNInnerSector();</span>
<span class="lineNum">    2369 </span><span class="lineCov">     790034 :     if (p[2]&lt;0)      sector+=(fTPCParam-&gt;GetNOuterSector()&gt;&gt;1);</span>
<span class="lineNum">    2370 </span>            :   }
<span class="lineNum">    2371 </span>            :     else   
<span class="lineNum">    2372 </span><span class="lineCov">    1087183 :       if (p[2]&lt;0) sector+=(fTPCParam-&gt;GetNInnerSector()&gt;&gt;1);  </span>
<span class="lineNum">    2373 </span>            :   //
<span class="lineNum">    2374 </span>            :   // here I have a sector number
<span class="lineNum">    2375 </span>            :   //
<span class="lineNum">    2376 </span>            : 
<span class="lineNum">    2377 </span><span class="lineCov">     740611 :   vol[0]=sector;</span>
<span class="lineNum">    2378 </span>            : 
<span class="lineNum">    2379 </span>            :   static Double_t lastReferenceR=0;
<span class="lineNum">    2380 </span><span class="lineCov">     740611 :   if (TMath::Abs(lastReferenceR-r)&gt;kMaxDistRef){</span>
<span class="lineNum">    2381 </span><span class="lineCov">       1796 :     AddTrackReference(gAlice-&gt;GetMCApp()-&gt;GetCurrentTrackNumber(), AliTrackReference::kTPC);</span>
<span class="lineNum">    2382 </span><span class="lineCov">        898 :     lastReferenceR = r;</span>
<span class="lineNum">    2383 </span><span class="lineCov">        898 :   }</span>
<span class="lineNum">    2384 </span>            : 
<span class="lineNum">    2385 </span>            :   // check if change of sector
<span class="lineNum">    2386 </span><span class="lineCov">     740611 :   if(sector != fSecOld){</span>
<span class="lineNum">    2387 </span><span class="lineCov">        354 :     fSecOld=sector;</span>
<span class="lineNum">    2388 </span>            :     // add track reference
<span class="lineNum">    2389 </span><span class="lineCov">        708 :     AddTrackReference(gAlice-&gt;GetMCApp()-&gt;GetCurrentTrackNumber(), AliTrackReference::kTPC);</span>
<span class="lineNum">    2390 </span>            :   }  
<span class="lineNum">    2391 </span>            :   // track is in the sensitive strip
<span class="lineNum">    2392 </span><span class="lineCov">     740611 :   if(id == fIdSens){</span>
<span class="lineNum">    2393 </span>            :     // track is entering the strip
<span class="lineNum">    2394 </span><span class="lineCov">        858 :     if (TVirtualMC::GetMC()-&gt;IsTrackEntering()){</span>
<span class="lineNum">    2395 </span><span class="lineCov">        363 :       Int_t totrows = fTPCParam-&gt;GetNRowLow()+fTPCParam-&gt;GetNRowUp();</span>
<span class="lineNum">    2396 </span><span class="lineCov">        121 :       vol[1] = (copy&lt;=totrows) ? copy-1 : copy-1-totrows;</span>
<span class="lineNum">    2397 </span>            :       // row numbers are autonomous for lower and upper sectors
<span class="lineNum">    2398 </span><span class="lineCov">        121 :       if(vol[0] &gt; fTPCParam-&gt;GetNInnerSector()) {</span>
<span class="lineNum">    2399 </span><span class="lineNoCov">          0 :         vol[1] -= fTPCParam-&gt;GetNRowLow();</span>
<span class="lineNum">    2400 </span><span class="lineNoCov">          0 :       }</span>
<span class="lineNum">    2401 </span>            :     //
<span class="lineNum">    2402 </span><span class="lineCov">        242 :       if(vol[0]&lt;fTPCParam-&gt;GetNInnerSector()&amp;&amp;vol[1] == 0){</span>
<span class="lineNum">    2403 </span>            :   
<span class="lineNum">    2404 </span>            :         // lower sector, row 0, because Jouri wants to have this
<span class="lineNum">    2405 </span>            : 
<span class="lineNum">    2406 </span><span class="lineCov">        242 :         TVirtualMC::GetMC()-&gt;TrackMomentum(p);</span>
<span class="lineNum">    2407 </span><span class="lineCov">        242 :         hits[0]=p[0];</span>
<span class="lineNum">    2408 </span><span class="lineCov">        242 :         hits[1]=p[1];</span>
<span class="lineNum">    2409 </span><span class="lineCov">        242 :         hits[2]=p[2];</span>
<span class="lineNum">    2410 </span><span class="lineCov">        121 :         hits[3]=0.; // this hit has no energy loss</span>
<span class="lineNum">    2411 </span>            :         // Get also the track time for pileup simulation
<span class="lineNum">    2412 </span><span class="lineCov">        363 :         hits[4]=TVirtualMC::GetMC()-&gt;TrackTime();</span>
<span class="lineNum">    2413 </span>            : 
<span class="lineNum">    2414 </span><span class="lineCov">        242 :         AddHit(gAlice-&gt;GetMCApp()-&gt;GetCurrentTrackNumber(), vol,hits);  </span>
<span class="lineNum">    2415 </span>            :       }
<span class="lineNum">    2416 </span>            :     //
<span class="lineNum">    2417 </span>            : 
<span class="lineNum">    2418 </span><span class="lineCov">        242 :        TVirtualMC::GetMC()-&gt;TrackPosition(p);</span>
<span class="lineNum">    2419 </span><span class="lineCov">        242 :        hits[0]=p[0];</span>
<span class="lineNum">    2420 </span><span class="lineCov">        242 :        hits[1]=p[1];</span>
<span class="lineNum">    2421 </span><span class="lineCov">        242 :        hits[2]=p[2];</span>
<span class="lineNum">    2422 </span><span class="lineCov">        121 :        hits[3]=0.; // this hit has no energy loss</span>
<span class="lineNum">    2423 </span>            :        // Get also the track time for pileup simulation
<span class="lineNum">    2424 </span><span class="lineCov">        363 :        hits[4]=TVirtualMC::GetMC()-&gt;TrackTime();</span>
<span class="lineNum">    2425 </span>            : 
<span class="lineNum">    2426 </span><span class="lineCov">        242 :        AddHit(gAlice-&gt;GetMCApp()-&gt;GetCurrentTrackNumber(), vol,hits);  </span>
<span class="lineNum">    2427 </span>            :     
<span class="lineNum">    2428 </span>            :     }
<span class="lineNum">    2429 </span><span class="lineCov">        165 :     else return;</span>
<span class="lineNum">    2430 </span><span class="lineCov">        121 :   }  </span>
<span class="lineNum">    2431 </span>            :   //-----------------------------------------------------------------
<span class="lineNum">    2432 </span>            :   //  charged particle is in the sensitive drift volume
<span class="lineNum">    2433 </span>            :   //-----------------------------------------------------------------
<span class="lineNum">    2434 </span><span class="lineCov">    2221338 :   if(TVirtualMC::GetMC()-&gt;TrackStep() &gt; 0) {</span>
<span class="lineNum">    2435 </span>            :     Int_t nel=0;
<span class="lineNum">    2436 </span><span class="lineCov">     739852 :     if (!fPrimaryIonisation) {</span>
<span class="lineNum">    2437 </span><span class="lineCov">    2219556 :       nel = (Int_t)(((TVirtualMC::GetMC()-&gt;Edep())-poti)/wIon) + 1;</span>
<span class="lineNum">    2438 </span><span class="lineCov">     739852 :     }</span>
<span class="lineNum">    2439 </span>            :     else {
<span class="lineNum">    2440 </span>            :       
<span class="lineNum">    2441 </span>            :       /*
<span class="lineNum">    2442 </span>            :       static Double_t deForNextStep = 0.;
<span class="lineNum">    2443 </span>            :       // Geant4 (the meaning of Edep as in Geant3) - wrong
<span class="lineNum">    2444 </span>            :       //nel = (Int_t)(((TVirtualMC::GetMC()-&gt;Edep())-poti)/wIon) + 1;
<span class="lineNum">    2445 </span>            : 
<span class="lineNum">    2446 </span>            :       // Geant4 (the meaning of Edep as in Geant3) - NEW
<span class="lineNum">    2447 </span>            :       Double_t eAvailable = TVirtualMC::GetMC()-&gt;Edep() + deForNextStep;
<span class="lineNum">    2448 </span>            :       nel = (Int_t)(eAvailable/wIon);
<span class="lineNum">    2449 </span>            :       deForNextStep = eAvailable - nel*wIon;
<span class="lineNum">    2450 </span>            :       */
<span class="lineNum">    2451 </span>            : 
<span class="lineNum">    2452 </span>            :       //new Geant4-approach
<span class="lineNum">    2453 </span><span class="lineNoCov">          0 :       Double_t meanIon = TVirtualMC::GetMC()-&gt;Edep()/(wIon*kScalewIonG4);</span>
<span class="lineNum">    2454 </span><span class="lineNoCov">          0 :       nel = (Int_t) ( kFanoFactorG4*AliMathBase::Gamma(meanIon/kFanoFactorG4)); // smear nel using gamma distr w mean = meanIon and variance = meanIon/kFanoFactorG4</span>
<span class="lineNum">    2455 </span>            :     }
<span class="lineNum">    2456 </span><span class="lineCov">     739852 :     nel=TMath::Min(nel,300); // 300 electrons corresponds to 10 keV</span>
<span class="lineNum">    2457 </span>            :     //
<span class="lineNum">    2458 </span><span class="lineCov">    1479704 :     TVirtualMC::GetMC()-&gt;TrackPosition(p);</span>
<span class="lineNum">    2459 </span><span class="lineCov">    1479704 :     hits[0]=p[0];</span>
<span class="lineNum">    2460 </span><span class="lineCov">    1479704 :     hits[1]=p[1];</span>
<span class="lineNum">    2461 </span><span class="lineCov">    1479704 :     hits[2]=p[2];</span>
<span class="lineNum">    2462 </span><span class="lineCov">     739852 :     hits[3]=(Float_t)nel;</span>
<span class="lineNum">    2463 </span>            : 
<span class="lineNum">    2464 </span>            :     // Add this hit
<span class="lineNum">    2465 </span>            : 
<span class="lineNum">    2466 </span>            :     //    if (fHitType&amp;&amp;2){
<span class="lineNum">    2467 </span><span class="lineCov">     739852 :     if(fHitType){</span>
<span class="lineNum">    2468 </span><span class="lineCov">    1479704 :       TVirtualMC::GetMC()-&gt;TrackMomentum(p);</span>
<span class="lineNum">    2469 </span><span class="lineCov">    3699260 :       Float_t momentum = TMath::Sqrt(p[0]*p[0]+p[1]*p[1]);</span>
<span class="lineNum">    2470 </span><span class="lineCov">     739852 :       Float_t precision =   (momentum&gt;0.1) ? 0.002 :0.01;</span>
<span class="lineNum">    2471 </span><span class="lineCov">     739852 :       fTrackHits-&gt;SetHitPrecision(precision);</span>
<span class="lineNum">    2472 </span><span class="lineCov">     739852 :     }</span>
<span class="lineNum">    2473 </span>            : 
<span class="lineNum">    2474 </span>            :     // Get also the track time for pileup simulation
<span class="lineNum">    2475 </span><span class="lineCov">    2219556 :     hits[4]=TVirtualMC::GetMC()-&gt;TrackTime();</span>
<span class="lineNum">    2476 </span>            :  
<span class="lineNum">    2477 </span><span class="lineCov">    1479704 :     AddHit(gAlice-&gt;GetMCApp()-&gt;GetCurrentTrackNumber(), vol,hits);</span>
<span class="lineNum">    2478 </span><span class="lineCov">     739852 :     if (fDebugStreamer){   </span>
<span class="lineNum">    2479 </span>            :       // You can dump here what you need
<span class="lineNum">    2480 </span>            :       // function  CreateDebugStremer() to be called in the Config.C  macro
<span class="lineNum">    2481 </span>            :       // if you want to enable it
<span class="lineNum">    2482 </span>            :       // By default debug streaemer is OFF
<span class="lineNum">    2483 </span><span class="lineNoCov">          0 :       Float_t edep = TVirtualMC::GetMC()-&gt;Edep();</span>
<span class="lineNum">    2484 </span><span class="lineNoCov">          0 :       Float_t tstep = TVirtualMC::GetMC()-&gt;TrackStep();</span>
<span class="lineNum">    2485 </span><span class="lineNoCov">          0 :       Int_t pid=TVirtualMC::GetMC()-&gt;TrackPid();</span>
<span class="lineNum">    2486 </span><span class="lineNoCov">          0 :       (*fDebugStreamer)&lt;&lt;&quot;hit&quot;&lt;&lt;      </span>
<span class="lineNum">    2487 </span><span class="lineNoCov">          0 :         &quot;x=&quot;&lt;&lt;hits[0]&lt;&lt;  // hit position</span>
<span class="lineNum">    2488 </span><span class="lineNoCov">          0 :         &quot;y=&quot;&lt;&lt;hits[1]&lt;&lt;</span>
<span class="lineNum">    2489 </span><span class="lineNoCov">          0 :         &quot;z=&quot;&lt;&lt;hits[2]&lt;&lt;</span>
<span class="lineNum">    2490 </span><span class="lineNoCov">          0 :         &quot;nel=&quot;&lt;&lt;hits[3]&lt;&lt;  // number of electorns</span>
<span class="lineNum">    2491 </span><span class="lineNoCov">          0 :         &quot;tof=&quot;&lt;&lt;hits[4]&lt;&lt;  // hit TOF</span>
<span class="lineNum">    2492 </span><span class="lineNoCov">          0 :         &quot;edep=&quot;&lt;&lt;edep&lt;&lt;    // energy deposit</span>
<span class="lineNum">    2493 </span><span class="lineNoCov">          0 :         &quot;pid=&quot;&lt;&lt;pid&lt;&lt;      // pid</span>
<span class="lineNum">    2494 </span><span class="lineNoCov">          0 :         &quot;step=&quot;&lt;&lt;tstep&lt;&lt;</span>
<span class="lineNum">    2495 </span><span class="lineNoCov">          0 :         &quot;p.=&quot;&lt;&lt;&amp;p&lt;&lt;</span>
<span class="lineNum">    2496 </span>            :         &quot;\n&quot;;
<span class="lineNum">    2497 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">    2498 </span>            :     
<span class="lineNum">    2499 </span><span class="lineCov">     739852 :   } // step&gt;0 </span>
<span class="lineNum">    2500 </span>            :   } //within sector's limits
<span class="lineNum">    2501 </span>            :   // Stemax calculation for the next step
<span class="lineNum">    2502 </span>            :   
<span class="lineNum">    2503 </span>            :   Float_t pp;
<span class="lineNum">    2504 </span><span class="lineCov">     824234 :   TLorentzVector mom;</span>
<span class="lineNum">    2505 </span>            :   // below is valid only for Geant3 (fPromaryIonisation not set)
<span class="lineNum">    2506 </span><span class="lineCov">     824234 :   if(!fPrimaryIonisation){</span>
<span class="lineNum">    2507 </span><span class="lineCov">    1648468 :     TVirtualMC::GetMC()-&gt;TrackMomentum(mom);</span>
<span class="lineNum">    2508 </span><span class="lineCov">    1648468 :     Float_t ptot=mom.Rho();</span>
<span class="lineNum">    2509 </span><span class="lineCov">    2472702 :     Float_t betaGamma = ptot/TVirtualMC::GetMC()-&gt;TrackMass();</span>
<span class="lineNum">    2510 </span>            : 
<span class="lineNum">    2511 </span>            :     //Int_t pid=TVirtualMC::GetMC()-&gt;TrackPid();
<span class="lineNum">    2512 </span>            :     // if((pid==kElectron || pid==kPositron) &amp;&amp; ptot &gt; 0.002)
<span class="lineNum">    2513 </span>            :     //       { 
<span class="lineNum">    2514 </span>            :     //         pp = prim*1.58; // electrons above 20 MeV/c are on the plateau!
<span class="lineNum">    2515 </span>            :     //       }
<span class="lineNum">    2516 </span>            :     //     else
<span class="lineNum">    2517 </span>            :     //       {
<span class="lineNum">    2518 </span>            :     
<span class="lineNum">    2519 </span><span class="lineCov">     824234 :     betaGamma = TMath::Max(betaGamma,(Float_t)7.e-3); // protection against too small bg</span>
<span class="lineNum">    2520 </span><span class="lineCov">     824234 :     TVectorD *bbpar = fTPCParam-&gt;GetBetheBlochParametersMC(); //get parametrization from OCDB</span>
<span class="lineNum">    2521 </span><span class="lineCov">    5769638 :     pp=prim*AliMathBase::BetheBlochAleph(betaGamma,(*bbpar)(0),(*bbpar)(1),(*bbpar)(2),(*bbpar)(3),(*bbpar)(4));         </span>
<span class="lineNum">    2522 </span>            :     //     }
<span class="lineNum">    2523 </span>            :   
<span class="lineNum">    2524 </span><span class="lineCov">    2472702 :     Double_t rnd = TVirtualMC::GetMC()-&gt;GetRandom()-&gt;Rndm();</span>
<span class="lineNum">    2525 </span>            :   
<span class="lineNum">    2526 </span><span class="lineCov">    1648468 :     TVirtualMC::GetMC()-&gt;SetMaxStep(-TMath::Log(rnd)/pp);</span>
<span class="lineNum">    2527 </span><span class="lineCov">     824234 :   }</span>
<span class="lineNum">    2528 </span>            :   
<span class="lineNum">    2529 </span><span class="lineCov">    2513269 : }</span>
<span class="lineNum">    2530 </span>            : 
<span class="lineNum">    2531 </span>            : 
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.11</a></td></tr>
  </table>
  <br>

</body>
</html>
